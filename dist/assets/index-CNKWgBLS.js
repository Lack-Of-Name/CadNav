var wx=e=>{throw TypeError(e)};var la=(e,t,n)=>t.has(e)?wx("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);function w1(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const l in s)if(l!=="default"&&!(l in e)){const f=Object.getOwnPropertyDescriptor(s,l);f&&Object.defineProperty(e,l,f.get?f:{enumerable:!0,get:()=>s[l]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const f of l)if(f.type==="childList")for(const m of f.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&s(m)}).observe(document,{childList:!0,subtree:!0});function n(l){const f={};return l.integrity&&(f.integrity=l.integrity),l.referrerPolicy&&(f.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?f.credentials="include":l.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function s(l){if(l.ep)return;l.ep=!0;const f=n(l);fetch(l.href,f)}})();var us=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var C1={exports:{}},Bc={},E1={exports:{}},ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ol=Symbol.for("react.element"),Cx=Symbol.for("react.portal"),Ex=Symbol.for("react.fragment"),bx=Symbol.for("react.strict_mode"),Sx=Symbol.for("react.profiler"),Ax=Symbol.for("react.provider"),Tx=Symbol.for("react.context"),Ix=Symbol.for("react.forward_ref"),Nx=Symbol.for("react.suspense"),Mx=Symbol.for("react.memo"),Rx=Symbol.for("react.lazy"),Td=Symbol.iterator;function kx(e){return e===null||typeof e!="object"?null:(e=Td&&e[Td]||e["@@iterator"],typeof e=="function"?e:null)}var b1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S1=Object.assign,A1={};function Zo(e,t,n){this.props=e,this.context=t,this.refs=A1,this.updater=n||b1}Zo.prototype.isReactComponent={};Zo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Zo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function T1(){}T1.prototype=Zo.prototype;function oh(e,t,n){this.props=e,this.context=t,this.refs=A1,this.updater=n||b1}var ah=oh.prototype=new T1;ah.constructor=oh;S1(ah,Zo.prototype);ah.isPureReactComponent=!0;var Id=Array.isArray,I1=Object.prototype.hasOwnProperty,lh={current:null},N1={key:!0,ref:!0,__self:!0,__source:!0};function M1(e,t,n){var s,l={},f=null,m=null;if(t!=null)for(s in t.ref!==void 0&&(m=t.ref),t.key!==void 0&&(f=""+t.key),t)I1.call(t,s)&&!N1.hasOwnProperty(s)&&(l[s]=t[s]);var v=arguments.length-2;if(v===1)l.children=n;else if(1<v){for(var _=Array(v),x=0;x<v;x++)_[x]=arguments[x+2];l.children=_}if(e&&e.defaultProps)for(s in v=e.defaultProps,v)l[s]===void 0&&(l[s]=v[s]);return{$$typeof:ol,type:e,key:f,ref:m,props:l,_owner:lh.current}}function Ox(e,t){return{$$typeof:ol,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ch(e){return typeof e=="object"&&e!==null&&e.$$typeof===ol}function Lx(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Nd=/\/+/g;function hu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Lx(""+e.key):t.toString(36)}function Ul(e,t,n,s,l){var f=typeof e;(f==="undefined"||f==="boolean")&&(e=null);var m=!1;if(e===null)m=!0;else switch(f){case"string":case"number":m=!0;break;case"object":switch(e.$$typeof){case ol:case Cx:m=!0}}if(m)return m=e,l=l(m),e=s===""?"."+hu(m,0):s,Id(l)?(n="",e!=null&&(n=e.replace(Nd,"$&/")+"/"),Ul(l,t,n,"",function(x){return x})):l!=null&&(ch(l)&&(l=Ox(l,n+(!l.key||m&&m.key===l.key?"":(""+l.key).replace(Nd,"$&/")+"/")+e)),t.push(l)),1;if(m=0,s=s===""?".":s+":",Id(e))for(var v=0;v<e.length;v++){f=e[v];var _=s+hu(f,v);m+=Ul(f,t,n,_,l)}else if(_=kx(e),typeof _=="function")for(e=_.call(e),v=0;!(f=e.next()).done;)f=f.value,_=s+hu(f,v++),m+=Ul(f,t,n,_,l);else if(f==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return m}function Cl(e,t,n){if(e==null)return e;var s=[],l=0;return Ul(e,s,"","",function(f){return t.call(n,f,l++)}),s}function Px(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var cr={current:null},Hl={transition:null},Dx={ReactCurrentDispatcher:cr,ReactCurrentBatchConfig:Hl,ReactCurrentOwner:lh};function R1(){throw Error("act(...) is not supported in production builds of React.")}ut.Children={map:Cl,forEach:function(e,t,n){Cl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Cl(e,function(){t++}),t},toArray:function(e){return Cl(e,function(t){return t})||[]},only:function(e){if(!ch(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ut.Component=Zo;ut.Fragment=Ex;ut.Profiler=Sx;ut.PureComponent=oh;ut.StrictMode=bx;ut.Suspense=Nx;ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Dx;ut.act=R1;ut.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=S1({},e.props),l=e.key,f=e.ref,m=e._owner;if(t!=null){if(t.ref!==void 0&&(f=t.ref,m=lh.current),t.key!==void 0&&(l=""+t.key),e.type&&e.type.defaultProps)var v=e.type.defaultProps;for(_ in t)I1.call(t,_)&&!N1.hasOwnProperty(_)&&(s[_]=t[_]===void 0&&v!==void 0?v[_]:t[_])}var _=arguments.length-2;if(_===1)s.children=n;else if(1<_){v=Array(_);for(var x=0;x<_;x++)v[x]=arguments[x+2];s.children=v}return{$$typeof:ol,type:e.type,key:l,ref:f,props:s,_owner:m}};ut.createContext=function(e){return e={$$typeof:Tx,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Ax,_context:e},e.Consumer=e};ut.createElement=M1;ut.createFactory=function(e){var t=M1.bind(null,e);return t.type=e,t};ut.createRef=function(){return{current:null}};ut.forwardRef=function(e){return{$$typeof:Ix,render:e}};ut.isValidElement=ch;ut.lazy=function(e){return{$$typeof:Rx,_payload:{_status:-1,_result:e},_init:Px}};ut.memo=function(e,t){return{$$typeof:Mx,type:e,compare:t===void 0?null:t}};ut.startTransition=function(e){var t=Hl.transition;Hl.transition={};try{e()}finally{Hl.transition=t}};ut.unstable_act=R1;ut.useCallback=function(e,t){return cr.current.useCallback(e,t)};ut.useContext=function(e){return cr.current.useContext(e)};ut.useDebugValue=function(){};ut.useDeferredValue=function(e){return cr.current.useDeferredValue(e)};ut.useEffect=function(e,t){return cr.current.useEffect(e,t)};ut.useId=function(){return cr.current.useId()};ut.useImperativeHandle=function(e,t,n){return cr.current.useImperativeHandle(e,t,n)};ut.useInsertionEffect=function(e,t){return cr.current.useInsertionEffect(e,t)};ut.useLayoutEffect=function(e,t){return cr.current.useLayoutEffect(e,t)};ut.useMemo=function(e,t){return cr.current.useMemo(e,t)};ut.useReducer=function(e,t,n){return cr.current.useReducer(e,t,n)};ut.useRef=function(e){return cr.current.useRef(e)};ut.useState=function(e){return cr.current.useState(e)};ut.useSyncExternalStore=function(e,t,n){return cr.current.useSyncExternalStore(e,t,n)};ut.useTransition=function(){return cr.current.useTransition()};ut.version="18.3.1";E1.exports=ut;var Y=E1.exports;const Gt=sl(Y);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bx=Y,Fx=Symbol.for("react.element"),jx=Symbol.for("react.fragment"),zx=Object.prototype.hasOwnProperty,Ux=Bx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Hx={key:!0,ref:!0,__self:!0,__source:!0};function k1(e,t,n){var s,l={},f=null,m=null;n!==void 0&&(f=""+n),t.key!==void 0&&(f=""+t.key),t.ref!==void 0&&(m=t.ref);for(s in t)zx.call(t,s)&&!Hx.hasOwnProperty(s)&&(l[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)l[s]===void 0&&(l[s]=t[s]);return{$$typeof:Fx,type:e,key:f,ref:m,props:l,_owner:Ux.current}}Bc.Fragment=jx;Bc.jsx=k1;Bc.jsxs=k1;C1.exports=Bc;var T=C1.exports,Vu={},O1={exports:{}},Lr={},L1={exports:{}},P1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(J,de){var ae=J.length;J.push(de);e:for(;0<ae;){var Ce=ae-1>>>1,Ne=J[Ce];if(0<l(Ne,de))J[Ce]=de,J[ae]=Ne,ae=Ce;else break e}}function n(J){return J.length===0?null:J[0]}function s(J){if(J.length===0)return null;var de=J[0],ae=J.pop();if(ae!==de){J[0]=ae;e:for(var Ce=0,Ne=J.length,Qe=Ne>>>1;Ce<Qe;){var we=2*(Ce+1)-1,Le=J[we],ge=we+1,mt=J[ge];if(0>l(Le,ae))ge<Ne&&0>l(mt,Le)?(J[Ce]=mt,J[ge]=ae,Ce=ge):(J[Ce]=Le,J[we]=ae,Ce=we);else if(ge<Ne&&0>l(mt,ae))J[Ce]=mt,J[ge]=ae,Ce=ge;else break e}}return de}function l(J,de){var ae=J.sortIndex-de.sortIndex;return ae!==0?ae:J.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var f=performance;e.unstable_now=function(){return f.now()}}else{var m=Date,v=m.now();e.unstable_now=function(){return m.now()-v}}var _=[],x=[],E=1,b=null,M=3,F=!1,z=!1,U=!1,re=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(J){for(var de=n(x);de!==null;){if(de.callback===null)s(x);else if(de.startTime<=J)s(x),de.sortIndex=de.expirationTime,t(_,de);else break;de=n(x)}}function $(J){if(U=!1,B(J),!z)if(n(_)!==null)z=!0,ye(fe);else{var de=n(x);de!==null&&he($,de.startTime-J)}}function fe(J,de){z=!1,U&&(U=!1,H(q),q=-1),F=!0;var ae=M;try{for(B(de),b=n(_);b!==null&&(!(b.expirationTime>de)||J&&!ce());){var Ce=b.callback;if(typeof Ce=="function"){b.callback=null,M=b.priorityLevel;var Ne=Ce(b.expirationTime<=de);de=e.unstable_now(),typeof Ne=="function"?b.callback=Ne:b===n(_)&&s(_),B(de)}else s(_);b=n(_)}if(b!==null)var Qe=!0;else{var we=n(x);we!==null&&he($,we.startTime-de),Qe=!1}return Qe}finally{b=null,M=ae,F=!1}}var pe=!1,K=null,q=-1,V=5,le=-1;function ce(){return!(e.unstable_now()-le<V)}function ue(){if(K!==null){var J=e.unstable_now();le=J;var de=!0;try{de=K(!0,J)}finally{de?Q():(pe=!1,K=null)}}else pe=!1}var Q;if(typeof D=="function")Q=function(){D(ue)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,Z=ne.port2;ne.port1.onmessage=ue,Q=function(){Z.postMessage(null)}}else Q=function(){re(ue,0)};function ye(J){K=J,pe||(pe=!0,Q())}function he(J,de){q=re(function(){J(e.unstable_now())},de)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){z||F||(z=!0,ye(fe))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return M},e.unstable_getFirstCallbackNode=function(){return n(_)},e.unstable_next=function(J){switch(M){case 1:case 2:case 3:var de=3;break;default:de=M}var ae=M;M=de;try{return J()}finally{M=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,de){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var ae=M;M=J;try{return de()}finally{M=ae}},e.unstable_scheduleCallback=function(J,de,ae){var Ce=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?Ce+ae:Ce):ae=Ce,J){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=ae+Ne,J={id:E++,callback:de,priorityLevel:J,startTime:ae,expirationTime:Ne,sortIndex:-1},ae>Ce?(J.sortIndex=ae,t(x,J),n(_)===null&&J===n(x)&&(U?(H(q),q=-1):U=!0,he($,ae-Ce))):(J.sortIndex=Ne,t(_,J),z||F||(z=!0,ye(fe))),J},e.unstable_shouldYield=ce,e.unstable_wrapCallback=function(J){var de=M;return function(){var ae=M;M=de;try{return J.apply(this,arguments)}finally{M=ae}}}})(P1);L1.exports=P1;var Vx=L1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wx=Y,Or=Vx;function Se(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var D1=new Set,ja={};function Js(e,t){Bo(e,t),Bo(e+"Capture",t)}function Bo(e,t){for(ja[e]=t,e=0;e<t.length;e++)D1.add(t[e])}var Yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wu=Object.prototype.hasOwnProperty,Zx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Md={},Rd={};function Gx(e){return Wu.call(Rd,e)?!0:Wu.call(Md,e)?!1:Zx.test(e)?Rd[e]=!0:(Md[e]=!0,!1)}function Yx(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Xx(e,t,n,s){if(t===null||typeof t>"u"||Yx(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ur(e,t,n,s,l,f,m){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=l,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=f,this.removeEmptyString=m}var Dn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Dn[e]=new ur(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Dn[t]=new ur(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Dn[e]=new ur(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Dn[e]=new ur(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Dn[e]=new ur(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Dn[e]=new ur(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Dn[e]=new ur(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Dn[e]=new ur(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Dn[e]=new ur(e,5,!1,e.toLowerCase(),null,!1,!1)});var uh=/[\-:]([a-z])/g;function fh(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(uh,fh);Dn[t]=new ur(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(uh,fh);Dn[t]=new ur(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(uh,fh);Dn[t]=new ur(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Dn[e]=new ur(e,1,!1,e.toLowerCase(),null,!1,!1)});Dn.xlinkHref=new ur("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Dn[e]=new ur(e,1,!1,e.toLowerCase(),null,!0,!0)});function hh(e,t,n,s){var l=Dn.hasOwnProperty(t)?Dn[t]:null;(l!==null?l.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Xx(t,n,l,s)&&(n=null),s||l===null?Gx(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):l.mustUseProperty?e[l.propertyName]=n===null?l.type===3?!1:"":n:(t=l.attributeName,s=l.attributeNamespace,n===null?e.removeAttribute(t):(l=l.type,n=l===3||l===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var Ki=Wx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,El=Symbol.for("react.element"),go=Symbol.for("react.portal"),mo=Symbol.for("react.fragment"),dh=Symbol.for("react.strict_mode"),Zu=Symbol.for("react.profiler"),B1=Symbol.for("react.provider"),F1=Symbol.for("react.context"),ph=Symbol.for("react.forward_ref"),Gu=Symbol.for("react.suspense"),Yu=Symbol.for("react.suspense_list"),gh=Symbol.for("react.memo"),ls=Symbol.for("react.lazy"),j1=Symbol.for("react.offscreen"),kd=Symbol.iterator;function ca(e){return e===null||typeof e!="object"?null:(e=kd&&e[kd]||e["@@iterator"],typeof e=="function"?e:null)}var en=Object.assign,du;function wa(e){if(du===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);du=t&&t[1]||""}return`
`+du+e}var pu=!1;function gu(e,t){if(!e||pu)return"";pu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(x){var s=x}Reflect.construct(e,[],t)}else{try{t.call()}catch(x){s=x}e.call(t.prototype)}else{try{throw Error()}catch(x){s=x}e()}}catch(x){if(x&&s&&typeof x.stack=="string"){for(var l=x.stack.split(`
`),f=s.stack.split(`
`),m=l.length-1,v=f.length-1;1<=m&&0<=v&&l[m]!==f[v];)v--;for(;1<=m&&0<=v;m--,v--)if(l[m]!==f[v]){if(m!==1||v!==1)do if(m--,v--,0>v||l[m]!==f[v]){var _=`
`+l[m].replace(" at new "," at ");return e.displayName&&_.includes("<anonymous>")&&(_=_.replace("<anonymous>",e.displayName)),_}while(1<=m&&0<=v);break}}}finally{pu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?wa(e):""}function $x(e){switch(e.tag){case 5:return wa(e.type);case 16:return wa("Lazy");case 13:return wa("Suspense");case 19:return wa("SuspenseList");case 0:case 2:case 15:return e=gu(e.type,!1),e;case 11:return e=gu(e.type.render,!1),e;case 1:return e=gu(e.type,!0),e;default:return""}}function Xu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case mo:return"Fragment";case go:return"Portal";case Zu:return"Profiler";case dh:return"StrictMode";case Gu:return"Suspense";case Yu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case F1:return(e.displayName||"Context")+".Consumer";case B1:return(e._context.displayName||"Context")+".Provider";case ph:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case gh:return t=e.displayName||null,t!==null?t:Xu(e.type)||"Memo";case ls:t=e._payload,e=e._init;try{return Xu(e(t))}catch{}}return null}function Qx(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xu(t);case 8:return t===dh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ss(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function z1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Kx(e){var t=z1(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var l=n.get,f=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(m){s=""+m,f.call(this,m)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(m){s=""+m},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bl(e){e._valueTracker||(e._valueTracker=Kx(e))}function U1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=z1(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function ac(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function $u(e,t){var n=t.checked;return en({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Od(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=Ss(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function H1(e,t){t=t.checked,t!=null&&hh(e,"checked",t,!1)}function Qu(e,t){H1(e,t);var n=Ss(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ku(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ku(e,t.type,Ss(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ld(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Ku(e,t,n){(t!=="number"||ac(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ca=Array.isArray;function No(e,t,n,s){if(e=e.options,t){t={};for(var l=0;l<n.length;l++)t["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=t.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Ss(n),t=null,l=0;l<e.length;l++){if(e[l].value===n){e[l].selected=!0,s&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function qu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Se(91));return en({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Pd(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Se(92));if(Ca(n)){if(1<n.length)throw Error(Se(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Ss(n)}}function V1(e,t){var n=Ss(t.value),s=Ss(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function Dd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function W1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ju(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?W1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Sl,Z1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,l){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,l)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Sl=Sl||document.createElement("div"),Sl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Sl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function za(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Aa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qx=["Webkit","ms","Moz","O"];Object.keys(Aa).forEach(function(e){qx.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Aa[t]=Aa[e]})});function G1(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Aa.hasOwnProperty(e)&&Aa[e]?(""+t).trim():t+"px"}function Y1(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,l=G1(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,l):e[n]=l}}var Jx=en({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ef(e,t){if(t){if(Jx[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Se(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Se(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Se(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Se(62))}}function tf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nf=null;function mh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var rf=null,Mo=null,Ro=null;function Bd(e){if(e=cl(e)){if(typeof rf!="function")throw Error(Se(280));var t=e.stateNode;t&&(t=Hc(t),rf(e.stateNode,e.type,t))}}function X1(e){Mo?Ro?Ro.push(e):Ro=[e]:Mo=e}function $1(){if(Mo){var e=Mo,t=Ro;if(Ro=Mo=null,Bd(e),t)for(e=0;e<t.length;e++)Bd(t[e])}}function Q1(e,t){return e(t)}function K1(){}var mu=!1;function q1(e,t,n){if(mu)return e(t,n);mu=!0;try{return Q1(e,t,n)}finally{mu=!1,(Mo!==null||Ro!==null)&&(K1(),$1())}}function Ua(e,t){var n=e.stateNode;if(n===null)return null;var s=Hc(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Se(231,t,typeof n));return n}var sf=!1;if(Yi)try{var ua={};Object.defineProperty(ua,"passive",{get:function(){sf=!0}}),window.addEventListener("test",ua,ua),window.removeEventListener("test",ua,ua)}catch{sf=!1}function e2(e,t,n,s,l,f,m,v,_){var x=Array.prototype.slice.call(arguments,3);try{t.apply(n,x)}catch(E){this.onError(E)}}var Ta=!1,lc=null,cc=!1,of=null,t2={onError:function(e){Ta=!0,lc=e}};function n2(e,t,n,s,l,f,m,v,_){Ta=!1,lc=null,e2.apply(t2,arguments)}function r2(e,t,n,s,l,f,m,v,_){if(n2.apply(this,arguments),Ta){if(Ta){var x=lc;Ta=!1,lc=null}else throw Error(Se(198));cc||(cc=!0,of=x)}}function eo(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function J1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Fd(e){if(eo(e)!==e)throw Error(Se(188))}function i2(e){var t=e.alternate;if(!t){if(t=eo(e),t===null)throw Error(Se(188));return t!==e?null:e}for(var n=e,s=t;;){var l=n.return;if(l===null)break;var f=l.alternate;if(f===null){if(s=l.return,s!==null){n=s;continue}break}if(l.child===f.child){for(f=l.child;f;){if(f===n)return Fd(l),e;if(f===s)return Fd(l),t;f=f.sibling}throw Error(Se(188))}if(n.return!==s.return)n=l,s=f;else{for(var m=!1,v=l.child;v;){if(v===n){m=!0,n=l,s=f;break}if(v===s){m=!0,s=l,n=f;break}v=v.sibling}if(!m){for(v=f.child;v;){if(v===n){m=!0,n=f,s=l;break}if(v===s){m=!0,s=f,n=l;break}v=v.sibling}if(!m)throw Error(Se(189))}}if(n.alternate!==s)throw Error(Se(190))}if(n.tag!==3)throw Error(Se(188));return n.stateNode.current===n?e:t}function ep(e){return e=i2(e),e!==null?tp(e):null}function tp(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=tp(e);if(t!==null)return t;e=e.sibling}return null}var np=Or.unstable_scheduleCallback,jd=Or.unstable_cancelCallback,s2=Or.unstable_shouldYield,o2=Or.unstable_requestPaint,fn=Or.unstable_now,a2=Or.unstable_getCurrentPriorityLevel,xh=Or.unstable_ImmediatePriority,rp=Or.unstable_UserBlockingPriority,uc=Or.unstable_NormalPriority,l2=Or.unstable_LowPriority,ip=Or.unstable_IdlePriority,Fc=null,Mi=null;function c2(e){if(Mi&&typeof Mi.onCommitFiberRoot=="function")try{Mi.onCommitFiberRoot(Fc,e,void 0,(e.current.flags&128)===128)}catch{}}var hi=Math.clz32?Math.clz32:h2,u2=Math.log,f2=Math.LN2;function h2(e){return e>>>=0,e===0?32:31-(u2(e)/f2|0)|0}var Al=64,Tl=4194304;function Ea(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function fc(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,l=e.suspendedLanes,f=e.pingedLanes,m=n&268435455;if(m!==0){var v=m&~l;v!==0?s=Ea(v):(f&=m,f!==0&&(s=Ea(f)))}else m=n&~l,m!==0?s=Ea(m):f!==0&&(s=Ea(f));if(s===0)return 0;if(t!==0&&t!==s&&!(t&l)&&(l=s&-s,f=t&-t,l>=f||l===16&&(f&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-hi(t),l=1<<n,s|=e[n],t&=~l;return s}function d2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function p2(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,l=e.expirationTimes,f=e.pendingLanes;0<f;){var m=31-hi(f),v=1<<m,_=l[m];_===-1?(!(v&n)||v&s)&&(l[m]=d2(v,t)):_<=t&&(e.expiredLanes|=v),f&=~v}}function af(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function sp(){var e=Al;return Al<<=1,!(Al&4194240)&&(Al=64),e}function xu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function al(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-hi(t),e[t]=n}function g2(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var l=31-hi(n),f=1<<l;t[l]=0,s[l]=-1,e[l]=-1,n&=~f}}function yh(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-hi(n),l=1<<s;l&t|e[s]&t&&(e[s]|=t),n&=~l}}var Tt=0;function op(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ap,_h,lp,cp,up,lf=!1,Il=[],ms=null,xs=null,ys=null,Ha=new Map,Va=new Map,fs=[],m2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zd(e,t){switch(e){case"focusin":case"focusout":ms=null;break;case"dragenter":case"dragleave":xs=null;break;case"mouseover":case"mouseout":ys=null;break;case"pointerover":case"pointerout":Ha.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Va.delete(t.pointerId)}}function fa(e,t,n,s,l,f){return e===null||e.nativeEvent!==f?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:f,targetContainers:[l]},t!==null&&(t=cl(t),t!==null&&_h(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function x2(e,t,n,s,l){switch(t){case"focusin":return ms=fa(ms,e,t,n,s,l),!0;case"dragenter":return xs=fa(xs,e,t,n,s,l),!0;case"mouseover":return ys=fa(ys,e,t,n,s,l),!0;case"pointerover":var f=l.pointerId;return Ha.set(f,fa(Ha.get(f)||null,e,t,n,s,l)),!0;case"gotpointercapture":return f=l.pointerId,Va.set(f,fa(Va.get(f)||null,e,t,n,s,l)),!0}return!1}function fp(e){var t=Us(e.target);if(t!==null){var n=eo(t);if(n!==null){if(t=n.tag,t===13){if(t=J1(n),t!==null){e.blockedOn=t,up(e.priority,function(){lp(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Vl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=cf(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);nf=s,n.target.dispatchEvent(s),nf=null}else return t=cl(n),t!==null&&_h(t),e.blockedOn=n,!1;t.shift()}return!0}function Ud(e,t,n){Vl(e)&&n.delete(t)}function y2(){lf=!1,ms!==null&&Vl(ms)&&(ms=null),xs!==null&&Vl(xs)&&(xs=null),ys!==null&&Vl(ys)&&(ys=null),Ha.forEach(Ud),Va.forEach(Ud)}function ha(e,t){e.blockedOn===t&&(e.blockedOn=null,lf||(lf=!0,Or.unstable_scheduleCallback(Or.unstable_NormalPriority,y2)))}function Wa(e){function t(l){return ha(l,e)}if(0<Il.length){ha(Il[0],e);for(var n=1;n<Il.length;n++){var s=Il[n];s.blockedOn===e&&(s.blockedOn=null)}}for(ms!==null&&ha(ms,e),xs!==null&&ha(xs,e),ys!==null&&ha(ys,e),Ha.forEach(t),Va.forEach(t),n=0;n<fs.length;n++)s=fs[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<fs.length&&(n=fs[0],n.blockedOn===null);)fp(n),n.blockedOn===null&&fs.shift()}var ko=Ki.ReactCurrentBatchConfig,hc=!0;function _2(e,t,n,s){var l=Tt,f=ko.transition;ko.transition=null;try{Tt=1,vh(e,t,n,s)}finally{Tt=l,ko.transition=f}}function v2(e,t,n,s){var l=Tt,f=ko.transition;ko.transition=null;try{Tt=4,vh(e,t,n,s)}finally{Tt=l,ko.transition=f}}function vh(e,t,n,s){if(hc){var l=cf(e,t,n,s);if(l===null)Tu(e,t,s,dc,n),zd(e,s);else if(x2(l,e,t,n,s))s.stopPropagation();else if(zd(e,s),t&4&&-1<m2.indexOf(e)){for(;l!==null;){var f=cl(l);if(f!==null&&ap(f),f=cf(e,t,n,s),f===null&&Tu(e,t,s,dc,n),f===l)break;l=f}l!==null&&s.stopPropagation()}else Tu(e,t,s,null,n)}}var dc=null;function cf(e,t,n,s){if(dc=null,e=mh(s),e=Us(e),e!==null)if(t=eo(e),t===null)e=null;else if(n=t.tag,n===13){if(e=J1(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return dc=e,null}function hp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(a2()){case xh:return 1;case rp:return 4;case uc:case l2:return 16;case ip:return 536870912;default:return 16}default:return 16}}var ds=null,wh=null,Wl=null;function dp(){if(Wl)return Wl;var e,t=wh,n=t.length,s,l="value"in ds?ds.value:ds.textContent,f=l.length;for(e=0;e<n&&t[e]===l[e];e++);var m=n-e;for(s=1;s<=m&&t[n-s]===l[f-s];s++);return Wl=l.slice(e,1<s?1-s:void 0)}function Zl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Nl(){return!0}function Hd(){return!1}function Pr(e){function t(n,s,l,f,m){this._reactName=n,this._targetInst=l,this.type=s,this.nativeEvent=f,this.target=m,this.currentTarget=null;for(var v in e)e.hasOwnProperty(v)&&(n=e[v],this[v]=n?n(f):f[v]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Nl:Hd,this.isPropagationStopped=Hd,this}return en(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Nl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Nl)},persist:function(){},isPersistent:Nl}),t}var Go={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ch=Pr(Go),ll=en({},Go,{view:0,detail:0}),w2=Pr(ll),yu,_u,da,jc=en({},ll,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Eh,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==da&&(da&&e.type==="mousemove"?(yu=e.screenX-da.screenX,_u=e.screenY-da.screenY):_u=yu=0,da=e),yu)},movementY:function(e){return"movementY"in e?e.movementY:_u}}),Vd=Pr(jc),C2=en({},jc,{dataTransfer:0}),E2=Pr(C2),b2=en({},ll,{relatedTarget:0}),vu=Pr(b2),S2=en({},Go,{animationName:0,elapsedTime:0,pseudoElement:0}),A2=Pr(S2),T2=en({},Go,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),I2=Pr(T2),N2=en({},Go,{data:0}),Wd=Pr(N2),M2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},R2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},k2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function O2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=k2[e])?!!t[e]:!1}function Eh(){return O2}var L2=en({},ll,{key:function(e){if(e.key){var t=M2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Zl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?R2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Eh,charCode:function(e){return e.type==="keypress"?Zl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Zl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),P2=Pr(L2),D2=en({},jc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zd=Pr(D2),B2=en({},ll,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Eh}),F2=Pr(B2),j2=en({},Go,{propertyName:0,elapsedTime:0,pseudoElement:0}),z2=Pr(j2),U2=en({},jc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),H2=Pr(U2),V2=[9,13,27,32],bh=Yi&&"CompositionEvent"in window,Ia=null;Yi&&"documentMode"in document&&(Ia=document.documentMode);var W2=Yi&&"TextEvent"in window&&!Ia,pp=Yi&&(!bh||Ia&&8<Ia&&11>=Ia),Gd=" ",Yd=!1;function gp(e,t){switch(e){case"keyup":return V2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xo=!1;function Z2(e,t){switch(e){case"compositionend":return mp(t);case"keypress":return t.which!==32?null:(Yd=!0,Gd);case"textInput":return e=t.data,e===Gd&&Yd?null:e;default:return null}}function G2(e,t){if(xo)return e==="compositionend"||!bh&&gp(e,t)?(e=dp(),Wl=wh=ds=null,xo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return pp&&t.locale!=="ko"?null:t.data;default:return null}}var Y2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Y2[e.type]:t==="textarea"}function xp(e,t,n,s){X1(s),t=pc(t,"onChange"),0<t.length&&(n=new Ch("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Na=null,Za=null;function X2(e){Ip(e,0)}function zc(e){var t=vo(e);if(U1(t))return e}function $2(e,t){if(e==="change")return t}var yp=!1;if(Yi){var wu;if(Yi){var Cu="oninput"in document;if(!Cu){var $d=document.createElement("div");$d.setAttribute("oninput","return;"),Cu=typeof $d.oninput=="function"}wu=Cu}else wu=!1;yp=wu&&(!document.documentMode||9<document.documentMode)}function Qd(){Na&&(Na.detachEvent("onpropertychange",_p),Za=Na=null)}function _p(e){if(e.propertyName==="value"&&zc(Za)){var t=[];xp(t,Za,e,mh(e)),q1(X2,t)}}function Q2(e,t,n){e==="focusin"?(Qd(),Na=t,Za=n,Na.attachEvent("onpropertychange",_p)):e==="focusout"&&Qd()}function K2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return zc(Za)}function q2(e,t){if(e==="click")return zc(t)}function J2(e,t){if(e==="input"||e==="change")return zc(t)}function ey(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var pi=typeof Object.is=="function"?Object.is:ey;function Ga(e,t){if(pi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var l=n[s];if(!Wu.call(t,l)||!pi(e[l],t[l]))return!1}return!0}function Kd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function qd(e,t){var n=Kd(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Kd(n)}}function vp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?vp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function wp(){for(var e=window,t=ac();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ac(e.document)}return t}function Sh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ty(e){var t=wp(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&vp(n.ownerDocument.documentElement,n)){if(s!==null&&Sh(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=n.textContent.length,f=Math.min(s.start,l);s=s.end===void 0?f:Math.min(s.end,l),!e.extend&&f>s&&(l=s,s=f,f=l),l=qd(n,f);var m=qd(n,s);l&&m&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==m.node||e.focusOffset!==m.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),f>s?(e.addRange(t),e.extend(m.node,m.offset)):(t.setEnd(m.node,m.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ny=Yi&&"documentMode"in document&&11>=document.documentMode,yo=null,uf=null,Ma=null,ff=!1;function Jd(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ff||yo==null||yo!==ac(s)||(s=yo,"selectionStart"in s&&Sh(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Ma&&Ga(Ma,s)||(Ma=s,s=pc(uf,"onSelect"),0<s.length&&(t=new Ch("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=yo)))}function Ml(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _o={animationend:Ml("Animation","AnimationEnd"),animationiteration:Ml("Animation","AnimationIteration"),animationstart:Ml("Animation","AnimationStart"),transitionend:Ml("Transition","TransitionEnd")},Eu={},Cp={};Yi&&(Cp=document.createElement("div").style,"AnimationEvent"in window||(delete _o.animationend.animation,delete _o.animationiteration.animation,delete _o.animationstart.animation),"TransitionEvent"in window||delete _o.transitionend.transition);function Uc(e){if(Eu[e])return Eu[e];if(!_o[e])return e;var t=_o[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Cp)return Eu[e]=t[n];return e}var Ep=Uc("animationend"),bp=Uc("animationiteration"),Sp=Uc("animationstart"),Ap=Uc("transitionend"),Tp=new Map,e0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Is(e,t){Tp.set(e,t),Js(t,[e])}for(var bu=0;bu<e0.length;bu++){var Su=e0[bu],ry=Su.toLowerCase(),iy=Su[0].toUpperCase()+Su.slice(1);Is(ry,"on"+iy)}Is(Ep,"onAnimationEnd");Is(bp,"onAnimationIteration");Is(Sp,"onAnimationStart");Is("dblclick","onDoubleClick");Is("focusin","onFocus");Is("focusout","onBlur");Is(Ap,"onTransitionEnd");Bo("onMouseEnter",["mouseout","mouseover"]);Bo("onMouseLeave",["mouseout","mouseover"]);Bo("onPointerEnter",["pointerout","pointerover"]);Bo("onPointerLeave",["pointerout","pointerover"]);Js("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Js("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Js("onBeforeInput",["compositionend","keypress","textInput","paste"]);Js("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Js("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Js("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ba="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sy=new Set("cancel close invalid load scroll toggle".split(" ").concat(ba));function t0(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,r2(s,t,void 0,e),e.currentTarget=null}function Ip(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],l=s.event;s=s.listeners;e:{var f=void 0;if(t)for(var m=s.length-1;0<=m;m--){var v=s[m],_=v.instance,x=v.currentTarget;if(v=v.listener,_!==f&&l.isPropagationStopped())break e;t0(l,v,x),f=_}else for(m=0;m<s.length;m++){if(v=s[m],_=v.instance,x=v.currentTarget,v=v.listener,_!==f&&l.isPropagationStopped())break e;t0(l,v,x),f=_}}}if(cc)throw e=of,cc=!1,of=null,e}function Vt(e,t){var n=t[mf];n===void 0&&(n=t[mf]=new Set);var s=e+"__bubble";n.has(s)||(Np(t,e,2,!1),n.add(s))}function Au(e,t,n){var s=0;t&&(s|=4),Np(n,e,s,t)}var Rl="_reactListening"+Math.random().toString(36).slice(2);function Ya(e){if(!e[Rl]){e[Rl]=!0,D1.forEach(function(n){n!=="selectionchange"&&(sy.has(n)||Au(n,!1,e),Au(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Rl]||(t[Rl]=!0,Au("selectionchange",!1,t))}}function Np(e,t,n,s){switch(hp(t)){case 1:var l=_2;break;case 4:l=v2;break;default:l=vh}n=l.bind(null,t,n,e),l=void 0,!sf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),s?l!==void 0?e.addEventListener(t,n,{capture:!0,passive:l}):e.addEventListener(t,n,!0):l!==void 0?e.addEventListener(t,n,{passive:l}):e.addEventListener(t,n,!1)}function Tu(e,t,n,s,l){var f=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var m=s.tag;if(m===3||m===4){var v=s.stateNode.containerInfo;if(v===l||v.nodeType===8&&v.parentNode===l)break;if(m===4)for(m=s.return;m!==null;){var _=m.tag;if((_===3||_===4)&&(_=m.stateNode.containerInfo,_===l||_.nodeType===8&&_.parentNode===l))return;m=m.return}for(;v!==null;){if(m=Us(v),m===null)return;if(_=m.tag,_===5||_===6){s=f=m;continue e}v=v.parentNode}}s=s.return}q1(function(){var x=f,E=mh(n),b=[];e:{var M=Tp.get(e);if(M!==void 0){var F=Ch,z=e;switch(e){case"keypress":if(Zl(n)===0)break e;case"keydown":case"keyup":F=P2;break;case"focusin":z="focus",F=vu;break;case"focusout":z="blur",F=vu;break;case"beforeblur":case"afterblur":F=vu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":F=Vd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":F=E2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":F=F2;break;case Ep:case bp:case Sp:F=A2;break;case Ap:F=z2;break;case"scroll":F=w2;break;case"wheel":F=H2;break;case"copy":case"cut":case"paste":F=I2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":F=Zd}var U=(t&4)!==0,re=!U&&e==="scroll",H=U?M!==null?M+"Capture":null:M;U=[];for(var D=x,B;D!==null;){B=D;var $=B.stateNode;if(B.tag===5&&$!==null&&(B=$,H!==null&&($=Ua(D,H),$!=null&&U.push(Xa(D,$,B)))),re)break;D=D.return}0<U.length&&(M=new F(M,z,null,n,E),b.push({event:M,listeners:U}))}}if(!(t&7)){e:{if(M=e==="mouseover"||e==="pointerover",F=e==="mouseout"||e==="pointerout",M&&n!==nf&&(z=n.relatedTarget||n.fromElement)&&(Us(z)||z[Xi]))break e;if((F||M)&&(M=E.window===E?E:(M=E.ownerDocument)?M.defaultView||M.parentWindow:window,F?(z=n.relatedTarget||n.toElement,F=x,z=z?Us(z):null,z!==null&&(re=eo(z),z!==re||z.tag!==5&&z.tag!==6)&&(z=null)):(F=null,z=x),F!==z)){if(U=Vd,$="onMouseLeave",H="onMouseEnter",D="mouse",(e==="pointerout"||e==="pointerover")&&(U=Zd,$="onPointerLeave",H="onPointerEnter",D="pointer"),re=F==null?M:vo(F),B=z==null?M:vo(z),M=new U($,D+"leave",F,n,E),M.target=re,M.relatedTarget=B,$=null,Us(E)===x&&(U=new U(H,D+"enter",z,n,E),U.target=B,U.relatedTarget=re,$=U),re=$,F&&z)t:{for(U=F,H=z,D=0,B=U;B;B=fo(B))D++;for(B=0,$=H;$;$=fo($))B++;for(;0<D-B;)U=fo(U),D--;for(;0<B-D;)H=fo(H),B--;for(;D--;){if(U===H||H!==null&&U===H.alternate)break t;U=fo(U),H=fo(H)}U=null}else U=null;F!==null&&n0(b,M,F,U,!1),z!==null&&re!==null&&n0(b,re,z,U,!0)}}e:{if(M=x?vo(x):window,F=M.nodeName&&M.nodeName.toLowerCase(),F==="select"||F==="input"&&M.type==="file")var fe=$2;else if(Xd(M))if(yp)fe=J2;else{fe=K2;var pe=Q2}else(F=M.nodeName)&&F.toLowerCase()==="input"&&(M.type==="checkbox"||M.type==="radio")&&(fe=q2);if(fe&&(fe=fe(e,x))){xp(b,fe,n,E);break e}pe&&pe(e,M,x),e==="focusout"&&(pe=M._wrapperState)&&pe.controlled&&M.type==="number"&&Ku(M,"number",M.value)}switch(pe=x?vo(x):window,e){case"focusin":(Xd(pe)||pe.contentEditable==="true")&&(yo=pe,uf=x,Ma=null);break;case"focusout":Ma=uf=yo=null;break;case"mousedown":ff=!0;break;case"contextmenu":case"mouseup":case"dragend":ff=!1,Jd(b,n,E);break;case"selectionchange":if(ny)break;case"keydown":case"keyup":Jd(b,n,E)}var K;if(bh)e:{switch(e){case"compositionstart":var q="onCompositionStart";break e;case"compositionend":q="onCompositionEnd";break e;case"compositionupdate":q="onCompositionUpdate";break e}q=void 0}else xo?gp(e,n)&&(q="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(q="onCompositionStart");q&&(pp&&n.locale!=="ko"&&(xo||q!=="onCompositionStart"?q==="onCompositionEnd"&&xo&&(K=dp()):(ds=E,wh="value"in ds?ds.value:ds.textContent,xo=!0)),pe=pc(x,q),0<pe.length&&(q=new Wd(q,e,null,n,E),b.push({event:q,listeners:pe}),K?q.data=K:(K=mp(n),K!==null&&(q.data=K)))),(K=W2?Z2(e,n):G2(e,n))&&(x=pc(x,"onBeforeInput"),0<x.length&&(E=new Wd("onBeforeInput","beforeinput",null,n,E),b.push({event:E,listeners:x}),E.data=K))}Ip(b,t)})}function Xa(e,t,n){return{instance:e,listener:t,currentTarget:n}}function pc(e,t){for(var n=t+"Capture",s=[];e!==null;){var l=e,f=l.stateNode;l.tag===5&&f!==null&&(l=f,f=Ua(e,n),f!=null&&s.unshift(Xa(e,f,l)),f=Ua(e,t),f!=null&&s.push(Xa(e,f,l))),e=e.return}return s}function fo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function n0(e,t,n,s,l){for(var f=t._reactName,m=[];n!==null&&n!==s;){var v=n,_=v.alternate,x=v.stateNode;if(_!==null&&_===s)break;v.tag===5&&x!==null&&(v=x,l?(_=Ua(n,f),_!=null&&m.unshift(Xa(n,_,v))):l||(_=Ua(n,f),_!=null&&m.push(Xa(n,_,v)))),n=n.return}m.length!==0&&e.push({event:t,listeners:m})}var oy=/\r\n?/g,ay=/\u0000|\uFFFD/g;function r0(e){return(typeof e=="string"?e:""+e).replace(oy,`
`).replace(ay,"")}function kl(e,t,n){if(t=r0(t),r0(e)!==t&&n)throw Error(Se(425))}function gc(){}var hf=null,df=null;function pf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var gf=typeof setTimeout=="function"?setTimeout:void 0,ly=typeof clearTimeout=="function"?clearTimeout:void 0,i0=typeof Promise=="function"?Promise:void 0,cy=typeof queueMicrotask=="function"?queueMicrotask:typeof i0<"u"?function(e){return i0.resolve(null).then(e).catch(uy)}:gf;function uy(e){setTimeout(function(){throw e})}function Iu(e,t){var n=t,s=0;do{var l=n.nextSibling;if(e.removeChild(n),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(s===0){e.removeChild(l),Wa(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=l}while(n);Wa(t)}function _s(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function s0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Yo=Math.random().toString(36).slice(2),Ni="__reactFiber$"+Yo,$a="__reactProps$"+Yo,Xi="__reactContainer$"+Yo,mf="__reactEvents$"+Yo,fy="__reactListeners$"+Yo,hy="__reactHandles$"+Yo;function Us(e){var t=e[Ni];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Xi]||n[Ni]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=s0(e);e!==null;){if(n=e[Ni])return n;e=s0(e)}return t}e=n,n=e.parentNode}return null}function cl(e){return e=e[Ni]||e[Xi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function vo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Se(33))}function Hc(e){return e[$a]||null}var xf=[],wo=-1;function Ns(e){return{current:e}}function Zt(e){0>wo||(e.current=xf[wo],xf[wo]=null,wo--)}function Ft(e,t){wo++,xf[wo]=e.current,e.current=t}var As={},Xn=Ns(As),xr=Ns(!1),Ys=As;function Fo(e,t){var n=e.type.contextTypes;if(!n)return As;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var l={},f;for(f in n)l[f]=t[f];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function yr(e){return e=e.childContextTypes,e!=null}function mc(){Zt(xr),Zt(Xn)}function o0(e,t,n){if(Xn.current!==As)throw Error(Se(168));Ft(Xn,t),Ft(xr,n)}function Mp(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var l in s)if(!(l in t))throw Error(Se(108,Qx(e)||"Unknown",l));return en({},n,s)}function xc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||As,Ys=Xn.current,Ft(Xn,e),Ft(xr,xr.current),!0}function a0(e,t,n){var s=e.stateNode;if(!s)throw Error(Se(169));n?(e=Mp(e,t,Ys),s.__reactInternalMemoizedMergedChildContext=e,Zt(xr),Zt(Xn),Ft(Xn,e)):Zt(xr),Ft(xr,n)}var Hi=null,Vc=!1,Nu=!1;function Rp(e){Hi===null?Hi=[e]:Hi.push(e)}function dy(e){Vc=!0,Rp(e)}function Ms(){if(!Nu&&Hi!==null){Nu=!0;var e=0,t=Tt;try{var n=Hi;for(Tt=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}Hi=null,Vc=!1}catch(l){throw Hi!==null&&(Hi=Hi.slice(e+1)),np(xh,Ms),l}finally{Tt=t,Nu=!1}}return null}var Co=[],Eo=0,yc=null,_c=0,Gr=[],Yr=0,Xs=null,Vi=1,Wi="";function Fs(e,t){Co[Eo++]=_c,Co[Eo++]=yc,yc=e,_c=t}function kp(e,t,n){Gr[Yr++]=Vi,Gr[Yr++]=Wi,Gr[Yr++]=Xs,Xs=e;var s=Vi;e=Wi;var l=32-hi(s)-1;s&=~(1<<l),n+=1;var f=32-hi(t)+l;if(30<f){var m=l-l%5;f=(s&(1<<m)-1).toString(32),s>>=m,l-=m,Vi=1<<32-hi(t)+l|n<<l|s,Wi=f+e}else Vi=1<<f|n<<l|s,Wi=e}function Ah(e){e.return!==null&&(Fs(e,1),kp(e,1,0))}function Th(e){for(;e===yc;)yc=Co[--Eo],Co[Eo]=null,_c=Co[--Eo],Co[Eo]=null;for(;e===Xs;)Xs=Gr[--Yr],Gr[Yr]=null,Wi=Gr[--Yr],Gr[Yr]=null,Vi=Gr[--Yr],Gr[Yr]=null}var kr=null,Rr=null,Yt=!1,fi=null;function Op(e,t){var n=Xr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function l0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,kr=e,Rr=_s(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,kr=e,Rr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Xs!==null?{id:Vi,overflow:Wi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Xr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,kr=e,Rr=null,!0):!1;default:return!1}}function yf(e){return(e.mode&1)!==0&&(e.flags&128)===0}function _f(e){if(Yt){var t=Rr;if(t){var n=t;if(!l0(e,t)){if(yf(e))throw Error(Se(418));t=_s(n.nextSibling);var s=kr;t&&l0(e,t)?Op(s,n):(e.flags=e.flags&-4097|2,Yt=!1,kr=e)}}else{if(yf(e))throw Error(Se(418));e.flags=e.flags&-4097|2,Yt=!1,kr=e}}}function c0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;kr=e}function Ol(e){if(e!==kr)return!1;if(!Yt)return c0(e),Yt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!pf(e.type,e.memoizedProps)),t&&(t=Rr)){if(yf(e))throw Lp(),Error(Se(418));for(;t;)Op(e,t),t=_s(t.nextSibling)}if(c0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Se(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Rr=_s(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Rr=null}}else Rr=kr?_s(e.stateNode.nextSibling):null;return!0}function Lp(){for(var e=Rr;e;)e=_s(e.nextSibling)}function jo(){Rr=kr=null,Yt=!1}function Ih(e){fi===null?fi=[e]:fi.push(e)}var py=Ki.ReactCurrentBatchConfig;function pa(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Se(309));var s=n.stateNode}if(!s)throw Error(Se(147,e));var l=s,f=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===f?t.ref:(t=function(m){var v=l.refs;m===null?delete v[f]:v[f]=m},t._stringRef=f,t)}if(typeof e!="string")throw Error(Se(284));if(!n._owner)throw Error(Se(290,e))}return e}function Ll(e,t){throw e=Object.prototype.toString.call(t),Error(Se(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function u0(e){var t=e._init;return t(e._payload)}function Pp(e){function t(H,D){if(e){var B=H.deletions;B===null?(H.deletions=[D],H.flags|=16):B.push(D)}}function n(H,D){if(!e)return null;for(;D!==null;)t(H,D),D=D.sibling;return null}function s(H,D){for(H=new Map;D!==null;)D.key!==null?H.set(D.key,D):H.set(D.index,D),D=D.sibling;return H}function l(H,D){return H=Es(H,D),H.index=0,H.sibling=null,H}function f(H,D,B){return H.index=B,e?(B=H.alternate,B!==null?(B=B.index,B<D?(H.flags|=2,D):B):(H.flags|=2,D)):(H.flags|=1048576,D)}function m(H){return e&&H.alternate===null&&(H.flags|=2),H}function v(H,D,B,$){return D===null||D.tag!==6?(D=Du(B,H.mode,$),D.return=H,D):(D=l(D,B),D.return=H,D)}function _(H,D,B,$){var fe=B.type;return fe===mo?E(H,D,B.props.children,$,B.key):D!==null&&(D.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===ls&&u0(fe)===D.type)?($=l(D,B.props),$.ref=pa(H,D,B),$.return=H,$):($=ql(B.type,B.key,B.props,null,H.mode,$),$.ref=pa(H,D,B),$.return=H,$)}function x(H,D,B,$){return D===null||D.tag!==4||D.stateNode.containerInfo!==B.containerInfo||D.stateNode.implementation!==B.implementation?(D=Bu(B,H.mode,$),D.return=H,D):(D=l(D,B.children||[]),D.return=H,D)}function E(H,D,B,$,fe){return D===null||D.tag!==7?(D=Gs(B,H.mode,$,fe),D.return=H,D):(D=l(D,B),D.return=H,D)}function b(H,D,B){if(typeof D=="string"&&D!==""||typeof D=="number")return D=Du(""+D,H.mode,B),D.return=H,D;if(typeof D=="object"&&D!==null){switch(D.$$typeof){case El:return B=ql(D.type,D.key,D.props,null,H.mode,B),B.ref=pa(H,null,D),B.return=H,B;case go:return D=Bu(D,H.mode,B),D.return=H,D;case ls:var $=D._init;return b(H,$(D._payload),B)}if(Ca(D)||ca(D))return D=Gs(D,H.mode,B,null),D.return=H,D;Ll(H,D)}return null}function M(H,D,B,$){var fe=D!==null?D.key:null;if(typeof B=="string"&&B!==""||typeof B=="number")return fe!==null?null:v(H,D,""+B,$);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case El:return B.key===fe?_(H,D,B,$):null;case go:return B.key===fe?x(H,D,B,$):null;case ls:return fe=B._init,M(H,D,fe(B._payload),$)}if(Ca(B)||ca(B))return fe!==null?null:E(H,D,B,$,null);Ll(H,B)}return null}function F(H,D,B,$,fe){if(typeof $=="string"&&$!==""||typeof $=="number")return H=H.get(B)||null,v(D,H,""+$,fe);if(typeof $=="object"&&$!==null){switch($.$$typeof){case El:return H=H.get($.key===null?B:$.key)||null,_(D,H,$,fe);case go:return H=H.get($.key===null?B:$.key)||null,x(D,H,$,fe);case ls:var pe=$._init;return F(H,D,B,pe($._payload),fe)}if(Ca($)||ca($))return H=H.get(B)||null,E(D,H,$,fe,null);Ll(D,$)}return null}function z(H,D,B,$){for(var fe=null,pe=null,K=D,q=D=0,V=null;K!==null&&q<B.length;q++){K.index>q?(V=K,K=null):V=K.sibling;var le=M(H,K,B[q],$);if(le===null){K===null&&(K=V);break}e&&K&&le.alternate===null&&t(H,K),D=f(le,D,q),pe===null?fe=le:pe.sibling=le,pe=le,K=V}if(q===B.length)return n(H,K),Yt&&Fs(H,q),fe;if(K===null){for(;q<B.length;q++)K=b(H,B[q],$),K!==null&&(D=f(K,D,q),pe===null?fe=K:pe.sibling=K,pe=K);return Yt&&Fs(H,q),fe}for(K=s(H,K);q<B.length;q++)V=F(K,H,q,B[q],$),V!==null&&(e&&V.alternate!==null&&K.delete(V.key===null?q:V.key),D=f(V,D,q),pe===null?fe=V:pe.sibling=V,pe=V);return e&&K.forEach(function(ce){return t(H,ce)}),Yt&&Fs(H,q),fe}function U(H,D,B,$){var fe=ca(B);if(typeof fe!="function")throw Error(Se(150));if(B=fe.call(B),B==null)throw Error(Se(151));for(var pe=fe=null,K=D,q=D=0,V=null,le=B.next();K!==null&&!le.done;q++,le=B.next()){K.index>q?(V=K,K=null):V=K.sibling;var ce=M(H,K,le.value,$);if(ce===null){K===null&&(K=V);break}e&&K&&ce.alternate===null&&t(H,K),D=f(ce,D,q),pe===null?fe=ce:pe.sibling=ce,pe=ce,K=V}if(le.done)return n(H,K),Yt&&Fs(H,q),fe;if(K===null){for(;!le.done;q++,le=B.next())le=b(H,le.value,$),le!==null&&(D=f(le,D,q),pe===null?fe=le:pe.sibling=le,pe=le);return Yt&&Fs(H,q),fe}for(K=s(H,K);!le.done;q++,le=B.next())le=F(K,H,q,le.value,$),le!==null&&(e&&le.alternate!==null&&K.delete(le.key===null?q:le.key),D=f(le,D,q),pe===null?fe=le:pe.sibling=le,pe=le);return e&&K.forEach(function(ue){return t(H,ue)}),Yt&&Fs(H,q),fe}function re(H,D,B,$){if(typeof B=="object"&&B!==null&&B.type===mo&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case El:e:{for(var fe=B.key,pe=D;pe!==null;){if(pe.key===fe){if(fe=B.type,fe===mo){if(pe.tag===7){n(H,pe.sibling),D=l(pe,B.props.children),D.return=H,H=D;break e}}else if(pe.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===ls&&u0(fe)===pe.type){n(H,pe.sibling),D=l(pe,B.props),D.ref=pa(H,pe,B),D.return=H,H=D;break e}n(H,pe);break}else t(H,pe);pe=pe.sibling}B.type===mo?(D=Gs(B.props.children,H.mode,$,B.key),D.return=H,H=D):($=ql(B.type,B.key,B.props,null,H.mode,$),$.ref=pa(H,D,B),$.return=H,H=$)}return m(H);case go:e:{for(pe=B.key;D!==null;){if(D.key===pe)if(D.tag===4&&D.stateNode.containerInfo===B.containerInfo&&D.stateNode.implementation===B.implementation){n(H,D.sibling),D=l(D,B.children||[]),D.return=H,H=D;break e}else{n(H,D);break}else t(H,D);D=D.sibling}D=Bu(B,H.mode,$),D.return=H,H=D}return m(H);case ls:return pe=B._init,re(H,D,pe(B._payload),$)}if(Ca(B))return z(H,D,B,$);if(ca(B))return U(H,D,B,$);Ll(H,B)}return typeof B=="string"&&B!==""||typeof B=="number"?(B=""+B,D!==null&&D.tag===6?(n(H,D.sibling),D=l(D,B),D.return=H,H=D):(n(H,D),D=Du(B,H.mode,$),D.return=H,H=D),m(H)):n(H,D)}return re}var zo=Pp(!0),Dp=Pp(!1),vc=Ns(null),wc=null,bo=null,Nh=null;function Mh(){Nh=bo=wc=null}function Rh(e){var t=vc.current;Zt(vc),e._currentValue=t}function vf(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Oo(e,t){wc=e,Nh=bo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(mr=!0),e.firstContext=null)}function Qr(e){var t=e._currentValue;if(Nh!==e)if(e={context:e,memoizedValue:t,next:null},bo===null){if(wc===null)throw Error(Se(308));bo=e,wc.dependencies={lanes:0,firstContext:e}}else bo=bo.next=e;return t}var Hs=null;function kh(e){Hs===null?Hs=[e]:Hs.push(e)}function Bp(e,t,n,s){var l=t.interleaved;return l===null?(n.next=n,kh(t)):(n.next=l.next,l.next=n),t.interleaved=n,$i(e,s)}function $i(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var cs=!1;function Oh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Gi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function vs(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,xt&2){var l=s.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),s.pending=t,$i(e,n)}return l=s.interleaved,l===null?(t.next=t,kh(s)):(t.next=l.next,l.next=t),s.interleaved=t,$i(e,n)}function Gl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,yh(e,n)}}function f0(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var l=null,f=null;if(n=n.firstBaseUpdate,n!==null){do{var m={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};f===null?l=f=m:f=f.next=m,n=n.next}while(n!==null);f===null?l=f=t:f=f.next=t}else l=f=t;n={baseState:s.baseState,firstBaseUpdate:l,lastBaseUpdate:f,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Cc(e,t,n,s){var l=e.updateQueue;cs=!1;var f=l.firstBaseUpdate,m=l.lastBaseUpdate,v=l.shared.pending;if(v!==null){l.shared.pending=null;var _=v,x=_.next;_.next=null,m===null?f=x:m.next=x,m=_;var E=e.alternate;E!==null&&(E=E.updateQueue,v=E.lastBaseUpdate,v!==m&&(v===null?E.firstBaseUpdate=x:v.next=x,E.lastBaseUpdate=_))}if(f!==null){var b=l.baseState;m=0,E=x=_=null,v=f;do{var M=v.lane,F=v.eventTime;if((s&M)===M){E!==null&&(E=E.next={eventTime:F,lane:0,tag:v.tag,payload:v.payload,callback:v.callback,next:null});e:{var z=e,U=v;switch(M=t,F=n,U.tag){case 1:if(z=U.payload,typeof z=="function"){b=z.call(F,b,M);break e}b=z;break e;case 3:z.flags=z.flags&-65537|128;case 0:if(z=U.payload,M=typeof z=="function"?z.call(F,b,M):z,M==null)break e;b=en({},b,M);break e;case 2:cs=!0}}v.callback!==null&&v.lane!==0&&(e.flags|=64,M=l.effects,M===null?l.effects=[v]:M.push(v))}else F={eventTime:F,lane:M,tag:v.tag,payload:v.payload,callback:v.callback,next:null},E===null?(x=E=F,_=b):E=E.next=F,m|=M;if(v=v.next,v===null){if(v=l.shared.pending,v===null)break;M=v,v=M.next,M.next=null,l.lastBaseUpdate=M,l.shared.pending=null}}while(!0);if(E===null&&(_=b),l.baseState=_,l.firstBaseUpdate=x,l.lastBaseUpdate=E,t=l.shared.interleaved,t!==null){l=t;do m|=l.lane,l=l.next;while(l!==t)}else f===null&&(l.shared.lanes=0);Qs|=m,e.lanes=m,e.memoizedState=b}}function h0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],l=s.callback;if(l!==null){if(s.callback=null,s=n,typeof l!="function")throw Error(Se(191,l));l.call(s)}}}var ul={},Ri=Ns(ul),Qa=Ns(ul),Ka=Ns(ul);function Vs(e){if(e===ul)throw Error(Se(174));return e}function Lh(e,t){switch(Ft(Ka,t),Ft(Qa,e),Ft(Ri,ul),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ju(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ju(t,e)}Zt(Ri),Ft(Ri,t)}function Uo(){Zt(Ri),Zt(Qa),Zt(Ka)}function jp(e){Vs(Ka.current);var t=Vs(Ri.current),n=Ju(t,e.type);t!==n&&(Ft(Qa,e),Ft(Ri,n))}function Ph(e){Qa.current===e&&(Zt(Ri),Zt(Qa))}var qt=Ns(0);function Ec(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Mu=[];function Dh(){for(var e=0;e<Mu.length;e++)Mu[e]._workInProgressVersionPrimary=null;Mu.length=0}var Yl=Ki.ReactCurrentDispatcher,Ru=Ki.ReactCurrentBatchConfig,$s=0,Jt=null,En=null,Nn=null,bc=!1,Ra=!1,qa=0,gy=0;function Wn(){throw Error(Se(321))}function Bh(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!pi(e[n],t[n]))return!1;return!0}function Fh(e,t,n,s,l,f){if($s=f,Jt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Yl.current=e===null||e.memoizedState===null?_y:vy,e=n(s,l),Ra){f=0;do{if(Ra=!1,qa=0,25<=f)throw Error(Se(301));f+=1,Nn=En=null,t.updateQueue=null,Yl.current=wy,e=n(s,l)}while(Ra)}if(Yl.current=Sc,t=En!==null&&En.next!==null,$s=0,Nn=En=Jt=null,bc=!1,t)throw Error(Se(300));return e}function jh(){var e=qa!==0;return qa=0,e}function Ti(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nn===null?Jt.memoizedState=Nn=e:Nn=Nn.next=e,Nn}function Kr(){if(En===null){var e=Jt.alternate;e=e!==null?e.memoizedState:null}else e=En.next;var t=Nn===null?Jt.memoizedState:Nn.next;if(t!==null)Nn=t,En=e;else{if(e===null)throw Error(Se(310));En=e,e={memoizedState:En.memoizedState,baseState:En.baseState,baseQueue:En.baseQueue,queue:En.queue,next:null},Nn===null?Jt.memoizedState=Nn=e:Nn=Nn.next=e}return Nn}function Ja(e,t){return typeof t=="function"?t(e):t}function ku(e){var t=Kr(),n=t.queue;if(n===null)throw Error(Se(311));n.lastRenderedReducer=e;var s=En,l=s.baseQueue,f=n.pending;if(f!==null){if(l!==null){var m=l.next;l.next=f.next,f.next=m}s.baseQueue=l=f,n.pending=null}if(l!==null){f=l.next,s=s.baseState;var v=m=null,_=null,x=f;do{var E=x.lane;if(($s&E)===E)_!==null&&(_=_.next={lane:0,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null}),s=x.hasEagerState?x.eagerState:e(s,x.action);else{var b={lane:E,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null};_===null?(v=_=b,m=s):_=_.next=b,Jt.lanes|=E,Qs|=E}x=x.next}while(x!==null&&x!==f);_===null?m=s:_.next=v,pi(s,t.memoizedState)||(mr=!0),t.memoizedState=s,t.baseState=m,t.baseQueue=_,n.lastRenderedState=s}if(e=n.interleaved,e!==null){l=e;do f=l.lane,Jt.lanes|=f,Qs|=f,l=l.next;while(l!==e)}else l===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ou(e){var t=Kr(),n=t.queue;if(n===null)throw Error(Se(311));n.lastRenderedReducer=e;var s=n.dispatch,l=n.pending,f=t.memoizedState;if(l!==null){n.pending=null;var m=l=l.next;do f=e(f,m.action),m=m.next;while(m!==l);pi(f,t.memoizedState)||(mr=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),n.lastRenderedState=f}return[f,s]}function zp(){}function Up(e,t){var n=Jt,s=Kr(),l=t(),f=!pi(s.memoizedState,l);if(f&&(s.memoizedState=l,mr=!0),s=s.queue,zh(Wp.bind(null,n,s,e),[e]),s.getSnapshot!==t||f||Nn!==null&&Nn.memoizedState.tag&1){if(n.flags|=2048,el(9,Vp.bind(null,n,s,l,t),void 0,null),Mn===null)throw Error(Se(349));$s&30||Hp(n,t,l)}return l}function Hp(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Jt.updateQueue,t===null?(t={lastEffect:null,stores:null},Jt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Vp(e,t,n,s){t.value=n,t.getSnapshot=s,Zp(t)&&Gp(e)}function Wp(e,t,n){return n(function(){Zp(t)&&Gp(e)})}function Zp(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!pi(e,n)}catch{return!0}}function Gp(e){var t=$i(e,1);t!==null&&di(t,e,1,-1)}function d0(e){var t=Ti();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:e},t.queue=e,e=e.dispatch=yy.bind(null,Jt,e),[t.memoizedState,e]}function el(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=Jt.updateQueue,t===null?(t={lastEffect:null,stores:null},Jt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function Yp(){return Kr().memoizedState}function Xl(e,t,n,s){var l=Ti();Jt.flags|=e,l.memoizedState=el(1|t,n,void 0,s===void 0?null:s)}function Wc(e,t,n,s){var l=Kr();s=s===void 0?null:s;var f=void 0;if(En!==null){var m=En.memoizedState;if(f=m.destroy,s!==null&&Bh(s,m.deps)){l.memoizedState=el(t,n,f,s);return}}Jt.flags|=e,l.memoizedState=el(1|t,n,f,s)}function p0(e,t){return Xl(8390656,8,e,t)}function zh(e,t){return Wc(2048,8,e,t)}function Xp(e,t){return Wc(4,2,e,t)}function $p(e,t){return Wc(4,4,e,t)}function Qp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Kp(e,t,n){return n=n!=null?n.concat([e]):null,Wc(4,4,Qp.bind(null,t,e),n)}function Uh(){}function qp(e,t){var n=Kr();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&Bh(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Jp(e,t){var n=Kr();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&Bh(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function eg(e,t,n){return $s&21?(pi(n,t)||(n=sp(),Jt.lanes|=n,Qs|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,mr=!0),e.memoizedState=n)}function my(e,t){var n=Tt;Tt=n!==0&&4>n?n:4,e(!0);var s=Ru.transition;Ru.transition={};try{e(!1),t()}finally{Tt=n,Ru.transition=s}}function tg(){return Kr().memoizedState}function xy(e,t,n){var s=Cs(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},ng(e))rg(t,n);else if(n=Bp(e,t,n,s),n!==null){var l=ar();di(n,e,s,l),ig(n,t,s)}}function yy(e,t,n){var s=Cs(e),l={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(ng(e))rg(t,l);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var m=t.lastRenderedState,v=f(m,n);if(l.hasEagerState=!0,l.eagerState=v,pi(v,m)){var _=t.interleaved;_===null?(l.next=l,kh(t)):(l.next=_.next,_.next=l),t.interleaved=l;return}}catch{}finally{}n=Bp(e,t,l,s),n!==null&&(l=ar(),di(n,e,s,l),ig(n,t,s))}}function ng(e){var t=e.alternate;return e===Jt||t!==null&&t===Jt}function rg(e,t){Ra=bc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ig(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,yh(e,n)}}var Sc={readContext:Qr,useCallback:Wn,useContext:Wn,useEffect:Wn,useImperativeHandle:Wn,useInsertionEffect:Wn,useLayoutEffect:Wn,useMemo:Wn,useReducer:Wn,useRef:Wn,useState:Wn,useDebugValue:Wn,useDeferredValue:Wn,useTransition:Wn,useMutableSource:Wn,useSyncExternalStore:Wn,useId:Wn,unstable_isNewReconciler:!1},_y={readContext:Qr,useCallback:function(e,t){return Ti().memoizedState=[e,t===void 0?null:t],e},useContext:Qr,useEffect:p0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Xl(4194308,4,Qp.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Xl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Xl(4,2,e,t)},useMemo:function(e,t){var n=Ti();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=Ti();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=xy.bind(null,Jt,e),[s.memoizedState,e]},useRef:function(e){var t=Ti();return e={current:e},t.memoizedState=e},useState:d0,useDebugValue:Uh,useDeferredValue:function(e){return Ti().memoizedState=e},useTransition:function(){var e=d0(!1),t=e[0];return e=my.bind(null,e[1]),Ti().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=Jt,l=Ti();if(Yt){if(n===void 0)throw Error(Se(407));n=n()}else{if(n=t(),Mn===null)throw Error(Se(349));$s&30||Hp(s,t,n)}l.memoizedState=n;var f={value:n,getSnapshot:t};return l.queue=f,p0(Wp.bind(null,s,f,e),[e]),s.flags|=2048,el(9,Vp.bind(null,s,f,n,t),void 0,null),n},useId:function(){var e=Ti(),t=Mn.identifierPrefix;if(Yt){var n=Wi,s=Vi;n=(s&~(1<<32-hi(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=qa++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=gy++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},vy={readContext:Qr,useCallback:qp,useContext:Qr,useEffect:zh,useImperativeHandle:Kp,useInsertionEffect:Xp,useLayoutEffect:$p,useMemo:Jp,useReducer:ku,useRef:Yp,useState:function(){return ku(Ja)},useDebugValue:Uh,useDeferredValue:function(e){var t=Kr();return eg(t,En.memoizedState,e)},useTransition:function(){var e=ku(Ja)[0],t=Kr().memoizedState;return[e,t]},useMutableSource:zp,useSyncExternalStore:Up,useId:tg,unstable_isNewReconciler:!1},wy={readContext:Qr,useCallback:qp,useContext:Qr,useEffect:zh,useImperativeHandle:Kp,useInsertionEffect:Xp,useLayoutEffect:$p,useMemo:Jp,useReducer:Ou,useRef:Yp,useState:function(){return Ou(Ja)},useDebugValue:Uh,useDeferredValue:function(e){var t=Kr();return En===null?t.memoizedState=e:eg(t,En.memoizedState,e)},useTransition:function(){var e=Ou(Ja)[0],t=Kr().memoizedState;return[e,t]},useMutableSource:zp,useSyncExternalStore:Up,useId:tg,unstable_isNewReconciler:!1};function li(e,t){if(e&&e.defaultProps){t=en({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function wf(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:en({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Zc={isMounted:function(e){return(e=e._reactInternals)?eo(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=ar(),l=Cs(e),f=Gi(s,l);f.payload=t,n!=null&&(f.callback=n),t=vs(e,f,l),t!==null&&(di(t,e,l,s),Gl(t,e,l))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=ar(),l=Cs(e),f=Gi(s,l);f.tag=1,f.payload=t,n!=null&&(f.callback=n),t=vs(e,f,l),t!==null&&(di(t,e,l,s),Gl(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ar(),s=Cs(e),l=Gi(n,s);l.tag=2,t!=null&&(l.callback=t),t=vs(e,l,s),t!==null&&(di(t,e,s,n),Gl(t,e,s))}};function g0(e,t,n,s,l,f,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,f,m):t.prototype&&t.prototype.isPureReactComponent?!Ga(n,s)||!Ga(l,f):!0}function sg(e,t,n){var s=!1,l=As,f=t.contextType;return typeof f=="object"&&f!==null?f=Qr(f):(l=yr(t)?Ys:Xn.current,s=t.contextTypes,f=(s=s!=null)?Fo(e,l):As),t=new t(n,f),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Zc,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=f),t}function m0(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Zc.enqueueReplaceState(t,t.state,null)}function Cf(e,t,n,s){var l=e.stateNode;l.props=n,l.state=e.memoizedState,l.refs={},Oh(e);var f=t.contextType;typeof f=="object"&&f!==null?l.context=Qr(f):(f=yr(t)?Ys:Xn.current,l.context=Fo(e,f)),l.state=e.memoizedState,f=t.getDerivedStateFromProps,typeof f=="function"&&(wf(e,t,f,n),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&Zc.enqueueReplaceState(l,l.state,null),Cc(e,n,l,s),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function Ho(e,t){try{var n="",s=t;do n+=$x(s),s=s.return;while(s);var l=n}catch(f){l=`
Error generating stack: `+f.message+`
`+f.stack}return{value:e,source:t,stack:l,digest:null}}function Lu(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Ef(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Cy=typeof WeakMap=="function"?WeakMap:Map;function og(e,t,n){n=Gi(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){Tc||(Tc=!0,Of=s),Ef(e,t)},n}function ag(e,t,n){n=Gi(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var l=t.value;n.payload=function(){return s(l)},n.callback=function(){Ef(e,t)}}var f=e.stateNode;return f!==null&&typeof f.componentDidCatch=="function"&&(n.callback=function(){Ef(e,t),typeof s!="function"&&(ws===null?ws=new Set([this]):ws.add(this));var m=t.stack;this.componentDidCatch(t.value,{componentStack:m!==null?m:""})}),n}function x0(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new Cy;var l=new Set;s.set(t,l)}else l=s.get(t),l===void 0&&(l=new Set,s.set(t,l));l.has(n)||(l.add(n),e=Dy.bind(null,e,t,n),t.then(e,e))}function y0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function _0(e,t,n,s,l){return e.mode&1?(e.flags|=65536,e.lanes=l,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Gi(-1,1),t.tag=2,vs(n,t,1))),n.lanes|=1),e)}var Ey=Ki.ReactCurrentOwner,mr=!1;function or(e,t,n,s){t.child=e===null?Dp(t,null,n,s):zo(t,e.child,n,s)}function v0(e,t,n,s,l){n=n.render;var f=t.ref;return Oo(t,l),s=Fh(e,t,n,s,f,l),n=jh(),e!==null&&!mr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Qi(e,t,l)):(Yt&&n&&Ah(t),t.flags|=1,or(e,t,s,l),t.child)}function w0(e,t,n,s,l){if(e===null){var f=n.type;return typeof f=="function"&&!$h(f)&&f.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=f,lg(e,t,f,s,l)):(e=ql(n.type,null,s,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,!(e.lanes&l)){var m=f.memoizedProps;if(n=n.compare,n=n!==null?n:Ga,n(m,s)&&e.ref===t.ref)return Qi(e,t,l)}return t.flags|=1,e=Es(f,s),e.ref=t.ref,e.return=t,t.child=e}function lg(e,t,n,s,l){if(e!==null){var f=e.memoizedProps;if(Ga(f,s)&&e.ref===t.ref)if(mr=!1,t.pendingProps=s=f,(e.lanes&l)!==0)e.flags&131072&&(mr=!0);else return t.lanes=e.lanes,Qi(e,t,l)}return bf(e,t,n,s,l)}function cg(e,t,n){var s=t.pendingProps,l=s.children,f=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ft(Ao,Nr),Nr|=n;else{if(!(n&1073741824))return e=f!==null?f.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ft(Ao,Nr),Nr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=f!==null?f.baseLanes:n,Ft(Ao,Nr),Nr|=s}else f!==null?(s=f.baseLanes|n,t.memoizedState=null):s=n,Ft(Ao,Nr),Nr|=s;return or(e,t,l,n),t.child}function ug(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function bf(e,t,n,s,l){var f=yr(n)?Ys:Xn.current;return f=Fo(t,f),Oo(t,l),n=Fh(e,t,n,s,f,l),s=jh(),e!==null&&!mr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Qi(e,t,l)):(Yt&&s&&Ah(t),t.flags|=1,or(e,t,n,l),t.child)}function C0(e,t,n,s,l){if(yr(n)){var f=!0;xc(t)}else f=!1;if(Oo(t,l),t.stateNode===null)$l(e,t),sg(t,n,s),Cf(t,n,s,l),s=!0;else if(e===null){var m=t.stateNode,v=t.memoizedProps;m.props=v;var _=m.context,x=n.contextType;typeof x=="object"&&x!==null?x=Qr(x):(x=yr(n)?Ys:Xn.current,x=Fo(t,x));var E=n.getDerivedStateFromProps,b=typeof E=="function"||typeof m.getSnapshotBeforeUpdate=="function";b||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==s||_!==x)&&m0(t,m,s,x),cs=!1;var M=t.memoizedState;m.state=M,Cc(t,s,m,l),_=t.memoizedState,v!==s||M!==_||xr.current||cs?(typeof E=="function"&&(wf(t,n,E,s),_=t.memoizedState),(v=cs||g0(t,n,v,s,M,_,x))?(b||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(t.flags|=4194308)):(typeof m.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=_),m.props=s,m.state=_,m.context=x,s=v):(typeof m.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{m=t.stateNode,Fp(e,t),v=t.memoizedProps,x=t.type===t.elementType?v:li(t.type,v),m.props=x,b=t.pendingProps,M=m.context,_=n.contextType,typeof _=="object"&&_!==null?_=Qr(_):(_=yr(n)?Ys:Xn.current,_=Fo(t,_));var F=n.getDerivedStateFromProps;(E=typeof F=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==b||M!==_)&&m0(t,m,s,_),cs=!1,M=t.memoizedState,m.state=M,Cc(t,s,m,l);var z=t.memoizedState;v!==b||M!==z||xr.current||cs?(typeof F=="function"&&(wf(t,n,F,s),z=t.memoizedState),(x=cs||g0(t,n,x,s,M,z,_)||!1)?(E||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(s,z,_),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(s,z,_)),typeof m.componentDidUpdate=="function"&&(t.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof m.componentDidUpdate!="function"||v===e.memoizedProps&&M===e.memoizedState||(t.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&M===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=z),m.props=s,m.state=z,m.context=_,s=x):(typeof m.componentDidUpdate!="function"||v===e.memoizedProps&&M===e.memoizedState||(t.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&M===e.memoizedState||(t.flags|=1024),s=!1)}return Sf(e,t,n,s,f,l)}function Sf(e,t,n,s,l,f){ug(e,t);var m=(t.flags&128)!==0;if(!s&&!m)return l&&a0(t,n,!1),Qi(e,t,f);s=t.stateNode,Ey.current=t;var v=m&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&m?(t.child=zo(t,e.child,null,f),t.child=zo(t,null,v,f)):or(e,t,v,f),t.memoizedState=s.state,l&&a0(t,n,!0),t.child}function fg(e){var t=e.stateNode;t.pendingContext?o0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&o0(e,t.context,!1),Lh(e,t.containerInfo)}function E0(e,t,n,s,l){return jo(),Ih(l),t.flags|=256,or(e,t,n,s),t.child}var Af={dehydrated:null,treeContext:null,retryLane:0};function Tf(e){return{baseLanes:e,cachePool:null,transitions:null}}function hg(e,t,n){var s=t.pendingProps,l=qt.current,f=!1,m=(t.flags&128)!==0,v;if((v=m)||(v=e!==null&&e.memoizedState===null?!1:(l&2)!==0),v?(f=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),Ft(qt,l&1),e===null)return _f(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(m=s.children,e=s.fallback,f?(s=t.mode,f=t.child,m={mode:"hidden",children:m},!(s&1)&&f!==null?(f.childLanes=0,f.pendingProps=m):f=Xc(m,s,0,null),e=Gs(e,s,n,null),f.return=t,e.return=t,f.sibling=e,t.child=f,t.child.memoizedState=Tf(n),t.memoizedState=Af,e):Hh(t,m));if(l=e.memoizedState,l!==null&&(v=l.dehydrated,v!==null))return by(e,t,m,s,v,l,n);if(f){f=s.fallback,m=t.mode,l=e.child,v=l.sibling;var _={mode:"hidden",children:s.children};return!(m&1)&&t.child!==l?(s=t.child,s.childLanes=0,s.pendingProps=_,t.deletions=null):(s=Es(l,_),s.subtreeFlags=l.subtreeFlags&14680064),v!==null?f=Es(v,f):(f=Gs(f,m,n,null),f.flags|=2),f.return=t,s.return=t,s.sibling=f,t.child=s,s=f,f=t.child,m=e.child.memoizedState,m=m===null?Tf(n):{baseLanes:m.baseLanes|n,cachePool:null,transitions:m.transitions},f.memoizedState=m,f.childLanes=e.childLanes&~n,t.memoizedState=Af,s}return f=e.child,e=f.sibling,s=Es(f,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Hh(e,t){return t=Xc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Pl(e,t,n,s){return s!==null&&Ih(s),zo(t,e.child,null,n),e=Hh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function by(e,t,n,s,l,f,m){if(n)return t.flags&256?(t.flags&=-257,s=Lu(Error(Se(422))),Pl(e,t,m,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(f=s.fallback,l=t.mode,s=Xc({mode:"visible",children:s.children},l,0,null),f=Gs(f,l,m,null),f.flags|=2,s.return=t,f.return=t,s.sibling=f,t.child=s,t.mode&1&&zo(t,e.child,null,m),t.child.memoizedState=Tf(m),t.memoizedState=Af,f);if(!(t.mode&1))return Pl(e,t,m,null);if(l.data==="$!"){if(s=l.nextSibling&&l.nextSibling.dataset,s)var v=s.dgst;return s=v,f=Error(Se(419)),s=Lu(f,s,void 0),Pl(e,t,m,s)}if(v=(m&e.childLanes)!==0,mr||v){if(s=Mn,s!==null){switch(m&-m){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(s.suspendedLanes|m)?0:l,l!==0&&l!==f.retryLane&&(f.retryLane=l,$i(e,l),di(s,e,l,-1))}return Xh(),s=Lu(Error(Se(421))),Pl(e,t,m,s)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=By.bind(null,e),l._reactRetry=t,null):(e=f.treeContext,Rr=_s(l.nextSibling),kr=t,Yt=!0,fi=null,e!==null&&(Gr[Yr++]=Vi,Gr[Yr++]=Wi,Gr[Yr++]=Xs,Vi=e.id,Wi=e.overflow,Xs=t),t=Hh(t,s.children),t.flags|=4096,t)}function b0(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),vf(e.return,t,n)}function Pu(e,t,n,s,l){var f=e.memoizedState;f===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:l}:(f.isBackwards=t,f.rendering=null,f.renderingStartTime=0,f.last=s,f.tail=n,f.tailMode=l)}function dg(e,t,n){var s=t.pendingProps,l=s.revealOrder,f=s.tail;if(or(e,t,s.children,n),s=qt.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&b0(e,n,t);else if(e.tag===19)b0(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Ft(qt,s),!(t.mode&1))t.memoizedState=null;else switch(l){case"forwards":for(n=t.child,l=null;n!==null;)e=n.alternate,e!==null&&Ec(e)===null&&(l=n),n=n.sibling;n=l,n===null?(l=t.child,t.child=null):(l=n.sibling,n.sibling=null),Pu(t,!1,l,n,f);break;case"backwards":for(n=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&Ec(e)===null){t.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}Pu(t,!0,n,null,f);break;case"together":Pu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $l(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Qi(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Qs|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Se(153));if(t.child!==null){for(e=t.child,n=Es(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Es(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Sy(e,t,n){switch(t.tag){case 3:fg(t),jo();break;case 5:jp(t);break;case 1:yr(t.type)&&xc(t);break;case 4:Lh(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,l=t.memoizedProps.value;Ft(vc,s._currentValue),s._currentValue=l;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(Ft(qt,qt.current&1),t.flags|=128,null):n&t.child.childLanes?hg(e,t,n):(Ft(qt,qt.current&1),e=Qi(e,t,n),e!==null?e.sibling:null);Ft(qt,qt.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return dg(e,t,n);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Ft(qt,qt.current),s)break;return null;case 22:case 23:return t.lanes=0,cg(e,t,n)}return Qi(e,t,n)}var pg,If,gg,mg;pg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};If=function(){};gg=function(e,t,n,s){var l=e.memoizedProps;if(l!==s){e=t.stateNode,Vs(Ri.current);var f=null;switch(n){case"input":l=$u(e,l),s=$u(e,s),f=[];break;case"select":l=en({},l,{value:void 0}),s=en({},s,{value:void 0}),f=[];break;case"textarea":l=qu(e,l),s=qu(e,s),f=[];break;default:typeof l.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=gc)}ef(n,s);var m;n=null;for(x in l)if(!s.hasOwnProperty(x)&&l.hasOwnProperty(x)&&l[x]!=null)if(x==="style"){var v=l[x];for(m in v)v.hasOwnProperty(m)&&(n||(n={}),n[m]="")}else x!=="dangerouslySetInnerHTML"&&x!=="children"&&x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(ja.hasOwnProperty(x)?f||(f=[]):(f=f||[]).push(x,null));for(x in s){var _=s[x];if(v=l!=null?l[x]:void 0,s.hasOwnProperty(x)&&_!==v&&(_!=null||v!=null))if(x==="style")if(v){for(m in v)!v.hasOwnProperty(m)||_&&_.hasOwnProperty(m)||(n||(n={}),n[m]="");for(m in _)_.hasOwnProperty(m)&&v[m]!==_[m]&&(n||(n={}),n[m]=_[m])}else n||(f||(f=[]),f.push(x,n)),n=_;else x==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,v=v?v.__html:void 0,_!=null&&v!==_&&(f=f||[]).push(x,_)):x==="children"?typeof _!="string"&&typeof _!="number"||(f=f||[]).push(x,""+_):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&(ja.hasOwnProperty(x)?(_!=null&&x==="onScroll"&&Vt("scroll",e),f||v===_||(f=[])):(f=f||[]).push(x,_))}n&&(f=f||[]).push("style",n);var x=f;(t.updateQueue=x)&&(t.flags|=4)}};mg=function(e,t,n,s){n!==s&&(t.flags|=4)};function ga(e,t){if(!Yt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Zn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var l=e.child;l!==null;)n|=l.lanes|l.childLanes,s|=l.subtreeFlags&14680064,s|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)n|=l.lanes|l.childLanes,s|=l.subtreeFlags,s|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function Ay(e,t,n){var s=t.pendingProps;switch(Th(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zn(t),null;case 1:return yr(t.type)&&mc(),Zn(t),null;case 3:return s=t.stateNode,Uo(),Zt(xr),Zt(Xn),Dh(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Ol(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,fi!==null&&(Df(fi),fi=null))),If(e,t),Zn(t),null;case 5:Ph(t);var l=Vs(Ka.current);if(n=t.type,e!==null&&t.stateNode!=null)gg(e,t,n,s,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(Se(166));return Zn(t),null}if(e=Vs(Ri.current),Ol(t)){s=t.stateNode,n=t.type;var f=t.memoizedProps;switch(s[Ni]=t,s[$a]=f,e=(t.mode&1)!==0,n){case"dialog":Vt("cancel",s),Vt("close",s);break;case"iframe":case"object":case"embed":Vt("load",s);break;case"video":case"audio":for(l=0;l<ba.length;l++)Vt(ba[l],s);break;case"source":Vt("error",s);break;case"img":case"image":case"link":Vt("error",s),Vt("load",s);break;case"details":Vt("toggle",s);break;case"input":Od(s,f),Vt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!f.multiple},Vt("invalid",s);break;case"textarea":Pd(s,f),Vt("invalid",s)}ef(n,f),l=null;for(var m in f)if(f.hasOwnProperty(m)){var v=f[m];m==="children"?typeof v=="string"?s.textContent!==v&&(f.suppressHydrationWarning!==!0&&kl(s.textContent,v,e),l=["children",v]):typeof v=="number"&&s.textContent!==""+v&&(f.suppressHydrationWarning!==!0&&kl(s.textContent,v,e),l=["children",""+v]):ja.hasOwnProperty(m)&&v!=null&&m==="onScroll"&&Vt("scroll",s)}switch(n){case"input":bl(s),Ld(s,f,!0);break;case"textarea":bl(s),Dd(s);break;case"select":case"option":break;default:typeof f.onClick=="function"&&(s.onclick=gc)}s=l,t.updateQueue=s,s!==null&&(t.flags|=4)}else{m=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=W1(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=m.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=m.createElement(n,{is:s.is}):(e=m.createElement(n),n==="select"&&(m=e,s.multiple?m.multiple=!0:s.size&&(m.size=s.size))):e=m.createElementNS(e,n),e[Ni]=t,e[$a]=s,pg(e,t,!1,!1),t.stateNode=e;e:{switch(m=tf(n,s),n){case"dialog":Vt("cancel",e),Vt("close",e),l=s;break;case"iframe":case"object":case"embed":Vt("load",e),l=s;break;case"video":case"audio":for(l=0;l<ba.length;l++)Vt(ba[l],e);l=s;break;case"source":Vt("error",e),l=s;break;case"img":case"image":case"link":Vt("error",e),Vt("load",e),l=s;break;case"details":Vt("toggle",e),l=s;break;case"input":Od(e,s),l=$u(e,s),Vt("invalid",e);break;case"option":l=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},l=en({},s,{value:void 0}),Vt("invalid",e);break;case"textarea":Pd(e,s),l=qu(e,s),Vt("invalid",e);break;default:l=s}ef(n,l),v=l;for(f in v)if(v.hasOwnProperty(f)){var _=v[f];f==="style"?Y1(e,_):f==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,_!=null&&Z1(e,_)):f==="children"?typeof _=="string"?(n!=="textarea"||_!=="")&&za(e,_):typeof _=="number"&&za(e,""+_):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(ja.hasOwnProperty(f)?_!=null&&f==="onScroll"&&Vt("scroll",e):_!=null&&hh(e,f,_,m))}switch(n){case"input":bl(e),Ld(e,s,!1);break;case"textarea":bl(e),Dd(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Ss(s.value));break;case"select":e.multiple=!!s.multiple,f=s.value,f!=null?No(e,!!s.multiple,f,!1):s.defaultValue!=null&&No(e,!!s.multiple,s.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=gc)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Zn(t),null;case 6:if(e&&t.stateNode!=null)mg(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(Se(166));if(n=Vs(Ka.current),Vs(Ri.current),Ol(t)){if(s=t.stateNode,n=t.memoizedProps,s[Ni]=t,(f=s.nodeValue!==n)&&(e=kr,e!==null))switch(e.tag){case 3:kl(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&kl(s.nodeValue,n,(e.mode&1)!==0)}f&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Ni]=t,t.stateNode=s}return Zn(t),null;case 13:if(Zt(qt),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Yt&&Rr!==null&&t.mode&1&&!(t.flags&128))Lp(),jo(),t.flags|=98560,f=!1;else if(f=Ol(t),s!==null&&s.dehydrated!==null){if(e===null){if(!f)throw Error(Se(318));if(f=t.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(Se(317));f[Ni]=t}else jo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Zn(t),f=!1}else fi!==null&&(Df(fi),fi=null),f=!0;if(!f)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||qt.current&1?bn===0&&(bn=3):Xh())),t.updateQueue!==null&&(t.flags|=4),Zn(t),null);case 4:return Uo(),If(e,t),e===null&&Ya(t.stateNode.containerInfo),Zn(t),null;case 10:return Rh(t.type._context),Zn(t),null;case 17:return yr(t.type)&&mc(),Zn(t),null;case 19:if(Zt(qt),f=t.memoizedState,f===null)return Zn(t),null;if(s=(t.flags&128)!==0,m=f.rendering,m===null)if(s)ga(f,!1);else{if(bn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(m=Ec(e),m!==null){for(t.flags|=128,ga(f,!1),s=m.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)f=n,e=s,f.flags&=14680066,m=f.alternate,m===null?(f.childLanes=0,f.lanes=e,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=m.childLanes,f.lanes=m.lanes,f.child=m.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=m.memoizedProps,f.memoizedState=m.memoizedState,f.updateQueue=m.updateQueue,f.type=m.type,e=m.dependencies,f.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ft(qt,qt.current&1|2),t.child}e=e.sibling}f.tail!==null&&fn()>Vo&&(t.flags|=128,s=!0,ga(f,!1),t.lanes=4194304)}else{if(!s)if(e=Ec(m),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ga(f,!0),f.tail===null&&f.tailMode==="hidden"&&!m.alternate&&!Yt)return Zn(t),null}else 2*fn()-f.renderingStartTime>Vo&&n!==1073741824&&(t.flags|=128,s=!0,ga(f,!1),t.lanes=4194304);f.isBackwards?(m.sibling=t.child,t.child=m):(n=f.last,n!==null?n.sibling=m:t.child=m,f.last=m)}return f.tail!==null?(t=f.tail,f.rendering=t,f.tail=t.sibling,f.renderingStartTime=fn(),t.sibling=null,n=qt.current,Ft(qt,s?n&1|2:n&1),t):(Zn(t),null);case 22:case 23:return Yh(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?Nr&1073741824&&(Zn(t),t.subtreeFlags&6&&(t.flags|=8192)):Zn(t),null;case 24:return null;case 25:return null}throw Error(Se(156,t.tag))}function Ty(e,t){switch(Th(t),t.tag){case 1:return yr(t.type)&&mc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Uo(),Zt(xr),Zt(Xn),Dh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Ph(t),null;case 13:if(Zt(qt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Se(340));jo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Zt(qt),null;case 4:return Uo(),null;case 10:return Rh(t.type._context),null;case 22:case 23:return Yh(),null;case 24:return null;default:return null}}var Dl=!1,Yn=!1,Iy=typeof WeakSet=="function"?WeakSet:Set,je=null;function So(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){rn(e,t,s)}else n.current=null}function Nf(e,t,n){try{n()}catch(s){rn(e,t,s)}}var S0=!1;function Ny(e,t){if(hf=hc,e=wp(),Sh(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var l=s.anchorOffset,f=s.focusNode;s=s.focusOffset;try{n.nodeType,f.nodeType}catch{n=null;break e}var m=0,v=-1,_=-1,x=0,E=0,b=e,M=null;t:for(;;){for(var F;b!==n||l!==0&&b.nodeType!==3||(v=m+l),b!==f||s!==0&&b.nodeType!==3||(_=m+s),b.nodeType===3&&(m+=b.nodeValue.length),(F=b.firstChild)!==null;)M=b,b=F;for(;;){if(b===e)break t;if(M===n&&++x===l&&(v=m),M===f&&++E===s&&(_=m),(F=b.nextSibling)!==null)break;b=M,M=b.parentNode}b=F}n=v===-1||_===-1?null:{start:v,end:_}}else n=null}n=n||{start:0,end:0}}else n=null;for(df={focusedElem:e,selectionRange:n},hc=!1,je=t;je!==null;)if(t=je,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,je=e;else for(;je!==null;){t=je;try{var z=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(z!==null){var U=z.memoizedProps,re=z.memoizedState,H=t.stateNode,D=H.getSnapshotBeforeUpdate(t.elementType===t.type?U:li(t.type,U),re);H.__reactInternalSnapshotBeforeUpdate=D}break;case 3:var B=t.stateNode.containerInfo;B.nodeType===1?B.textContent="":B.nodeType===9&&B.documentElement&&B.removeChild(B.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Se(163))}}catch($){rn(t,t.return,$)}if(e=t.sibling,e!==null){e.return=t.return,je=e;break}je=t.return}return z=S0,S0=!1,z}function ka(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var l=s=s.next;do{if((l.tag&e)===e){var f=l.destroy;l.destroy=void 0,f!==void 0&&Nf(t,n,f)}l=l.next}while(l!==s)}}function Gc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function Mf(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function xg(e){var t=e.alternate;t!==null&&(e.alternate=null,xg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ni],delete t[$a],delete t[mf],delete t[fy],delete t[hy])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function yg(e){return e.tag===5||e.tag===3||e.tag===4}function A0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||yg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Rf(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=gc));else if(s!==4&&(e=e.child,e!==null))for(Rf(e,t,n),e=e.sibling;e!==null;)Rf(e,t,n),e=e.sibling}function kf(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(kf(e,t,n),e=e.sibling;e!==null;)kf(e,t,n),e=e.sibling}var Ln=null,ci=!1;function os(e,t,n){for(n=n.child;n!==null;)_g(e,t,n),n=n.sibling}function _g(e,t,n){if(Mi&&typeof Mi.onCommitFiberUnmount=="function")try{Mi.onCommitFiberUnmount(Fc,n)}catch{}switch(n.tag){case 5:Yn||So(n,t);case 6:var s=Ln,l=ci;Ln=null,os(e,t,n),Ln=s,ci=l,Ln!==null&&(ci?(e=Ln,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ln.removeChild(n.stateNode));break;case 18:Ln!==null&&(ci?(e=Ln,n=n.stateNode,e.nodeType===8?Iu(e.parentNode,n):e.nodeType===1&&Iu(e,n),Wa(e)):Iu(Ln,n.stateNode));break;case 4:s=Ln,l=ci,Ln=n.stateNode.containerInfo,ci=!0,os(e,t,n),Ln=s,ci=l;break;case 0:case 11:case 14:case 15:if(!Yn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){l=s=s.next;do{var f=l,m=f.destroy;f=f.tag,m!==void 0&&(f&2||f&4)&&Nf(n,t,m),l=l.next}while(l!==s)}os(e,t,n);break;case 1:if(!Yn&&(So(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(v){rn(n,t,v)}os(e,t,n);break;case 21:os(e,t,n);break;case 22:n.mode&1?(Yn=(s=Yn)||n.memoizedState!==null,os(e,t,n),Yn=s):os(e,t,n);break;default:os(e,t,n)}}function T0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Iy),t.forEach(function(s){var l=Fy.bind(null,e,s);n.has(s)||(n.add(s),s.then(l,l))})}}function ai(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var l=n[s];try{var f=e,m=t,v=m;e:for(;v!==null;){switch(v.tag){case 5:Ln=v.stateNode,ci=!1;break e;case 3:Ln=v.stateNode.containerInfo,ci=!0;break e;case 4:Ln=v.stateNode.containerInfo,ci=!0;break e}v=v.return}if(Ln===null)throw Error(Se(160));_g(f,m,l),Ln=null,ci=!1;var _=l.alternate;_!==null&&(_.return=null),l.return=null}catch(x){rn(l,t,x)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)vg(t,e),t=t.sibling}function vg(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ai(t,e),Ai(e),s&4){try{ka(3,e,e.return),Gc(3,e)}catch(U){rn(e,e.return,U)}try{ka(5,e,e.return)}catch(U){rn(e,e.return,U)}}break;case 1:ai(t,e),Ai(e),s&512&&n!==null&&So(n,n.return);break;case 5:if(ai(t,e),Ai(e),s&512&&n!==null&&So(n,n.return),e.flags&32){var l=e.stateNode;try{za(l,"")}catch(U){rn(e,e.return,U)}}if(s&4&&(l=e.stateNode,l!=null)){var f=e.memoizedProps,m=n!==null?n.memoizedProps:f,v=e.type,_=e.updateQueue;if(e.updateQueue=null,_!==null)try{v==="input"&&f.type==="radio"&&f.name!=null&&H1(l,f),tf(v,m);var x=tf(v,f);for(m=0;m<_.length;m+=2){var E=_[m],b=_[m+1];E==="style"?Y1(l,b):E==="dangerouslySetInnerHTML"?Z1(l,b):E==="children"?za(l,b):hh(l,E,b,x)}switch(v){case"input":Qu(l,f);break;case"textarea":V1(l,f);break;case"select":var M=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!f.multiple;var F=f.value;F!=null?No(l,!!f.multiple,F,!1):M!==!!f.multiple&&(f.defaultValue!=null?No(l,!!f.multiple,f.defaultValue,!0):No(l,!!f.multiple,f.multiple?[]:"",!1))}l[$a]=f}catch(U){rn(e,e.return,U)}}break;case 6:if(ai(t,e),Ai(e),s&4){if(e.stateNode===null)throw Error(Se(162));l=e.stateNode,f=e.memoizedProps;try{l.nodeValue=f}catch(U){rn(e,e.return,U)}}break;case 3:if(ai(t,e),Ai(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Wa(t.containerInfo)}catch(U){rn(e,e.return,U)}break;case 4:ai(t,e),Ai(e);break;case 13:ai(t,e),Ai(e),l=e.child,l.flags&8192&&(f=l.memoizedState!==null,l.stateNode.isHidden=f,!f||l.alternate!==null&&l.alternate.memoizedState!==null||(Zh=fn())),s&4&&T0(e);break;case 22:if(E=n!==null&&n.memoizedState!==null,e.mode&1?(Yn=(x=Yn)||E,ai(t,e),Yn=x):ai(t,e),Ai(e),s&8192){if(x=e.memoizedState!==null,(e.stateNode.isHidden=x)&&!E&&e.mode&1)for(je=e,E=e.child;E!==null;){for(b=je=E;je!==null;){switch(M=je,F=M.child,M.tag){case 0:case 11:case 14:case 15:ka(4,M,M.return);break;case 1:So(M,M.return);var z=M.stateNode;if(typeof z.componentWillUnmount=="function"){s=M,n=M.return;try{t=s,z.props=t.memoizedProps,z.state=t.memoizedState,z.componentWillUnmount()}catch(U){rn(s,n,U)}}break;case 5:So(M,M.return);break;case 22:if(M.memoizedState!==null){N0(b);continue}}F!==null?(F.return=M,je=F):N0(b)}E=E.sibling}e:for(E=null,b=e;;){if(b.tag===5){if(E===null){E=b;try{l=b.stateNode,x?(f=l.style,typeof f.setProperty=="function"?f.setProperty("display","none","important"):f.display="none"):(v=b.stateNode,_=b.memoizedProps.style,m=_!=null&&_.hasOwnProperty("display")?_.display:null,v.style.display=G1("display",m))}catch(U){rn(e,e.return,U)}}}else if(b.tag===6){if(E===null)try{b.stateNode.nodeValue=x?"":b.memoizedProps}catch(U){rn(e,e.return,U)}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===e)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===e)break e;for(;b.sibling===null;){if(b.return===null||b.return===e)break e;E===b&&(E=null),b=b.return}E===b&&(E=null),b.sibling.return=b.return,b=b.sibling}}break;case 19:ai(t,e),Ai(e),s&4&&T0(e);break;case 21:break;default:ai(t,e),Ai(e)}}function Ai(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(yg(n)){var s=n;break e}n=n.return}throw Error(Se(160))}switch(s.tag){case 5:var l=s.stateNode;s.flags&32&&(za(l,""),s.flags&=-33);var f=A0(e);kf(e,f,l);break;case 3:case 4:var m=s.stateNode.containerInfo,v=A0(e);Rf(e,v,m);break;default:throw Error(Se(161))}}catch(_){rn(e,e.return,_)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function My(e,t,n){je=e,wg(e)}function wg(e,t,n){for(var s=(e.mode&1)!==0;je!==null;){var l=je,f=l.child;if(l.tag===22&&s){var m=l.memoizedState!==null||Dl;if(!m){var v=l.alternate,_=v!==null&&v.memoizedState!==null||Yn;v=Dl;var x=Yn;if(Dl=m,(Yn=_)&&!x)for(je=l;je!==null;)m=je,_=m.child,m.tag===22&&m.memoizedState!==null?M0(l):_!==null?(_.return=m,je=_):M0(l);for(;f!==null;)je=f,wg(f),f=f.sibling;je=l,Dl=v,Yn=x}I0(e)}else l.subtreeFlags&8772&&f!==null?(f.return=l,je=f):I0(e)}}function I0(e){for(;je!==null;){var t=je;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Yn||Gc(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Yn)if(n===null)s.componentDidMount();else{var l=t.elementType===t.type?n.memoizedProps:li(t.type,n.memoizedProps);s.componentDidUpdate(l,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var f=t.updateQueue;f!==null&&h0(t,f,s);break;case 3:var m=t.updateQueue;if(m!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}h0(t,m,n)}break;case 5:var v=t.stateNode;if(n===null&&t.flags&4){n=v;var _=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":_.autoFocus&&n.focus();break;case"img":_.src&&(n.src=_.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var x=t.alternate;if(x!==null){var E=x.memoizedState;if(E!==null){var b=E.dehydrated;b!==null&&Wa(b)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Se(163))}Yn||t.flags&512&&Mf(t)}catch(M){rn(t,t.return,M)}}if(t===e){je=null;break}if(n=t.sibling,n!==null){n.return=t.return,je=n;break}je=t.return}}function N0(e){for(;je!==null;){var t=je;if(t===e){je=null;break}var n=t.sibling;if(n!==null){n.return=t.return,je=n;break}je=t.return}}function M0(e){for(;je!==null;){var t=je;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Gc(4,t)}catch(_){rn(t,n,_)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var l=t.return;try{s.componentDidMount()}catch(_){rn(t,l,_)}}var f=t.return;try{Mf(t)}catch(_){rn(t,f,_)}break;case 5:var m=t.return;try{Mf(t)}catch(_){rn(t,m,_)}}}catch(_){rn(t,t.return,_)}if(t===e){je=null;break}var v=t.sibling;if(v!==null){v.return=t.return,je=v;break}je=t.return}}var Ry=Math.ceil,Ac=Ki.ReactCurrentDispatcher,Vh=Ki.ReactCurrentOwner,$r=Ki.ReactCurrentBatchConfig,xt=0,Mn=null,yn=null,Pn=0,Nr=0,Ao=Ns(0),bn=0,tl=null,Qs=0,Yc=0,Wh=0,Oa=null,gr=null,Zh=0,Vo=1/0,Ui=null,Tc=!1,Of=null,ws=null,Bl=!1,ps=null,Ic=0,La=0,Lf=null,Ql=-1,Kl=0;function ar(){return xt&6?fn():Ql!==-1?Ql:Ql=fn()}function Cs(e){return e.mode&1?xt&2&&Pn!==0?Pn&-Pn:py.transition!==null?(Kl===0&&(Kl=sp()),Kl):(e=Tt,e!==0||(e=window.event,e=e===void 0?16:hp(e.type)),e):1}function di(e,t,n,s){if(50<La)throw La=0,Lf=null,Error(Se(185));al(e,n,s),(!(xt&2)||e!==Mn)&&(e===Mn&&(!(xt&2)&&(Yc|=n),bn===4&&hs(e,Pn)),_r(e,s),n===1&&xt===0&&!(t.mode&1)&&(Vo=fn()+500,Vc&&Ms()))}function _r(e,t){var n=e.callbackNode;p2(e,t);var s=fc(e,e===Mn?Pn:0);if(s===0)n!==null&&jd(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&jd(n),t===1)e.tag===0?dy(R0.bind(null,e)):Rp(R0.bind(null,e)),cy(function(){!(xt&6)&&Ms()}),n=null;else{switch(op(s)){case 1:n=xh;break;case 4:n=rp;break;case 16:n=uc;break;case 536870912:n=ip;break;default:n=uc}n=Ng(n,Cg.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Cg(e,t){if(Ql=-1,Kl=0,xt&6)throw Error(Se(327));var n=e.callbackNode;if(Lo()&&e.callbackNode!==n)return null;var s=fc(e,e===Mn?Pn:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Nc(e,s);else{t=s;var l=xt;xt|=2;var f=bg();(Mn!==e||Pn!==t)&&(Ui=null,Vo=fn()+500,Zs(e,t));do try{Ly();break}catch(v){Eg(e,v)}while(!0);Mh(),Ac.current=f,xt=l,yn!==null?t=0:(Mn=null,Pn=0,t=bn)}if(t!==0){if(t===2&&(l=af(e),l!==0&&(s=l,t=Pf(e,l))),t===1)throw n=tl,Zs(e,0),hs(e,s),_r(e,fn()),n;if(t===6)hs(e,s);else{if(l=e.current.alternate,!(s&30)&&!ky(l)&&(t=Nc(e,s),t===2&&(f=af(e),f!==0&&(s=f,t=Pf(e,f))),t===1))throw n=tl,Zs(e,0),hs(e,s),_r(e,fn()),n;switch(e.finishedWork=l,e.finishedLanes=s,t){case 0:case 1:throw Error(Se(345));case 2:js(e,gr,Ui);break;case 3:if(hs(e,s),(s&130023424)===s&&(t=Zh+500-fn(),10<t)){if(fc(e,0)!==0)break;if(l=e.suspendedLanes,(l&s)!==s){ar(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=gf(js.bind(null,e,gr,Ui),t);break}js(e,gr,Ui);break;case 4:if(hs(e,s),(s&4194240)===s)break;for(t=e.eventTimes,l=-1;0<s;){var m=31-hi(s);f=1<<m,m=t[m],m>l&&(l=m),s&=~f}if(s=l,s=fn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Ry(s/1960))-s,10<s){e.timeoutHandle=gf(js.bind(null,e,gr,Ui),s);break}js(e,gr,Ui);break;case 5:js(e,gr,Ui);break;default:throw Error(Se(329))}}}return _r(e,fn()),e.callbackNode===n?Cg.bind(null,e):null}function Pf(e,t){var n=Oa;return e.current.memoizedState.isDehydrated&&(Zs(e,t).flags|=256),e=Nc(e,t),e!==2&&(t=gr,gr=n,t!==null&&Df(t)),e}function Df(e){gr===null?gr=e:gr.push.apply(gr,e)}function ky(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var l=n[s],f=l.getSnapshot;l=l.value;try{if(!pi(f(),l))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function hs(e,t){for(t&=~Wh,t&=~Yc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-hi(t),s=1<<n;e[n]=-1,t&=~s}}function R0(e){if(xt&6)throw Error(Se(327));Lo();var t=fc(e,0);if(!(t&1))return _r(e,fn()),null;var n=Nc(e,t);if(e.tag!==0&&n===2){var s=af(e);s!==0&&(t=s,n=Pf(e,s))}if(n===1)throw n=tl,Zs(e,0),hs(e,t),_r(e,fn()),n;if(n===6)throw Error(Se(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,js(e,gr,Ui),_r(e,fn()),null}function Gh(e,t){var n=xt;xt|=1;try{return e(t)}finally{xt=n,xt===0&&(Vo=fn()+500,Vc&&Ms())}}function Ks(e){ps!==null&&ps.tag===0&&!(xt&6)&&Lo();var t=xt;xt|=1;var n=$r.transition,s=Tt;try{if($r.transition=null,Tt=1,e)return e()}finally{Tt=s,$r.transition=n,xt=t,!(xt&6)&&Ms()}}function Yh(){Nr=Ao.current,Zt(Ao)}function Zs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,ly(n)),yn!==null)for(n=yn.return;n!==null;){var s=n;switch(Th(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&mc();break;case 3:Uo(),Zt(xr),Zt(Xn),Dh();break;case 5:Ph(s);break;case 4:Uo();break;case 13:Zt(qt);break;case 19:Zt(qt);break;case 10:Rh(s.type._context);break;case 22:case 23:Yh()}n=n.return}if(Mn=e,yn=e=Es(e.current,null),Pn=Nr=t,bn=0,tl=null,Wh=Yc=Qs=0,gr=Oa=null,Hs!==null){for(t=0;t<Hs.length;t++)if(n=Hs[t],s=n.interleaved,s!==null){n.interleaved=null;var l=s.next,f=n.pending;if(f!==null){var m=f.next;f.next=l,s.next=m}n.pending=s}Hs=null}return e}function Eg(e,t){do{var n=yn;try{if(Mh(),Yl.current=Sc,bc){for(var s=Jt.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}bc=!1}if($s=0,Nn=En=Jt=null,Ra=!1,qa=0,Vh.current=null,n===null||n.return===null){bn=1,tl=t,yn=null;break}e:{var f=e,m=n.return,v=n,_=t;if(t=Pn,v.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){var x=_,E=v,b=E.tag;if(!(E.mode&1)&&(b===0||b===11||b===15)){var M=E.alternate;M?(E.updateQueue=M.updateQueue,E.memoizedState=M.memoizedState,E.lanes=M.lanes):(E.updateQueue=null,E.memoizedState=null)}var F=y0(m);if(F!==null){F.flags&=-257,_0(F,m,v,f,t),F.mode&1&&x0(f,x,t),t=F,_=x;var z=t.updateQueue;if(z===null){var U=new Set;U.add(_),t.updateQueue=U}else z.add(_);break e}else{if(!(t&1)){x0(f,x,t),Xh();break e}_=Error(Se(426))}}else if(Yt&&v.mode&1){var re=y0(m);if(re!==null){!(re.flags&65536)&&(re.flags|=256),_0(re,m,v,f,t),Ih(Ho(_,v));break e}}f=_=Ho(_,v),bn!==4&&(bn=2),Oa===null?Oa=[f]:Oa.push(f),f=m;do{switch(f.tag){case 3:f.flags|=65536,t&=-t,f.lanes|=t;var H=og(f,_,t);f0(f,H);break e;case 1:v=_;var D=f.type,B=f.stateNode;if(!(f.flags&128)&&(typeof D.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(ws===null||!ws.has(B)))){f.flags|=65536,t&=-t,f.lanes|=t;var $=ag(f,v,t);f0(f,$);break e}}f=f.return}while(f!==null)}Ag(n)}catch(fe){t=fe,yn===n&&n!==null&&(yn=n=n.return);continue}break}while(!0)}function bg(){var e=Ac.current;return Ac.current=Sc,e===null?Sc:e}function Xh(){(bn===0||bn===3||bn===2)&&(bn=4),Mn===null||!(Qs&268435455)&&!(Yc&268435455)||hs(Mn,Pn)}function Nc(e,t){var n=xt;xt|=2;var s=bg();(Mn!==e||Pn!==t)&&(Ui=null,Zs(e,t));do try{Oy();break}catch(l){Eg(e,l)}while(!0);if(Mh(),xt=n,Ac.current=s,yn!==null)throw Error(Se(261));return Mn=null,Pn=0,bn}function Oy(){for(;yn!==null;)Sg(yn)}function Ly(){for(;yn!==null&&!s2();)Sg(yn)}function Sg(e){var t=Ig(e.alternate,e,Nr);e.memoizedProps=e.pendingProps,t===null?Ag(e):yn=t,Vh.current=null}function Ag(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Ty(n,t),n!==null){n.flags&=32767,yn=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{bn=6,yn=null;return}}else if(n=Ay(n,t,Nr),n!==null){yn=n;return}if(t=t.sibling,t!==null){yn=t;return}yn=t=e}while(t!==null);bn===0&&(bn=5)}function js(e,t,n){var s=Tt,l=$r.transition;try{$r.transition=null,Tt=1,Py(e,t,n,s)}finally{$r.transition=l,Tt=s}return null}function Py(e,t,n,s){do Lo();while(ps!==null);if(xt&6)throw Error(Se(327));n=e.finishedWork;var l=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Se(177));e.callbackNode=null,e.callbackPriority=0;var f=n.lanes|n.childLanes;if(g2(e,f),e===Mn&&(yn=Mn=null,Pn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bl||(Bl=!0,Ng(uc,function(){return Lo(),null})),f=(n.flags&15990)!==0,n.subtreeFlags&15990||f){f=$r.transition,$r.transition=null;var m=Tt;Tt=1;var v=xt;xt|=4,Vh.current=null,Ny(e,n),vg(n,e),ty(df),hc=!!hf,df=hf=null,e.current=n,My(n),o2(),xt=v,Tt=m,$r.transition=f}else e.current=n;if(Bl&&(Bl=!1,ps=e,Ic=l),f=e.pendingLanes,f===0&&(ws=null),c2(n.stateNode),_r(e,fn()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)l=t[n],s(l.value,{componentStack:l.stack,digest:l.digest});if(Tc)throw Tc=!1,e=Of,Of=null,e;return Ic&1&&e.tag!==0&&Lo(),f=e.pendingLanes,f&1?e===Lf?La++:(La=0,Lf=e):La=0,Ms(),null}function Lo(){if(ps!==null){var e=op(Ic),t=$r.transition,n=Tt;try{if($r.transition=null,Tt=16>e?16:e,ps===null)var s=!1;else{if(e=ps,ps=null,Ic=0,xt&6)throw Error(Se(331));var l=xt;for(xt|=4,je=e.current;je!==null;){var f=je,m=f.child;if(je.flags&16){var v=f.deletions;if(v!==null){for(var _=0;_<v.length;_++){var x=v[_];for(je=x;je!==null;){var E=je;switch(E.tag){case 0:case 11:case 15:ka(8,E,f)}var b=E.child;if(b!==null)b.return=E,je=b;else for(;je!==null;){E=je;var M=E.sibling,F=E.return;if(xg(E),E===x){je=null;break}if(M!==null){M.return=F,je=M;break}je=F}}}var z=f.alternate;if(z!==null){var U=z.child;if(U!==null){z.child=null;do{var re=U.sibling;U.sibling=null,U=re}while(U!==null)}}je=f}}if(f.subtreeFlags&2064&&m!==null)m.return=f,je=m;else e:for(;je!==null;){if(f=je,f.flags&2048)switch(f.tag){case 0:case 11:case 15:ka(9,f,f.return)}var H=f.sibling;if(H!==null){H.return=f.return,je=H;break e}je=f.return}}var D=e.current;for(je=D;je!==null;){m=je;var B=m.child;if(m.subtreeFlags&2064&&B!==null)B.return=m,je=B;else e:for(m=D;je!==null;){if(v=je,v.flags&2048)try{switch(v.tag){case 0:case 11:case 15:Gc(9,v)}}catch(fe){rn(v,v.return,fe)}if(v===m){je=null;break e}var $=v.sibling;if($!==null){$.return=v.return,je=$;break e}je=v.return}}if(xt=l,Ms(),Mi&&typeof Mi.onPostCommitFiberRoot=="function")try{Mi.onPostCommitFiberRoot(Fc,e)}catch{}s=!0}return s}finally{Tt=n,$r.transition=t}}return!1}function k0(e,t,n){t=Ho(n,t),t=og(e,t,1),e=vs(e,t,1),t=ar(),e!==null&&(al(e,1,t),_r(e,t))}function rn(e,t,n){if(e.tag===3)k0(e,e,n);else for(;t!==null;){if(t.tag===3){k0(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ws===null||!ws.has(s))){e=Ho(n,e),e=ag(t,e,1),t=vs(t,e,1),e=ar(),t!==null&&(al(t,1,e),_r(t,e));break}}t=t.return}}function Dy(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=ar(),e.pingedLanes|=e.suspendedLanes&n,Mn===e&&(Pn&n)===n&&(bn===4||bn===3&&(Pn&130023424)===Pn&&500>fn()-Zh?Zs(e,0):Wh|=n),_r(e,t)}function Tg(e,t){t===0&&(e.mode&1?(t=Tl,Tl<<=1,!(Tl&130023424)&&(Tl=4194304)):t=1);var n=ar();e=$i(e,t),e!==null&&(al(e,t,n),_r(e,n))}function By(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Tg(e,n)}function Fy(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,l=e.memoizedState;l!==null&&(n=l.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(Se(314))}s!==null&&s.delete(t),Tg(e,n)}var Ig;Ig=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||xr.current)mr=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return mr=!1,Sy(e,t,n);mr=!!(e.flags&131072)}else mr=!1,Yt&&t.flags&1048576&&kp(t,_c,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;$l(e,t),e=t.pendingProps;var l=Fo(t,Xn.current);Oo(t,n),l=Fh(null,t,s,e,l,n);var f=jh();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,yr(s)?(f=!0,xc(t)):f=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,Oh(t),l.updater=Zc,t.stateNode=l,l._reactInternals=t,Cf(t,s,e,n),t=Sf(null,t,s,!0,f,n)):(t.tag=0,Yt&&f&&Ah(t),or(null,t,l,n),t=t.child),t;case 16:s=t.elementType;e:{switch($l(e,t),e=t.pendingProps,l=s._init,s=l(s._payload),t.type=s,l=t.tag=zy(s),e=li(s,e),l){case 0:t=bf(null,t,s,e,n);break e;case 1:t=C0(null,t,s,e,n);break e;case 11:t=v0(null,t,s,e,n);break e;case 14:t=w0(null,t,s,li(s.type,e),n);break e}throw Error(Se(306,s,""))}return t;case 0:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:li(s,l),bf(e,t,s,l,n);case 1:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:li(s,l),C0(e,t,s,l,n);case 3:e:{if(fg(t),e===null)throw Error(Se(387));s=t.pendingProps,f=t.memoizedState,l=f.element,Fp(e,t),Cc(t,s,null,n);var m=t.memoizedState;if(s=m.element,f.isDehydrated)if(f={element:s,isDehydrated:!1,cache:m.cache,pendingSuspenseBoundaries:m.pendingSuspenseBoundaries,transitions:m.transitions},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){l=Ho(Error(Se(423)),t),t=E0(e,t,s,n,l);break e}else if(s!==l){l=Ho(Error(Se(424)),t),t=E0(e,t,s,n,l);break e}else for(Rr=_s(t.stateNode.containerInfo.firstChild),kr=t,Yt=!0,fi=null,n=Dp(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(jo(),s===l){t=Qi(e,t,n);break e}or(e,t,s,n)}t=t.child}return t;case 5:return jp(t),e===null&&_f(t),s=t.type,l=t.pendingProps,f=e!==null?e.memoizedProps:null,m=l.children,pf(s,l)?m=null:f!==null&&pf(s,f)&&(t.flags|=32),ug(e,t),or(e,t,m,n),t.child;case 6:return e===null&&_f(t),null;case 13:return hg(e,t,n);case 4:return Lh(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=zo(t,null,s,n):or(e,t,s,n),t.child;case 11:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:li(s,l),v0(e,t,s,l,n);case 7:return or(e,t,t.pendingProps,n),t.child;case 8:return or(e,t,t.pendingProps.children,n),t.child;case 12:return or(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,l=t.pendingProps,f=t.memoizedProps,m=l.value,Ft(vc,s._currentValue),s._currentValue=m,f!==null)if(pi(f.value,m)){if(f.children===l.children&&!xr.current){t=Qi(e,t,n);break e}}else for(f=t.child,f!==null&&(f.return=t);f!==null;){var v=f.dependencies;if(v!==null){m=f.child;for(var _=v.firstContext;_!==null;){if(_.context===s){if(f.tag===1){_=Gi(-1,n&-n),_.tag=2;var x=f.updateQueue;if(x!==null){x=x.shared;var E=x.pending;E===null?_.next=_:(_.next=E.next,E.next=_),x.pending=_}}f.lanes|=n,_=f.alternate,_!==null&&(_.lanes|=n),vf(f.return,n,t),v.lanes|=n;break}_=_.next}}else if(f.tag===10)m=f.type===t.type?null:f.child;else if(f.tag===18){if(m=f.return,m===null)throw Error(Se(341));m.lanes|=n,v=m.alternate,v!==null&&(v.lanes|=n),vf(m,n,t),m=f.sibling}else m=f.child;if(m!==null)m.return=f;else for(m=f;m!==null;){if(m===t){m=null;break}if(f=m.sibling,f!==null){f.return=m.return,m=f;break}m=m.return}f=m}or(e,t,l.children,n),t=t.child}return t;case 9:return l=t.type,s=t.pendingProps.children,Oo(t,n),l=Qr(l),s=s(l),t.flags|=1,or(e,t,s,n),t.child;case 14:return s=t.type,l=li(s,t.pendingProps),l=li(s.type,l),w0(e,t,s,l,n);case 15:return lg(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:li(s,l),$l(e,t),t.tag=1,yr(s)?(e=!0,xc(t)):e=!1,Oo(t,n),sg(t,s,l),Cf(t,s,l,n),Sf(null,t,s,!0,e,n);case 19:return dg(e,t,n);case 22:return cg(e,t,n)}throw Error(Se(156,t.tag))};function Ng(e,t){return np(e,t)}function jy(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xr(e,t,n,s){return new jy(e,t,n,s)}function $h(e){return e=e.prototype,!(!e||!e.isReactComponent)}function zy(e){if(typeof e=="function")return $h(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ph)return 11;if(e===gh)return 14}return 2}function Es(e,t){var n=e.alternate;return n===null?(n=Xr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ql(e,t,n,s,l,f){var m=2;if(s=e,typeof e=="function")$h(e)&&(m=1);else if(typeof e=="string")m=5;else e:switch(e){case mo:return Gs(n.children,l,f,t);case dh:m=8,l|=8;break;case Zu:return e=Xr(12,n,t,l|2),e.elementType=Zu,e.lanes=f,e;case Gu:return e=Xr(13,n,t,l),e.elementType=Gu,e.lanes=f,e;case Yu:return e=Xr(19,n,t,l),e.elementType=Yu,e.lanes=f,e;case j1:return Xc(n,l,f,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case B1:m=10;break e;case F1:m=9;break e;case ph:m=11;break e;case gh:m=14;break e;case ls:m=16,s=null;break e}throw Error(Se(130,e==null?e:typeof e,""))}return t=Xr(m,n,t,l),t.elementType=e,t.type=s,t.lanes=f,t}function Gs(e,t,n,s){return e=Xr(7,e,s,t),e.lanes=n,e}function Xc(e,t,n,s){return e=Xr(22,e,s,t),e.elementType=j1,e.lanes=n,e.stateNode={isHidden:!1},e}function Du(e,t,n){return e=Xr(6,e,null,t),e.lanes=n,e}function Bu(e,t,n){return t=Xr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uy(e,t,n,s,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xu(0),this.expirationTimes=xu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xu(0),this.identifierPrefix=s,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Qh(e,t,n,s,l,f,m,v,_){return e=new Uy(e,t,n,v,_),t===1?(t=1,f===!0&&(t|=8)):t=0,f=Xr(3,null,null,t),e.current=f,f.stateNode=e,f.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oh(f),e}function Hy(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:go,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function Mg(e){if(!e)return As;e=e._reactInternals;e:{if(eo(e)!==e||e.tag!==1)throw Error(Se(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(yr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Se(171))}if(e.tag===1){var n=e.type;if(yr(n))return Mp(e,n,t)}return t}function Rg(e,t,n,s,l,f,m,v,_){return e=Qh(n,s,!0,e,l,f,m,v,_),e.context=Mg(null),n=e.current,s=ar(),l=Cs(n),f=Gi(s,l),f.callback=t??null,vs(n,f,l),e.current.lanes=l,al(e,l,s),_r(e,s),e}function $c(e,t,n,s){var l=t.current,f=ar(),m=Cs(l);return n=Mg(n),t.context===null?t.context=n:t.pendingContext=n,t=Gi(f,m),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=vs(l,t,m),e!==null&&(di(e,l,m,f),Gl(e,l,m)),m}function Mc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function O0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Kh(e,t){O0(e,t),(e=e.alternate)&&O0(e,t)}function Vy(){return null}var kg=typeof reportError=="function"?reportError:function(e){console.error(e)};function qh(e){this._internalRoot=e}Qc.prototype.render=qh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Se(409));$c(e,t,null,null)};Qc.prototype.unmount=qh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ks(function(){$c(null,e,null,null)}),t[Xi]=null}};function Qc(e){this._internalRoot=e}Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=cp();e={blockedOn:null,target:e,priority:t};for(var n=0;n<fs.length&&t!==0&&t<fs[n].priority;n++);fs.splice(n,0,e),n===0&&fp(e)}};function Jh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Kc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function L0(){}function Wy(e,t,n,s,l){if(l){if(typeof s=="function"){var f=s;s=function(){var x=Mc(m);f.call(x)}}var m=Rg(t,s,e,0,null,!1,!1,"",L0);return e._reactRootContainer=m,e[Xi]=m.current,Ya(e.nodeType===8?e.parentNode:e),Ks(),m}for(;l=e.lastChild;)e.removeChild(l);if(typeof s=="function"){var v=s;s=function(){var x=Mc(_);v.call(x)}}var _=Qh(e,0,!1,null,null,!1,!1,"",L0);return e._reactRootContainer=_,e[Xi]=_.current,Ya(e.nodeType===8?e.parentNode:e),Ks(function(){$c(t,_,n,s)}),_}function qc(e,t,n,s,l){var f=n._reactRootContainer;if(f){var m=f;if(typeof l=="function"){var v=l;l=function(){var _=Mc(m);v.call(_)}}$c(t,m,e,l)}else m=Wy(n,t,e,l,s);return Mc(m)}ap=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ea(t.pendingLanes);n!==0&&(yh(t,n|1),_r(t,fn()),!(xt&6)&&(Vo=fn()+500,Ms()))}break;case 13:Ks(function(){var s=$i(e,1);if(s!==null){var l=ar();di(s,e,1,l)}}),Kh(e,1)}};_h=function(e){if(e.tag===13){var t=$i(e,134217728);if(t!==null){var n=ar();di(t,e,134217728,n)}Kh(e,134217728)}};lp=function(e){if(e.tag===13){var t=Cs(e),n=$i(e,t);if(n!==null){var s=ar();di(n,e,t,s)}Kh(e,t)}};cp=function(){return Tt};up=function(e,t){var n=Tt;try{return Tt=e,t()}finally{Tt=n}};rf=function(e,t,n){switch(t){case"input":if(Qu(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var l=Hc(s);if(!l)throw Error(Se(90));U1(s),Qu(s,l)}}}break;case"textarea":V1(e,n);break;case"select":t=n.value,t!=null&&No(e,!!n.multiple,t,!1)}};Q1=Gh;K1=Ks;var Zy={usingClientEntryPoint:!1,Events:[cl,vo,Hc,X1,$1,Gh]},ma={findFiberByHostInstance:Us,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Gy={bundleType:ma.bundleType,version:ma.version,rendererPackageName:ma.rendererPackageName,rendererConfig:ma.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ki.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ep(e),e===null?null:e.stateNode},findFiberByHostInstance:ma.findFiberByHostInstance||Vy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fl.isDisabled&&Fl.supportsFiber)try{Fc=Fl.inject(Gy),Mi=Fl}catch{}}Lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zy;Lr.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jh(t))throw Error(Se(200));return Hy(e,t,null,n)};Lr.createRoot=function(e,t){if(!Jh(e))throw Error(Se(299));var n=!1,s="",l=kg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=Qh(e,1,!1,null,null,n,!1,s,l),e[Xi]=t.current,Ya(e.nodeType===8?e.parentNode:e),new qh(t)};Lr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Se(188)):(e=Object.keys(e).join(","),Error(Se(268,e)));return e=ep(t),e=e===null?null:e.stateNode,e};Lr.flushSync=function(e){return Ks(e)};Lr.hydrate=function(e,t,n){if(!Kc(t))throw Error(Se(200));return qc(null,e,t,!0,n)};Lr.hydrateRoot=function(e,t,n){if(!Jh(e))throw Error(Se(405));var s=n!=null&&n.hydratedSources||null,l=!1,f="",m=kg;if(n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(f=n.identifierPrefix),n.onRecoverableError!==void 0&&(m=n.onRecoverableError)),t=Rg(t,null,e,1,n??null,l,!1,f,m),e[Xi]=t.current,Ya(e),s)for(e=0;e<s.length;e++)n=s[e],l=n._getVersion,l=l(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,l]:t.mutableSourceEagerHydrationData.push(n,l);return new Qc(t)};Lr.render=function(e,t,n){if(!Kc(t))throw Error(Se(200));return qc(null,e,t,!1,n)};Lr.unmountComponentAtNode=function(e){if(!Kc(e))throw Error(Se(40));return e._reactRootContainer?(Ks(function(){qc(null,null,e,!1,function(){e._reactRootContainer=null,e[Xi]=null})}),!0):!1};Lr.unstable_batchedUpdates=Gh;Lr.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!Kc(n))throw Error(Se(200));if(e==null||e._reactInternals===void 0)throw Error(Se(38));return qc(e,t,n,!1,s)};Lr.version="18.3.1-next-f1338f8080-20240426";function Og(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Og)}catch(e){console.error(e)}}Og(),O1.exports=Lr;var Yy=O1.exports,P0=Yy;Vu.createRoot=P0.createRoot,Vu.hydrateRoot=P0.hydrateRoot;var Bf={exports:{}};/*! mobile-drag-drop 3.0.0-rc.0 | Copyright (c) 2022 Tim Ruffles | MIT License */(function(e,t){(function(n,s){s(t)})(us,function(n){var s="dnd-poly-",l=["none","copy","copyLink","copyMove","link","linkMove","move","all"],f=["none","copy","move","link"];function m(){var Q=!1;try{var ne=Object.defineProperty({},"passive",{get:function(){Q=!0}});window.addEventListener("test",null,ne)}catch{}return Q}var v=m();function _(Q){return Q&&Q.tagName}function x(Q,ne,Z){document.addEventListener(Q,ne,!!v&&{passive:Z})}function E(Q,ne){document.removeEventListener(Q,ne)}function b(Q,ne,Z,ye){ye===void 0&&(ye=!1);var he=v?{passive:!0,capture:ye}:ye;return Q.addEventListener(ne,Z,he),{off:function(){Q.removeEventListener(ne,Z,he)}}}function M(Q){return Q.length===0?0:Q.reduce(function(ne,Z){return Z+ne},0)/Q.length}function F(Q,ne){for(var Z=0;Z<Q.changedTouches.length;Z++)if(Q.changedTouches[Z].identifier===ne)return!0;return!1}function z(Q,ne,Z){for(var ye=[],he=[],J=0;J<ne.touches.length;J++){var de=ne.touches[J];ye.push(de[Q+"X"]),he.push(de[Q+"Y"])}Z.x=M(ye),Z.y=M(he)}var U=["","-webkit-"];function re(Q,de,Z,ye,he){var J=de.x,de=de.y;ye&&(J+=ye.x,de+=ye.y),(he=he===void 0||he)&&(J-=parseInt(Q.offsetWidth,10)/2,de-=parseInt(Q.offsetHeight,10)/2);for(var ae="translate3d("+J+"px,"+de+"px, 0)",Ce=0;Ce<U.length;Ce++){var Ne=U[Ce]+"transform";Q.style[Ne]=ae+" "+Z[Ce]}}var H=(Object.defineProperty(D.prototype,"dropEffect",{get:function(){return this.t},set:function(Q){this.i.mode!==0&&-1<l.indexOf(Q)&&(this.t=Q)},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"types",{get:function(){if(this.i.mode!==0)return Object.freeze(this.i.types)},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"effectAllowed",{get:function(){return this.i.effectAllowed},set:function(Q){this.i.mode===2&&-1<l.indexOf(Q)&&(this.i.effectAllowed=Q)},enumerable:!1,configurable:!0}),D.prototype.setData=function(Q,ne){if(this.i.mode===2){if(-1<Q.indexOf(" "))throw new Error("illegal arg: type contains space");this.i.data[Q]=ne,this.i.types.indexOf(Q)===-1&&this.i.types.push(Q)}},D.prototype.getData=function(Q){if(this.i.mode===1||this.i.mode===2)return this.i.data[Q]||""},D.prototype.clearData=function(Q){this.i.mode===2&&(Q&&this.i.data[Q]?(delete this.i.data[Q],-1<(Q=this.i.types.indexOf(Q))&&this.i.types.splice(Q,1)):(this.i.data={},this.i.types=[]))},D.prototype.setDragImage=function(Q,ne,Z){this.i.mode===2&&this.h(Q,ne,Z)},D);function D(Q,ne){this.i=Q,this.h=ne,this.t=f[0]}function B(Q,ne){return Q?Q===l[0]?f[0]:Q.indexOf(l[1])===0||Q===l[7]?f[1]:Q.indexOf(l[4])===0?f[3]:Q===l[6]?f[2]:f[1]:ne.nodeType===3&&ne.tagName==="A"?f[3]:f[1]}function $(Q,ne,Z,ye,he,J,de){return de===void 0&&(de=null),he=function(ae,Ce,Ne,He,we,Le,ge){de===void 0&&(ge=null);var mt=Z.changedTouches[0],He=new Event(Q,{bubbles:!0,cancelable:He});return He.dataTransfer=Le,He.relatedTarget=ge,He.screenX=mt.screenX,He.screenY=mt.screenY,He.clientX=mt.clientX,He.clientY=mt.clientY,He.pageX=mt.pageX,He.pageY=mt.pageY,ae=ae.getBoundingClientRect(),He.offsetX=He.clientX-ae.left,He.offsetY=He.clientY-ae.top,He}(ne,0,0,J=J===void 0||J,document.defaultView,he,de),he=!ne.dispatchEvent(he),ye.mode=0,he}function fe(Q,ne){if(!Q||Q===l[7])return ne;if(ne===f[1]){if(Q.indexOf(f[1])===0)return f[1]}else if(ne===f[3]){if(Q.indexOf(f[3])===0||-1<Q.indexOf("Link"))return f[3]}else if(ne===f[2]&&(Q.indexOf(f[2])===0||-1<Q.indexOf("Move")))return f[2];return f[0]}var pe=(K.prototype.o=function(){var Q=this;this.u=1,this.l=f[0],this.v={data:{},effectAllowed:void 0,mode:3,types:[]},this.p={x:null,y:null},this.g={x:null,y:null};var ne=this.m;if(this.I=new H(this.v,function(J,de,ae){ne=J,typeof de!="number"&&typeof ae!="number"||(Q.j={x:de||0,y:ae||0})}),this.v.mode=2,this.I.dropEffect=f[0],$("dragstart",this.m,this.k,this.v,this.I))return this.u=3,this.C(),!1;z("page",this.k,this.g);var Z,ye,he=this.S.dragImageSetup(ne);return this.A=(Z=he,U.map(function(J){return J=Z.style[J+"transform"],J&&J!=="none"?J.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,""):""})),he.style.position="absolute",he.style.left="0px",he.style.top="0px",he.style.zIndex="999999",he.classList.add("dnd-poly-drag-image"),he.classList.add("dnd-poly-icon"),this.O=he,this.j||(this.S.dragImageOffset?this.j={x:this.S.dragImageOffset.x,y:this.S.dragImageOffset.y}:this.S.dragImageCenterOnTouch?(ye=getComputedStyle(ne),this.j={x:0-parseInt(ye.marginLeft,10),y:0-parseInt(ye.marginTop,10)}):(he=ne.getBoundingClientRect(),ye=getComputedStyle(ne),this.j={x:he.left-this.M.clientX-parseInt(ye.marginLeft,10)+he.width/2,y:he.top-this.M.clientY-parseInt(ye.marginTop,10)+he.height/2})),re(this.O,this.g,this.A,this.j,this.S.dragImageCenterOnTouch),document.body.appendChild(this.O),this.D=window.setInterval(function(){Q.F||(Q.F=!0,Q.N(),Q.F=!1)},this.S.iterationInterval),!0},K.prototype.C=function(){this.D&&(clearInterval(this.D),this.D=null),E("touchmove",this.P),E("touchend",this.T),E("touchcancel",this.T),this.O&&(this.O.parentNode.removeChild(this.O),this.O=null),this.L(this.S,this.k,this.u)},K.prototype._=function(Q){var ne=this;if(F(Q,this.M.identifier)!==!1){if(this.k=Q,this.u===0){var Z=void 0;if(this.S.dragStartConditionOverride)try{Z=this.S.dragStartConditionOverride(Q)}catch{Z=!1}else Z=Q.touches.length===1;return Z?void(this.o()===!0&&(this.H.preventDefault(),Q.preventDefault())):void this.C()}if(Q.preventDefault(),z("client",Q,this.p),z("page",Q,this.g),this.S.dragImageTranslateOverride)try{var ye=!1;if(this.S.dragImageTranslateOverride(Q,{x:this.p.x,y:this.p.y},this.V,function(he,J){ne.O&&(ye=!0,ne.p.x+=he,ne.p.y+=J,ne.g.x+=he,ne.g.y+=J,re(ne.O,ne.g,ne.A,ne.j,ne.S.dragImageCenterOnTouch))}),ye)return}catch{}re(this.O,this.g,this.A,this.j,this.S.dragImageCenterOnTouch)}},K.prototype.X=function(Q){if(F(Q,this.M.identifier)!==!1){if(this.S.dragImageTranslateOverride)try{this.S.dragImageTranslateOverride(void 0,void 0,void 0,function(){})}catch{}this.u!==0?(Q.preventDefault(),this.u=Q.type==="touchcancel"?3:2):this.C()}},K.prototype.N=function(){var Q=this,ne=this.l;this.v.mode=3,this.I.dropEffect=f[0];var Z,ye,he,J,de,ae=$("drag",this.m,this.k,this.v,this.I);if(ae&&(this.l=f[0]),ae||this.u===2||this.u===3)return this.Y(this.u)?(J=this.m,Z=this.O,ye=this.A,Ne=function(){Q.q()},void((de=getComputedStyle(J)).visibility!=="hidden"&&de.display!=="none"?(Z.classList.add("dnd-poly-snapback"),he=getComputedStyle(Z),ae=parseFloat(he.transitionDuration),isNaN(ae)||ae===0?Ne():((J={x:(Ce=J.getBoundingClientRect()).left,y:Ce.top}).x+=document.body.scrollLeft||document.documentElement.scrollLeft,J.y+=document.body.scrollTop||document.documentElement.scrollTop,J.x-=parseInt(de.marginLeft,10),J.y-=parseInt(de.marginTop,10),Ce=parseFloat(he.transitionDelay),Ce=Math.round(1e3*(ae+Ce)),re(Z,J,ye,void 0,!1),setTimeout(Ne,Ce))):Ne())):void this.q();var Ce=this.S.elementFromPoint(this.p.x,this.p.y),Ne=this.B;Ce!==this.V&&Ce!==this.B&&(this.V=Ce,this.B!==null&&(this.v.mode=3,this.I.dropEffect=f[0],$("dragexit",this.B,this.k,this.v,this.I,!1)),this.V===null?this.B=this.V:(this.v.mode=3,this.I.dropEffect=B(this.v.effectAllowed,this.m),$("dragenter",this.V,this.k,this.v,this.I)?(this.B=this.V,this.l=fe(this.I.effectAllowed,this.I.dropEffect)):this.V!==document.body&&(this.B=document.body))),Ne!==this.B&&_(Ne)&&(this.v.mode=3,this.I.dropEffect=f[0],$("dragleave",Ne,this.k,this.v,this.I,!1,this.B)),_(this.B)&&(this.v.mode=3,this.I.dropEffect=B(this.v.effectAllowed,this.m),$("dragover",this.B,this.k,this.v,this.I)===!1?this.l=f[0]:this.l=fe(this.I.effectAllowed,this.I.dropEffect)),ne!==this.l&&this.O.classList.remove(s+ne),ne=s+this.l,this.O.classList.add(ne)},K.prototype.Y=function(Q){return Q=this.l===f[0]||this.B===null||Q===3,Q?_(this.B)&&(this.v.mode=3,this.I.dropEffect=f[0],$("dragleave",this.B,this.k,this.v,this.I,!1)):_(this.B)&&(this.v.mode=1,this.I.dropEffect=this.l,$("drop",this.B,this.k,this.v,this.I)===!0?this.l=this.I.dropEffect:this.l=f[0]),Q},K.prototype.q=function(){this.v.mode=3,this.I.dropEffect=this.l,$("dragend",this.m,this.k,this.v,this.I,!1),this.u=2,this.C()},K);function K(Q,ne,Z,ye){this.H=Q,this.S=ne,this.m=Z,this.L=ye,this.u=0,this.V=null,this.B=null,this.k=Q,this.M=Q.changedTouches[0],this.P=this._.bind(this),this.T=this.X.bind(this),x("touchmove",this.P,!1),x("touchend",this.T,!1),x("touchcancel",this.T,!1)}var q,V={iterationInterval:150,tryFindDraggableTarget:function(Q){for(var ne=0,Z=Q.composedPath();ne<Z.length;ne++){var ye=Z[ne];do if(ye.draggable!==!1&&(ye.draggable===!0||ye.getAttribute&&ye.getAttribute("draggable")==="true"))return ye;while((ye=ye.parentNode)&&ye!==document.body)}},dragImageSetup:function(Q){var ne=Q.cloneNode(!0);return function Z(ye,he){if(ye.nodeType===1){for(var J,de,ae=getComputedStyle(ye),Ce=0;Ce<ae.length;Ce++){var Ne=ae[Ce];he.style.setProperty(Ne,ae.getPropertyValue(Ne),ae.getPropertyPriority(Ne))}he.style.pointerEvents="none",he.removeAttribute("id"),he.removeAttribute("class"),he.removeAttribute("draggable"),he.nodeName==="CANVAS"&&(J=he,de=(de=ye).getContext("2d").getImageData(0,0,de.width,de.height),J.getContext("2d").putImageData(de,0,0))}if(ye.hasChildNodes())for(Ce=0;Ce<ye.childNodes.length;Ce++)Z(ye.childNodes[Ce],he.childNodes[Ce]);(function Qe(we){if(we instanceof HTMLElement&&(we.style.pointerEvents="none"),we.children&&we.children.length)for(var Le=0;Le<we.children.length;Le++)Qe(we.children[Le]);if(we.shadowRoot&&we.shadowRoot.children.length)for(Le=0;Le<we.shadowRoot.children.length;Le++)Qe(we.shadowRoot.children[Le])})(he)}(Q,ne),ne},elementFromPoint:function(Q,ne){var Z=document.elementFromPoint(Q,ne);if(Z){for(;Z.shadowRoot;){var ye=Z.shadowRoot.elementFromPoint(Q,ne);if(ye===null||ye===Z)break;Z=ye}return Z}}};function le(Q){if(!q){var ne=V.tryFindDraggableTarget(Q);if(ne)try{q=new pe(Q,V,ne,ue)}catch(Z){throw ue(V,Q,3),Z}}}function ce(Q){function ne(Ce){he.off(),J.off(),de.off(),ae.off(),Z&&Z.dispatchEvent(new CustomEvent("dnd-poly-dragstart-cancel",{bubbles:!0,cancelable:!0})),clearTimeout(ye)}var Z=Q.target;Z&&Z.dispatchEvent(new CustomEvent("dnd-poly-dragstart-pending",{bubbles:!0,cancelable:!0}));var ye=window.setTimeout(function(){he.off(),J.off(),de.off(),ae.off(),le(Q)},V.holdToDrag),he=b(Z,"touchend",ne),J=b(Z,"touchcancel",ne),de=b(Z,"touchmove",ne),ae=b(window,"scroll",ne,!0)}function ue(Q,ne,Z){if(Z===0&&Q.defaultActionOverride)try{Q.defaultActionOverride(ne),ne.defaultPrevented}catch{}q=null}n.polyfill=function(Q){if(Q&&Object.keys(Q).forEach(function(Z){V[Z]=Q[Z]}),!V.forceApply&&(ne=(ne=!!window.chrome||/chrome/i.test(navigator.userAgent),{dragEvents:"ondragstart"in document.documentElement,draggable:"draggable"in document.documentElement,userAgentSupportingNativeDnD:!(/iPad|iPhone|iPod|Android/.test(navigator.userAgent)||ne&&"ontouchstart"in document.documentElement)}),ne.userAgentSupportingNativeDnD&&ne.draggable&&ne.dragEvents))return!1;var ne;return V.holdToDrag?x("touchstart",ce,!1):x("touchstart",le,!1),!0},n.supportsPassiveEventListener=m,Object.defineProperty(n,"G",{value:!0})})})(Bf,Bf.exports);var Xy=Bf.exports,Ff={exports:{}};(function(e,t){(function(n,s){s(t)})(us,function(n){function s(V){return V===document.body||V===document.documentElement}function l(V,le){var ce;if(s(V))ce=le===0?V.clientLeft:V.clientTop;else{var ue=V.getBoundingClientRect();ce=le===0?ue.left:ue.top}return ce}function f(V,le){var ce;return s(V)?ce=le===0?window.innerWidth:window.innerHeight:ce=le===0?V.clientWidth:V.clientHeight,ce}function m(V,le,ce){var ue=le===0?"scrollLeft":"scrollTop",Q=s(V);if(arguments.length===2)return Q?document.body[ue]||document.documentElement[ue]:V[ue];Q?(document.documentElement[ue]+=ce,document.body[ue]+=ce):V[ue]+=ce}function v(V){var le=getComputedStyle(V);return V.scrollHeight>V.clientHeight&&(le.overflowY==="scroll"||le.overflowY==="auto")||V.scrollWidth>V.clientWidth&&(le.overflowX==="scroll"||le.overflowX==="auto")}function _(V){do{if(!V)return;if(v(V))return V;if(V===document.documentElement)return null}while(V=V.parentNode);return null}function x(V,le,ce){return V<ce?-1:le-V<ce?1:0}function E(V,le,ce,ue){return V===-1?Math.abs(le-ue):V===1?Math.abs(ce-le-ue):0}function b(V,le,ce){var ue=V===0?ce.scrollX:ce.scrollY;if(le===1){var Q=V===0?ce.scrollWidth-ce.width:ce.scrollHeight-ce.height;return ue>=Q}else if(le===-1)return ue<=0;return!0}var M={threshold:75,velocityFn:function(V,le){var ce=V/le,ue=ce*ce*ce;return ue*le}},F={horizontal:0,vertical:0},z={x:0,y:0},U,re,H,D,B;function $(V,le,ce,ue){re=le,B=ue,H!==ce&&(H=ce,D=_(H));var Q=K(re,D,M.threshold,F,z);Q?fe():U&&(window.cancelAnimationFrame(U),U=null)}function fe(){U||(U=window.requestAnimationFrame(pe))}function pe(){var V=0,le=0,ce=s(D);F.horizontal!==0&&(V=Math.round(M.velocityFn(z.x,M.threshold)*F.horizontal),m(D,0,V)),F.vertical!==0&&(le=Math.round(M.velocityFn(z.y,M.threshold)*F.vertical),m(D,1,le)),ce?B(V,le):B(0,0),U=null,K(re,D,M.threshold,F,z)&&fe()}function K(V,le,ce,ue,Q){if(!V||!le)return!1;var ne={x:l(le,0),y:l(le,1),width:f(le,0),height:f(le,1),scrollX:m(le,0),scrollY:m(le,1),scrollWidth:le.scrollWidth,scrollHeight:le.scrollHeight},Z={x:V.x-ne.x,y:V.y-ne.y};return ue.horizontal=x(Z.x,ne.width,ce),ue.vertical=x(Z.y,ne.height,ce),ue.horizontal&&b(0,ue.horizontal,ne)?ue.horizontal=0:ue.horizontal&&(Q.x=E(ue.horizontal,Z.x,ne.width,ce)),ue.vertical&&b(1,ue.vertical,ne)?ue.vertical=0:ue.vertical&&(Q.y=E(ue.vertical,Z.y,ne.height,ce)),!!(ue.horizontal||ue.vertical)}var q=$;n.scrollBehaviourDragImageTranslateOverride=q,Object.defineProperty(n,"__esModule",{value:!0})})})(Ff,Ff.exports);var $y=Ff.exports;const Qy=""+new URL("compass-DjuYXV7z.png",import.meta.url).href,Ky=""+new URL("layer-tgRGCNyO.png",import.meta.url).href,qy=""+new URL("menu-CTekbRYg.png",import.meta.url).href,Jy=""+new URL("route-oCgy4FtE.png",import.meta.url).href,e_=""+new URL("settings-DL-iSASc.png",import.meta.url).href,t_=""+new URL("zoom-BsLudKLj.png",import.meta.url).href;function n_(e,t){const n=Y.useRef(t);Y.useEffect(function(){t!==n.current&&e.attributionControl!=null&&(n.current!=null&&e.attributionControl.removeAttribution(n.current),t!=null&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}const r_=1;function i_(e){return Object.freeze({__version:r_,map:e})}function Lg(e,t){return Object.freeze({...e,...t})}const Pg=Y.createContext(null),Dg=Pg.Provider;function Jc(){const e=Y.useContext(Pg);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function Bg(e){function t(n,s){const{instance:l,context:f}=e(n).current;return Y.useImperativeHandle(s,()=>l),n.children==null?null:Gt.createElement(Dg,{value:f},n.children)}return Y.forwardRef(t)}function Fg(e){function t(n,s){const{instance:l}=e(n).current;return Y.useImperativeHandle(s,()=>l),null}return Y.forwardRef(t)}function s_(e){return function(n){const s=Jc(),l=e(n,s),{instance:f}=l.current,m=Y.useRef(n.position),{position:v}=n;return Y.useEffect(function(){return f.addTo(s.map),function(){f.remove()}},[s.map,f]),Y.useEffect(function(){v!=null&&v!==m.current&&(f.setPosition(v),m.current=v)},[f,v]),l}}function jg(e,t){const n=Y.useRef();Y.useEffect(function(){return t!=null&&e.instance.on(t),n.current=t,function(){n.current!=null&&e.instance.off(n.current),n.current=null}},[e,t])}function ed(e,t){const n=e.pane??t.pane;return n?{...e,pane:n}:e}var jf={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,s){s(t)})(us,function(n){var s="1.9.4";function l(o){var h,g,C,A;for(g=1,C=arguments.length;g<C;g++){A=arguments[g];for(h in A)o[h]=A[h]}return o}var f=Object.create||function(){function o(){}return function(h){return o.prototype=h,new o}}();function m(o,h){var g=Array.prototype.slice;if(o.bind)return o.bind.apply(o,g.call(arguments,1));var C=g.call(arguments,2);return function(){return o.apply(h,C.length?C.concat(g.call(arguments)):arguments)}}var v=0;function _(o){return"_leaflet_id"in o||(o._leaflet_id=++v),o._leaflet_id}function x(o,h,g){var C,A,O,W;return W=function(){C=!1,A&&(O.apply(g,A),A=!1)},O=function(){C?A=arguments:(o.apply(g,arguments),setTimeout(W,h),C=!0)},O}function E(o,h,g){var C=h[1],A=h[0],O=C-A;return o===C&&g?o:((o-A)%O+O)%O+A}function b(){return!1}function M(o,h){if(h===!1)return o;var g=Math.pow(10,h===void 0?6:h);return Math.round(o*g)/g}function F(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}function z(o){return F(o).split(/\s+/)}function U(o,h){Object.prototype.hasOwnProperty.call(o,"options")||(o.options=o.options?f(o.options):{});for(var g in h)o.options[g]=h[g];return o.options}function re(o,h,g){var C=[];for(var A in o)C.push(encodeURIComponent(g?A.toUpperCase():A)+"="+encodeURIComponent(o[A]));return(!h||h.indexOf("?")===-1?"?":"&")+C.join("&")}var H=/\{ *([\w_ -]+) *\}/g;function D(o,h){return o.replace(H,function(g,C){var A=h[C];if(A===void 0)throw new Error("No value provided for variable "+g);return typeof A=="function"&&(A=A(h)),A})}var B=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"};function $(o,h){for(var g=0;g<o.length;g++)if(o[g]===h)return g;return-1}var fe="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function pe(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}var K=0;function q(o){var h=+new Date,g=Math.max(0,16-(h-K));return K=h+g,window.setTimeout(o,g)}var V=window.requestAnimationFrame||pe("RequestAnimationFrame")||q,le=window.cancelAnimationFrame||pe("CancelAnimationFrame")||pe("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)};function ce(o,h,g){if(g&&V===q)o.call(h);else return V.call(window,m(o,h))}function ue(o){o&&le.call(window,o)}var Q={__proto__:null,extend:l,create:f,bind:m,get lastId(){return v},stamp:_,throttle:x,wrapNum:E,falseFn:b,formatNum:M,trim:F,splitWords:z,setOptions:U,getParamString:re,template:D,isArray:B,indexOf:$,emptyImageUrl:fe,requestFn:V,cancelFn:le,requestAnimFrame:ce,cancelAnimFrame:ue};function ne(){}ne.extend=function(o){var h=function(){U(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},g=h.__super__=this.prototype,C=f(g);C.constructor=h,h.prototype=C;for(var A in this)Object.prototype.hasOwnProperty.call(this,A)&&A!=="prototype"&&A!=="__super__"&&(h[A]=this[A]);return o.statics&&l(h,o.statics),o.includes&&(Z(o.includes),l.apply(null,[C].concat(o.includes))),l(C,o),delete C.statics,delete C.includes,C.options&&(C.options=g.options?f(g.options):{},l(C.options,o.options)),C._initHooks=[],C.callInitHooks=function(){if(!this._initHooksCalled){g.callInitHooks&&g.callInitHooks.call(this),this._initHooksCalled=!0;for(var O=0,W=C._initHooks.length;O<W;O++)C._initHooks[O].call(this)}},h},ne.include=function(o){var h=this.prototype.options;return l(this.prototype,o),o.options&&(this.prototype.options=h,this.mergeOptions(o.options)),this},ne.mergeOptions=function(o){return l(this.prototype.options,o),this},ne.addInitHook=function(o){var h=Array.prototype.slice.call(arguments,1),g=typeof o=="function"?o:function(){this[o].apply(this,h)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(g),this};function Z(o){if(!(typeof L>"u"||!L||!L.Mixin)){o=B(o)?o:[o];for(var h=0;h<o.length;h++)o[h]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ye={on:function(o,h,g){if(typeof o=="object")for(var C in o)this._on(C,o[C],h);else{o=z(o);for(var A=0,O=o.length;A<O;A++)this._on(o[A],h,g)}return this},off:function(o,h,g){if(!arguments.length)delete this._events;else if(typeof o=="object")for(var C in o)this._off(C,o[C],h);else{o=z(o);for(var A=arguments.length===1,O=0,W=o.length;O<W;O++)A?this._off(o[O]):this._off(o[O],h,g)}return this},_on:function(o,h,g,C){if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}if(this._listens(o,h,g)===!1){g===this&&(g=void 0);var A={fn:h,ctx:g};C&&(A.once=!0),this._events=this._events||{},this._events[o]=this._events[o]||[],this._events[o].push(A)}},_off:function(o,h,g){var C,A,O;if(this._events&&(C=this._events[o],!!C)){if(arguments.length===1){if(this._firingCount)for(A=0,O=C.length;A<O;A++)C[A].fn=b;delete this._events[o];return}if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}var W=this._listens(o,h,g);if(W!==!1){var te=C[W];this._firingCount&&(te.fn=b,this._events[o]=C=C.slice()),C.splice(W,1)}}},fire:function(o,h,g){if(!this.listens(o,g))return this;var C=l({},h,{type:o,target:this,sourceTarget:h&&h.sourceTarget||this});if(this._events){var A=this._events[o];if(A){this._firingCount=this._firingCount+1||1;for(var O=0,W=A.length;O<W;O++){var te=A[O],oe=te.fn;te.once&&this.off(o,oe,te.ctx),oe.call(te.ctx||this,C)}this._firingCount--}}return g&&this._propagateEvent(C),this},listens:function(o,h,g,C){typeof o!="string"&&console.warn('"string" type argument expected');var A=h;typeof h!="function"&&(C=!!h,A=void 0,g=void 0);var O=this._events&&this._events[o];if(O&&O.length&&this._listens(o,A,g)!==!1)return!0;if(C){for(var W in this._eventParents)if(this._eventParents[W].listens(o,h,g,C))return!0}return!1},_listens:function(o,h,g){if(!this._events)return!1;var C=this._events[o]||[];if(!h)return!!C.length;g===this&&(g=void 0);for(var A=0,O=C.length;A<O;A++)if(C[A].fn===h&&C[A].ctx===g)return A;return!1},once:function(o,h,g){if(typeof o=="object")for(var C in o)this._on(C,o[C],h,!0);else{o=z(o);for(var A=0,O=o.length;A<O;A++)this._on(o[A],h,g,!0)}return this},addEventParent:function(o){return this._eventParents=this._eventParents||{},this._eventParents[_(o)]=o,this},removeEventParent:function(o){return this._eventParents&&delete this._eventParents[_(o)],this},_propagateEvent:function(o){for(var h in this._eventParents)this._eventParents[h].fire(o.type,l({layer:o.target,propagatedFrom:o.target},o),!0)}};ye.addEventListener=ye.on,ye.removeEventListener=ye.clearAllEventListeners=ye.off,ye.addOneTimeEventListener=ye.once,ye.fireEvent=ye.fire,ye.hasEventListeners=ye.listens;var he=ne.extend(ye);function J(o,h,g){this.x=g?Math.round(o):o,this.y=g?Math.round(h):h}var de=Math.trunc||function(o){return o>0?Math.floor(o):Math.ceil(o)};J.prototype={clone:function(){return new J(this.x,this.y)},add:function(o){return this.clone()._add(ae(o))},_add:function(o){return this.x+=o.x,this.y+=o.y,this},subtract:function(o){return this.clone()._subtract(ae(o))},_subtract:function(o){return this.x-=o.x,this.y-=o.y,this},divideBy:function(o){return this.clone()._divideBy(o)},_divideBy:function(o){return this.x/=o,this.y/=o,this},multiplyBy:function(o){return this.clone()._multiplyBy(o)},_multiplyBy:function(o){return this.x*=o,this.y*=o,this},scaleBy:function(o){return new J(this.x*o.x,this.y*o.y)},unscaleBy:function(o){return new J(this.x/o.x,this.y/o.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=de(this.x),this.y=de(this.y),this},distanceTo:function(o){o=ae(o);var h=o.x-this.x,g=o.y-this.y;return Math.sqrt(h*h+g*g)},equals:function(o){return o=ae(o),o.x===this.x&&o.y===this.y},contains:function(o){return o=ae(o),Math.abs(o.x)<=Math.abs(this.x)&&Math.abs(o.y)<=Math.abs(this.y)},toString:function(){return"Point("+M(this.x)+", "+M(this.y)+")"}};function ae(o,h,g){return o instanceof J?o:B(o)?new J(o[0],o[1]):o==null?o:typeof o=="object"&&"x"in o&&"y"in o?new J(o.x,o.y):new J(o,h,g)}function Ce(o,h){if(o)for(var g=h?[o,h]:o,C=0,A=g.length;C<A;C++)this.extend(g[C])}Ce.prototype={extend:function(o){var h,g;if(!o)return this;if(o instanceof J||typeof o[0]=="number"||"x"in o)h=g=ae(o);else if(o=Ne(o),h=o.min,g=o.max,!h||!g)return this;return!this.min&&!this.max?(this.min=h.clone(),this.max=g.clone()):(this.min.x=Math.min(h.x,this.min.x),this.max.x=Math.max(g.x,this.max.x),this.min.y=Math.min(h.y,this.min.y),this.max.y=Math.max(g.y,this.max.y)),this},getCenter:function(o){return ae((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,o)},getBottomLeft:function(){return ae(this.min.x,this.max.y)},getTopRight:function(){return ae(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(o){var h,g;return typeof o[0]=="number"||o instanceof J?o=ae(o):o=Ne(o),o instanceof Ce?(h=o.min,g=o.max):h=g=o,h.x>=this.min.x&&g.x<=this.max.x&&h.y>=this.min.y&&g.y<=this.max.y},intersects:function(o){o=Ne(o);var h=this.min,g=this.max,C=o.min,A=o.max,O=A.x>=h.x&&C.x<=g.x,W=A.y>=h.y&&C.y<=g.y;return O&&W},overlaps:function(o){o=Ne(o);var h=this.min,g=this.max,C=o.min,A=o.max,O=A.x>h.x&&C.x<g.x,W=A.y>h.y&&C.y<g.y;return O&&W},isValid:function(){return!!(this.min&&this.max)},pad:function(o){var h=this.min,g=this.max,C=Math.abs(h.x-g.x)*o,A=Math.abs(h.y-g.y)*o;return Ne(ae(h.x-C,h.y-A),ae(g.x+C,g.y+A))},equals:function(o){return o?(o=Ne(o),this.min.equals(o.getTopLeft())&&this.max.equals(o.getBottomRight())):!1}};function Ne(o,h){return!o||o instanceof Ce?o:new Ce(o,h)}function Qe(o,h){if(o)for(var g=h?[o,h]:o,C=0,A=g.length;C<A;C++)this.extend(g[C])}Qe.prototype={extend:function(o){var h=this._southWest,g=this._northEast,C,A;if(o instanceof Le)C=o,A=o;else if(o instanceof Qe){if(C=o._southWest,A=o._northEast,!C||!A)return this}else return o?this.extend(ge(o)||we(o)):this;return!h&&!g?(this._southWest=new Le(C.lat,C.lng),this._northEast=new Le(A.lat,A.lng)):(h.lat=Math.min(C.lat,h.lat),h.lng=Math.min(C.lng,h.lng),g.lat=Math.max(A.lat,g.lat),g.lng=Math.max(A.lng,g.lng)),this},pad:function(o){var h=this._southWest,g=this._northEast,C=Math.abs(h.lat-g.lat)*o,A=Math.abs(h.lng-g.lng)*o;return new Qe(new Le(h.lat-C,h.lng-A),new Le(g.lat+C,g.lng+A))},getCenter:function(){return new Le((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Le(this.getNorth(),this.getWest())},getSouthEast:function(){return new Le(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(o){typeof o[0]=="number"||o instanceof Le||"lat"in o?o=ge(o):o=we(o);var h=this._southWest,g=this._northEast,C,A;return o instanceof Qe?(C=o.getSouthWest(),A=o.getNorthEast()):C=A=o,C.lat>=h.lat&&A.lat<=g.lat&&C.lng>=h.lng&&A.lng<=g.lng},intersects:function(o){o=we(o);var h=this._southWest,g=this._northEast,C=o.getSouthWest(),A=o.getNorthEast(),O=A.lat>=h.lat&&C.lat<=g.lat,W=A.lng>=h.lng&&C.lng<=g.lng;return O&&W},overlaps:function(o){o=we(o);var h=this._southWest,g=this._northEast,C=o.getSouthWest(),A=o.getNorthEast(),O=A.lat>h.lat&&C.lat<g.lat,W=A.lng>h.lng&&C.lng<g.lng;return O&&W},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(o,h){return o?(o=we(o),this._southWest.equals(o.getSouthWest(),h)&&this._northEast.equals(o.getNorthEast(),h)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function we(o,h){return o instanceof Qe?o:new Qe(o,h)}function Le(o,h,g){if(isNaN(o)||isNaN(h))throw new Error("Invalid LatLng object: ("+o+", "+h+")");this.lat=+o,this.lng=+h,g!==void 0&&(this.alt=+g)}Le.prototype={equals:function(o,h){if(!o)return!1;o=ge(o);var g=Math.max(Math.abs(this.lat-o.lat),Math.abs(this.lng-o.lng));return g<=(h===void 0?1e-9:h)},toString:function(o){return"LatLng("+M(this.lat,o)+", "+M(this.lng,o)+")"},distanceTo:function(o){return He.distance(this,ge(o))},wrap:function(){return He.wrapLatLng(this)},toBounds:function(o){var h=180*o/40075017,g=h/Math.cos(Math.PI/180*this.lat);return we([this.lat-h,this.lng-g],[this.lat+h,this.lng+g])},clone:function(){return new Le(this.lat,this.lng,this.alt)}};function ge(o,h,g){return o instanceof Le?o:B(o)&&typeof o[0]!="object"?o.length===3?new Le(o[0],o[1],o[2]):o.length===2?new Le(o[0],o[1]):null:o==null?o:typeof o=="object"&&"lat"in o?new Le(o.lat,"lng"in o?o.lng:o.lon,o.alt):h===void 0?null:new Le(o,h,g)}var mt={latLngToPoint:function(o,h){var g=this.projection.project(o),C=this.scale(h);return this.transformation._transform(g,C)},pointToLatLng:function(o,h){var g=this.scale(h),C=this.transformation.untransform(o,g);return this.projection.unproject(C)},project:function(o){return this.projection.project(o)},unproject:function(o){return this.projection.unproject(o)},scale:function(o){return 256*Math.pow(2,o)},zoom:function(o){return Math.log(o/256)/Math.LN2},getProjectedBounds:function(o){if(this.infinite)return null;var h=this.projection.bounds,g=this.scale(o),C=this.transformation.transform(h.min,g),A=this.transformation.transform(h.max,g);return new Ce(C,A)},infinite:!1,wrapLatLng:function(o){var h=this.wrapLng?E(o.lng,this.wrapLng,!0):o.lng,g=this.wrapLat?E(o.lat,this.wrapLat,!0):o.lat,C=o.alt;return new Le(g,h,C)},wrapLatLngBounds:function(o){var h=o.getCenter(),g=this.wrapLatLng(h),C=h.lat-g.lat,A=h.lng-g.lng;if(C===0&&A===0)return o;var O=o.getSouthWest(),W=o.getNorthEast(),te=new Le(O.lat-C,O.lng-A),oe=new Le(W.lat-C,W.lng-A);return new Qe(te,oe)}},He=l({},mt,{wrapLng:[-180,180],R:6371e3,distance:function(o,h){var g=Math.PI/180,C=o.lat*g,A=h.lat*g,O=Math.sin((h.lat-o.lat)*g/2),W=Math.sin((h.lng-o.lng)*g/2),te=O*O+Math.cos(C)*Math.cos(A)*W*W,oe=2*Math.atan2(Math.sqrt(te),Math.sqrt(1-te));return this.R*oe}}),Bn=6378137,Fn={R:Bn,MAX_LATITUDE:85.0511287798,project:function(o){var h=Math.PI/180,g=this.MAX_LATITUDE,C=Math.max(Math.min(g,o.lat),-g),A=Math.sin(C*h);return new J(this.R*o.lng*h,this.R*Math.log((1+A)/(1-A))/2)},unproject:function(o){var h=180/Math.PI;return new Le((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*h,o.x*h/this.R)},bounds:function(){var o=Bn*Math.PI;return new Ce([-o,-o],[o,o])}()};function Ot(o,h,g,C){if(B(o)){this._a=o[0],this._b=o[1],this._c=o[2],this._d=o[3];return}this._a=o,this._b=h,this._c=g,this._d=C}Ot.prototype={transform:function(o,h){return this._transform(o.clone(),h)},_transform:function(o,h){return h=h||1,o.x=h*(this._a*o.x+this._b),o.y=h*(this._c*o.y+this._d),o},untransform:function(o,h){return h=h||1,new J((o.x/h-this._b)/this._a,(o.y/h-this._d)/this._c)}};function yt(o,h,g,C){return new Ot(o,h,g,C)}var $e=l({},He,{code:"EPSG:3857",projection:Fn,transformation:function(){var o=.5/(Math.PI*Fn.R);return yt(o,.5,-o,.5)}()}),Sn=l({},$e,{code:"EPSG:900913"});function Xt(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function Rn(o,h){var g="",C,A,O,W,te,oe;for(C=0,O=o.length;C<O;C++){for(te=o[C],A=0,W=te.length;A<W;A++)oe=te[A],g+=(A?"L":"M")+oe.x+" "+oe.y;g+=h?Be.svg?"z":"x":""}return g||"M0 0"}var Oe=document.documentElement.style,We="ActiveXObject"in window,Xe=We&&!document.addEventListener,$t="msLaunchUri"in navigator&&!("documentMode"in document),Te=Nt("webkit"),Lt=Nt("android"),ki=Nt("android 2")||Nt("android 3"),hn=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Oi=Lt&&Nt("Google")&&hn<537&&!("AudioNode"in window),Ct=!!window.opera,gi=!$t&&Nt("chrome"),Qn=Nt("gecko")&&!Te&&!Ct&&!We,Pt=!gi&&Nt("safari"),Kn=Nt("phantom"),An="OTransition"in Oe,jn=navigator.platform.indexOf("Win")===0,wt=We&&"transition"in Oe,Ae="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ki,Ie="MozPerspective"in Oe,Me=!window.L_DISABLE_3D&&(wt||Ae||Ie)&&!An&&!Kn,Ve=typeof orientation<"u"||Nt("mobile"),It=Ve&&Te,Dt=Ve&&Ae,Ge=!window.PointerEvent&&window.MSPointerEvent,ft=!!(window.PointerEvent||Ge),Dr="ontouchstart"in window||!!window.TouchEvent,io=!window.L_NO_TOUCH&&(Dr||ft),_n=Ve&&Ct,qn=Ve&&Qn,Rs=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Qt=function(){var o=!1;try{var h=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("testPassiveEventSupport",b,h),window.removeEventListener("testPassiveEventSupport",b,h)}catch{}return o}(),mi=function(){return!!document.createElement("canvas").getContext}(),vr=!!(document.createElementNS&&Xt("svg").createSVGRect),jt=!!vr&&function(){var o=document.createElement("div");return o.innerHTML="<svg/>",(o.firstChild&&o.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Li=!vr&&function(){try{var o=document.createElement("div");o.innerHTML='<v:shape adj="1"/>';var h=o.firstChild;return h.style.behavior="url(#default#VML)",h&&typeof h.adj=="object"}catch{return!1}}(),Br=navigator.platform.indexOf("Mac")===0,xi=navigator.platform.indexOf("Linux")===0;function Nt(o){return navigator.userAgent.toLowerCase().indexOf(o)>=0}var Be={ie:We,ielt9:Xe,edge:$t,webkit:Te,android:Lt,android23:ki,androidStock:Oi,opera:Ct,chrome:gi,gecko:Qn,safari:Pt,phantom:Kn,opera12:An,win:jn,ie3d:wt,webkit3d:Ae,gecko3d:Ie,any3d:Me,mobile:Ve,mobileWebkit:It,mobileWebkit3d:Dt,msPointer:Ge,pointer:ft,touch:io,touchNative:Dr,mobileOpera:_n,mobileGecko:qn,retina:Rs,passiveEvents:Qt,canvas:mi,svg:vr,vml:Li,inlineSvg:jt,mac:Br,linux:xi},dn=Be.msPointer?"MSPointerDown":"pointerdown",ke=Be.msPointer?"MSPointerMove":"pointermove",qr=Be.msPointer?"MSPointerUp":"pointerup",yi=Be.msPointer?"MSPointerCancel":"pointercancel",pn={touchstart:dn,touchmove:ke,touchend:qr,touchcancel:yi},Jr={touchstart:Fr,touchmove:Pi,touchend:Pi,touchcancel:Pi},kn={},ei=!1;function Jn(o,h,g){return h==="touchstart"&&Mt(),Jr[h]?(g=Jr[h].bind(this,g),o.addEventListener(pn[h],g,!1),g):(console.warn("wrong event specified:",h),b)}function sn(o,h,g){if(!pn[h]){console.warn("wrong event specified:",h);return}o.removeEventListener(pn[h],g,!1)}function Qo(o){kn[o.pointerId]=o}function er(o){kn[o.pointerId]&&(kn[o.pointerId]=o)}function on(o){delete kn[o.pointerId]}function Mt(){ei||(document.addEventListener(dn,Qo,!0),document.addEventListener(ke,er,!0),document.addEventListener(qr,on,!0),document.addEventListener(yi,on,!0),ei=!0)}function Pi(o,h){if(h.pointerType!==(h.MSPOINTER_TYPE_MOUSE||"mouse")){h.touches=[];for(var g in kn)h.touches.push(kn[g]);h.changedTouches=[h],o(h)}}function Fr(o,h){h.MSPOINTER_TYPE_TOUCH&&h.pointerType===h.MSPOINTER_TYPE_TOUCH&&vn(h),Pi(o,h)}function ks(o){var h={},g,C;for(C in o)g=o[C],h[C]=g&&g.bind?g.bind(o):g;return o=h,h.type="dblclick",h.detail=2,h.isTrusted=!1,h._simulated=!0,h}var xe=200;function Ko(o,h){o.addEventListener("dblclick",h);var g=0,C;function A(O){if(O.detail!==1){C=O.detail;return}if(!(O.pointerType==="mouse"||O.sourceCapabilities&&!O.sourceCapabilities.firesTouchEvents)){var W=qi(O);if(!(W.some(function(oe){return oe instanceof HTMLLabelElement&&oe.attributes.for})&&!W.some(function(oe){return oe instanceof HTMLInputElement||oe instanceof HTMLSelectElement}))){var te=Date.now();te-g<=xe?(C++,C===2&&h(ks(O))):C=1,g=te}}}return o.addEventListener("click",A),{dblclick:h,simDblclick:A}}function Bt(o,h){o.removeEventListener("dblclick",h.dblclick),o.removeEventListener("click",h.simDblclick)}var jr=P(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),_i=P(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),pt=_i==="webkitTransition"||_i==="OTransition"?_i+"End":"transitionend";function at(o){return typeof o=="string"?document.getElementById(o):o}function qe(o,h){var g=o.style[h]||o.currentStyle&&o.currentStyle[h];if((!g||g==="auto")&&document.defaultView){var C=document.defaultView.getComputedStyle(o,null);g=C?C[h]:null}return g==="auto"?null:g}function st(o,h,g){var C=document.createElement(o);return C.className=h||"",g&&g.appendChild(C),C}function bt(o){var h=o.parentNode;h&&h.removeChild(o)}function vi(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function Rt(o){var h=o.parentNode;h&&h.lastChild!==o&&h.appendChild(o)}function On(o){var h=o.parentNode;h&&h.firstChild!==o&&h.insertBefore(o,h.firstChild)}function Os(o,h){if(o.classList!==void 0)return o.classList.contains(h);var g=tr(o);return g.length>0&&new RegExp("(^|\\s)"+h+"(\\s|$)").test(g)}function ze(o,h){if(o.classList!==void 0)for(var g=z(h),C=0,A=g.length;C<A;C++)o.classList.add(g[C]);else if(!Os(o,h)){var O=tr(o);Ls(o,(O?O+" ":"")+h)}}function _t(o,h){o.classList!==void 0?o.classList.remove(h):Ls(o,F((" "+tr(o)+" ").replace(" "+h+" "," ")))}function Ls(o,h){o.className.baseVal===void 0?o.className=h:o.className.baseVal=h}function tr(o){return o.correspondingElement&&(o=o.correspondingElement),o.className.baseVal===void 0?o.className:o.className.baseVal}function nt(o,h){"opacity"in o.style?o.style.opacity=h:"filter"in o.style&&an(o,h)}function an(o,h){var g=!1,C="DXImageTransform.Microsoft.Alpha";try{g=o.filters.item(C)}catch{if(h===1)return}h=Math.round(h*100),g?(g.Enabled=h!==100,g.Opacity=h):o.style.filter+=" progid:"+C+"(opacity="+h+")"}function P(o){for(var h=document.documentElement.style,g=0;g<o.length;g++)if(o[g]in h)return o[g];return!1}function R(o,h,g){var C=h||new J(0,0);o.style[jr]=(Be.ie3d?"translate("+C.x+"px,"+C.y+"px)":"translate3d("+C.x+"px,"+C.y+"px,0)")+(g?" scale("+g+")":"")}function me(o,h){o._leaflet_pos=h,Be.any3d?R(o,h):(o.style.left=h.x+"px",o.style.top=h.y+"px")}function rt(o){return o._leaflet_pos||new J(0,0)}var zt,wi,ti;if("onselectstart"in document)zt=function(){Ye(window,"selectstart",vn)},wi=function(){Re(window,"selectstart",vn)};else{var ln=P(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);zt=function(){if(ln){var o=document.documentElement.style;ti=o[ln],o[ln]="none"}},wi=function(){ln&&(document.documentElement.style[ln]=ti,ti=void 0)}}function Pe(){Ye(window,"dragstart",vn)}function ht(){Re(window,"dragstart",vn)}var Tn,wr;function Cr(o){for(;o.tabIndex===-1;)o=o.parentNode;o.style&&(Er(),Tn=o,wr=o.style.outlineStyle,o.style.outlineStyle="none",Ye(window,"keydown",Er))}function Er(){Tn&&(Tn.style.outlineStyle=wr,Tn=void 0,wr=void 0,Re(window,"keydown",Er))}function fr(o){do o=o.parentNode;while((!o.offsetWidth||!o.offsetHeight)&&o!==document.body);return o}function ni(o){var h=o.getBoundingClientRect();return{x:h.width/o.offsetWidth||1,y:h.height/o.offsetHeight||1,boundingClientRect:h}}var dt={__proto__:null,TRANSFORM:jr,TRANSITION:_i,TRANSITION_END:pt,get:at,getStyle:qe,create:st,remove:bt,empty:vi,toFront:Rt,toBack:On,hasClass:Os,addClass:ze,removeClass:_t,setClass:Ls,getClass:tr,setOpacity:nt,testProp:P,setTransform:R,setPosition:me,getPosition:rt,get disableTextSelection(){return zt},get enableTextSelection(){return wi},disableImageDrag:Pe,enableImageDrag:ht,preventOutline:Cr,restoreOutline:Er,getSizedParentNode:fr,getScale:ni};function Ye(o,h,g,C){if(h&&typeof h=="object")for(var A in h)un(o,A,h[A],g);else{h=z(h);for(var O=0,W=h.length;O<W;O++)un(o,h[O],g,C)}return this}var cn="_leaflet_events";function Re(o,h,g,C){if(arguments.length===1)hl(o),delete o[cn];else if(h&&typeof h=="object")for(var A in h)qo(o,A,h[A],g);else if(h=z(h),arguments.length===2)hl(o,function(te){return $(h,te)!==-1});else for(var O=0,W=h.length;O<W;O++)qo(o,h[O],g,C);return this}function hl(o,h){for(var g in o[cn]){var C=g.split(/\d/)[0];(!h||h(C))&&qo(o,C,null,null,g)}}var Je={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function un(o,h,g,C){var A=h+_(g)+(C?"_"+_(C):"");if(o[cn]&&o[cn][A])return this;var O=function(te){return g.call(C||o,te||window.event)},W=O;!Be.touchNative&&Be.pointer&&h.indexOf("touch")===0?O=Jn(o,h,O):Be.touch&&h==="dblclick"?O=Ko(o,O):"addEventListener"in o?h==="touchstart"||h==="touchmove"||h==="wheel"||h==="mousewheel"?o.addEventListener(Je[h]||h,O,Be.passiveEvents?{passive:!1}:!1):h==="mouseenter"||h==="mouseleave"?(O=function(te){te=te||window.event,Di(o,te)&&W(te)},o.addEventListener(Je[h],O,!1)):o.addEventListener(h,W,!1):o.attachEvent("on"+h,O),o[cn]=o[cn]||{},o[cn][A]=O}function qo(o,h,g,C,A){A=A||h+_(g)+(C?"_"+_(C):"");var O=o[cn]&&o[cn][A];if(!O)return this;!Be.touchNative&&Be.pointer&&h.indexOf("touch")===0?sn(o,h,O):Be.touch&&h==="dblclick"?Bt(o,O):"removeEventListener"in o?o.removeEventListener(Je[h]||h,O,!1):o.detachEvent("on"+h,O),o[cn][A]=null}function ri(o){return o.stopPropagation?o.stopPropagation():o.originalEvent?o.originalEvent._stopped=!0:o.cancelBubble=!0,this}function so(o){return un(o,"wheel",ri),this}function br(o){return Ye(o,"mousedown touchstart dblclick contextmenu",ri),o._leaflet_disable_click=!0,this}function vn(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function Sr(o){return vn(o),ri(o),this}function qi(o){if(o.composedPath)return o.composedPath();for(var h=[],g=o.target;g;)h.push(g),g=g.parentNode;return h}function Ji(o,h){if(!h)return new J(o.clientX,o.clientY);var g=ni(h),C=g.boundingClientRect;return new J((o.clientX-C.left)/g.x-h.clientLeft,(o.clientY-C.top)/g.y-h.clientTop)}var dl=Be.linux&&Be.chrome?window.devicePixelRatio:Be.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function es(o){return Be.edge?o.wheelDeltaY/2:o.deltaY&&o.deltaMode===0?-o.deltaY/dl:o.deltaY&&o.deltaMode===1?-o.deltaY*20:o.deltaY&&o.deltaMode===2?-o.deltaY*60:o.deltaX||o.deltaZ?0:o.wheelDelta?(o.wheelDeltaY||o.wheelDelta)/2:o.detail&&Math.abs(o.detail)<32765?-o.detail*20:o.detail?o.detail/-32765*60:0}function Di(o,h){var g=h.relatedTarget;if(!g)return!0;try{for(;g&&g!==o;)g=g.parentNode}catch{return!1}return g!==o}var zn={__proto__:null,on:Ye,off:Re,stopPropagation:ri,disableScrollPropagation:so,disableClickPropagation:br,preventDefault:vn,stop:Sr,getPropagationPath:qi,getMousePosition:Ji,getWheelDelta:es,isExternalTarget:Di,addListener:Ye,removeListener:Re},Jo=he.extend({run:function(o,h,g,C){this.stop(),this._el=o,this._inProgress=!0,this._duration=g||.25,this._easeOutPower=1/Math.max(C||.5,.2),this._startPos=rt(o),this._offset=h.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ce(this._animate,this),this._step()},_step:function(o){var h=+new Date-this._startTime,g=this._duration*1e3;h<g?this._runFrame(this._easeOut(h/g),o):(this._runFrame(1),this._complete())},_runFrame:function(o,h){var g=this._startPos.add(this._offset.multiplyBy(o));h&&g._round(),me(this._el,g),this.fire("step")},_complete:function(){ue(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(o){return 1-Math.pow(1-o,this._easeOutPower)}}),lt=he.extend({options:{crs:$e,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(o,h){h=U(this,h),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(o),this._initLayout(),this._onResize=m(this._onResize,this),this._initEvents(),h.maxBounds&&this.setMaxBounds(h.maxBounds),h.zoom!==void 0&&(this._zoom=this._limitZoom(h.zoom)),h.center&&h.zoom!==void 0&&this.setView(ge(h.center),h.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=_i&&Be.any3d&&!Be.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ye(this._proxy,pt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(o,h,g){if(h=h===void 0?this._zoom:this._limitZoom(h),o=this._limitCenter(ge(o),h,this.options.maxBounds),g=g||{},this._stop(),this._loaded&&!g.reset&&g!==!0){g.animate!==void 0&&(g.zoom=l({animate:g.animate},g.zoom),g.pan=l({animate:g.animate,duration:g.duration},g.pan));var C=this._zoom!==h?this._tryAnimatedZoom&&this._tryAnimatedZoom(o,h,g.zoom):this._tryAnimatedPan(o,g.pan);if(C)return clearTimeout(this._sizeTimer),this}return this._resetView(o,h,g.pan&&g.pan.noMoveStart),this},setZoom:function(o,h){return this._loaded?this.setView(this.getCenter(),o,{zoom:h}):(this._zoom=o,this)},zoomIn:function(o,h){return o=o||(Be.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+o,h)},zoomOut:function(o,h){return o=o||(Be.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-o,h)},setZoomAround:function(o,h,g){var C=this.getZoomScale(h),A=this.getSize().divideBy(2),O=o instanceof J?o:this.latLngToContainerPoint(o),W=O.subtract(A).multiplyBy(1-1/C),te=this.containerPointToLatLng(A.add(W));return this.setView(te,h,{zoom:g})},_getBoundsCenterZoom:function(o,h){h=h||{},o=o.getBounds?o.getBounds():we(o);var g=ae(h.paddingTopLeft||h.padding||[0,0]),C=ae(h.paddingBottomRight||h.padding||[0,0]),A=this.getBoundsZoom(o,!1,g.add(C));if(A=typeof h.maxZoom=="number"?Math.min(h.maxZoom,A):A,A===1/0)return{center:o.getCenter(),zoom:A};var O=C.subtract(g).divideBy(2),W=this.project(o.getSouthWest(),A),te=this.project(o.getNorthEast(),A),oe=this.unproject(W.add(te).divideBy(2).add(O),A);return{center:oe,zoom:A}},fitBounds:function(o,h){if(o=we(o),!o.isValid())throw new Error("Bounds are not valid.");var g=this._getBoundsCenterZoom(o,h);return this.setView(g.center,g.zoom,h)},fitWorld:function(o){return this.fitBounds([[-90,-180],[90,180]],o)},panTo:function(o,h){return this.setView(o,this._zoom,{pan:h})},panBy:function(o,h){if(o=ae(o).round(),h=h||{},!o.x&&!o.y)return this.fire("moveend");if(h.animate!==!0&&!this.getSize().contains(o))return this._resetView(this.unproject(this.project(this.getCenter()).add(o)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Jo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),h.noMoveStart||this.fire("movestart"),h.animate!==!1){ze(this._mapPane,"leaflet-pan-anim");var g=this._getMapPanePos().subtract(o).round();this._panAnim.run(this._mapPane,g,h.duration||.25,h.easeLinearity)}else this._rawPanBy(o),this.fire("move").fire("moveend");return this},flyTo:function(o,h,g){if(g=g||{},g.animate===!1||!Be.any3d)return this.setView(o,h,g);this._stop();var C=this.project(this.getCenter()),A=this.project(o),O=this.getSize(),W=this._zoom;o=ge(o),h=h===void 0?W:h;var te=Math.max(O.x,O.y),oe=te*this.getZoomScale(W,h),_e=A.distanceTo(C)||1,De=1.42,Ke=De*De;function ot(mn){var wl=mn?-1:1,xx=mn?oe:te,yx=oe*oe-te*te+wl*Ke*Ke*_e*_e,_x=2*xx*Ke*_e,fu=yx/_x,Ad=Math.sqrt(fu*fu+1)-fu,vx=Ad<1e-9?-18:Math.log(Ad);return vx}function sr(mn){return(Math.exp(mn)-Math.exp(-mn))/2}function In(mn){return(Math.exp(mn)+Math.exp(-mn))/2}function Zr(mn){return sr(mn)/In(mn)}var dr=ot(0);function uo(mn){return te*(In(dr)/In(dr+De*mn))}function dx(mn){return te*(In(dr)*Zr(dr+De*mn)-sr(dr))/Ke}function px(mn){return 1-Math.pow(1-mn,1.5)}var gx=Date.now(),bd=(ot(1)-dr)/De,mx=g.duration?1e3*g.duration:1e3*bd*.8;function Sd(){var mn=(Date.now()-gx)/mx,wl=px(mn)*bd;mn<=1?(this._flyToFrame=ce(Sd,this),this._move(this.unproject(C.add(A.subtract(C).multiplyBy(dx(wl)/_e)),W),this.getScaleZoom(te/uo(wl),W),{flyTo:!0})):this._move(o,h)._moveEnd(!0)}return this._moveStart(!0,g.noMoveStart),Sd.call(this),this},flyToBounds:function(o,h){var g=this._getBoundsCenterZoom(o,h);return this.flyTo(g.center,g.zoom,h)},setMaxBounds:function(o){return o=we(o),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),o.isValid()?(this.options.maxBounds=o,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(o){var h=this.options.minZoom;return this.options.minZoom=o,this._loaded&&h!==o&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(o):this},setMaxZoom:function(o){var h=this.options.maxZoom;return this.options.maxZoom=o,this._loaded&&h!==o&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(o):this},panInsideBounds:function(o,h){this._enforcingBounds=!0;var g=this.getCenter(),C=this._limitCenter(g,this._zoom,we(o));return g.equals(C)||this.panTo(C,h),this._enforcingBounds=!1,this},panInside:function(o,h){h=h||{};var g=ae(h.paddingTopLeft||h.padding||[0,0]),C=ae(h.paddingBottomRight||h.padding||[0,0]),A=this.project(this.getCenter()),O=this.project(o),W=this.getPixelBounds(),te=Ne([W.min.add(g),W.max.subtract(C)]),oe=te.getSize();if(!te.contains(O)){this._enforcingBounds=!0;var _e=O.subtract(te.getCenter()),De=te.extend(O).getSize().subtract(oe);A.x+=_e.x<0?-De.x:De.x,A.y+=_e.y<0?-De.y:De.y,this.panTo(this.unproject(A),h),this._enforcingBounds=!1}return this},invalidateSize:function(o){if(!this._loaded)return this;o=l({animate:!1,pan:!0},o===!0?{animate:!0}:o);var h=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var g=this.getSize(),C=h.divideBy(2).round(),A=g.divideBy(2).round(),O=C.subtract(A);return!O.x&&!O.y?this:(o.animate&&o.pan?this.panBy(O):(o.pan&&this._rawPanBy(O),this.fire("move"),o.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(m(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:h,newSize:g}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(o){if(o=this._locateOptions=l({timeout:1e4,watch:!1},o),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var h=m(this._handleGeolocationResponse,this),g=m(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(h,g,o):navigator.geolocation.getCurrentPosition(h,g,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){if(this._container._leaflet_id){var h=o.code,g=o.message||(h===1?"permission denied":h===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:h,message:"Geolocation error: "+g+"."})}},_handleGeolocationResponse:function(o){if(this._container._leaflet_id){var h=o.coords.latitude,g=o.coords.longitude,C=new Le(h,g),A=C.toBounds(o.coords.accuracy*2),O=this._locateOptions;if(O.setView){var W=this.getBoundsZoom(A);this.setView(C,O.maxZoom?Math.min(W,O.maxZoom):W)}var te={latlng:C,bounds:A,timestamp:o.timestamp};for(var oe in o.coords)typeof o.coords[oe]=="number"&&(te[oe]=o.coords[oe]);this.fire("locationfound",te)}},addHandler:function(o,h){if(!h)return this;var g=this[o]=new h(this);return this._handlers.push(g),this.options[o]&&g.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),bt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(ue(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var o;for(o in this._layers)this._layers[o].remove();for(o in this._panes)bt(this._panes[o]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(o,h){var g="leaflet-pane"+(o?" leaflet-"+o.replace("Pane","")+"-pane":""),C=st("div",g,h||this._mapPane);return o&&(this._panes[o]=C),C},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var o=this.getPixelBounds(),h=this.unproject(o.getBottomLeft()),g=this.unproject(o.getTopRight());return new Qe(h,g)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(o,h,g){o=we(o),g=ae(g||[0,0]);var C=this.getZoom()||0,A=this.getMinZoom(),O=this.getMaxZoom(),W=o.getNorthWest(),te=o.getSouthEast(),oe=this.getSize().subtract(g),_e=Ne(this.project(te,C),this.project(W,C)).getSize(),De=Be.any3d?this.options.zoomSnap:1,Ke=oe.x/_e.x,ot=oe.y/_e.y,sr=h?Math.max(Ke,ot):Math.min(Ke,ot);return C=this.getScaleZoom(sr,C),De&&(C=Math.round(C/(De/100))*(De/100),C=h?Math.ceil(C/De)*De:Math.floor(C/De)*De),Math.max(A,Math.min(O,C))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new J(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(o,h){var g=this._getTopLeftPoint(o,h);return new Ce(g,g.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(o){return this.options.crs.getProjectedBounds(o===void 0?this.getZoom():o)},getPane:function(o){return typeof o=="string"?this._panes[o]:o},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(o,h){var g=this.options.crs;return h=h===void 0?this._zoom:h,g.scale(o)/g.scale(h)},getScaleZoom:function(o,h){var g=this.options.crs;h=h===void 0?this._zoom:h;var C=g.zoom(o*g.scale(h));return isNaN(C)?1/0:C},project:function(o,h){return h=h===void 0?this._zoom:h,this.options.crs.latLngToPoint(ge(o),h)},unproject:function(o,h){return h=h===void 0?this._zoom:h,this.options.crs.pointToLatLng(ae(o),h)},layerPointToLatLng:function(o){var h=ae(o).add(this.getPixelOrigin());return this.unproject(h)},latLngToLayerPoint:function(o){var h=this.project(ge(o))._round();return h._subtract(this.getPixelOrigin())},wrapLatLng:function(o){return this.options.crs.wrapLatLng(ge(o))},wrapLatLngBounds:function(o){return this.options.crs.wrapLatLngBounds(we(o))},distance:function(o,h){return this.options.crs.distance(ge(o),ge(h))},containerPointToLayerPoint:function(o){return ae(o).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(o){return ae(o).add(this._getMapPanePos())},containerPointToLatLng:function(o){var h=this.containerPointToLayerPoint(ae(o));return this.layerPointToLatLng(h)},latLngToContainerPoint:function(o){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ge(o)))},mouseEventToContainerPoint:function(o){return Ji(o,this._container)},mouseEventToLayerPoint:function(o){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(o))},mouseEventToLatLng:function(o){return this.layerPointToLatLng(this.mouseEventToLayerPoint(o))},_initContainer:function(o){var h=this._container=at(o);if(h){if(h._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ye(h,"scroll",this._onScroll,this),this._containerId=_(h)},_initLayout:function(){var o=this._container;this._fadeAnimated=this.options.fadeAnimation&&Be.any3d,ze(o,"leaflet-container"+(Be.touch?" leaflet-touch":"")+(Be.retina?" leaflet-retina":"")+(Be.ielt9?" leaflet-oldie":"")+(Be.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var h=qe(o,"position");h!=="absolute"&&h!=="relative"&&h!=="fixed"&&h!=="sticky"&&(o.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var o=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),me(this._mapPane,new J(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ze(o.markerPane,"leaflet-zoom-hide"),ze(o.shadowPane,"leaflet-zoom-hide"))},_resetView:function(o,h,g){me(this._mapPane,new J(0,0));var C=!this._loaded;this._loaded=!0,h=this._limitZoom(h),this.fire("viewprereset");var A=this._zoom!==h;this._moveStart(A,g)._move(o,h)._moveEnd(A),this.fire("viewreset"),C&&this.fire("load")},_moveStart:function(o,h){return o&&this.fire("zoomstart"),h||this.fire("movestart"),this},_move:function(o,h,g,C){h===void 0&&(h=this._zoom);var A=this._zoom!==h;return this._zoom=h,this._lastCenter=o,this._pixelOrigin=this._getNewPixelOrigin(o),C?g&&g.pinch&&this.fire("zoom",g):((A||g&&g.pinch)&&this.fire("zoom",g),this.fire("move",g)),this},_moveEnd:function(o){return o&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return ue(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(o){me(this._mapPane,this._getMapPanePos().subtract(o))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(o){this._targets={},this._targets[_(this._container)]=this;var h=o?Re:Ye;h(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&h(window,"resize",this._onResize,this),Be.any3d&&this.options.transform3DLimit&&(o?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){ue(this._resizeRequest),this._resizeRequest=ce(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var o=this._getMapPanePos();Math.max(Math.abs(o.x),Math.abs(o.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(o,h){for(var g=[],C,A=h==="mouseout"||h==="mouseover",O=o.target||o.srcElement,W=!1;O;){if(C=this._targets[_(O)],C&&(h==="click"||h==="preclick")&&this._draggableMoved(C)){W=!0;break}if(C&&C.listens(h,!0)&&(A&&!Di(O,o)||(g.push(C),A))||O===this._container)break;O=O.parentNode}return!g.length&&!W&&!A&&this.listens(h,!0)&&(g=[this]),g},_isClickDisabled:function(o){for(;o&&o!==this._container;){if(o._leaflet_disable_click)return!0;o=o.parentNode}},_handleDOMEvent:function(o){var h=o.target||o.srcElement;if(!(!this._loaded||h._leaflet_disable_events||o.type==="click"&&this._isClickDisabled(h))){var g=o.type;g==="mousedown"&&Cr(h),this._fireDOMEvent(o,g)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(o,h,g){if(o.type==="click"){var C=l({},o);C.type="preclick",this._fireDOMEvent(C,C.type,g)}var A=this._findEventTargets(o,h);if(g){for(var O=[],W=0;W<g.length;W++)g[W].listens(h,!0)&&O.push(g[W]);A=O.concat(A)}if(A.length){h==="contextmenu"&&vn(o);var te=A[0],oe={originalEvent:o};if(o.type!=="keypress"&&o.type!=="keydown"&&o.type!=="keyup"){var _e=te.getLatLng&&(!te._radius||te._radius<=10);oe.containerPoint=_e?this.latLngToContainerPoint(te.getLatLng()):this.mouseEventToContainerPoint(o),oe.layerPoint=this.containerPointToLayerPoint(oe.containerPoint),oe.latlng=_e?te.getLatLng():this.layerPointToLatLng(oe.layerPoint)}for(W=0;W<A.length;W++)if(A[W].fire(h,oe,!0),oe.originalEvent._stopped||A[W].options.bubblingMouseEvents===!1&&$(this._mouseEvents,h)!==-1)return}},_draggableMoved:function(o){return o=o.dragging&&o.dragging.enabled()?o:this,o.dragging&&o.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var o=0,h=this._handlers.length;o<h;o++)this._handlers[o].disable()},whenReady:function(o,h){return this._loaded?o.call(h||this,{target:this}):this.on("load",o,h),this},_getMapPanePos:function(){return rt(this._mapPane)||new J(0,0)},_moved:function(){var o=this._getMapPanePos();return o&&!o.equals([0,0])},_getTopLeftPoint:function(o,h){var g=o&&h!==void 0?this._getNewPixelOrigin(o,h):this.getPixelOrigin();return g.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(o,h){var g=this.getSize()._divideBy(2);return this.project(o,h)._subtract(g)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(o,h,g){var C=this._getNewPixelOrigin(g,h);return this.project(o,h)._subtract(C)},_latLngBoundsToNewLayerBounds:function(o,h,g){var C=this._getNewPixelOrigin(g,h);return Ne([this.project(o.getSouthWest(),h)._subtract(C),this.project(o.getNorthWest(),h)._subtract(C),this.project(o.getSouthEast(),h)._subtract(C),this.project(o.getNorthEast(),h)._subtract(C)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(o){return this.latLngToLayerPoint(o).subtract(this._getCenterLayerPoint())},_limitCenter:function(o,h,g){if(!g)return o;var C=this.project(o,h),A=this.getSize().divideBy(2),O=new Ce(C.subtract(A),C.add(A)),W=this._getBoundsOffset(O,g,h);return Math.abs(W.x)<=1&&Math.abs(W.y)<=1?o:this.unproject(C.add(W),h)},_limitOffset:function(o,h){if(!h)return o;var g=this.getPixelBounds(),C=new Ce(g.min.add(o),g.max.add(o));return o.add(this._getBoundsOffset(C,h))},_getBoundsOffset:function(o,h,g){var C=Ne(this.project(h.getNorthEast(),g),this.project(h.getSouthWest(),g)),A=C.min.subtract(o.min),O=C.max.subtract(o.max),W=this._rebound(A.x,-O.x),te=this._rebound(A.y,-O.y);return new J(W,te)},_rebound:function(o,h){return o+h>0?Math.round(o-h)/2:Math.max(0,Math.ceil(o))-Math.max(0,Math.floor(h))},_limitZoom:function(o){var h=this.getMinZoom(),g=this.getMaxZoom(),C=Be.any3d?this.options.zoomSnap:1;return C&&(o=Math.round(o/C)*C),Math.max(h,Math.min(g,o))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){_t(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(o,h){var g=this._getCenterOffset(o)._trunc();return(h&&h.animate)!==!0&&!this.getSize().contains(g)?!1:(this.panBy(g,h),!0)},_createAnimProxy:function(){var o=this._proxy=st("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(o),this.on("zoomanim",function(h){var g=jr,C=this._proxy.style[g];R(this._proxy,this.project(h.center,h.zoom),this.getZoomScale(h.zoom,1)),C===this._proxy.style[g]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){bt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var o=this.getCenter(),h=this.getZoom();R(this._proxy,this.project(o,h),this.getZoomScale(h,1))},_catchTransitionEnd:function(o){this._animatingZoom&&o.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(o,h,g){if(this._animatingZoom)return!0;if(g=g||{},!this._zoomAnimated||g.animate===!1||this._nothingToAnimate()||Math.abs(h-this._zoom)>this.options.zoomAnimationThreshold)return!1;var C=this.getZoomScale(h),A=this._getCenterOffset(o)._divideBy(1-1/C);return g.animate!==!0&&!this.getSize().contains(A)?!1:(ce(function(){this._moveStart(!0,g.noMoveStart||!1)._animateZoom(o,h,!0)},this),!0)},_animateZoom:function(o,h,g,C){this._mapPane&&(g&&(this._animatingZoom=!0,this._animateToCenter=o,this._animateToZoom=h,ze(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:o,zoom:h,noUpdate:C}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(m(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&_t(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function pl(o,h){return new lt(o,h)}var Ar=ne.extend({options:{position:"topright"},initialize:function(o){U(this,o)},getPosition:function(){return this.options.position},setPosition:function(o){var h=this._map;return h&&h.removeControl(this),this.options.position=o,h&&h.addControl(this),this},getContainer:function(){return this._container},addTo:function(o){this.remove(),this._map=o;var h=this._container=this.onAdd(o),g=this.getPosition(),C=o._controlCorners[g];return ze(h,"leaflet-control"),g.indexOf("bottom")!==-1?C.insertBefore(h,C.firstChild):C.appendChild(h),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(bt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(o){this._map&&o&&o.screenX>0&&o.screenY>0&&this._map.getContainer().focus()}}),Ps=function(o){return new Ar(o)};lt.include({addControl:function(o){return o.addTo(this),this},removeControl:function(o){return o.remove(),this},_initControlPos:function(){var o=this._controlCorners={},h="leaflet-",g=this._controlContainer=st("div",h+"control-container",this._container);function C(A,O){var W=h+A+" "+h+O;o[A+O]=st("div",W,g)}C("top","left"),C("top","right"),C("bottom","left"),C("bottom","right")},_clearControlPos:function(){for(var o in this._controlCorners)bt(this._controlCorners[o]);bt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var gl=Ar.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(o,h,g,C){return g<C?-1:C<g?1:0}},initialize:function(o,h,g){U(this,g),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var C in o)this._addLayer(o[C],C);for(C in h)this._addLayer(h[C],C,!0)},onAdd:function(o){this._initLayout(),this._update(),this._map=o,o.on("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(o){return Ar.prototype.addTo.call(this,o),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(o,h){return this._addLayer(o,h),this._map?this._update():this},addOverlay:function(o,h){return this._addLayer(o,h,!0),this._map?this._update():this},removeLayer:function(o){o.off("add remove",this._onLayerChange,this);var h=this._getLayer(_(o));return h&&this._layers.splice(this._layers.indexOf(h),1),this._map?this._update():this},expand:function(){ze(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var o=this._map.getSize().y-(this._container.offsetTop+50);return o<this._section.clientHeight?(ze(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=o+"px"):_t(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return _t(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var o="leaflet-control-layers",h=this._container=st("div",o),g=this.options.collapsed;h.setAttribute("aria-haspopup",!0),br(h),so(h);var C=this._section=st("section",o+"-list");g&&(this._map.on("click",this.collapse,this),Ye(h,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var A=this._layersLink=st("a",o+"-toggle",h);A.href="#",A.title="Layers",A.setAttribute("role","button"),Ye(A,{keydown:function(O){O.keyCode===13&&this._expandSafely()},click:function(O){vn(O),this._expandSafely()}},this),g||this.expand(),this._baseLayersList=st("div",o+"-base",C),this._separator=st("div",o+"-separator",C),this._overlaysList=st("div",o+"-overlays",C),h.appendChild(C)},_getLayer:function(o){for(var h=0;h<this._layers.length;h++)if(this._layers[h]&&_(this._layers[h].layer)===o)return this._layers[h]},_addLayer:function(o,h,g){this._map&&o.on("add remove",this._onLayerChange,this),this._layers.push({layer:o,name:h,overlay:g}),this.options.sortLayers&&this._layers.sort(m(function(C,A){return this.options.sortFunction(C.layer,A.layer,C.name,A.name)},this)),this.options.autoZIndex&&o.setZIndex&&(this._lastZIndex++,o.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;vi(this._baseLayersList),vi(this._overlaysList),this._layerControlInputs=[];var o,h,g,C,A=0;for(g=0;g<this._layers.length;g++)C=this._layers[g],this._addItem(C),h=h||C.overlay,o=o||!C.overlay,A+=C.overlay?0:1;return this.options.hideSingleBase&&(o=o&&A>1,this._baseLayersList.style.display=o?"":"none"),this._separator.style.display=h&&o?"":"none",this},_onLayerChange:function(o){this._handlingClick||this._update();var h=this._getLayer(_(o.target)),g=h.overlay?o.type==="add"?"overlayadd":"overlayremove":o.type==="add"?"baselayerchange":null;g&&this._map.fire(g,h)},_createRadioElement:function(o,h){var g='<input type="radio" class="leaflet-control-layers-selector" name="'+o+'"'+(h?' checked="checked"':"")+"/>",C=document.createElement("div");return C.innerHTML=g,C.firstChild},_addItem:function(o){var h=document.createElement("label"),g=this._map.hasLayer(o.layer),C;o.overlay?(C=document.createElement("input"),C.type="checkbox",C.className="leaflet-control-layers-selector",C.defaultChecked=g):C=this._createRadioElement("leaflet-base-layers_"+_(this),g),this._layerControlInputs.push(C),C.layerId=_(o.layer),Ye(C,"click",this._onInputClick,this);var A=document.createElement("span");A.innerHTML=" "+o.name;var O=document.createElement("span");h.appendChild(O),O.appendChild(C),O.appendChild(A);var W=o.overlay?this._overlaysList:this._baseLayersList;return W.appendChild(h),this._checkDisabledLayers(),h},_onInputClick:function(){if(!this._preventClick){var o=this._layerControlInputs,h,g,C=[],A=[];this._handlingClick=!0;for(var O=o.length-1;O>=0;O--)h=o[O],g=this._getLayer(h.layerId).layer,h.checked?C.push(g):h.checked||A.push(g);for(O=0;O<A.length;O++)this._map.hasLayer(A[O])&&this._map.removeLayer(A[O]);for(O=0;O<C.length;O++)this._map.hasLayer(C[O])||this._map.addLayer(C[O]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var o=this._layerControlInputs,h,g,C=this._map.getZoom(),A=o.length-1;A>=0;A--)h=o[A],g=this._getLayer(h.layerId).layer,h.disabled=g.options.minZoom!==void 0&&C<g.options.minZoom||g.options.maxZoom!==void 0&&C>g.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var o=this._section;this._preventClick=!0,Ye(o,"click",vn),this.expand();var h=this;setTimeout(function(){Re(o,"click",vn),h._preventClick=!1})}}),Et=function(o,h,g){return new gl(o,h,g)},oo=Ar.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(o){var h="leaflet-control-zoom",g=st("div",h+" leaflet-bar"),C=this.options;return this._zoomInButton=this._createButton(C.zoomInText,C.zoomInTitle,h+"-in",g,this._zoomIn),this._zoomOutButton=this._createButton(C.zoomOutText,C.zoomOutTitle,h+"-out",g,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),g},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(o){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(o.shiftKey?3:1))},_zoomOut:function(o){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(o.shiftKey?3:1))},_createButton:function(o,h,g,C,A){var O=st("a",g,C);return O.innerHTML=o,O.href="#",O.title=h,O.setAttribute("role","button"),O.setAttribute("aria-label",h),br(O),Ye(O,"click",Sr),Ye(O,"click",A,this),Ye(O,"click",this._refocusOnMap,this),O},_updateDisabled:function(){var o=this._map,h="leaflet-disabled";_t(this._zoomInButton,h),_t(this._zoomOutButton,h),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||o._zoom===o.getMinZoom())&&(ze(this._zoomOutButton,h),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||o._zoom===o.getMaxZoom())&&(ze(this._zoomInButton,h),this._zoomInButton.setAttribute("aria-disabled","true"))}});lt.mergeOptions({zoomControl:!0}),lt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new oo,this.addControl(this.zoomControl))});var ao=function(o){return new oo(o)},ii=Ar.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(o){var h="leaflet-control-scale",g=st("div",h),C=this.options;return this._addScales(C,h+"-line",g),o.on(C.updateWhenIdle?"moveend":"move",this._update,this),o.whenReady(this._update,this),g},onRemove:function(o){o.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(o,h,g){o.metric&&(this._mScale=st("div",h,g)),o.imperial&&(this._iScale=st("div",h,g))},_update:function(){var o=this._map,h=o.getSize().y/2,g=o.distance(o.containerPointToLatLng([0,h]),o.containerPointToLatLng([this.options.maxWidth,h]));this._updateScales(g)},_updateScales:function(o){this.options.metric&&o&&this._updateMetric(o),this.options.imperial&&o&&this._updateImperial(o)},_updateMetric:function(o){var h=this._getRoundNum(o),g=h<1e3?h+" m":h/1e3+" km";this._updateScale(this._mScale,g,h/o)},_updateImperial:function(o){var h=o*3.2808399,g,C,A;h>5280?(g=h/5280,C=this._getRoundNum(g),this._updateScale(this._iScale,C+" mi",C/g)):(A=this._getRoundNum(h),this._updateScale(this._iScale,A+" ft",A/h))},_updateScale:function(o,h,g){o.style.width=Math.round(this.options.maxWidth*g)+"px",o.innerHTML=h},_getRoundNum:function(o){var h=Math.pow(10,(Math.floor(o)+"").length-1),g=o/h;return g=g>=10?10:g>=5?5:g>=3?3:g>=2?2:1,h*g}}),su=function(o){return new ii(o)},se='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',tt=Ar.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Be.inlineSvg?se+" ":"")+"Leaflet</a>"},initialize:function(o){U(this,o),this._attributions={}},onAdd:function(o){o.attributionControl=this,this._container=st("div","leaflet-control-attribution"),br(this._container);for(var h in o._layers)o._layers[h].getAttribution&&this.addAttribution(o._layers[h].getAttribution());return this._update(),o.on("layeradd",this._addAttribution,this),this._container},onRemove:function(o){o.off("layeradd",this._addAttribution,this)},_addAttribution:function(o){o.layer.getAttribution&&(this.addAttribution(o.layer.getAttribution()),o.layer.once("remove",function(){this.removeAttribution(o.layer.getAttribution())},this))},setPrefix:function(o){return this.options.prefix=o,this._update(),this},addAttribution:function(o){return o?(this._attributions[o]||(this._attributions[o]=0),this._attributions[o]++,this._update(),this):this},removeAttribution:function(o){return o?(this._attributions[o]&&(this._attributions[o]--,this._update()),this):this},_update:function(){if(this._map){var o=[];for(var h in this._attributions)this._attributions[h]&&o.push(h);var g=[];this.options.prefix&&g.push(this.options.prefix),o.length&&g.push(o.join(", ")),this._container.innerHTML=g.join(' <span aria-hidden="true">|</span> ')}}});lt.mergeOptions({attributionControl:!0}),lt.addInitHook(function(){this.options.attributionControl&&new tt().addTo(this)});var wn=function(o){return new tt(o)};Ar.Layers=gl,Ar.Zoom=oo,Ar.Scale=ii,Ar.Attribution=tt,Ps.layers=Et,Ps.zoom=ao,Ps.scale=su,Ps.attribution=wn;var nr=ne.extend({initialize:function(o){this._map=o},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});nr.addTo=function(o,h){return o.addHandler(h,this),this};var ml={Events:ye},xl=Be.touch?"touchstart mousedown":"mousedown",Ci=he.extend({options:{clickTolerance:3},initialize:function(o,h,g,C){U(this,C),this._element=o,this._dragStartTarget=h||o,this._preventOutline=g},enable:function(){this._enabled||(Ye(this._dragStartTarget,xl,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ci._dragging===this&&this.finishDrag(!0),Re(this._dragStartTarget,xl,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(o){if(this._enabled&&(this._moved=!1,!Os(this._element,"leaflet-zoom-anim"))){if(o.touches&&o.touches.length!==1){Ci._dragging===this&&this.finishDrag();return}if(!(Ci._dragging||o.shiftKey||o.which!==1&&o.button!==1&&!o.touches)&&(Ci._dragging=this,this._preventOutline&&Cr(this._element),Pe(),zt(),!this._moving)){this.fire("down");var h=o.touches?o.touches[0]:o,g=fr(this._element);this._startPoint=new J(h.clientX,h.clientY),this._startPos=rt(this._element),this._parentScale=ni(g);var C=o.type==="mousedown";Ye(document,C?"mousemove":"touchmove",this._onMove,this),Ye(document,C?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(o){if(this._enabled){if(o.touches&&o.touches.length>1){this._moved=!0;return}var h=o.touches&&o.touches.length===1?o.touches[0]:o,g=new J(h.clientX,h.clientY)._subtract(this._startPoint);!g.x&&!g.y||Math.abs(g.x)+Math.abs(g.y)<this.options.clickTolerance||(g.x/=this._parentScale.x,g.y/=this._parentScale.y,vn(o),this._moved||(this.fire("dragstart"),this._moved=!0,ze(document.body,"leaflet-dragging"),this._lastTarget=o.target||o.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ze(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(g),this._moving=!0,this._lastEvent=o,this._updatePosition())}},_updatePosition:function(){var o={originalEvent:this._lastEvent};this.fire("predrag",o),me(this._element,this._newPos),this.fire("drag",o)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(o){_t(document.body,"leaflet-dragging"),this._lastTarget&&(_t(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Re(document,"mousemove touchmove",this._onMove,this),Re(document,"mouseup touchend touchcancel",this._onUp,this),ht(),wi();var h=this._moved&&this._moving;this._moving=!1,Ci._dragging=!1,h&&this.fire("dragend",{noInertia:o,distance:this._newPos.distanceTo(this._startPos)})}});function yl(o,h,g){var C,A=[1,4,2,8],O,W,te,oe,_e,De,Ke,ot;for(O=0,De=o.length;O<De;O++)o[O]._code=Fi(o[O],h);for(te=0;te<4;te++){for(Ke=A[te],C=[],O=0,De=o.length,W=De-1;O<De;W=O++)oe=o[O],_e=o[W],oe._code&Ke?_e._code&Ke||(ot=si(_e,oe,Ke,h,g),ot._code=Fi(ot,h),C.push(ot)):(_e._code&Ke&&(ot=si(_e,oe,Ke,h,g),ot._code=Fi(ot,h),C.push(ot)),C.push(oe));o=C}return o}function lo(o,h){var g,C,A,O,W,te,oe,_e,De;if(!o||o.length===0)throw new Error("latlngs not passed");rr(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var Ke=ge([0,0]),ot=we(o),sr=ot.getNorthWest().distanceTo(ot.getSouthWest())*ot.getNorthEast().distanceTo(ot.getNorthWest());sr<1700&&(Ke=Kt(o));var In=o.length,Zr=[];for(g=0;g<In;g++){var dr=ge(o[g]);Zr.push(h.project(ge([dr.lat-Ke.lat,dr.lng-Ke.lng])))}for(te=oe=_e=0,g=0,C=In-1;g<In;C=g++)A=Zr[g],O=Zr[C],W=A.y*O.x-O.y*A.x,oe+=(A.x+O.x)*W,_e+=(A.y+O.y)*W,te+=W*3;te===0?De=Zr[0]:De=[oe/te,_e/te];var uo=h.unproject(ae(De));return ge([uo.lat+Ke.lat,uo.lng+Ke.lng])}function Kt(o){for(var h=0,g=0,C=0,A=0;A<o.length;A++){var O=ge(o[A]);h+=O.lat,g+=O.lng,C++}return ge([h/C,g/C])}var ea={__proto__:null,clipPolygon:yl,polygonCenter:lo,centroid:Kt};function Ut(o,h){if(!h||!o.length)return o.slice();var g=h*h;return o=ou(o,g),o=St(o,g),o}function Ds(o,h,g){return Math.sqrt(ji(o,h,g,!0))}function Bi(o,h,g){return ji(o,h,g)}function St(o,h){var g=o.length,C=typeof Uint8Array<"u"?Uint8Array:Array,A=new C(g);A[0]=A[g-1]=1,Ze(o,A,h,0,g-1);var O,W=[];for(O=0;O<g;O++)A[O]&&W.push(o[O]);return W}function Ze(o,h,g,C,A){var O=0,W,te,oe;for(te=C+1;te<=A-1;te++)oe=ji(o[te],o[C],o[A],!0),oe>O&&(W=te,O=oe);O>g&&(h[W]=1,Ze(o,h,g,C,W),Ze(o,h,g,W,A))}function ou(o,h){for(var g=[o[0]],C=1,A=0,O=o.length;C<O;C++)zr(o[C],o[A])>h&&(g.push(o[C]),A=C);return A<O-1&&g.push(o[O-1]),g}var kt;function Ei(o,h,g,C,A){var O=C?kt:Fi(o,g),W=Fi(h,g),te,oe,_e;for(kt=W;;){if(!(O|W))return[o,h];if(O&W)return!1;te=O||W,oe=si(o,h,te,g,A),_e=Fi(oe,g),te===O?(o=oe,O=_e):(h=oe,W=_e)}}function si(o,h,g,C,A){var O=h.x-o.x,W=h.y-o.y,te=C.min,oe=C.max,_e,De;return g&8?(_e=o.x+O*(oe.y-o.y)/W,De=oe.y):g&4?(_e=o.x+O*(te.y-o.y)/W,De=te.y):g&2?(_e=oe.x,De=o.y+W*(oe.x-o.x)/O):g&1&&(_e=te.x,De=o.y+W*(te.x-o.x)/O),new J(_e,De,A)}function Fi(o,h){var g=0;return o.x<h.min.x?g|=1:o.x>h.max.x&&(g|=2),o.y<h.min.y?g|=4:o.y>h.max.y&&(g|=8),g}function zr(o,h){var g=h.x-o.x,C=h.y-o.y;return g*g+C*C}function ji(o,h,g,C){var A=h.x,O=h.y,W=g.x-A,te=g.y-O,oe=W*W+te*te,_e;return oe>0&&(_e=((o.x-A)*W+(o.y-O)*te)/oe,_e>1?(A=g.x,O=g.y):_e>0&&(A+=W*_e,O+=te*_e)),W=o.x-A,te=o.y-O,C?W*W+te*te:new J(A,O)}function rr(o){return!B(o[0])||typeof o[0][0]!="object"&&typeof o[0][0]<"u"}function co(o){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),rr(o)}function ta(o,h){var g,C,A,O,W,te,oe,_e;if(!o||o.length===0)throw new Error("latlngs not passed");rr(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var De=ge([0,0]),Ke=we(o),ot=Ke.getNorthWest().distanceTo(Ke.getSouthWest())*Ke.getNorthEast().distanceTo(Ke.getNorthWest());ot<1700&&(De=Kt(o));var sr=o.length,In=[];for(g=0;g<sr;g++){var Zr=ge(o[g]);In.push(h.project(ge([Zr.lat-De.lat,Zr.lng-De.lng])))}for(g=0,C=0;g<sr-1;g++)C+=In[g].distanceTo(In[g+1])/2;if(C===0)_e=In[0];else for(g=0,O=0;g<sr-1;g++)if(W=In[g],te=In[g+1],A=W.distanceTo(te),O+=A,O>C){oe=(O-C)/A,_e=[te.x-oe*(te.x-W.x),te.y-oe*(te.y-W.y)];break}var dr=h.unproject(ae(_e));return ge([dr.lat+De.lat,dr.lng+De.lng])}var _l={__proto__:null,simplify:Ut,pointToSegmentDistance:Ds,closestPointOnSegment:Bi,clipSegment:Ei,_getEdgeIntersection:si,_getBitCode:Fi,_sqClosestPointOnSegment:ji,isFlat:rr,_flat:co,polylineCenter:ta},na={project:function(o){return new J(o.lng,o.lat)},unproject:function(o){return new Le(o.y,o.x)},bounds:new Ce([-180,-90],[180,90])},bi={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Ce([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(o){var h=Math.PI/180,g=this.R,C=o.lat*h,A=this.R_MINOR/g,O=Math.sqrt(1-A*A),W=O*Math.sin(C),te=Math.tan(Math.PI/4-C/2)/Math.pow((1-W)/(1+W),O/2);return C=-g*Math.log(Math.max(te,1e-10)),new J(o.lng*h*g,C)},unproject:function(o){for(var h=180/Math.PI,g=this.R,C=this.R_MINOR/g,A=Math.sqrt(1-C*C),O=Math.exp(-o.y/g),W=Math.PI/2-2*Math.atan(O),te=0,oe=.1,_e;te<15&&Math.abs(oe)>1e-7;te++)_e=A*Math.sin(W),_e=Math.pow((1-_e)/(1+_e),A/2),oe=Math.PI/2-2*Math.atan(O*_e)-W,W+=oe;return new Le(W*h,o.x*h/g)}},ra={__proto__:null,LonLat:na,Mercator:bi,SphericalMercator:Fn},au=l({},He,{code:"EPSG:3395",projection:bi,transformation:function(){var o=.5/(Math.PI*bi.R);return yt(o,.5,-o,.5)}()}),ts=l({},He,{code:"EPSG:4326",projection:na,transformation:yt(1/180,1,-1/180,.5)}),lu=l({},mt,{projection:na,transformation:yt(1,0,-1,0),scale:function(o){return Math.pow(2,o)},zoom:function(o){return Math.log(o)/Math.LN2},distance:function(o,h){var g=h.lng-o.lng,C=h.lat-o.lat;return Math.sqrt(g*g+C*C)},infinite:!0});mt.Earth=He,mt.EPSG3395=au,mt.EPSG3857=$e,mt.EPSG900913=Sn,mt.EPSG4326=ts,mt.Simple=lu;var gn=he.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(o){return o.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(o){return o&&o.removeLayer(this),this},getPane:function(o){return this._map.getPane(o?this.options[o]||o:this.options.pane)},addInteractiveTarget:function(o){return this._map._targets[_(o)]=this,this},removeInteractiveTarget:function(o){return delete this._map._targets[_(o)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(o){var h=o.target;if(h.hasLayer(this)){if(this._map=h,this._zoomAnimated=h._zoomAnimated,this.getEvents){var g=this.getEvents();h.on(g,this),this.once("remove",function(){h.off(g,this)},this)}this.onAdd(h),this.fire("add"),h.fire("layeradd",{layer:this})}}});lt.include({addLayer:function(o){if(!o._layerAdd)throw new Error("The provided object is not a Layer.");var h=_(o);return this._layers[h]?this:(this._layers[h]=o,o._mapToAdd=this,o.beforeAdd&&o.beforeAdd(this),this.whenReady(o._layerAdd,o),this)},removeLayer:function(o){var h=_(o);return this._layers[h]?(this._loaded&&o.onRemove(this),delete this._layers[h],this._loaded&&(this.fire("layerremove",{layer:o}),o.fire("remove")),o._map=o._mapToAdd=null,this):this},hasLayer:function(o){return _(o)in this._layers},eachLayer:function(o,h){for(var g in this._layers)o.call(h,this._layers[g]);return this},_addLayers:function(o){o=o?B(o)?o:[o]:[];for(var h=0,g=o.length;h<g;h++)this.addLayer(o[h])},_addZoomLimit:function(o){(!isNaN(o.options.maxZoom)||!isNaN(o.options.minZoom))&&(this._zoomBoundLayers[_(o)]=o,this._updateZoomLevels())},_removeZoomLimit:function(o){var h=_(o);this._zoomBoundLayers[h]&&(delete this._zoomBoundLayers[h],this._updateZoomLevels())},_updateZoomLevels:function(){var o=1/0,h=-1/0,g=this._getZoomSpan();for(var C in this._zoomBoundLayers){var A=this._zoomBoundLayers[C].options;o=A.minZoom===void 0?o:Math.min(o,A.minZoom),h=A.maxZoom===void 0?h:Math.max(h,A.maxZoom)}this._layersMaxZoom=h===-1/0?void 0:h,this._layersMinZoom=o===1/0?void 0:o,g!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var oi=gn.extend({initialize:function(o,h){U(this,h),this._layers={};var g,C;if(o)for(g=0,C=o.length;g<C;g++)this.addLayer(o[g])},addLayer:function(o){var h=this.getLayerId(o);return this._layers[h]=o,this._map&&this._map.addLayer(o),this},removeLayer:function(o){var h=o in this._layers?o:this.getLayerId(o);return this._map&&this._layers[h]&&this._map.removeLayer(this._layers[h]),delete this._layers[h],this},hasLayer:function(o){var h=typeof o=="number"?o:this.getLayerId(o);return h in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(o){var h=Array.prototype.slice.call(arguments,1),g,C;for(g in this._layers)C=this._layers[g],C[o]&&C[o].apply(C,h);return this},onAdd:function(o){this.eachLayer(o.addLayer,o)},onRemove:function(o){this.eachLayer(o.removeLayer,o)},eachLayer:function(o,h){for(var g in this._layers)o.call(h,this._layers[g]);return this},getLayer:function(o){return this._layers[o]},getLayers:function(){var o=[];return this.eachLayer(o.push,o),o},setZIndex:function(o){return this.invoke("setZIndex",o)},getLayerId:function(o){return _(o)}}),hr=function(o,h){return new oi(o,h)},Ur=oi.extend({addLayer:function(o){return this.hasLayer(o)?this:(o.addEventParent(this),oi.prototype.addLayer.call(this,o),this.fire("layeradd",{layer:o}))},removeLayer:function(o){return this.hasLayer(o)?(o in this._layers&&(o=this._layers[o]),o.removeEventParent(this),oi.prototype.removeLayer.call(this,o),this.fire("layerremove",{layer:o})):this},setStyle:function(o){return this.invoke("setStyle",o)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var o=new Qe;for(var h in this._layers){var g=this._layers[h];o.extend(g.getBounds?g.getBounds():g.getLatLng())}return o}}),Hr=function(o,h){return new Ur(o,h)},ns=ne.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(o){U(this,o)},createIcon:function(o){return this._createIcon("icon",o)},createShadow:function(o){return this._createIcon("shadow",o)},_createIcon:function(o,h){var g=this._getIconUrl(o);if(!g){if(o==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var C=this._createImg(g,h&&h.tagName==="IMG"?h:null);return this._setIconStyles(C,o),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),C},_setIconStyles:function(o,h){var g=this.options,C=g[h+"Size"];typeof C=="number"&&(C=[C,C]);var A=ae(C),O=ae(h==="shadow"&&g.shadowAnchor||g.iconAnchor||A&&A.divideBy(2,!0));o.className="leaflet-marker-"+h+" "+(g.className||""),O&&(o.style.marginLeft=-O.x+"px",o.style.marginTop=-O.y+"px"),A&&(o.style.width=A.x+"px",o.style.height=A.y+"px")},_createImg:function(o,h){return h=h||document.createElement("img"),h.src=o,h},_getIconUrl:function(o){return Be.retina&&this.options[o+"RetinaUrl"]||this.options[o+"Url"]}});function ia(o){return new ns(o)}var Bs=ns.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(o){return typeof Bs.imagePath!="string"&&(Bs.imagePath=this._detectIconPath()),(this.options.imagePath||Bs.imagePath)+ns.prototype._getIconUrl.call(this,o)},_stripUrl:function(o){var h=function(g,C,A){var O=C.exec(g);return O&&O[A]};return o=h(o,/^url\((['"])?(.+)\1\)$/,2),o&&h(o,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var o=st("div","leaflet-default-icon-path",document.body),h=qe(o,"background-image")||qe(o,"backgroundImage");if(document.body.removeChild(o),h=this._stripUrl(h),h)return h;var g=document.querySelector('link[href$="leaflet.css"]');return g?g.href.substring(0,g.href.length-11-1):""}}),sa=nr.extend({initialize:function(o){this._marker=o},addHooks:function(){var o=this._marker._icon;this._draggable||(this._draggable=new Ci(o,o,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ze(o,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&_t(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(o){var h=this._marker,g=h._map,C=this._marker.options.autoPanSpeed,A=this._marker.options.autoPanPadding,O=rt(h._icon),W=g.getPixelBounds(),te=g.getPixelOrigin(),oe=Ne(W.min._subtract(te).add(A),W.max._subtract(te).subtract(A));if(!oe.contains(O)){var _e=ae((Math.max(oe.max.x,O.x)-oe.max.x)/(W.max.x-oe.max.x)-(Math.min(oe.min.x,O.x)-oe.min.x)/(W.min.x-oe.min.x),(Math.max(oe.max.y,O.y)-oe.max.y)/(W.max.y-oe.max.y)-(Math.min(oe.min.y,O.y)-oe.min.y)/(W.min.y-oe.min.y)).multiplyBy(C);g.panBy(_e,{animate:!1}),this._draggable._newPos._add(_e),this._draggable._startPos._add(_e),me(h._icon,this._draggable._newPos),this._onDrag(o),this._panRequest=ce(this._adjustPan.bind(this,o))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(o){this._marker.options.autoPan&&(ue(this._panRequest),this._panRequest=ce(this._adjustPan.bind(this,o)))},_onDrag:function(o){var h=this._marker,g=h._shadow,C=rt(h._icon),A=h._map.layerPointToLatLng(C);g&&me(g,C),h._latlng=A,o.latlng=A,o.oldLatLng=this._oldLatLng,h.fire("move",o).fire("drag",o)},_onDragEnd:function(o){ue(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",o)}}),ir=gn.extend({options:{icon:new Bs,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(o,h){U(this,h),this._latlng=ge(o)},onAdd:function(o){this._zoomAnimated=this._zoomAnimated&&o.options.markerZoomAnimation,this._zoomAnimated&&o.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(o){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&o.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(o){var h=this._latlng;return this._latlng=ge(o),this.update(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},setZIndexOffset:function(o){return this.options.zIndexOffset=o,this.update()},getIcon:function(){return this.options.icon},setIcon:function(o){return this.options.icon=o,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var o=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(o)}return this},_initIcon:function(){var o=this.options,h="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),g=o.icon.createIcon(this._icon),C=!1;g!==this._icon&&(this._icon&&this._removeIcon(),C=!0,o.title&&(g.title=o.title),g.tagName==="IMG"&&(g.alt=o.alt||"")),ze(g,h),o.keyboard&&(g.tabIndex="0",g.setAttribute("role","button")),this._icon=g,o.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ye(g,"focus",this._panOnFocus,this);var A=o.icon.createShadow(this._shadow),O=!1;A!==this._shadow&&(this._removeShadow(),O=!0),A&&(ze(A,h),A.alt=""),this._shadow=A,o.opacity<1&&this._updateOpacity(),C&&this.getPane().appendChild(this._icon),this._initInteraction(),A&&O&&this.getPane(o.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Re(this._icon,"focus",this._panOnFocus,this),bt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&bt(this._shadow),this._shadow=null},_setPos:function(o){this._icon&&me(this._icon,o),this._shadow&&me(this._shadow,o),this._zIndex=o.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(o){this._icon&&(this._icon.style.zIndex=this._zIndex+o)},_animateZoom:function(o){var h=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center).round();this._setPos(h)},_initInteraction:function(){if(this.options.interactive&&(ze(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),sa)){var o=this.options.draggable;this.dragging&&(o=this.dragging.enabled(),this.dragging.disable()),this.dragging=new sa(this),o&&this.dragging.enable()}},setOpacity:function(o){return this.options.opacity=o,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var o=this.options.opacity;this._icon&&nt(this._icon,o),this._shadow&&nt(this._shadow,o)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var o=this._map;if(o){var h=this.options.icon.options,g=h.iconSize?ae(h.iconSize):ae(0,0),C=h.iconAnchor?ae(h.iconAnchor):ae(0,0);o.panInside(this._latlng,{paddingTopLeft:C,paddingBottomRight:g.subtract(C)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function cu(o,h){return new ir(o,h)}var Vr=gn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(o){this._renderer=o.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(o){return U(this,o),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&o&&Object.prototype.hasOwnProperty.call(o,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Si=Vr.extend({options:{fill:!0,radius:10},initialize:function(o,h){U(this,h),this._latlng=ge(o),this._radius=this.options.radius},setLatLng:function(o){var h=this._latlng;return this._latlng=ge(o),this.redraw(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(o){return this.options.radius=this._radius=o,this.redraw()},getRadius:function(){return this._radius},setStyle:function(o){var h=o&&o.radius||this._radius;return Vr.prototype.setStyle.call(this,o),this.setRadius(h),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var o=this._radius,h=this._radiusY||o,g=this._clickTolerance(),C=[o+g,h+g];this._pxBounds=new Ce(this._point.subtract(C),this._point.add(C))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(o){return o.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function gt(o,h){return new Si(o,h)}var rs=Si.extend({initialize:function(o,h,g){if(typeof h=="number"&&(h=l({},g,{radius:h})),U(this,h),this._latlng=ge(o),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(o){return this._mRadius=o,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var o=[this._radius,this._radiusY||this._radius];return new Qe(this._map.layerPointToLatLng(this._point.subtract(o)),this._map.layerPointToLatLng(this._point.add(o)))},setStyle:Vr.prototype.setStyle,_project:function(){var o=this._latlng.lng,h=this._latlng.lat,g=this._map,C=g.options.crs;if(C.distance===He.distance){var A=Math.PI/180,O=this._mRadius/He.R/A,W=g.project([h+O,o]),te=g.project([h-O,o]),oe=W.add(te).divideBy(2),_e=g.unproject(oe).lat,De=Math.acos((Math.cos(O*A)-Math.sin(h*A)*Math.sin(_e*A))/(Math.cos(h*A)*Math.cos(_e*A)))/A;(isNaN(De)||De===0)&&(De=O/Math.cos(Math.PI/180*h)),this._point=oe.subtract(g.getPixelOrigin()),this._radius=isNaN(De)?0:oe.x-g.project([_e,o-De]).x,this._radiusY=oe.y-W.y}else{var Ke=C.unproject(C.project(this._latlng).subtract([this._mRadius,0]));this._point=g.latLngToLayerPoint(this._latlng),this._radius=this._point.x-g.latLngToLayerPoint(Ke).x}this._updateBounds()}});function I(o,h,g){return new rs(o,h,g)}var r=Vr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(o,h){U(this,h),this._setLatLngs(o)},getLatLngs:function(){return this._latlngs},setLatLngs:function(o){return this._setLatLngs(o),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(o){for(var h=1/0,g=null,C=ji,A,O,W=0,te=this._parts.length;W<te;W++)for(var oe=this._parts[W],_e=1,De=oe.length;_e<De;_e++){A=oe[_e-1],O=oe[_e];var Ke=C(o,A,O,!0);Ke<h&&(h=Ke,g=C(o,A,O))}return g&&(g.distance=Math.sqrt(h)),g},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ta(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(o,h){return h=h||this._defaultShape(),o=ge(o),h.push(o),this._bounds.extend(o),this.redraw()},_setLatLngs:function(o){this._bounds=new Qe,this._latlngs=this._convertLatLngs(o)},_defaultShape:function(){return rr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(o){for(var h=[],g=rr(o),C=0,A=o.length;C<A;C++)g?(h[C]=ge(o[C]),this._bounds.extend(h[C])):h[C]=this._convertLatLngs(o[C]);return h},_project:function(){var o=new Ce;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,o),this._bounds.isValid()&&o.isValid()&&(this._rawPxBounds=o,this._updateBounds())},_updateBounds:function(){var o=this._clickTolerance(),h=new J(o,o);this._rawPxBounds&&(this._pxBounds=new Ce([this._rawPxBounds.min.subtract(h),this._rawPxBounds.max.add(h)]))},_projectLatlngs:function(o,h,g){var C=o[0]instanceof Le,A=o.length,O,W;if(C){for(W=[],O=0;O<A;O++)W[O]=this._map.latLngToLayerPoint(o[O]),g.extend(W[O]);h.push(W)}else for(O=0;O<A;O++)this._projectLatlngs(o[O],h,g)},_clipPoints:function(){var o=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}var h=this._parts,g,C,A,O,W,te,oe;for(g=0,A=0,O=this._rings.length;g<O;g++)for(oe=this._rings[g],C=0,W=oe.length;C<W-1;C++)te=Ei(oe[C],oe[C+1],o,C,!0),te&&(h[A]=h[A]||[],h[A].push(te[0]),(te[1]!==oe[C+1]||C===W-2)&&(h[A].push(te[1]),A++))}},_simplifyPoints:function(){for(var o=this._parts,h=this.options.smoothFactor,g=0,C=o.length;g<C;g++)o[g]=Ut(o[g],h)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(o,h){var g,C,A,O,W,te,oe=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(g=0,O=this._parts.length;g<O;g++)for(te=this._parts[g],C=0,W=te.length,A=W-1;C<W;A=C++)if(!(!h&&C===0)&&Ds(o,te[A],te[C])<=oe)return!0;return!1}});function i(o,h){return new r(o,h)}r._flat=co;var a=r.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return lo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(o){var h=r.prototype._convertLatLngs.call(this,o),g=h.length;return g>=2&&h[0]instanceof Le&&h[0].equals(h[g-1])&&h.pop(),h},_setLatLngs:function(o){r.prototype._setLatLngs.call(this,o),rr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return rr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var o=this._renderer._bounds,h=this.options.weight,g=new J(h,h);if(o=new Ce(o.min.subtract(g),o.max.add(g)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}for(var C=0,A=this._rings.length,O;C<A;C++)O=yl(this._rings[C],o,!0),O.length&&this._parts.push(O)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(o){var h=!1,g,C,A,O,W,te,oe,_e;if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(O=0,oe=this._parts.length;O<oe;O++)for(g=this._parts[O],W=0,_e=g.length,te=_e-1;W<_e;te=W++)C=g[W],A=g[te],C.y>o.y!=A.y>o.y&&o.x<(A.x-C.x)*(o.y-C.y)/(A.y-C.y)+C.x&&(h=!h);return h||r.prototype._containsPoint.call(this,o,!0)}});function c(o,h){return new a(o,h)}var u=Ur.extend({initialize:function(o,h){U(this,h),this._layers={},o&&this.addData(o)},addData:function(o){var h=B(o)?o:o.features,g,C,A;if(h){for(g=0,C=h.length;g<C;g++)A=h[g],(A.geometries||A.geometry||A.features||A.coordinates)&&this.addData(A);return this}var O=this.options;if(O.filter&&!O.filter(o))return this;var W=d(o,O);return W?(W.feature=j(o),W.defaultOptions=W.options,this.resetStyle(W),O.onEachFeature&&O.onEachFeature(o,W),this.addLayer(W)):this},resetStyle:function(o){return o===void 0?this.eachLayer(this.resetStyle,this):(o.options=l({},o.defaultOptions),this._setLayerStyle(o,this.options.style),this)},setStyle:function(o){return this.eachLayer(function(h){this._setLayerStyle(h,o)},this)},_setLayerStyle:function(o,h){o.setStyle&&(typeof h=="function"&&(h=h(o.feature)),o.setStyle(h))}});function d(o,h){var g=o.type==="Feature"?o.geometry:o,C=g?g.coordinates:null,A=[],O=h&&h.pointToLayer,W=h&&h.coordsToLatLng||y,te,oe,_e,De;if(!C&&!g)return null;switch(g.type){case"Point":return te=W(C),p(O,o,te,h);case"MultiPoint":for(_e=0,De=C.length;_e<De;_e++)te=W(C[_e]),A.push(p(O,o,te,h));return new Ur(A);case"LineString":case"MultiLineString":return oe=w(C,g.type==="LineString"?0:1,W),new r(oe,h);case"Polygon":case"MultiPolygon":return oe=w(C,g.type==="Polygon"?1:2,W),new a(oe,h);case"GeometryCollection":for(_e=0,De=g.geometries.length;_e<De;_e++){var Ke=d({geometry:g.geometries[_e],type:"Feature",properties:o.properties},h);Ke&&A.push(Ke)}return new Ur(A);case"FeatureCollection":for(_e=0,De=g.features.length;_e<De;_e++){var ot=d(g.features[_e],h);ot&&A.push(ot)}return new Ur(A);default:throw new Error("Invalid GeoJSON object.")}}function p(o,h,g,C){return o?o(h,g):new ir(g,C&&C.markersInheritOptions&&C)}function y(o){return new Le(o[1],o[0],o[2])}function w(o,h,g){for(var C=[],A=0,O=o.length,W;A<O;A++)W=h?w(o[A],h-1,g):(g||y)(o[A]),C.push(W);return C}function S(o,h){return o=ge(o),o.alt!==void 0?[M(o.lng,h),M(o.lat,h),M(o.alt,h)]:[M(o.lng,h),M(o.lat,h)]}function N(o,h,g,C){for(var A=[],O=0,W=o.length;O<W;O++)A.push(h?N(o[O],rr(o[O])?0:h-1,g,C):S(o[O],C));return!h&&g&&A.length>0&&A.push(A[0].slice()),A}function k(o,h){return o.feature?l({},o.feature,{geometry:h}):j(h)}function j(o){return o.type==="Feature"||o.type==="FeatureCollection"?o:{type:"Feature",properties:{},geometry:o}}var G={toGeoJSON:function(o){return k(this,{type:"Point",coordinates:S(this.getLatLng(),o)})}};ir.include(G),rs.include(G),Si.include(G),r.include({toGeoJSON:function(o){var h=!rr(this._latlngs),g=N(this._latlngs,h?1:0,!1,o);return k(this,{type:(h?"Multi":"")+"LineString",coordinates:g})}}),a.include({toGeoJSON:function(o){var h=!rr(this._latlngs),g=h&&!rr(this._latlngs[0]),C=N(this._latlngs,g?2:h?1:0,!0,o);return h||(C=[C]),k(this,{type:(g?"Multi":"")+"Polygon",coordinates:C})}}),oi.include({toMultiPoint:function(o){var h=[];return this.eachLayer(function(g){h.push(g.toGeoJSON(o).geometry.coordinates)}),k(this,{type:"MultiPoint",coordinates:h})},toGeoJSON:function(o){var h=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(h==="MultiPoint")return this.toMultiPoint(o);var g=h==="GeometryCollection",C=[];return this.eachLayer(function(A){if(A.toGeoJSON){var O=A.toGeoJSON(o);if(g)C.push(O.geometry);else{var W=j(O);W.type==="FeatureCollection"?C.push.apply(C,W.features):C.push(W)}}}),g?k(this,{geometries:C,type:"GeometryCollection"}):{type:"FeatureCollection",features:C}}});function X(o,h){return new u(o,h)}var ee=X,ie=gn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(o,h,g){this._url=o,this._bounds=we(h),U(this,g)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ze(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){bt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(o){return this.options.opacity=o,this._image&&this._updateOpacity(),this},setStyle:function(o){return o.opacity&&this.setOpacity(o.opacity),this},bringToFront:function(){return this._map&&Rt(this._image),this},bringToBack:function(){return this._map&&On(this._image),this},setUrl:function(o){return this._url=o,this._image&&(this._image.src=o),this},setBounds:function(o){return this._bounds=we(o),this._map&&this._reset(),this},getEvents:function(){var o={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var o=this._url.tagName==="IMG",h=this._image=o?this._url:st("img");if(ze(h,"leaflet-image-layer"),this._zoomAnimated&&ze(h,"leaflet-zoom-animated"),this.options.className&&ze(h,this.options.className),h.onselectstart=b,h.onmousemove=b,h.onload=m(this.fire,this,"load"),h.onerror=m(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),o){this._url=h.src;return}h.src=this._url,h.alt=this.options.alt},_animateZoom:function(o){var h=this._map.getZoomScale(o.zoom),g=this._map._latLngBoundsToNewLayerBounds(this._bounds,o.zoom,o.center).min;R(this._image,g,h)},_reset:function(){var o=this._image,h=new Ce(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),g=h.getSize();me(o,h.min),o.style.width=g.x+"px",o.style.height=g.y+"px"},_updateOpacity:function(){nt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var o=this.options.errorOverlayUrl;o&&this._url!==o&&(this._url=o,this._image.src=o)},getCenter:function(){return this._bounds.getCenter()}}),Ee=function(o,h,g){return new ie(o,h,g)},be=ie.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var o=this._url.tagName==="VIDEO",h=this._image=o?this._url:st("video");if(ze(h,"leaflet-image-layer"),this._zoomAnimated&&ze(h,"leaflet-zoom-animated"),this.options.className&&ze(h,this.options.className),h.onselectstart=b,h.onmousemove=b,h.onloadeddata=m(this.fire,this,"load"),o){for(var g=h.getElementsByTagName("source"),C=[],A=0;A<g.length;A++)C.push(g[A].src);this._url=g.length>0?C:[h.src];return}B(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(h.style,"objectFit")&&(h.style.objectFit="fill"),h.autoplay=!!this.options.autoplay,h.loop=!!this.options.loop,h.muted=!!this.options.muted,h.playsInline=!!this.options.playsInline;for(var O=0;O<this._url.length;O++){var W=st("source");W.src=this._url[O],h.appendChild(W)}}});function ve(o,h,g){return new be(o,h,g)}var it=ie.extend({_initImage:function(){var o=this._image=this._url;ze(o,"leaflet-image-layer"),this._zoomAnimated&&ze(o,"leaflet-zoom-animated"),this.options.className&&ze(o,this.options.className),o.onselectstart=b,o.onmousemove=b}});function et(o,h,g){return new it(o,h,g)}var Ht=gn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(o,h){o&&(o instanceof Le||B(o))?(this._latlng=ge(o),U(this,h)):(U(this,o),this._source=h),this.options.content&&(this._content=this.options.content)},openOn:function(o){return o=arguments.length?o:this._source._map,o.hasLayer(this)||o.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(o){return this._map?this.close():(arguments.length?this._source=o:o=this._source,this._prepareOpen(),this.openOn(o._map)),this},onAdd:function(o){this._zoomAnimated=o._zoomAnimated,this._container||this._initLayout(),o._fadeAnimated&&nt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),o._fadeAnimated&&nt(this._container,1),this.bringToFront(),this.options.interactive&&(ze(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(o){o._fadeAnimated?(nt(this._container,0),this._removeTimeout=setTimeout(m(bt,void 0,this._container),200)):bt(this._container),this.options.interactive&&(_t(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(o){return this._latlng=ge(o),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(o){return this._content=o,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var o={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Rt(this._container),this},bringToBack:function(){return this._map&&On(this._container),this},_prepareOpen:function(o){var h=this._source;if(!h._map)return!1;if(h instanceof Ur){h=null;var g=this._source._layers;for(var C in g)if(g[C]._map){h=g[C];break}if(!h)return!1;this._source=h}if(!o)if(h.getCenter)o=h.getCenter();else if(h.getLatLng)o=h.getLatLng();else if(h.getBounds)o=h.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(o),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var o=this._contentNode,h=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof h=="string")o.innerHTML=h;else{for(;o.hasChildNodes();)o.removeChild(o.firstChild);o.appendChild(h)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var o=this._map.latLngToLayerPoint(this._latlng),h=ae(this.options.offset),g=this._getAnchor();this._zoomAnimated?me(this._container,o.add(g)):h=h.add(o).add(g);var C=this._containerBottom=-h.y,A=this._containerLeft=-Math.round(this._containerWidth/2)+h.x;this._container.style.bottom=C+"px",this._container.style.left=A+"px"}},_getAnchor:function(){return[0,0]}});lt.include({_initOverlay:function(o,h,g,C){var A=h;return A instanceof o||(A=new o(C).setContent(h)),g&&A.setLatLng(g),A}}),gn.include({_initOverlay:function(o,h,g,C){var A=g;return A instanceof o?(U(A,C),A._source=this):(A=h&&!C?h:new o(C,this),A.setContent(g)),A}});var Un=Ht.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(o){return o=arguments.length?o:this._source._map,!o.hasLayer(this)&&o._popup&&o._popup.options.autoClose&&o.removeLayer(o._popup),o._popup=this,Ht.prototype.openOn.call(this,o)},onAdd:function(o){Ht.prototype.onAdd.call(this,o),o.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Vr||this._source.on("preclick",ri))},onRemove:function(o){Ht.prototype.onRemove.call(this,o),o.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Vr||this._source.off("preclick",ri))},getEvents:function(){var o=Ht.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(o.preclick=this.close),this.options.keepInView&&(o.moveend=this._adjustPan),o},_initLayout:function(){var o="leaflet-popup",h=this._container=st("div",o+" "+(this.options.className||"")+" leaflet-zoom-animated"),g=this._wrapper=st("div",o+"-content-wrapper",h);if(this._contentNode=st("div",o+"-content",g),br(h),so(this._contentNode),Ye(h,"contextmenu",ri),this._tipContainer=st("div",o+"-tip-container",h),this._tip=st("div",o+"-tip",this._tipContainer),this.options.closeButton){var C=this._closeButton=st("a",o+"-close-button",h);C.setAttribute("role","button"),C.setAttribute("aria-label","Close popup"),C.href="#close",C.innerHTML='<span aria-hidden="true">&#215;</span>',Ye(C,"click",function(A){vn(A),this.close()},this)}},_updateLayout:function(){var o=this._contentNode,h=o.style;h.width="",h.whiteSpace="nowrap";var g=o.offsetWidth;g=Math.min(g,this.options.maxWidth),g=Math.max(g,this.options.minWidth),h.width=g+1+"px",h.whiteSpace="",h.height="";var C=o.offsetHeight,A=this.options.maxHeight,O="leaflet-popup-scrolled";A&&C>A?(h.height=A+"px",ze(o,O)):_t(o,O),this._containerWidth=this._container.offsetWidth},_animateZoom:function(o){var h=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center),g=this._getAnchor();me(this._container,h.add(g))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var o=this._map,h=parseInt(qe(this._container,"marginBottom"),10)||0,g=this._container.offsetHeight+h,C=this._containerWidth,A=new J(this._containerLeft,-g-this._containerBottom);A._add(rt(this._container));var O=o.layerPointToContainerPoint(A),W=ae(this.options.autoPanPadding),te=ae(this.options.autoPanPaddingTopLeft||W),oe=ae(this.options.autoPanPaddingBottomRight||W),_e=o.getSize(),De=0,Ke=0;O.x+C+oe.x>_e.x&&(De=O.x+C-_e.x+oe.x),O.x-De-te.x<0&&(De=O.x-te.x),O.y+g+oe.y>_e.y&&(Ke=O.y+g-_e.y+oe.y),O.y-Ke-te.y<0&&(Ke=O.y-te.y),(De||Ke)&&(this.options.keepInView&&(this._autopanning=!0),o.fire("autopanstart").panBy([De,Ke]))}},_getAnchor:function(){return ae(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Hn=function(o,h){return new Un(o,h)};lt.mergeOptions({closePopupOnClick:!0}),lt.include({openPopup:function(o,h,g){return this._initOverlay(Un,o,h,g).openOn(this),this},closePopup:function(o){return o=arguments.length?o:this._popup,o&&o.close(),this}}),gn.include({bindPopup:function(o,h){return this._popup=this._initOverlay(Un,this._popup,o,h),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(o){return this._popup&&(this instanceof Ur||(this._popup._source=this),this._popup._prepareOpen(o||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(o){return this._popup&&this._popup.setContent(o),this},getPopup:function(){return this._popup},_openPopup:function(o){if(!(!this._popup||!this._map)){Sr(o);var h=o.layer||o.target;if(this._popup._source===h&&!(h instanceof Vr)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(o.latlng);return}this._popup._source=h,this.openPopup(o.latlng)}},_movePopup:function(o){this._popup.setLatLng(o.latlng)},_onKeyPress:function(o){o.originalEvent.keyCode===13&&this._openPopup(o)}});var vt=Ht.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(o){Ht.prototype.onAdd.call(this,o),this.setOpacity(this.options.opacity),o.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(o){Ht.prototype.onRemove.call(this,o),o.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var o=Ht.prototype.getEvents.call(this);return this.options.permanent||(o.preclick=this.close),o},_initLayout:function(){var o="leaflet-tooltip",h=o+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=st("div",h),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+_(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(o){var h,g,C=this._map,A=this._container,O=C.latLngToContainerPoint(C.getCenter()),W=C.layerPointToContainerPoint(o),te=this.options.direction,oe=A.offsetWidth,_e=A.offsetHeight,De=ae(this.options.offset),Ke=this._getAnchor();te==="top"?(h=oe/2,g=_e):te==="bottom"?(h=oe/2,g=0):te==="center"?(h=oe/2,g=_e/2):te==="right"?(h=0,g=_e/2):te==="left"?(h=oe,g=_e/2):W.x<O.x?(te="right",h=0,g=_e/2):(te="left",h=oe+(De.x+Ke.x)*2,g=_e/2),o=o.subtract(ae(h,g,!0)).add(De).add(Ke),_t(A,"leaflet-tooltip-right"),_t(A,"leaflet-tooltip-left"),_t(A,"leaflet-tooltip-top"),_t(A,"leaflet-tooltip-bottom"),ze(A,"leaflet-tooltip-"+te),me(A,o)},_updatePosition:function(){var o=this._map.latLngToLayerPoint(this._latlng);this._setPosition(o)},setOpacity:function(o){this.options.opacity=o,this._container&&nt(this._container,o)},_animateZoom:function(o){var h=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center);this._setPosition(h)},_getAnchor:function(){return ae(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Cn=function(o,h){return new vt(o,h)};lt.include({openTooltip:function(o,h,g){return this._initOverlay(vt,o,h,g).openOn(this),this},closeTooltip:function(o){return o.close(),this}}),gn.include({bindTooltip:function(o,h){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(vt,this._tooltip,o,h),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(o){if(!(!o&&this._tooltipHandlersAdded)){var h=o?"off":"on",g={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?g.add=this._openTooltip:(g.mouseover=this._openTooltip,g.mouseout=this.closeTooltip,g.click=this._openTooltip,this._map?this._addFocusListeners():g.add=this._addFocusListeners),this._tooltip.options.sticky&&(g.mousemove=this._moveTooltip),this[h](g),this._tooltipHandlersAdded=!o}},openTooltip:function(o){return this._tooltip&&(this instanceof Ur||(this._tooltip._source=this),this._tooltip._prepareOpen(o)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(o){return this._tooltip&&this._tooltip.setContent(o),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(o){var h=typeof o.getElement=="function"&&o.getElement();h&&(Ye(h,"focus",function(){this._tooltip._source=o,this.openTooltip()},this),Ye(h,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(o){var h=typeof o.getElement=="function"&&o.getElement();h&&h.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(o){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var h=this;this._map.once("moveend",function(){h._openOnceFlag=!1,h._openTooltip(o)});return}this._tooltip._source=o.layer||o.target,this.openTooltip(this._tooltip.options.sticky?o.latlng:void 0)}},_moveTooltip:function(o){var h=o.latlng,g,C;this._tooltip.options.sticky&&o.originalEvent&&(g=this._map.mouseEventToContainerPoint(o.originalEvent),C=this._map.containerPointToLayerPoint(g),h=this._map.layerPointToLatLng(C)),this._tooltip.setLatLng(h)}});var Vn=ns.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(o){var h=o&&o.tagName==="DIV"?o:document.createElement("div"),g=this.options;if(g.html instanceof Element?(vi(h),h.appendChild(g.html)):h.innerHTML=g.html!==!1?g.html:"",g.bgPos){var C=ae(g.bgPos);h.style.backgroundPosition=-C.x+"px "+-C.y+"px"}return this._setIconStyles(h,"icon"),h},createShadow:function(){return null}});function is(o){return new Vn(o)}ns.Default=Bs;var Wr=gn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Be.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(o){U(this,o)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(o){o._addZoomLimit(this)},onRemove:function(o){this._removeAllTiles(),bt(this._container),o._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Rt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(On(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(o){return this.options.opacity=o,this._updateOpacity(),this},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var o=this._clampZoom(this._map.getZoom());o!==this._tileZoom&&(this._tileZoom=o,this._updateLevels()),this._update()}return this},getEvents:function(){var o={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=x(this._onMoveEnd,this.options.updateInterval,this)),o.move=this._onMove),this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},createTile:function(){return document.createElement("div")},getTileSize:function(){var o=this.options.tileSize;return o instanceof J?o:new J(o,o)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(o){for(var h=this.getPane().children,g=-o(-1/0,1/0),C=0,A=h.length,O;C<A;C++)O=h[C].style.zIndex,h[C]!==this._container&&O&&(g=o(g,+O));isFinite(g)&&(this.options.zIndex=g+o(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Be.ielt9){nt(this._container,this.options.opacity);var o=+new Date,h=!1,g=!1;for(var C in this._tiles){var A=this._tiles[C];if(!(!A.current||!A.loaded)){var O=Math.min(1,(o-A.loaded)/200);nt(A.el,O),O<1?h=!0:(A.active?g=!0:this._onOpaqueTile(A),A.active=!0)}}g&&!this._noPrune&&this._pruneTiles(),h&&(ue(this._fadeFrame),this._fadeFrame=ce(this._updateOpacity,this))}},_onOpaqueTile:b,_initContainer:function(){this._container||(this._container=st("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,h=this.options.maxZoom;if(o!==void 0){for(var g in this._levels)g=Number(g),this._levels[g].el.children.length||g===o?(this._levels[g].el.style.zIndex=h-Math.abs(o-g),this._onUpdateLevel(g)):(bt(this._levels[g].el),this._removeTilesAtZoom(g),this._onRemoveLevel(g),delete this._levels[g]);var C=this._levels[o],A=this._map;return C||(C=this._levels[o]={},C.el=st("div","leaflet-tile-container leaflet-zoom-animated",this._container),C.el.style.zIndex=h,C.origin=A.project(A.unproject(A.getPixelOrigin()),o).round(),C.zoom=o,this._setZoomTransform(C,A.getCenter(),A.getZoom()),b(C.el.offsetWidth),this._onCreateLevel(C)),this._level=C,C}},_onUpdateLevel:b,_onRemoveLevel:b,_onCreateLevel:b,_pruneTiles:function(){if(this._map){var o,h,g=this._map.getZoom();if(g>this.options.maxZoom||g<this.options.minZoom){this._removeAllTiles();return}for(o in this._tiles)h=this._tiles[o],h.retain=h.current;for(o in this._tiles)if(h=this._tiles[o],h.current&&!h.active){var C=h.coords;this._retainParent(C.x,C.y,C.z,C.z-5)||this._retainChildren(C.x,C.y,C.z,C.z+2)}for(o in this._tiles)this._tiles[o].retain||this._removeTile(o)}},_removeTilesAtZoom:function(o){for(var h in this._tiles)this._tiles[h].coords.z===o&&this._removeTile(h)},_removeAllTiles:function(){for(var o in this._tiles)this._removeTile(o)},_invalidateAll:function(){for(var o in this._levels)bt(this._levels[o].el),this._onRemoveLevel(Number(o)),delete this._levels[o];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(o,h,g,C){var A=Math.floor(o/2),O=Math.floor(h/2),W=g-1,te=new J(+A,+O);te.z=+W;var oe=this._tileCoordsToKey(te),_e=this._tiles[oe];return _e&&_e.active?(_e.retain=!0,!0):(_e&&_e.loaded&&(_e.retain=!0),W>C?this._retainParent(A,O,W,C):!1)},_retainChildren:function(o,h,g,C){for(var A=2*o;A<2*o+2;A++)for(var O=2*h;O<2*h+2;O++){var W=new J(A,O);W.z=g+1;var te=this._tileCoordsToKey(W),oe=this._tiles[te];if(oe&&oe.active){oe.retain=!0;continue}else oe&&oe.loaded&&(oe.retain=!0);g+1<C&&this._retainChildren(A,O,g+1,C)}},_resetView:function(o){var h=o&&(o.pinch||o.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),h,h)},_animateZoom:function(o){this._setView(o.center,o.zoom,!0,o.noUpdate)},_clampZoom:function(o){var h=this.options;return h.minNativeZoom!==void 0&&o<h.minNativeZoom?h.minNativeZoom:h.maxNativeZoom!==void 0&&h.maxNativeZoom<o?h.maxNativeZoom:o},_setView:function(o,h,g,C){var A=Math.round(h);this.options.maxZoom!==void 0&&A>this.options.maxZoom||this.options.minZoom!==void 0&&A<this.options.minZoom?A=void 0:A=this._clampZoom(A);var O=this.options.updateWhenZooming&&A!==this._tileZoom;(!C||O)&&(this._tileZoom=A,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),A!==void 0&&this._update(o),g||this._pruneTiles(),this._noPrune=!!g),this._setZoomTransforms(o,h)},_setZoomTransforms:function(o,h){for(var g in this._levels)this._setZoomTransform(this._levels[g],o,h)},_setZoomTransform:function(o,h,g){var C=this._map.getZoomScale(g,o.zoom),A=o.origin.multiplyBy(C).subtract(this._map._getNewPixelOrigin(h,g)).round();Be.any3d?R(o.el,A,C):me(o.el,A)},_resetGrid:function(){var o=this._map,h=o.options.crs,g=this._tileSize=this.getTileSize(),C=this._tileZoom,A=this._map.getPixelWorldBounds(this._tileZoom);A&&(this._globalTileRange=this._pxBoundsToTileRange(A)),this._wrapX=h.wrapLng&&!this.options.noWrap&&[Math.floor(o.project([0,h.wrapLng[0]],C).x/g.x),Math.ceil(o.project([0,h.wrapLng[1]],C).x/g.y)],this._wrapY=h.wrapLat&&!this.options.noWrap&&[Math.floor(o.project([h.wrapLat[0],0],C).y/g.x),Math.ceil(o.project([h.wrapLat[1],0],C).y/g.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(o){var h=this._map,g=h._animatingZoom?Math.max(h._animateToZoom,h.getZoom()):h.getZoom(),C=h.getZoomScale(g,this._tileZoom),A=h.project(o,this._tileZoom).floor(),O=h.getSize().divideBy(C*2);return new Ce(A.subtract(O),A.add(O))},_update:function(o){var h=this._map;if(h){var g=this._clampZoom(h.getZoom());if(o===void 0&&(o=h.getCenter()),this._tileZoom!==void 0){var C=this._getTiledPixelBounds(o),A=this._pxBoundsToTileRange(C),O=A.getCenter(),W=[],te=this.options.keepBuffer,oe=new Ce(A.getBottomLeft().subtract([te,-te]),A.getTopRight().add([te,-te]));if(!(isFinite(A.min.x)&&isFinite(A.min.y)&&isFinite(A.max.x)&&isFinite(A.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var _e in this._tiles){var De=this._tiles[_e].coords;(De.z!==this._tileZoom||!oe.contains(new J(De.x,De.y)))&&(this._tiles[_e].current=!1)}if(Math.abs(g-this._tileZoom)>1){this._setView(o,g);return}for(var Ke=A.min.y;Ke<=A.max.y;Ke++)for(var ot=A.min.x;ot<=A.max.x;ot++){var sr=new J(ot,Ke);if(sr.z=this._tileZoom,!!this._isValidTile(sr)){var In=this._tiles[this._tileCoordsToKey(sr)];In?In.current=!0:W.push(sr)}}if(W.sort(function(dr,uo){return dr.distanceTo(O)-uo.distanceTo(O)}),W.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Zr=document.createDocumentFragment();for(ot=0;ot<W.length;ot++)this._addTile(W[ot],Zr);this._level.el.appendChild(Zr)}}}},_isValidTile:function(o){var h=this._map.options.crs;if(!h.infinite){var g=this._globalTileRange;if(!h.wrapLng&&(o.x<g.min.x||o.x>g.max.x)||!h.wrapLat&&(o.y<g.min.y||o.y>g.max.y))return!1}if(!this.options.bounds)return!0;var C=this._tileCoordsToBounds(o);return we(this.options.bounds).overlaps(C)},_keyToBounds:function(o){return this._tileCoordsToBounds(this._keyToTileCoords(o))},_tileCoordsToNwSe:function(o){var h=this._map,g=this.getTileSize(),C=o.scaleBy(g),A=C.add(g),O=h.unproject(C,o.z),W=h.unproject(A,o.z);return[O,W]},_tileCoordsToBounds:function(o){var h=this._tileCoordsToNwSe(o),g=new Qe(h[0],h[1]);return this.options.noWrap||(g=this._map.wrapLatLngBounds(g)),g},_tileCoordsToKey:function(o){return o.x+":"+o.y+":"+o.z},_keyToTileCoords:function(o){var h=o.split(":"),g=new J(+h[0],+h[1]);return g.z=+h[2],g},_removeTile:function(o){var h=this._tiles[o];h&&(bt(h.el),delete this._tiles[o],this.fire("tileunload",{tile:h.el,coords:this._keyToTileCoords(o)}))},_initTile:function(o){ze(o,"leaflet-tile");var h=this.getTileSize();o.style.width=h.x+"px",o.style.height=h.y+"px",o.onselectstart=b,o.onmousemove=b,Be.ielt9&&this.options.opacity<1&&nt(o,this.options.opacity)},_addTile:function(o,h){var g=this._getTilePos(o),C=this._tileCoordsToKey(o),A=this.createTile(this._wrapCoords(o),m(this._tileReady,this,o));this._initTile(A),this.createTile.length<2&&ce(m(this._tileReady,this,o,null,A)),me(A,g),this._tiles[C]={el:A,coords:o,current:!0},h.appendChild(A),this.fire("tileloadstart",{tile:A,coords:o})},_tileReady:function(o,h,g){h&&this.fire("tileerror",{error:h,tile:g,coords:o});var C=this._tileCoordsToKey(o);g=this._tiles[C],g&&(g.loaded=+new Date,this._map._fadeAnimated?(nt(g.el,0),ue(this._fadeFrame),this._fadeFrame=ce(this._updateOpacity,this)):(g.active=!0,this._pruneTiles()),h||(ze(g.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:g.el,coords:o})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Be.ielt9||!this._map._fadeAnimated?ce(this._pruneTiles,this):setTimeout(m(this._pruneTiles,this),250)))},_getTilePos:function(o){return o.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(o){var h=new J(this._wrapX?E(o.x,this._wrapX):o.x,this._wrapY?E(o.y,this._wrapY):o.y);return h.z=o.z,h},_pxBoundsToTileRange:function(o){var h=this.getTileSize();return new Ce(o.min.unscaleBy(h).floor(),o.max.unscaleBy(h).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var o in this._tiles)if(!this._tiles[o].loaded)return!1;return!0}});function uu(o){return new Wr(o)}var ss=Wr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(o,h){this._url=o,h=U(this,h),h.detectRetina&&Be.retina&&h.maxZoom>0?(h.tileSize=Math.floor(h.tileSize/2),h.zoomReverse?(h.zoomOffset--,h.minZoom=Math.min(h.maxZoom,h.minZoom+1)):(h.zoomOffset++,h.maxZoom=Math.max(h.minZoom,h.maxZoom-1)),h.minZoom=Math.max(0,h.minZoom)):h.zoomReverse?h.minZoom=Math.min(h.maxZoom,h.minZoom):h.maxZoom=Math.max(h.minZoom,h.maxZoom),typeof h.subdomains=="string"&&(h.subdomains=h.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(o,h){return this._url===o&&h===void 0&&(h=!0),this._url=o,h||this.redraw(),this},createTile:function(o,h){var g=document.createElement("img");return Ye(g,"load",m(this._tileOnLoad,this,h,g)),Ye(g,"error",m(this._tileOnError,this,h,g)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(g.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(g.referrerPolicy=this.options.referrerPolicy),g.alt="",g.src=this.getTileUrl(o),g},getTileUrl:function(o){var h={r:Be.retina?"@2x":"",s:this._getSubdomain(o),x:o.x,y:o.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var g=this._globalTileRange.max.y-o.y;this.options.tms&&(h.y=g),h["-y"]=g}return D(this._url,l(h,this.options))},_tileOnLoad:function(o,h){Be.ielt9?setTimeout(m(o,this,null,h),0):o(null,h)},_tileOnError:function(o,h,g){var C=this.options.errorTileUrl;C&&h.getAttribute("src")!==C&&(h.src=C),o(g,h)},_onTileRemove:function(o){o.tile.onload=null},_getZoomForUrl:function(){var o=this._tileZoom,h=this.options.maxZoom,g=this.options.zoomReverse,C=this.options.zoomOffset;return g&&(o=h-o),o+C},_getSubdomain:function(o){var h=Math.abs(o.x+o.y)%this.options.subdomains.length;return this.options.subdomains[h]},_abortLoading:function(){var o,h;for(o in this._tiles)if(this._tiles[o].coords.z!==this._tileZoom&&(h=this._tiles[o].el,h.onload=b,h.onerror=b,!h.complete)){h.src=fe;var g=this._tiles[o].coords;bt(h),delete this._tiles[o],this.fire("tileabort",{tile:h,coords:g})}},_removeTile:function(o){var h=this._tiles[o];if(h)return h.el.setAttribute("src",fe),Wr.prototype._removeTile.call(this,o)},_tileReady:function(o,h,g){if(!(!this._map||g&&g.getAttribute("src")===fe))return Wr.prototype._tileReady.call(this,o,h,g)}});function fd(o,h){return new ss(o,h)}var hd=ss.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(o,h){this._url=o;var g=l({},this.defaultWmsParams);for(var C in h)C in this.options||(g[C]=h[C]);h=U(this,h);var A=h.detectRetina&&Be.retina?2:1,O=this.getTileSize();g.width=O.x*A,g.height=O.y*A,this.wmsParams=g},onAdd:function(o){this._crs=this.options.crs||o.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var h=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[h]=this._crs.code,ss.prototype.onAdd.call(this,o)},getTileUrl:function(o){var h=this._tileCoordsToNwSe(o),g=this._crs,C=Ne(g.project(h[0]),g.project(h[1])),A=C.min,O=C.max,W=(this._wmsVersion>=1.3&&this._crs===ts?[A.y,A.x,O.y,O.x]:[A.x,A.y,O.x,O.y]).join(","),te=ss.prototype.getTileUrl.call(this,o);return te+re(this.wmsParams,te,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+W},setParams:function(o,h){return l(this.wmsParams,o),h||this.redraw(),this}});function lx(o,h){return new hd(o,h)}ss.WMS=hd,fd.wms=lx;var zi=gn.extend({options:{padding:.1},initialize:function(o){U(this,o),_(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ze(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var o={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(o.zoomanim=this._onAnimZoom),o},_onAnimZoom:function(o){this._updateTransform(o.center,o.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(o,h){var g=this._map.getZoomScale(h,this._zoom),C=this._map.getSize().multiplyBy(.5+this.options.padding),A=this._map.project(this._center,h),O=C.multiplyBy(-g).add(A).subtract(this._map._getNewPixelOrigin(o,h));Be.any3d?R(this._container,O,g):me(this._container,O)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var o in this._layers)this._layers[o]._reset()},_onZoomEnd:function(){for(var o in this._layers)this._layers[o]._project()},_updatePaths:function(){for(var o in this._layers)this._layers[o]._update()},_update:function(){var o=this.options.padding,h=this._map.getSize(),g=this._map.containerPointToLayerPoint(h.multiplyBy(-o)).round();this._bounds=new Ce(g,g.add(h.multiplyBy(1+o*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),dd=zi.extend({options:{tolerance:0},getEvents:function(){var o=zi.prototype.getEvents.call(this);return o.viewprereset=this._onViewPreReset,o},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){zi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var o=this._container=document.createElement("canvas");Ye(o,"mousemove",this._onMouseMove,this),Ye(o,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ye(o,"mouseout",this._handleMouseOut,this),o._leaflet_disable_events=!0,this._ctx=o.getContext("2d")},_destroyContainer:function(){ue(this._redrawRequest),delete this._ctx,bt(this._container),Re(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var o;this._redrawBounds=null;for(var h in this._layers)o=this._layers[h],o._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){zi.prototype._update.call(this);var o=this._bounds,h=this._container,g=o.getSize(),C=Be.retina?2:1;me(h,o.min),h.width=C*g.x,h.height=C*g.y,h.style.width=g.x+"px",h.style.height=g.y+"px",Be.retina&&this._ctx.scale(2,2),this._ctx.translate(-o.min.x,-o.min.y),this.fire("update")}},_reset:function(){zi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(o){this._updateDashArray(o),this._layers[_(o)]=o;var h=o._order={layer:o,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=h),this._drawLast=h,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(o){this._requestRedraw(o)},_removePath:function(o){var h=o._order,g=h.next,C=h.prev;g?g.prev=C:this._drawLast=C,C?C.next=g:this._drawFirst=g,delete o._order,delete this._layers[_(o)],this._requestRedraw(o)},_updatePath:function(o){this._extendRedrawBounds(o),o._project(),o._update(),this._requestRedraw(o)},_updateStyle:function(o){this._updateDashArray(o),this._requestRedraw(o)},_updateDashArray:function(o){if(typeof o.options.dashArray=="string"){var h=o.options.dashArray.split(/[, ]+/),g=[],C,A;for(A=0;A<h.length;A++){if(C=Number(h[A]),isNaN(C))return;g.push(C)}o.options._dashArray=g}else o.options._dashArray=o.options.dashArray},_requestRedraw:function(o){this._map&&(this._extendRedrawBounds(o),this._redrawRequest=this._redrawRequest||ce(this._redraw,this))},_extendRedrawBounds:function(o){if(o._pxBounds){var h=(o.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Ce,this._redrawBounds.extend(o._pxBounds.min.subtract([h,h])),this._redrawBounds.extend(o._pxBounds.max.add([h,h]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var o=this._redrawBounds;if(o){var h=o.getSize();this._ctx.clearRect(o.min.x,o.min.y,h.x,h.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var o,h=this._redrawBounds;if(this._ctx.save(),h){var g=h.getSize();this._ctx.beginPath(),this._ctx.rect(h.min.x,h.min.y,g.x,g.y),this._ctx.clip()}this._drawing=!0;for(var C=this._drawFirst;C;C=C.next)o=C.layer,(!h||o._pxBounds&&o._pxBounds.intersects(h))&&o._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(o,h){if(this._drawing){var g,C,A,O,W=o._parts,te=W.length,oe=this._ctx;if(te){for(oe.beginPath(),g=0;g<te;g++){for(C=0,A=W[g].length;C<A;C++)O=W[g][C],oe[C?"lineTo":"moveTo"](O.x,O.y);h&&oe.closePath()}this._fillStroke(oe,o)}}},_updateCircle:function(o){if(!(!this._drawing||o._empty())){var h=o._point,g=this._ctx,C=Math.max(Math.round(o._radius),1),A=(Math.max(Math.round(o._radiusY),1)||C)/C;A!==1&&(g.save(),g.scale(1,A)),g.beginPath(),g.arc(h.x,h.y/A,C,0,Math.PI*2,!1),A!==1&&g.restore(),this._fillStroke(g,o)}},_fillStroke:function(o,h){var g=h.options;g.fill&&(o.globalAlpha=g.fillOpacity,o.fillStyle=g.fillColor||g.color,o.fill(g.fillRule||"evenodd")),g.stroke&&g.weight!==0&&(o.setLineDash&&o.setLineDash(h.options&&h.options._dashArray||[]),o.globalAlpha=g.opacity,o.lineWidth=g.weight,o.strokeStyle=g.color,o.lineCap=g.lineCap,o.lineJoin=g.lineJoin,o.stroke())},_onClick:function(o){for(var h=this._map.mouseEventToLayerPoint(o),g,C,A=this._drawFirst;A;A=A.next)g=A.layer,g.options.interactive&&g._containsPoint(h)&&(!(o.type==="click"||o.type==="preclick")||!this._map._draggableMoved(g))&&(C=g);this._fireEvent(C?[C]:!1,o)},_onMouseMove:function(o){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var h=this._map.mouseEventToLayerPoint(o);this._handleMouseHover(o,h)}},_handleMouseOut:function(o){var h=this._hoveredLayer;h&&(_t(this._container,"leaflet-interactive"),this._fireEvent([h],o,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(o,h){if(!this._mouseHoverThrottled){for(var g,C,A=this._drawFirst;A;A=A.next)g=A.layer,g.options.interactive&&g._containsPoint(h)&&(C=g);C!==this._hoveredLayer&&(this._handleMouseOut(o),C&&(ze(this._container,"leaflet-interactive"),this._fireEvent([C],o,"mouseover"),this._hoveredLayer=C)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,o),this._mouseHoverThrottled=!0,setTimeout(m(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(o,h,g){this._map._fireDOMEvent(h,g||h.type,o)},_bringToFront:function(o){var h=o._order;if(h){var g=h.next,C=h.prev;if(g)g.prev=C;else return;C?C.next=g:g&&(this._drawFirst=g),h.prev=this._drawLast,this._drawLast.next=h,h.next=null,this._drawLast=h,this._requestRedraw(o)}},_bringToBack:function(o){var h=o._order;if(h){var g=h.next,C=h.prev;if(C)C.next=g;else return;g?g.prev=C:C&&(this._drawLast=C),h.prev=null,h.next=this._drawFirst,this._drawFirst.prev=h,this._drawFirst=h,this._requestRedraw(o)}}});function pd(o){return Be.canvas?new dd(o):null}var oa=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(o){return document.createElement("<lvml:"+o+' class="lvml">')}}catch{}return function(o){return document.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),cx={_initContainer:function(){this._container=st("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(zi.prototype._update.call(this),this.fire("update"))},_initPath:function(o){var h=o._container=oa("shape");ze(h,"leaflet-vml-shape "+(this.options.className||"")),h.coordsize="1 1",o._path=oa("path"),h.appendChild(o._path),this._updateStyle(o),this._layers[_(o)]=o},_addPath:function(o){var h=o._container;this._container.appendChild(h),o.options.interactive&&o.addInteractiveTarget(h)},_removePath:function(o){var h=o._container;bt(h),o.removeInteractiveTarget(h),delete this._layers[_(o)]},_updateStyle:function(o){var h=o._stroke,g=o._fill,C=o.options,A=o._container;A.stroked=!!C.stroke,A.filled=!!C.fill,C.stroke?(h||(h=o._stroke=oa("stroke")),A.appendChild(h),h.weight=C.weight+"px",h.color=C.color,h.opacity=C.opacity,C.dashArray?h.dashStyle=B(C.dashArray)?C.dashArray.join(" "):C.dashArray.replace(/( *, *)/g," "):h.dashStyle="",h.endcap=C.lineCap.replace("butt","flat"),h.joinstyle=C.lineJoin):h&&(A.removeChild(h),o._stroke=null),C.fill?(g||(g=o._fill=oa("fill")),A.appendChild(g),g.color=C.fillColor||C.color,g.opacity=C.fillOpacity):g&&(A.removeChild(g),o._fill=null)},_updateCircle:function(o){var h=o._point.round(),g=Math.round(o._radius),C=Math.round(o._radiusY||g);this._setPath(o,o._empty()?"M0 0":"AL "+h.x+","+h.y+" "+g+","+C+" 0,"+65535*360)},_setPath:function(o,h){o._path.v=h},_bringToFront:function(o){Rt(o._container)},_bringToBack:function(o){On(o._container)}},vl=Be.vml?oa:Xt,aa=zi.extend({_initContainer:function(){this._container=vl("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=vl("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){bt(this._container),Re(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){zi.prototype._update.call(this);var o=this._bounds,h=o.getSize(),g=this._container;(!this._svgSize||!this._svgSize.equals(h))&&(this._svgSize=h,g.setAttribute("width",h.x),g.setAttribute("height",h.y)),me(g,o.min),g.setAttribute("viewBox",[o.min.x,o.min.y,h.x,h.y].join(" ")),this.fire("update")}},_initPath:function(o){var h=o._path=vl("path");o.options.className&&ze(h,o.options.className),o.options.interactive&&ze(h,"leaflet-interactive"),this._updateStyle(o),this._layers[_(o)]=o},_addPath:function(o){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(o._path),o.addInteractiveTarget(o._path)},_removePath:function(o){bt(o._path),o.removeInteractiveTarget(o._path),delete this._layers[_(o)]},_updatePath:function(o){o._project(),o._update()},_updateStyle:function(o){var h=o._path,g=o.options;h&&(g.stroke?(h.setAttribute("stroke",g.color),h.setAttribute("stroke-opacity",g.opacity),h.setAttribute("stroke-width",g.weight),h.setAttribute("stroke-linecap",g.lineCap),h.setAttribute("stroke-linejoin",g.lineJoin),g.dashArray?h.setAttribute("stroke-dasharray",g.dashArray):h.removeAttribute("stroke-dasharray"),g.dashOffset?h.setAttribute("stroke-dashoffset",g.dashOffset):h.removeAttribute("stroke-dashoffset")):h.setAttribute("stroke","none"),g.fill?(h.setAttribute("fill",g.fillColor||g.color),h.setAttribute("fill-opacity",g.fillOpacity),h.setAttribute("fill-rule",g.fillRule||"evenodd")):h.setAttribute("fill","none"))},_updatePoly:function(o,h){this._setPath(o,Rn(o._parts,h))},_updateCircle:function(o){var h=o._point,g=Math.max(Math.round(o._radius),1),C=Math.max(Math.round(o._radiusY),1)||g,A="a"+g+","+C+" 0 1,0 ",O=o._empty()?"M0 0":"M"+(h.x-g)+","+h.y+A+g*2+",0 "+A+-g*2+",0 ";this._setPath(o,O)},_setPath:function(o,h){o._path.setAttribute("d",h)},_bringToFront:function(o){Rt(o._path)},_bringToBack:function(o){On(o._path)}});Be.vml&&aa.include(cx);function gd(o){return Be.svg||Be.vml?new aa(o):null}lt.include({getRenderer:function(o){var h=o.options.renderer||this._getPaneRenderer(o.options.pane)||this.options.renderer||this._renderer;return h||(h=this._renderer=this._createRenderer()),this.hasLayer(h)||this.addLayer(h),h},_getPaneRenderer:function(o){if(o==="overlayPane"||o===void 0)return!1;var h=this._paneRenderers[o];return h===void 0&&(h=this._createRenderer({pane:o}),this._paneRenderers[o]=h),h},_createRenderer:function(o){return this.options.preferCanvas&&pd(o)||gd(o)}});var md=a.extend({initialize:function(o,h){a.prototype.initialize.call(this,this._boundsToLatLngs(o),h)},setBounds:function(o){return this.setLatLngs(this._boundsToLatLngs(o))},_boundsToLatLngs:function(o){return o=we(o),[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()]}});function ux(o,h){return new md(o,h)}aa.create=vl,aa.pointsToPath=Rn,u.geometryToLayer=d,u.coordsToLatLng=y,u.coordsToLatLngs=w,u.latLngToCoords=S,u.latLngsToCoords=N,u.getFeature=k,u.asFeature=j,lt.mergeOptions({boxZoom:!0});var xd=nr.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane,this._resetStateTimeout=0,o.on("unload",this._destroy,this)},addHooks:function(){Ye(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Re(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){bt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(o){if(!o.shiftKey||o.which!==1&&o.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),zt(),Pe(),this._startPoint=this._map.mouseEventToContainerPoint(o),Ye(document,{contextmenu:Sr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=st("div","leaflet-zoom-box",this._container),ze(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var h=new Ce(this._point,this._startPoint),g=h.getSize();me(this._box,h.min),this._box.style.width=g.x+"px",this._box.style.height=g.y+"px"},_finish:function(){this._moved&&(bt(this._box),_t(this._container,"leaflet-crosshair")),wi(),ht(),Re(document,{contextmenu:Sr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(o){if(!(o.which!==1&&o.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(m(this._resetState,this),0);var h=new Qe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(h).fire("boxzoomend",{boxZoomBounds:h})}},_onKeyDown:function(o){o.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});lt.addInitHook("addHandler","boxZoom",xd),lt.mergeOptions({doubleClickZoom:!0});var yd=nr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var h=this._map,g=h.getZoom(),C=h.options.zoomDelta,A=o.originalEvent.shiftKey?g-C:g+C;h.options.doubleClickZoom==="center"?h.setZoom(A):h.setZoomAround(o.containerPoint,A)}});lt.addInitHook("addHandler","doubleClickZoom",yd),lt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var _d=nr.extend({addHooks:function(){if(!this._draggable){var o=this._map;this._draggable=new Ci(o._mapPane,o._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),o.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),o.on("zoomend",this._onZoomEnd,this),o.whenReady(this._onZoomEnd,this))}ze(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){_t(this._map._container,"leaflet-grab"),_t(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var o=this._map;if(o._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var h=we(this._map.options.maxBounds);this._offsetLimit=Ne(this._map.latLngToContainerPoint(h.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(h.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;o.fire("movestart").fire("dragstart"),o.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(o){if(this._map.options.inertia){var h=this._lastTime=+new Date,g=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(g),this._times.push(h),this._prunePositions(h)}this._map.fire("move",o).fire("drag",o)},_prunePositions:function(o){for(;this._positions.length>1&&o-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var o=this._map.getSize().divideBy(2),h=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=h.subtract(o).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(o,h){return o-(o-h)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var o=this._draggable._newPos.subtract(this._draggable._startPos),h=this._offsetLimit;o.x<h.min.x&&(o.x=this._viscousLimit(o.x,h.min.x)),o.y<h.min.y&&(o.y=this._viscousLimit(o.y,h.min.y)),o.x>h.max.x&&(o.x=this._viscousLimit(o.x,h.max.x)),o.y>h.max.y&&(o.y=this._viscousLimit(o.y,h.max.y)),this._draggable._newPos=this._draggable._startPos.add(o)}},_onPreDragWrap:function(){var o=this._worldWidth,h=Math.round(o/2),g=this._initialWorldOffset,C=this._draggable._newPos.x,A=(C-h+g)%o+h-g,O=(C+h+g)%o-h-g,W=Math.abs(A+g)<Math.abs(O+g)?A:O;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=W},_onDragEnd:function(o){var h=this._map,g=h.options,C=!g.inertia||o.noInertia||this._times.length<2;if(h.fire("dragend",o),C)h.fire("moveend");else{this._prunePositions(+new Date);var A=this._lastPos.subtract(this._positions[0]),O=(this._lastTime-this._times[0])/1e3,W=g.easeLinearity,te=A.multiplyBy(W/O),oe=te.distanceTo([0,0]),_e=Math.min(g.inertiaMaxSpeed,oe),De=te.multiplyBy(_e/oe),Ke=_e/(g.inertiaDeceleration*W),ot=De.multiplyBy(-Ke/2).round();!ot.x&&!ot.y?h.fire("moveend"):(ot=h._limitOffset(ot,h.options.maxBounds),ce(function(){h.panBy(ot,{duration:Ke,easeLinearity:W,noMoveStart:!0,animate:!0})}))}}});lt.addInitHook("addHandler","dragging",_d),lt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var vd=nr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(o){this._map=o,this._setPanDelta(o.options.keyboardPanDelta),this._setZoomDelta(o.options.zoomDelta)},addHooks:function(){var o=this._map._container;o.tabIndex<=0&&(o.tabIndex="0"),Ye(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Re(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,h=document.documentElement,g=o.scrollTop||h.scrollTop,C=o.scrollLeft||h.scrollLeft;this._map._container.focus(),window.scrollTo(C,g)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(o){var h=this._panKeys={},g=this.keyCodes,C,A;for(C=0,A=g.left.length;C<A;C++)h[g.left[C]]=[-1*o,0];for(C=0,A=g.right.length;C<A;C++)h[g.right[C]]=[o,0];for(C=0,A=g.down.length;C<A;C++)h[g.down[C]]=[0,o];for(C=0,A=g.up.length;C<A;C++)h[g.up[C]]=[0,-1*o]},_setZoomDelta:function(o){var h=this._zoomKeys={},g=this.keyCodes,C,A;for(C=0,A=g.zoomIn.length;C<A;C++)h[g.zoomIn[C]]=o;for(C=0,A=g.zoomOut.length;C<A;C++)h[g.zoomOut[C]]=-o},_addHooks:function(){Ye(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Re(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var h=o.keyCode,g=this._map,C;if(h in this._panKeys){if(!g._panAnim||!g._panAnim._inProgress)if(C=this._panKeys[h],o.shiftKey&&(C=ae(C).multiplyBy(3)),g.options.maxBounds&&(C=g._limitOffset(ae(C),g.options.maxBounds)),g.options.worldCopyJump){var A=g.wrapLatLng(g.unproject(g.project(g.getCenter()).add(C)));g.panTo(A)}else g.panBy(C)}else if(h in this._zoomKeys)g.setZoom(g.getZoom()+(o.shiftKey?3:1)*this._zoomKeys[h]);else if(h===27&&g._popup&&g._popup.options.closeOnEscapeKey)g.closePopup();else return;Sr(o)}}});lt.addInitHook("addHandler","keyboard",vd),lt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var wd=nr.extend({addHooks:function(){Ye(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Re(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(o){var h=es(o),g=this._map.options.wheelDebounceTime;this._delta+=h,this._lastMousePos=this._map.mouseEventToContainerPoint(o),this._startTime||(this._startTime=+new Date);var C=Math.max(g-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(m(this._performZoom,this),C),Sr(o)},_performZoom:function(){var o=this._map,h=o.getZoom(),g=this._map.options.zoomSnap||0;o._stop();var C=this._delta/(this._map.options.wheelPxPerZoomLevel*4),A=4*Math.log(2/(1+Math.exp(-Math.abs(C))))/Math.LN2,O=g?Math.ceil(A/g)*g:A,W=o._limitZoom(h+(this._delta>0?O:-O))-h;this._delta=0,this._startTime=null,W&&(o.options.scrollWheelZoom==="center"?o.setZoom(h+W):o.setZoomAround(this._lastMousePos,h+W))}});lt.addInitHook("addHandler","scrollWheelZoom",wd);var fx=600;lt.mergeOptions({tapHold:Be.touchNative&&Be.safari&&Be.mobile,tapTolerance:15});var Cd=nr.extend({addHooks:function(){Ye(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Re(this._map._container,"touchstart",this._onDown,this)},_onDown:function(o){if(clearTimeout(this._holdTimeout),o.touches.length===1){var h=o.touches[0];this._startPos=this._newPos=new J(h.clientX,h.clientY),this._holdTimeout=setTimeout(m(function(){this._cancel(),this._isTapValid()&&(Ye(document,"touchend",vn),Ye(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",h))},this),fx),Ye(document,"touchend touchcancel contextmenu",this._cancel,this),Ye(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function o(){Re(document,"touchend",vn),Re(document,"touchend touchcancel",o)},_cancel:function(){clearTimeout(this._holdTimeout),Re(document,"touchend touchcancel contextmenu",this._cancel,this),Re(document,"touchmove",this._onMove,this)},_onMove:function(o){var h=o.touches[0];this._newPos=new J(h.clientX,h.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(o,h){var g=new MouseEvent(o,{bubbles:!0,cancelable:!0,view:window,screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY});g._simulated=!0,h.target.dispatchEvent(g)}});lt.addInitHook("addHandler","tapHold",Cd),lt.mergeOptions({touchZoom:Be.touch,bounceAtZoomLimits:!0});var Ed=nr.extend({addHooks:function(){ze(this._map._container,"leaflet-touch-zoom"),Ye(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){_t(this._map._container,"leaflet-touch-zoom"),Re(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var h=this._map;if(!(!o.touches||o.touches.length!==2||h._animatingZoom||this._zooming)){var g=h.mouseEventToContainerPoint(o.touches[0]),C=h.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=h.getSize()._divideBy(2),this._startLatLng=h.containerPointToLatLng(this._centerPoint),h.options.touchZoom!=="center"&&(this._pinchStartLatLng=h.containerPointToLatLng(g.add(C)._divideBy(2))),this._startDist=g.distanceTo(C),this._startZoom=h.getZoom(),this._moved=!1,this._zooming=!0,h._stop(),Ye(document,"touchmove",this._onTouchMove,this),Ye(document,"touchend touchcancel",this._onTouchEnd,this),vn(o)}},_onTouchMove:function(o){if(!(!o.touches||o.touches.length!==2||!this._zooming)){var h=this._map,g=h.mouseEventToContainerPoint(o.touches[0]),C=h.mouseEventToContainerPoint(o.touches[1]),A=g.distanceTo(C)/this._startDist;if(this._zoom=h.getScaleZoom(A,this._startZoom),!h.options.bounceAtZoomLimits&&(this._zoom<h.getMinZoom()&&A<1||this._zoom>h.getMaxZoom()&&A>1)&&(this._zoom=h._limitZoom(this._zoom)),h.options.touchZoom==="center"){if(this._center=this._startLatLng,A===1)return}else{var O=g._add(C)._divideBy(2)._subtract(this._centerPoint);if(A===1&&O.x===0&&O.y===0)return;this._center=h.unproject(h.project(this._pinchStartLatLng,this._zoom).subtract(O),this._zoom)}this._moved||(h._moveStart(!0,!1),this._moved=!0),ue(this._animRequest);var W=m(h._move,h,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ce(W,this,!0),vn(o)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,ue(this._animRequest),Re(document,"touchmove",this._onTouchMove,this),Re(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});lt.addInitHook("addHandler","touchZoom",Ed),lt.BoxZoom=xd,lt.DoubleClickZoom=yd,lt.Drag=_d,lt.Keyboard=vd,lt.ScrollWheelZoom=wd,lt.TapHold=Cd,lt.TouchZoom=Ed,n.Bounds=Ce,n.Browser=Be,n.CRS=mt,n.Canvas=dd,n.Circle=rs,n.CircleMarker=Si,n.Class=ne,n.Control=Ar,n.DivIcon=Vn,n.DivOverlay=Ht,n.DomEvent=zn,n.DomUtil=dt,n.Draggable=Ci,n.Evented=he,n.FeatureGroup=Ur,n.GeoJSON=u,n.GridLayer=Wr,n.Handler=nr,n.Icon=ns,n.ImageOverlay=ie,n.LatLng=Le,n.LatLngBounds=Qe,n.Layer=gn,n.LayerGroup=oi,n.LineUtil=_l,n.Map=lt,n.Marker=ir,n.Mixin=ml,n.Path=Vr,n.Point=J,n.PolyUtil=ea,n.Polygon=a,n.Polyline=r,n.Popup=Un,n.PosAnimation=Jo,n.Projection=ra,n.Rectangle=md,n.Renderer=zi,n.SVG=aa,n.SVGOverlay=it,n.TileLayer=ss,n.Tooltip=vt,n.Transformation=Ot,n.Util=Q,n.VideoOverlay=be,n.bind=m,n.bounds=Ne,n.canvas=pd,n.circle=I,n.circleMarker=gt,n.control=Ps,n.divIcon=is,n.extend=l,n.featureGroup=Hr,n.geoJSON=X,n.geoJson=ee,n.gridLayer=uu,n.icon=ia,n.imageOverlay=Ee,n.latLng=ge,n.latLngBounds=we,n.layerGroup=hr,n.map=pl,n.marker=cu,n.point=ae,n.polygon=c,n.polyline=i,n.popup=Hn,n.rectangle=ux,n.setOptions=U,n.stamp=_,n.svg=gd,n.svgOverlay=et,n.tileLayer=fd,n.tooltip=Cn,n.transformation=yt,n.version=s,n.videoOverlay=ve;var hx=window.L;n.noConflict=function(){return window.L=hx,this},window.L=n})})(jf,jf.exports);var Xo=jf.exports;const eu=sl(Xo);function tu(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function nu(e,t){return t==null?function(s,l){const f=Y.useRef();return f.current||(f.current=e(s,l)),f}:function(s,l){const f=Y.useRef();f.current||(f.current=e(s,l));const m=Y.useRef(s),{instance:v}=f.current;return Y.useEffect(function(){m.current!==s&&(t(v,s,m.current),m.current=s)},[v,s,l]),f}}function zg(e,t){Y.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var f;(f=t.layerContainer)==null||f.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Ug(e){return function(n){const s=Jc(),l=e(ed(n,s),s);return n_(s.map,n.attribution),jg(l.current,n.eventHandlers),zg(l.current,s),l}}function o_(e,t){const n=Y.useRef();Y.useEffect(function(){if(t.pathOptions!==n.current){const l=t.pathOptions??{};e.instance.setStyle(l),n.current=l}},[e,t])}function a_(e){return function(n){const s=Jc(),l=e(ed(n,s),s);return jg(l.current,n.eventHandlers),zg(l.current,s),o_(l.current,n),l}}function l_(e){function t(l,f){return tu(e(l),f)}const n=nu(t),s=s_(n);return Fg(s)}function c_(e,t){const n=nu(e,t),s=Ug(n);return Bg(s)}function u_(e,t){const n=nu(e,t),s=a_(n);return Bg(s)}function f_(e,t){const n=nu(e,t),s=Ug(n);return Fg(s)}function h_(e,t,n){const{opacity:s,zIndex:l}=t;s!=null&&s!==n.opacity&&e.setOpacity(s),l!=null&&l!==n.zIndex&&e.setZIndex(l)}function Hg(){return Jc().map}function d_(e){const t=Hg();return Y.useEffect(function(){return t.on(e),function(){t.off(e)}},[t,e]),t}const p_=l_(function(t){return new Xo.Control.Attribution(t)});function zf(){return zf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},zf.apply(this,arguments)}function g_({bounds:e,boundsOptions:t,center:n,children:s,className:l,id:f,placeholder:m,style:v,whenReady:_,zoom:x,...E},b){const[M]=Y.useState({className:l,id:f,style:v}),[F,z]=Y.useState(null);Y.useImperativeHandle(b,()=>(F==null?void 0:F.map)??null,[F]);const U=Y.useCallback(H=>{if(H!==null&&F===null){const D=new Xo.Map(H,E);n!=null&&x!=null?D.setView(n,x):e!=null&&D.fitBounds(e,t),_!=null&&D.whenReady(_),z(i_(D))}},[]);Y.useEffect(()=>()=>{F==null||F.map.remove()},[F]);const re=F?Gt.createElement(Dg,{value:F},s):m??null;return Gt.createElement("div",zf({},M,{ref:U}),re)}const m_=Y.forwardRef(g_),Jl=c_(function({position:t,...n},s){const l=new Xo.Marker(t,n);return tu(l,Lg(s,{overlayContainer:l}))},function(t,n,s){n.position!==s.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==s.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==s.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==s.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==s.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),xa=u_(function({positions:t,...n},s){const l=new Xo.Polyline(t,n);return tu(l,Lg(s,{overlayContainer:l}))},function(t,n,s){n.positions!==s.positions&&t.setLatLngs(n.positions)}),x_=f_(function({url:t,...n},s){const l=new Xo.TileLayer(t,ed(n,s));return tu(l,s)},function(t,n,s){h_(t,n,s);const{url:l}=n;l!=null&&l!==s.url&&t.setUrl(l)}),y_={},D0=e=>{let t;const n=new Set,s=(E,b)=>{const M=typeof E=="function"?E(t):E;if(!Object.is(M,t)){const F=t;t=b??(typeof M!="object"||M===null)?M:Object.assign({},t,M),n.forEach(z=>z(t,F))}},l=()=>t,_={setState:s,getState:l,getInitialState:()=>x,subscribe:E=>(n.add(E),()=>n.delete(E)),destroy:()=>{(y_?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},x=t=e(s,l,_);return _},__=e=>e?D0(e):D0;var Vg={exports:{}},Wg={},Zg={exports:{}},Gg={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wo=Y;function v_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var w_=typeof Object.is=="function"?Object.is:v_,C_=Wo.useState,E_=Wo.useEffect,b_=Wo.useLayoutEffect,S_=Wo.useDebugValue;function A_(e,t){var n=t(),s=C_({inst:{value:n,getSnapshot:t}}),l=s[0].inst,f=s[1];return b_(function(){l.value=n,l.getSnapshot=t,Fu(l)&&f({inst:l})},[e,n,t]),E_(function(){return Fu(l)&&f({inst:l}),e(function(){Fu(l)&&f({inst:l})})},[e]),S_(n),n}function Fu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!w_(e,n)}catch{return!0}}function T_(e,t){return t()}var I_=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?T_:A_;Gg.useSyncExternalStore=Wo.useSyncExternalStore!==void 0?Wo.useSyncExternalStore:I_;Zg.exports=Gg;var N_=Zg.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ru=Y,M_=N_;function R_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var k_=typeof Object.is=="function"?Object.is:R_,O_=M_.useSyncExternalStore,L_=ru.useRef,P_=ru.useEffect,D_=ru.useMemo,B_=ru.useDebugValue;Wg.useSyncExternalStoreWithSelector=function(e,t,n,s,l){var f=L_(null);if(f.current===null){var m={hasValue:!1,value:null};f.current=m}else m=f.current;f=D_(function(){function _(F){if(!x){if(x=!0,E=F,F=s(F),l!==void 0&&m.hasValue){var z=m.value;if(l(z,F))return b=z}return b=F}if(z=b,k_(E,F))return z;var U=s(F);return l!==void 0&&l(z,U)?(E=F,z):(E=F,b=U)}var x=!1,E,b,M=n===void 0?null:n;return[function(){return _(t())},M===null?void 0:function(){return _(M())}]},[t,n,s,l]);var v=O_(e,f[0],f[1]);return P_(function(){m.hasValue=!0,m.value=v},[v]),B_(v),v};Vg.exports=Wg;var F_=Vg.exports;const j_=sl(F_),Yg={},{useDebugValue:z_}=Gt,{useSyncExternalStoreWithSelector:U_}=j_;let B0=!1;const H_=e=>e;function V_(e,t=H_,n){(Yg?"production":void 0)!=="production"&&n&&!B0&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),B0=!0);const s=U_(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return z_(s),s}const F0=e=>{(Yg?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?__(e):e,n=(s,l)=>V_(t,s,l);return Object.assign(n,t),n},td=e=>e?F0(e):F0,Xg=e=>{if(typeof globalThis<"u"&&typeof globalThis.atob=="function")return globalThis.atob(e);if(typeof Buffer<"u")return Buffer.from(e,"base64").toString("utf-8");throw new Error("Base64 decoding is not supported in this environment.")},W_=e=>{const t=new Uint8Array(e.length);for(let n=0;n<e.length;n+=1)t[n]=e.charCodeAt(n);return t},Z_=e=>{const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=t.length%4===0?"":"=".repeat(4-t.length%4),s=Xg(`${t}${n}`);return W_(s)},j0=e=>Math.round(e*1e6)/1e6,z0=e=>typeof e=="number"&&Number.isFinite(e),po=e=>{if(!e||typeof e!="object")return null;const t=Number(e.lat),n=Number(e.lng);return!z0(t)||!z0(n)||t<-90||t>90||n<-180||n>180?null:{lat:j0(t),lng:j0(n)}},nl=4,ho=1e5,Rc="#38bdf8",Uf={r:"#ef4444",o:"#f97316",a:"#f59e0b",y:"#eab308",l:"#84cc16",g:"#22c55e",e:"#10b981",t:"#14b8a6",c:"#06b6d4",s:"#0ea5e9",b:"#3b82f6",i:"#6366f1",v:"#8b5cf6",p:"#a855f7",f:"#d946ef",k:"#ec4899",z:"#f43f5e",x:"#64748b",d:"#6b7280",m:"#71717a",n:"#737373",w:"#78716c",0:"#000000",1:"#ffffff"},U0=Object.entries(Uf).reduce((e,[t,n])=>(e[n]=t,e),{}),Pa=e=>{if(!e||typeof e!="object")return null;const t=typeof e.version=="number"?e.version:nl;if(t<3){let f=[],m="direct";if(t===1){m=e.connectVia==="route"?"route":"direct";const v=po(e.start),_=po(e.end),x=Array.isArray(e.checkpoints)?e.checkpoints.map(po).filter(Boolean):[];v&&f.push(v),f.push(...x),_&&f.push(_)}else m=e.connectVia==="route"?"route":"direct",f=Array.isArray(e.checkpoints)?e.checkpoints.map(po).filter(Boolean):[];return{version:3,connectVia:m,checkpoints:f,routes:[{name:"Route 1",color:"#38bdf8",indices:f.map((v,_)=>_),isVisible:!0}]}}if(t>nl)return null;const n=e.connectVia==="route"?"route":"direct",s=Array.isArray(e.checkpoints)?e.checkpoints.map(po).filter(Boolean):[],l=Array.isArray(e.routes)?e.routes.map(f=>({name:typeof f.name=="string"?f.name.slice(0,20):"Route",color:f.color===null?null:typeof f.color=="string"?f.color:Rc,indices:Array.isArray(f.indices)?f.indices.filter(m=>typeof m=="number"&&m>=0&&m<s.length):[],isVisible:typeof f.isVisible=="boolean"?f.isVisible:!0})):[];return{version:t,connectVia:n,checkpoints:s,routes:l}},G_=({checkpointMap:e,routes:t,connectVia:n,includeNames:s=!1,includeColors:l=!1})=>{const f=new Set;t.forEach(x=>{Array.isArray(x.items)&&x.items.forEach(E=>f.add(E))});const m=[],v={};Array.from(f).forEach(x=>{const E=e[x];E&&E.position&&(v[x]=m.length,m.push(E.position))});const _=t.map(x=>({name:s?x.name:"",color:l?x.color:null,isVisible:x.isVisible,indices:(x.items||[]).map(E=>v[E]).filter(E=>typeof E=="number")}));return{version:nl,connectVia:n,checkpoints:m,routes:_}},Y_=e=>{try{const t=Z_(e);if(t.length<4)return null;const n=new DataView(t.buffer,t.byteOffset,t.byteLength);let s=0;const l=n.getUint8(s);if(s+=1,l<1||l>nl)return null;if(l<3){let b="direct";const M=[];if(l===1){const F=n.getUint8(s);s+=1,b=n.getUint8(s)===1?"route":"direct",s+=1;const z=n.getUint16(s,!1);s+=2;const U=()=>{const re=n.getInt32(s,!1)/ho;s+=4;const H=n.getInt32(s,!1)/ho;return s+=4,{lat:re,lng:H}};F&1&&M.push(U());for(let re=0;re<z;re+=1)M.push(U());F&2&&M.push(U())}else{b=n.getUint8(s)===1?"route":"direct",s+=1;const F=n.getUint16(s,!1);s+=2;for(let z=0;z<F;z+=1){const U=n.getInt32(s,!1)/ho;s+=4;const re=n.getInt32(s,!1)/ho;s+=4,M.push({lat:U,lng:re})}}return{version:3,connectVia:b,checkpoints:M,routes:[{name:"Route 1",color:Rc,isVisible:!0,indices:M.map((F,z)=>z)}]}}const f=n.getUint8(s)===1?"route":"direct";s+=1;const m=n.getUint16(s,!1);s+=2;const v=n.getUint8(s);s+=1;const _=[];for(let b=0;b<m;b+=1){const M=n.getInt32(s,!1)/ho;s+=4;const F=n.getInt32(s,!1)/ho;s+=4,_.push({lat:M,lng:F})}const x=new TextDecoder,E=[];for(let b=0;b<v;b+=1)if(l===3){const M=n.getUint8(s);s+=1;const F=new Uint8Array(t.buffer,t.byteOffset+s,M),z=x.decode(F);s+=M;const U=n.getUint8(s);s+=1;const re=new Uint8Array(t.buffer,t.byteOffset+s,U),H=x.decode(re);s+=U;const D=n.getUint8(s)===1;s+=1;const B=n.getUint16(s,!1);s+=2;const $=[];for(let fe=0;fe<B;fe+=1)$.push(n.getUint16(s,!1)),s+=2;E.push({name:H,color:z,isVisible:D,indices:$})}else{const M=n.getUint8(s);s+=1;const F=new Uint8Array(t.buffer,t.byteOffset+s,M);let z=x.decode(F);s+=M,z||(z=`Route ${b+1}`);const U=n.getUint16(s,!1);s+=2;const re=[];for(let H=0;H<U;H+=1)re.push(n.getUint16(s,!1)),s+=2;E.push({name:z,color:Rc,isVisible:!0,indices:re})}return{version:l,connectVia:f,checkpoints:_,routes:E}}catch(t){return console.error(t),null}},X_=e=>{const t=e.checkpoints,n=e.routes;let s="";return n.map(l=>{const f=l.indices.map(x=>{const E=t[x];if(!E)return null;const b=nd(E,9);let M=0;if(s){const z=Math.min(s.length,b.length);for(;M<z&&s[M]===b[M];)M+=1}const F=b.slice(M);return s=b,F}).filter(x=>x!==null);if(f.length===0)return null;const m=f.join("_"),v=l.name&&l.name.trim().length>0,_=l.color&&l.color.trim().length>0;if(v||_){const x=v?encodeURIComponent(l.name).replace(/%20/g,"+"):"";let E="";if(_){const b=l.color.toLowerCase();U0[b]?E=U0[b]:b.startsWith("#")?(E=b.slice(1),E.length===6&&E[0]===E[1]&&E[2]===E[3]&&E[4]===E[5]&&(E=E[0]+E[2]+E[4])):E=encodeURIComponent(l.color)}return _?`(${x},${E})${m}`:`(${x})${m}`}return m}).filter(l=>l&&l.length>0).join(" ")},$_=e=>{if(!/^[a-z0-9_ \(\)\%\-\.\~\!\*\'\(\)\,\+]+$/i.test(e))return null;const t=e.split(/\s+/).filter(Boolean);if(t.length===0)return null;const n=[],s=[];let l="";return t.forEach((f,m)=>{let v=`Route ${m+1}`,_=Rc,x=f;const E=f.match(/^\((.*?)\)(.*)/);if(E){const F=E[1];x=E[2];const z=F.split(",");if(z.length>0&&z[0])try{v=decodeURIComponent(z[0].replace(/\+/g,"%20"))}catch{v=z[0]}if(z.length>1&&z[1]){const U=z[1];if(Uf[U])_=Uf[U];else if(/^[0-9a-f]{3,6}$/i.test(U))_=`#${U}`;else try{_=decodeURIComponent(U)}catch{_=U}}}const b=x.length===0?[""]:x.split("_"),M=[];b.forEach(F=>{let z=F;const re=9-F.length;re>0&&l.length>=re&&(z=l.slice(0,re)+F);const H=Hf(z);H&&(l=z,M.push(n.length),n.push(H))}),M.length>0&&s.push({name:v,color:_,isVisible:!0,indices:M})}),s.length===0?null:{version:nl,connectVia:"direct",checkpoints:n,routes:s}},Q_=e=>{const t=Pa(e);return t?X_(t):""},K_=e=>{if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const n=Y_(t);if(n)return Pa(n);const s=$_(t);if(s)return Pa(s);try{const l=JSON.parse(Xg(t));return Pa(l)}catch{return null}},$g="0123456789bcdefghjkmnpqrstuvwxyz",Da=[16,8,4,2,1],nd=(e,t=9)=>{if(typeof t!="number"||t<1||t>12)throw new Error("encodeLocationCode precision must be between 1 and 12.");const n=po(e);if(!n)return null;let s=-90,l=90,f=-180,m=180,v=!0,_=0,x=0,E="";for(;E.length<t;){if(v){const b=(f+m)/2;n.lng>=b?(x|=Da[_],f=b):m=b}else{const b=(s+l)/2;n.lat>=b?(x|=Da[_],s=b):l=b}v=!v,_<Da.length-1?_+=1:(E+=$g[x],_=0,x=0)}return E},Hf=e=>{if(typeof e!="string"||e.length===0)return null;let t=-90,n=90,s=-180,l=180,f=!0;for(let m=0;m<e.length;m+=1){const v=e[m].toLowerCase(),_=$g.indexOf(v);if(_===-1)return null;for(let x=0;x<Da.length;x+=1){const E=Da[x];if(f){const b=(s+l)/2;_&E?s=b:l=b}else{const b=(t+n)/2;_&E?t=b:n=b}f=!f}}return{lat:(t+n)/2,lng:(s+l)/2}},ya=e=>`${e}-${Math.random().toString(36).slice(2,9)}`,Vf="#38bdf8",Po={checkpointMap:{},routes:[{id:"route-1",name:"Route 1",color:Vf,items:[],isVisible:!0,nextLabelIndex:1}],activeRouteId:"route-1",selectedId:null,connectVia:"direct",placementMode:null},H0=e=>e==null?null:typeof e=="string"?{type:e}:typeof e=="object"&&typeof e.type=="string"?e:null,q_=td((e,t)=>({...Po,addRoute:(n="New Route",s=Vf)=>e(l=>{const f={id:ya("route"),name:n,color:s,items:[],isVisible:!0,nextLabelIndex:1};return{routes:[...l.routes,f],activeRouteId:f.id}}),removeRoute:n=>e(s=>{if(s.routes.length<=1)return s;const l=s.routes.filter(_=>_.id!==n),f=s.activeRouteId===n?l[0].id:s.activeRouteId,m=new Set(l.flatMap(_=>_.items)),v={};return Object.values(s.checkpointMap).forEach(_=>{m.has(_.id)&&(v[_.id]=_)}),{routes:l,activeRouteId:f,checkpointMap:v,selectedId:s.selectedId}}),setActiveRoute:n=>e(s=>({activeRouteId:s.routes.find(l=>l.id===n)?n:s.activeRouteId})),updateRoute:(n,s)=>e(l=>({routes:l.routes.map(f=>f.id===n?{...f,...s}:f)})),setPlacementMode:n=>e(s=>{const l=H0(n);if(!l)return{placementMode:null};const f=H0(s.placementMode);return(f==null?void 0:f.type)===l.type&&((f==null?void 0:f.insertIndex)??null)===((l==null?void 0:l.insertIndex)??null)?{placementMode:null}:{placementMode:l}}),toggleConnectMode:()=>e(n=>({connectVia:n.connectVia==="direct"?"route":"direct"})),addCheckpoint:(n,s)=>e(l=>{var M;const f=l.routes.find(F=>F.id===l.activeRouteId);if(!f)return l;const m=typeof f.nextLabelIndex=="number"?f.nextLabelIndex:(((M=f.items)==null?void 0:M.length)??0)+1,v={id:ya("checkpoint"),position:n,name:`Point ${m}`},_={...l.checkpointMap,[v.id]:v},x=[...f.items];typeof s=="number"&&s>=0&&s<=x.length?x.splice(s,0,v.id):x.push(v.id);const E={...f,items:x,nextLabelIndex:m+1},b=l.routes.map(F=>F.id===l.activeRouteId?E:F);return{checkpointMap:_,routes:b,placementMode:null,selectedId:v.id}}),selectCheckpoint:n=>e({selectedId:n}),updateCheckpoint:(n,s)=>e(l=>({checkpointMap:{...l.checkpointMap,[n]:{...l.checkpointMap[n],position:s}}})),moveCheckpoint:(n,s)=>e(l=>{const f=l.routes.find(_=>_.id===l.activeRouteId);if(!f)return l;const m=f.items.indexOf(n);if(m===-1||typeof s!="number")return l;const v=[...f.items];return s<0||s>=v.length||s===m?l:(v.splice(m,1),v.splice(s,0,n),{routes:l.routes.map(_=>_.id===l.activeRouteId?{..._,items:v}:_)})}),removeCheckpoint:n=>e(s=>{const l=s.routes.find(x=>x.id===s.activeRouteId);if(!l)return s;const f=l.items.includes(n);let m=s.routes;f?m=s.routes.map(x=>x.id===s.activeRouteId?{...x,items:x.items.filter(E=>E!==n)}:x):m=s.routes.map(x=>({...x,items:x.items.filter(E=>E!==n)}));const v=new Set(m.flatMap(x=>x.items)),_={};return Object.values(s.checkpointMap).forEach(x=>{v.has(x.id)&&(_[x.id]=x)}),{routes:m,checkpointMap:_,selectedId:s.selectedId===n?null:s.selectedId,placementMode:null}}),loadRouteSnapshot:n=>e(s=>{const l=Pa(n);if(!l)return s;const f={},v=(l.checkpoints||[]).map((x,E)=>{const b=ya("checkpoint");return f[b]={id:b,position:x,name:`Point ${E+1}`},b}),_=l.routes.map(x=>{const E=x.indices.map(b=>v[b]).filter(Boolean);return{id:ya("route"),name:x.name,color:x.color,isVisible:x.isVisible,items:E,nextLabelIndex:E.length+1}});if(_.length===0){const x=ya("route");_.push({id:x,name:"Route 1",color:Vf,items:v,isVisible:!0,nextLabelIndex:v.length+1})}return{...Po,connectVia:l.connectVia,checkpointMap:f,routes:_,activeRouteId:_[0].id,selectedId:null,placementMode:null}}),clearAll:()=>e(Po),swapCheckpoints:(n,s)=>e(l=>{const f=l.routes.find(x=>x.id===l.activeRouteId);if(!f)return l;const m=f.items.indexOf(n),v=f.items.indexOf(s);if(m===-1||v===-1)return l;const _=[...f.items];return _[m]=s,_[v]=n,{routes:l.routes.map(x=>x.id===l.activeRouteId?{...x,items:_}:x)}})})),$o=()=>q_(e=>{const t=Array.isArray(e.routes)?e.routes:Po.routes,n=e.checkpointMap||Po.checkpointMap,s=e.activeRouteId||Po.activeRouteId,l=t.find(m=>m.id===s)||t[0],f=l?l.items.map(m=>n[m]).filter(Boolean):[];return{...e,routes:t,checkpointMap:n,activeRouteId:s,checkpoints:f,activeRoute:l}}),J_=({onDropItem:e})=>{const t=Hg();return Y.useEffect(()=>{if(!e)return;const n=t.getContainer(),s=m=>{m.preventDefault(),m.dataTransfer.dropEffect="copy"},l=m=>{m.preventDefault(),m.dataTransfer.dropEffect="copy"},f=m=>{m.preventDefault(),m.stopPropagation();const{clientX:v,clientY:_}=m,x=n.getBoundingClientRect(),E=v-x.left,b=_-x.top,M=t.containerPointToLatLng([E,b]),F=m.dataTransfer.getData("application/x-cadet-map-item");F&&e(F,M)};return n.addEventListener("dragenter",s),n.addEventListener("dragover",l),n.addEventListener("drop",f),()=>{n.removeEventListener("dragenter",s),n.removeEventListener("dragover",l),n.removeEventListener("drop",f)}},[t,e]),null},ev=Object.assign({"../../assets/compass.png":Qy,"../../assets/layer.png":Ky,"../../assets/menu.png":qy,"../../assets/route.png":Jy,"../../assets/settings.png":e_,"../../assets/zoom.png":t_}),tv=e=>ev[`../../assets/${e}.png`]??null,_a=({iconName:e,label:t,onClick:n,title:s,isActive:l=!1,disabled:f=!1,themeStyles:m})=>{const v=tv(e),_=(m==null?void 0:m.button)??{},x=_.base??"flex h-12 w-12 items-center justify-center rounded-2xl border transition-colors duration-150 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2",E=_.active??"border-sky-500 bg-sky-200 text-slate-900 focus-visible:ring-sky-400",b=_.idle??"border-slate-300 bg-slate-100 text-slate-900 hover:border-slate-400 hover:bg-slate-200 focus-visible:ring-slate-500/50",M=f?_.disabled??"opacity-60 pointer-events-none":"",F=(m==null?void 0:m.iconStyle)??null,z=(m==null?void 0:m.iconClass)??"";return T.jsx("button",{type:"button",className:`${x} ${l?E:b} ${M}`,onClick:n,title:s??t,"aria-label":t,disabled:f,children:v?T.jsx("img",{src:v,alt:"",className:`h-5 w-5 object-contain select-none ${z}`,style:F??void 0,"aria-hidden":"true",draggable:"false"}):T.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-wide",children:t})})},nv=[51.505,10],ju={street:{id:"street",label:"OpenStreetMap Standard",description:"Balanced street map with global coverage sourced from the OpenStreetMap community.",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',subdomains:["a","b","c"],maxZoom:19,minZoom:3,category:"Streets"},light:{id:"light",label:"Carto Light",description:"Soft grayscale basemap designed for daylight navigation with minimal visual noise.",url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://carto.com/attributions">CARTO</a> | Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',subdomains:["a","b","c","d"],maxZoom:19,minZoom:3,category:"Streets"},dark:{id:"dark",label:"Carto Dark Matter",description:"Night-friendly basemap with high contrast roads and landmarks on a deep navy canvas.",url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://carto.com/attributions">CARTO</a> | Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',subdomains:["a","b","c","d"],maxZoom:19,minZoom:3,category:"Streets"},voyager:{id:"voyager",label:"Carto Voyager",description:"Colorful, detail-rich cartography ideal for orientation and wayfinding at multiple zoom levels.",url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://carto.com/attributions">CARTO</a> | Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',subdomains:["a","b","c","d"],maxZoom:19,minZoom:3,category:"Streets"},hot:{id:"hot",label:"OSM Humanitarian",description:"Humanitarian OpenStreetMap Team basemap with emphasis on populated areas and infrastructure.",url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="https://www.hotosm.org/">Humanitarian OpenStreetMap Team</a>',subdomains:["a","b","c"],maxZoom:19,minZoom:3,category:"Streets"},topo:{id:"topo",label:"OpenTopoMap",description:"Topographic map derived from OSM data with contour lines and terrain shading.",url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors | SRTM | <a href="https://opentopomap.org">OpenTopoMap</a>',subdomains:["a","b","c"],maxZoom:17,minZoom:3,category:"Outdoor"},satellite:{id:"satellite",label:"Esri World Imagery",description:"High-resolution satellite and aerial imagery from Esri and the GIS user community.",url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Imagery &copy; Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",subdomains:[],maxZoom:19,minZoom:3,category:"Imagery"}},rv=["street","light","dark","voyager","hot","topo","satellite"],V0={light:{container:"pointer-events-auto flex flex-col gap-2 rounded-3xl border border-slate-200 bg-slate-100 p-2 text-slate-900 backdrop-blur-sm",badge:"rounded-full border border-slate-300 bg-slate-100 px-3 py-1 text-[10px] font-semibold text-slate-700",button:{base:"flex h-12 w-12 items-center justify-center rounded-2xl border transition-colors duration-150 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-slate-400/40 focus-visible:ring-offset-slate-100/60",active:"border-sky-500 bg-sky-200 text-slate-900",idle:"border-slate-300 bg-slate-100 text-slate-900 hover:border-slate-400 hover:bg-slate-200",disabled:"opacity-60 pointer-events-none"},panel:"pointer-events-auto w-60 rounded-3xl border border-slate-200 bg-slate-100 p-4 text-slate-900 backdrop-blur-md",panelTitle:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",panelButton:"rounded-xl border border-slate-300 bg-white px-3 py-1.5 text-[12px] font-semibold text-slate-900 transition hover:border-sky-400 hover:bg-sky-100",panelToggle:"rounded-xl border border-slate-300 bg-slate-100 px-3 py-1.5 text-[12px] font-semibold text-slate-900 transition hover:border-sky-400 hover:bg-sky-100",layerScroll:"flex max-h-60 flex-col gap-2 overflow-y-auto pr-1",layerOption:"flex flex-col gap-1 rounded-2xl border border-slate-300 bg-white px-3 py-2 text-left transition hover:border-sky-400 hover:bg-sky-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-400/40",layerOptionActive:"border-sky-500 bg-sky-100 text-slate-900 shadow-inner shadow-sky-200/60",layerOptionDescription:"text-[11px] text-slate-500 leading-snug",layerOptionCategory:"text-[10px] font-semibold uppercase tracking-wide text-slate-400",iconStyle:null,iconClass:""},dark:{container:"pointer-events-auto flex flex-col gap-2 rounded-3xl border border-slate-700 bg-[#0b1224] p-2 text-slate-100 backdrop-blur-sm",badge:"rounded-full border border-slate-600 bg-[#0f1b38] px-3 py-1 text-[10px] font-semibold text-slate-200",button:{base:"flex h-12 w-12 items-center justify-center rounded-2xl border transition-colors duration-150 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-slate-200/30 focus-visible:ring-offset-[#0b1224]/40",active:"border-sky-400 bg-[#1e335d] text-sky-100",idle:"border-slate-600 bg-[#0d172e] text-slate-100 hover:border-slate-400 hover:bg-[#15213f]",disabled:"opacity-50 pointer-events-none"},panel:"pointer-events-auto w-60 rounded-3xl border border-slate-700 bg-[#080f1e] p-4 text-slate-100 backdrop-blur-md",panelTitle:"text-[11px] font-semibold uppercase tracking-wide text-slate-400",panelButton:"rounded-xl border border-slate-600 bg-[#111b33] px-3 py-1.5 text-[12px] font-semibold text-slate-100 transition hover:border-sky-400 hover:bg-[#1d2b4e]",panelToggle:"rounded-xl border border-slate-500 bg-[#0f1b38] px-3 py-1.5 text-[12px] font-semibold text-slate-100 transition hover:border-sky-400 hover:bg-[#1a2a4d]",layerScroll:"flex max-h-60 flex-col gap-2 overflow-y-auto pr-1",layerOption:"flex flex-col gap-1 rounded-2xl border border-slate-600 bg-[#101d39] px-3 py-2 text-left transition hover:border-sky-400 hover:bg-[#16254a] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-200/30",layerOptionActive:"border-sky-400 bg-[#1e335d] text-sky-100 shadow-inner shadow-sky-900/40",layerOptionDescription:"text-[11px] text-slate-300 leading-snug",layerOptionCategory:"text-[10px] font-semibold uppercase tracking-wide text-slate-400/90",iconStyle:{filter:"invert(0.9)"},iconClass:""}},iv=6,sv=[{id:"getting-started",title:"Getting started",description:"Allow location access, pick an active route, then use placement or grid tools to build precise checkpoint lists.",points:['Use the Route tab to manage multiple routes. Click "Add New Route" to start fresh, rename it, and choose a colour for quick identification.','Tap "Add Checkpoint" inside a route to enter placement mode. Drop the route-coloured puck onto the map or a Grid Tool preview marker to add that position.','Share progress from the Route tools: copy codes for a single route or use "All Routes" to export the full plan.']},{id:"toolbar",title:"Toolbar buttons",description:"Each button in the floating toolbar opens a tool. The Menu button mirrors these shortcuts, so every tool is reachable even when the bar is hidden.",points:["Menu toggles quick actions for Compass, Route, Grid, and Share tools without leaving the map.","Compass opens the heading overlay. Select a target route to get bearings and switch between degrees or mils.","Route opens the checkpoint manager where you can reorder points, adjust colours, and generate share codes."]},{id:"maps",title:"Choosing maps",description:"Different base layers emphasise different features. Pick the layer that best supports the task at hand.",points:["OpenStreetMap Street is the fallback layer and works reliably online or with low mobile reception.","Carto Light or Dark provide high-contrast styling that is easier to read in bright sun or at night.","OpenTopoMap is ideal for land navigation where contours and terrain shading matter.","Esri Satellite is ideal when you need to see real details, but is heavy on mobile data."]}],ov=(e,t,n)=>{const s=e*Math.PI/180,l=2**n,f=Math.floor((t+180)/360*l),m=Math.floor((1-Math.log(Math.tan(s)+1/Math.cos(s))/Math.PI)/2*l),v=l-1;return{x:Math.min(Math.max(f,0),v),y:Math.min(Math.max(m,0),v),z:n}},av=(e,t,{x:n,y:s,z:l})=>{const f=Array.isArray(t)&&t.length>0?t:[""],m=Math.abs((n+s)%f.length),v=f[m];return e.replace("{s}",v).replace("{x}",n).replace("{y}",s).replace("{z}",l)},fl=(e,t)=>eu.divIcon({className:"flex items-center justify-center rounded-full text-xs font-semibold text-white shadow-lg shadow-slate-900/50",html:`<div style="background:${e};width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:9999px;">${t}</div>`});fl("#22c55e","S");fl("#ef4444","F");fl("#3b82f6","");const lv=fl("#d946ef",""),cv=e=>eu.divIcon({className:"user-heading-icon",html:`
      <div style="position:relative;width:44px;height:44px;">
        <div style="position:absolute;inset:0;border-radius:50%;background:rgba(14,165,233,0.12);border:2px solid rgba(56,189,248,0.9);box-shadow:0 0 8px rgba(56,189,248,0.4);"></div>
        <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(${e}deg);transform-origin:center;">
          <div style="width:0;height:0;border-left:7px solid transparent;border-right:7px solid transparent;border-bottom:18px solid #fbbf24;"></div>
        </div>
      </div>
    `,iconSize:[44,44],iconAnchor:[22,22]}),uv=(e="#22c55e")=>eu.divIcon({className:"peer-icon",html:`
      <div style="position:relative;width:32px;height:32px;">
        <div style="position:absolute;inset:0;border-radius:50%;background:${e}33;border:2px solid ${e}E6;box-shadow:0 0 8px ${e}66;"></div>
        <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:10px;height:10px;background:${e};border-radius:50%;"></div>
      </div>
    `,iconSize:[32,32],iconAnchor:[16,16]}),fv=()=>{const{placementMode:e,addCheckpoint:t,setPlacementMode:n}=$o();return d_({click:s=>{if(!e)return;const l=typeof e=="string"?{type:e}:e;if(!(l!=null&&l.type))return;const{latlng:f}=s;if(l.type==="checkpoint"){const m=typeof l.insertIndex=="number"?l.insertIndex:void 0;t({lat:f.lat,lng:f.lng},m)}n(null)}}),null},Qg=Y.memo(({id:e,position:t,icon:n,onSelect:s,onUpdate:l})=>{const f=Y.useRef(null),m=Y.useMemo(()=>({click:()=>s(e),dragend:()=>{const _=f.current;if(_){const{lat:x,lng:E}=_.getLatLng();l(e,{lat:x,lng:E})}}}),[e,s,l]),v=Y.useMemo(()=>[t.lat,t.lng],[t]);return T.jsx(Jl,{draggable:!0,eventHandlers:m,position:v,icon:n,ref:f})});Qg.displayName="DraggableMarker";const hv=({userLocation:e,peers:t={},userHeading:n,targets:s=[],onEnableLocation:l,locationEnabled:f,hasLocationFix:m,isRequestingLocation:v,locationRequestToken:_=0,baseLayer:x="street",onBaseLayerChange:E,onToggleMenu:b,onOpenCompass:M,onOpenRoute:F,toolbarTheme:z="light",onToolbarThemeToggle:U,isMenuOpen:re=!1,isSettingsOpen:H=!1,onToggleSettings:D,previewLocation:B,onDropItem:$,hideToolbar:fe=!1})=>{const{checkpoints:pe,checkpointMap:K,routes:q,activeRouteId:V,connectVia:le,selectedId:ce,selectCheckpoint:ue,updateCheckpoint:Q,setPlacementMode:ne,toggleConnectMode:Z,loadRouteSnapshot:ye,placementMode:he,addCheckpoint:J}=$o(),de=Y.useRef(null),ae=Y.useRef(!1),Ce=Y.useRef(0),[Ne,Qe]=Y.useState(null),[we,Le]=Y.useState(!1),[ge,mt]=Y.useState(!1),[He,Bn]=Y.useState(!1),[Fn,Ot]=Y.useState(null),[yt,$e]=Y.useState("settings"),[Sn,Xt]=Y.useState(0),[Rn,Oe]=Y.useState(null),[We,Xe]=Y.useState(""),[$t,Te]=Y.useState(null),[Lt,ki]=Y.useState(!1),[hn,Oi]=Y.useState(!1),[Ct,gi]=Y.useState(""),[Qn,Pt]=Y.useState("checkpoint"),[Kn,An]=Y.useState(null),jn=Y.useRef(null),wt=Y.useRef(0),Ae=Y.useRef(null),Ie=Y.useRef(null),Me=Y.useRef(null),Ve=Y.useRef(null),It=Y.useRef(null),Dt=ju[x]??ju.street,Ge=V0[z]??V0.light,ft=z==="dark"?"map-theme-dark":"map-theme-light",Dr=e?[e.lat,e.lng]:nv,io=e?"user-centered":"default-centered",_n=Y.useCallback(()=>{de.current&&de.current.invalidateSize({animate:!1})},[]),qn=Y.useMemo(()=>rv.map(P=>ju[P]).filter(Boolean),[]),Rs=Y.useMemo(()=>({top:"calc(env(safe-area-inset-top, 0px) + 1rem)",right:"calc(env(safe-area-inset-right, 0px) + 1rem)"}),[]),[Qt,mi]=Y.useState("all"),vr=Y.useMemo(()=>Qt==="all"?q:q.filter(P=>P.id===Qt),[q,Qt]),jt=Y.useMemo(()=>G_({checkpointMap:K,routes:vr,connectVia:le,includeNames:Lt,includeColors:hn}),[K,vr,le,Lt,hn]),Li=Y.useMemo(()=>jt?Q_(jt):"",[jt]),Br=Y.useMemo(()=>{if(!jt)return null;const P=[];jt.checkpoints.length>0&&P.push(`${jt.checkpoints.length} checkpoint${jt.checkpoints.length===1?"":"s"}`),jt.routes&&jt.routes.length>0&&P.push(`${jt.routes.length} route${jt.routes.length===1?"":"s"}`);const R=P.length?`Includes ${P.join(", ")}. `:"";return Lt&&hn?`${R}Compact text format (connection mode excluded).`:Lt?`${R}Compact text format (connection mode & colors excluded).`:hn?`${R}Compact text format (names & connection mode excluded).`:`${R}Compact text format (names, connection mode & colors excluded).`},[jt,Lt,hn]),xi=!!Li,Nt=Y.useMemo(()=>vr.map(P=>{const R=P.items.map((me,rt)=>{const zt=K[me];return zt?{key:`${P.id}-${zt.id}`,label:zt.name||`Point ${rt+1}`,code:nd(zt.position),position:zt.position}:null}).filter(Boolean);return R.length===0?null:{route:P.name,color:P.color,codes:R}}).filter(Boolean),[vr,K]),Be=Y.useCallback(P=>P==="success"?"text-emerald-500":P==="error"?"text-rose-500":P==="warning"?"text-amber-500":"text-slate-500",[]),dn=Y.useCallback((P,R,me=2500)=>{Me.current&&typeof window<"u"&&(window.clearTimeout(Me.current),Me.current=null),Oe(R?{tone:P,message:R}:null),R&&me!==null&&typeof window<"u"&&(Me.current=window.setTimeout(()=>{Oe(null),Me.current=null},me))},[Oe,Me]),ke=Y.useCallback((P,R,me=4e3)=>{Ve.current&&typeof window<"u"&&(window.clearTimeout(Ve.current),Ve.current=null),Te(R?{tone:P,message:R}:null),R&&me!==null&&typeof window<"u"&&(Ve.current=window.setTimeout(()=>{Te(null),An(null),Ve.current=null},me))},[Te,Ve]),qr=Y.useCallback(async()=>{var P;if(!xi){dn("warning","Define a route to generate a share code.",3200);return}try{let R=!1;if(typeof navigator<"u"&&((P=navigator.clipboard)!=null&&P.writeText))await navigator.clipboard.writeText(Li),R=!0;else if(typeof document<"u"&&Ie.current){const me=Ie.current;me.focus(),me.select(),typeof me.setSelectionRange=="function"&&me.setSelectionRange(0,Li.length),R=!!(typeof document.execCommand=="function"&&document.execCommand("copy"))}if(!R)throw new Error("Copy not supported");dn("success","Share code copied to clipboard.",2500)}catch(R){dn("error",R!=null&&R.message&&R.message!=="Copy not supported"?R.message:"Copy failed. Try selecting and copying the code manually.",4e3)}},[xi,Li,dn]),yi=Y.useCallback(()=>{const P=We.trim();if(!P){ke("warning","Paste a share code to import.",3500);return}const R=K_(P);if(!R){ke("error","That share code could not be read. Check the full code and try again.",4e3);return}ye(R),Xe(""),ke("success","Route imported. Close this panel to review it on the map.",4e3)},[ye,We,ke]),pn=Y.useCallback(P=>{Ve.current&&typeof window<"u"&&(window.clearTimeout(Ve.current),Ve.current=null),Xe(P.target.value),Te(null)},[Te,Xe,Ve]),Jr=Y.useCallback(P=>{(P.ctrlKey||P.metaKey)&&P.key==="Enter"&&(P.preventDefault(),yi())},[yi]);Y.useEffect(()=>{yt!=="share"&&(Oe(null),Te(null),Me.current&&typeof window<"u"&&(window.clearTimeout(Me.current),Me.current=null),Ve.current&&typeof window<"u"&&(window.clearTimeout(Ve.current),Ve.current=null))},[yt]);const kn=Y.useMemo(()=>z==="light"?"border border-slate-300 bg-white text-slate-900 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-400":"border border-slate-700 bg-slate-950 text-slate-100 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-500",[z]),ei=Y.useMemo(()=>{if(!he)return null;const P=typeof he=="string"?{type:he}:he;return P!=null&&P.type?P.type==="start"?"Start point":P.type==="end"?"End point":P.type==="checkpoint"?typeof P.insertIndex=="number"?`Checkpoint (position ${P.insertIndex+1})`:"Checkpoint":null:null},[he]),Jn=Y.useMemo(()=>ei?[{key:"placement",text:`Currently placing: ${ei}`,tone:"emerald"}]:[],[ei]),sn=Y.useCallback((P,R="info",me=4e3)=>{jn.current&&typeof window<"u"&&(window.clearTimeout(jn.current),jn.current=null),Qe(P?{message:P,tone:R}:null),P&&me!==null&&typeof window<"u"&&(jn.current=window.setTimeout(()=>{Qe(null),jn.current=null},me))},[]);Y.useEffect(()=>{eu.Icon.Default.mergeOptions({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"})},[]),Y.useEffect(()=>{Ot(null),sn(null),Le(!1),wt.current=0,Xt(P=>P+1)},[x,sn]),Y.useEffect(()=>{re&&$e("settings")},[re,$e]),Y.useEffect(()=>{if(!ge||typeof window>"u")return;const P=()=>{window.requestAnimationFrame(_n)};return window.requestAnimationFrame(_n),window.addEventListener("resize",P,{passive:!0}),window.addEventListener("orientationchange",P,{passive:!0}),()=>{window.removeEventListener("resize",P),window.removeEventListener("orientationchange",P)}},[ge,_n]),Y.useEffect(()=>{var me;if(!ge||typeof ResizeObserver>"u")return;const P=(me=de.current)==null?void 0:me.getContainer();if(!P)return;const R=new ResizeObserver(()=>{typeof window<"u"?window.requestAnimationFrame(_n):_n()});return R.observe(P),()=>R.disconnect()},[ge,_n]),Y.useEffect(()=>{ge&&_n()},[ge,_n,z,H,re,x]),Y.useEffect(()=>{!de.current||!e||ae.current||(de.current.setView([e.lat,e.lng],16),ae.current=!0)},[e]),Y.useEffect(()=>{Ae.current=e},[e]),Y.useEffect(()=>{if(!de.current)return;ae.current=!1,_n();const P=Ae.current;P&&(de.current.flyTo([P.lat,P.lng],Math.max(de.current.getZoom(),16),{animate:!1}),ae.current=!0)},[x,_n]),Y.useEffect(()=>{de.current&&(_===void 0||_===Ce.current||(Ce.current=_,ae.current=!1,e&&(de.current.flyTo([e.lat,e.lng],Math.max(de.current.getZoom(),16),{animate:!0}),ae.current=!0)))},[_,e]);const Qo=Y.useMemo(()=>cv(n??0),[n]),er=Y.useCallback(()=>{if(!de.current)return;const P=Ae.current??e;if(!P)return;const R=de.current;_n();const me=Math.max(R.getZoom(),16);R.flyTo([P.lat,P.lng],me,{animate:!0}),ae.current=!0},[_n,e]);Y.useEffect(()=>()=>{de.current&&(de.current.getContainer().classList.remove("mapview-attribution-offset"),de.current=null)},[]),Y.useEffect(()=>()=>{jn.current&&typeof window<"u"&&window.clearTimeout(jn.current),Me.current&&typeof window<"u"&&window.clearTimeout(Me.current),Ve.current&&typeof window<"u"&&window.clearTimeout(Ve.current),It.current&&typeof window<"u"&&window.clearTimeout(It.current)},[]);const on=Y.useCallback(()=>typeof l=="function"?l():!1,[l]),Mt=Y.useCallback(()=>{typeof b=="function"&&b()},[b]),Pi=Y.useCallback(()=>{typeof M=="function"&&M()},[M]),Fr=Y.useCallback(()=>{typeof F=="function"&&F()},[F]),ks=Y.useCallback(P=>{P!==x&&typeof E=="function"&&E(P)},[x,E]),xe=Y.useCallback((P,R,me=3500)=>{It.current&&typeof window<"u"&&(window.clearTimeout(It.current),It.current=null),An(R?{tone:P,message:R}:null),R&&me!==null&&typeof window<"u"&&(It.current=window.setTimeout(()=>{An(null),It.current=null},me))},[An,It]),Ko=Y.useCallback(async()=>{if(!ge||!de.current){sn("Map not ready yet.","warning");return}if(x!=="satellite"){sn("Switch to satellite view to cache imagery.","warning");return}if(typeof window>"u"||!("caches"in window)){sn("Tile caching not supported in this browser.","error");return}const P=de.current,R=Math.round(P.getZoom()),me=2**R,rt=[];if(e&&rt.push(e),pe.forEach(Pe=>{Pe!=null&&Pe.position&&rt.push(Pe.position)}),rt.length===0){sn("Add a checkpoint or enable location before caching.","warning");return}const wi=40075016686e-3/me,ti=new Set;if(rt.forEach(Pe=>{const ht=ov(Pe.lat,Pe.lng,R),Tn=Pe.lat*Math.PI/180,wr=Math.cos(Tn)||1e-4,Cr=wi*wr,Er=wi,fr=Math.max(1,Math.ceil(2e3/Cr)),ni=Math.max(1,Math.ceil(2e3/Er));for(let dt=-fr;dt<=fr;dt+=1)for(let Ye=-ni;Ye<=ni;Ye+=1){const cn=Math.min(Math.max(ht.x+dt,0),me-1),Re=Math.min(Math.max(ht.y+Ye,0),me-1);ti.add(`${cn}:${Re}:${R}`)}}),ti.size===0){sn("No tiles identified for caching.","warning");return}const ln=Array.from(ti).map(Pe=>{const[ht,Tn,wr]=Pe.split(":").map(Cr=>Number(Cr));return{x:ht,y:Tn,z:wr}});try{Le(!0),sn("Caching satellite tiles nearby","info",null);const Pe=await caches.open("cadet-map-tile-cache");let ht=0;const Tn=[],wr=[...ln],Cr=Math.min(iv,wr.length),Er=async()=>{for(;wr.length>0;){const fr=wr.shift();if(!fr)continue;const ni=av(Dt.url,Dt.subdomains,fr);try{const dt=await fetch(ni,{mode:"cors"});if(!dt.ok&&dt.type!=="opaque")throw new Error(`HTTP ${dt.status}`);await Pe.put(ni,dt.clone()),ht+=1}catch(dt){Tn.push((dt==null?void 0:dt.message)??"Unknown error")}await new Promise(dt=>{if(typeof window>"u"){dt();return}window.requestAnimationFrame(dt)})}};if(await Promise.all(Array.from({length:Cr},Er)),Tn.length===ln.length)sn("Unable to cache tiles. Please try again later.","error");else{const fr=Tn.length?` (skipped ${Tn.length} tile${Tn.length===1?"":"s"})`:"";sn(`Cached ${ht} satellite tile${ht===1?"":"s"}${fr}.`,Tn.length?"warning":"success")}}catch(Pe){sn(Pe.message??"Tile caching failed.","error")}finally{Le(!1)}},[x,pe,ge,sn,Dt.subdomains,Dt.url,e]),Bt=Y.useCallback(()=>{typeof D=="function"&&D(),$e("settings")},[D]),jr=Y.useCallback(()=>{$e("help"),!H&&typeof D=="function"&&D()},[H,D]),_i=Y.useCallback(()=>{!H&&typeof D=="function"&&D(),$e("share")},[H,D]),pt=Y.useCallback(()=>{typeof U=="function"&&U()},[U]),at=Y.useCallback(()=>{if(e){er(),H&&typeof D=="function"&&D(),$e("settings");return}on()?sn("Requesting location fix","info",2500):sn("Enable location permissions to center the map.","warning")},[on,er,H,D,sn,e]),qe=x!=="satellite"||we,st=we?"Caching":x!=="satellite"?"Satellite required":"Cache tiles",bt=Y.useMemo(()=>({loading:()=>{wt.current=0},load:()=>{_n()},tileerror:()=>{if(wt.current+=1,wt.current>=3){wt.current=0;const P="Selected map unavailable";sn(P,"warning",6e3),Ot(P),x!=="street"&&typeof E=="function"?E("street"):Xt(R=>R+1)}}}),[x,E,_n,Xt,sn]),vi=Y.useCallback(P=>{const R=P.target.value.replace(/\s+/g,"").toLowerCase();gi(R),An(null),It.current&&typeof window<"u"&&(window.clearTimeout(It.current),It.current=null)},[]),Rt=Y.useCallback(P=>{Pt(P.target.value)},[]),On=Y.useCallback(()=>{const P=Ct.trim().toLowerCase();if(!P){xe("warning","Enter a callout code to place it.");return}if(P.length<4||P.length>12){xe("error","Callouts should be between 4 and 12 characters.");return}const R=Hf(P);if(!R){xe("error","That code could not be decoded. Double-check the letters.");return}J(R),xe("success","Checkpoint added from callout.",3e3),gi("")},[J,Hf,Ct,xe]),Os=Y.useMemo(()=>`${Ge.panelToggle} ${yt==="settings"?"ring-1 ring-sky-400 text-sky-500 border-sky-400":"opacity-80 hover:opacity-100"}`,[yt,Ge.panelToggle]),ze=Y.useMemo(()=>`${Ge.panelToggle} ${yt==="share"?"ring-1 ring-sky-400 text-sky-500 border-sky-400":"opacity-80 hover:opacity-100"}`,[yt,Ge.panelToggle]),_t=Y.useMemo(()=>`${Ge.panelToggle} ${yt==="help"?"ring-1 ring-sky-400 text-sky-500 border-sky-400":"opacity-80 hover:opacity-100"}`,[yt,Ge.panelToggle]),Ls=Y.useMemo(()=>{const P={};return q.filter(R=>R.isVisible).forEach(R=>{var me;(me=R.items)==null||me.forEach(rt=>{(!P[rt]||R.id===V)&&(P[rt]={checkpoint:K[rt],color:R.color,routeId:R.id})})}),Object.values(P).filter(R=>R.checkpoint)},[q,K,V]),tr=Y.useRef(new Map),nt=Y.useCallback(P=>(tr.current.has(P)||tr.current.set(P,fl(P,"")),tr.current.get(P)),[]),an=Y.useMemo(()=>q.filter(P=>P.isVisible).map(P=>{const R=(P.items||[]).map(me=>{var rt;return(rt=K[me])==null?void 0:rt.position}).filter(Boolean).map(me=>[me.lat,me.lng]);return{id:P.id,color:P.color,positions:R}}),[q,K]);return T.jsxs("div",{className:"relative h-full w-full flex-1",children:[T.jsxs(m_,{center:Dr,zoom:13,className:`h-full w-full ${ft}`,preferCanvas:!0,ref:de,attributionControl:!1,whenCreated:P=>{P.getContainer().classList.add("mapview-attribution-offset")},children:[T.jsx(J_,{onDropItem:$}),T.jsx(p_,{position:"bottomleft",prefix:!1}),T.jsx(x_,{url:Dt.url,attribution:Dt.attribution,subdomains:Dt.subdomains,minZoom:Dt.minZoom,maxZoom:Dt.maxZoom,maxNativeZoom:He?16:void 0,eventHandlers:bt},`${Dt.id}-${Sn}-${He}`),T.jsx(fv,{}),e&&T.jsx(Jl,{position:[e.lat,e.lng],icon:Qo,interactive:!1}),Object.values(t).map(P=>P.location&&T.jsx(Jl,{position:[P.location.lat,P.location.lng],icon:uv(P.color),interactive:!1},`peer-loc-${P.id}`)),Ls.map(({checkpoint:P,color:R})=>T.jsx(Qg,{id:P.id,position:P.position,icon:nt(R),onSelect:ue,onUpdate:Q},P.id)),(B==null?void 0:B.position)&&T.jsxs(T.Fragment,{children:[T.jsx(Jl,{position:[B.position.lat,B.position.lng],icon:lv,opacity:.8}),B.source&&T.jsx(xa,{positions:[[B.source.lat,B.source.lng],[B.position.lat,B.position.lng]],pathOptions:{color:"#d946ef",weight:3,dashArray:"5 5",opacity:.6}})]}),le==="direct"&&an.map(P=>P.positions.length>=2&&T.jsx(xa,{positions:P.positions,pathOptions:{color:P.color,weight:4,opacity:.7}},`direct-${P.id}`)),le==="route"&&an.map(P=>P.positions.length>=2&&T.jsx(xa,{positions:P.positions,pathOptions:{color:P.color,weight:4,dashArray:"10 6",opacity:.8}},`route-${P.id}`)),Object.values(t).map(P=>P.routes&&P.routes.map(R=>R.items&&R.items.length>=2&&T.jsx(xa,{positions:R.items.map(me=>[me.position.lat,me.position.lng]),pathOptions:{color:P.color||"#22c55e",weight:4,dashArray:"10 6",opacity:.6}},`peer-route-${P.id}-${R.id}`))),e&&s.filter(P=>P.position).map(P=>T.jsx(xa,{positions:[[e.lat,e.lng],[P.position.lat,P.position.lng]],pathOptions:{color:"#818cf8",weight:2,dashArray:"4 6",opacity:.4}},`user-target-${P.id}`))]},io),Ne&&T.jsx("div",{className:`pointer-events-none absolute left-1/2 top-4 z-[1000] -translate-x-1/2 rounded-full border px-4 py-1.5 text-[11px] font-semibold tracking-wide ${Ne.tone==="success"?"border-emerald-300 bg-emerald-200 text-emerald-900":Ne.tone==="warning"?"border-amber-300 bg-amber-200 text-amber-900":Ne.tone==="error"?"border-rose-300 bg-rose-200 text-rose-900":"border-sky-300 bg-sky-200 text-slate-900"}`,children:Ne.message}),T.jsxs("div",{className:`pointer-events-none absolute z-[990] flex flex-col items-end gap-3 transition-opacity duration-300 ${fe?"opacity-0":"opacity-100"}`,style:Rs,children:[T.jsxs("div",{className:Ge.container,children:[T.jsx(_a,{iconName:"menu",label:"Menu",onClick:Mt,title:"Toggle navigation menu",isActive:re,themeStyles:Ge}),T.jsx(_a,{iconName:"compass",label:"Compass",onClick:Pi,title:"Open compass overlay",themeStyles:Ge}),T.jsx(_a,{iconName:"route",label:"Route",onClick:Fr,title:"Open route tools",themeStyles:Ge}),T.jsx(_a,{iconName:"settings",label:"Settings",onClick:Bt,title:"Open settings",isActive:H,themeStyles:Ge})]}),(v||f&&!m)&&T.jsx("div",{className:`pointer-events-none ${Ge.badge}`,children:v?"Getting location":"GPS active, awaiting fix"})]}),T.jsx("div",{className:"pointer-events-none absolute z-[990] flex flex-col items-start gap-3",style:{bottom:"calc(env(safe-area-inset-bottom, 0px) + 1rem)",left:"calc(env(safe-area-inset-left, 0px) + 1rem)"},children:T.jsx("div",{className:"pointer-events-auto",children:T.jsx(_a,{iconName:"zoom",label:"Zoom",onClick:at,title:"Zoom to location",isActive:!1,themeStyles:Ge})})}),H&&T.jsxs("div",{className:"pointer-events-auto fixed inset-0 z-[1180] flex items-center justify-center p-4",children:[T.jsx("button",{type:"button",className:"absolute inset-0 rounded-none border-0 bg-slate-950 backdrop-blur-sm",style:{backgroundColor:"rgba(2, 6, 23, 0.45)"},"aria-label":"Close settings",onClick:()=>{typeof D=="function"&&D(),$e("settings")}}),T.jsxs("div",{className:`${Ge.panel} w-full max-w-md max-h-[80vh] overflow-hidden shadow-2xl shadow-slate-950/50`,role:"dialog","aria-modal":"true","aria-label":yt==="help"?"Map help":yt==="share"?"Share current route":"Map settings",children:[T.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[T.jsx("span",{className:Ge.panelTitle,children:yt==="help"?"Help":yt==="share"?"Share route":"Settings"}),T.jsx("button",{type:"button",className:Ge.panelButton,onClick:()=>{typeof D=="function"&&D(),$e("settings")},children:"Close"})]}),T.jsxs("div",{className:"mb-3 flex items-center gap-2 text-[11px]",children:[T.jsx("button",{type:"button",className:Os,onClick:()=>$e("settings"),"aria-pressed":yt==="settings",children:"Settings"}),T.jsx("button",{type:"button",className:ze,onClick:_i,"aria-pressed":yt==="share",children:"Share"}),T.jsx("button",{type:"button",className:_t,onClick:jr,"aria-pressed":yt==="help",children:"Help"})]}),T.jsx("div",{className:"flex h-full max-h-[65vh] flex-col gap-3 overflow-y-auto pr-1 text-[12px]",children:yt==="help"?T.jsx("div",{className:"flex flex-col gap-2",children:sv.map(P=>T.jsxs("section",{className:`${Ge.layerOption} cursor-default`,"aria-labelledby":`${P.id}-title`,children:[T.jsx("h3",{id:`${P.id}-title`,className:"text-[12px] font-semibold leading-tight",children:P.title}),T.jsx("p",{className:Ge.layerOptionDescription,children:P.description}),T.jsx("ul",{className:"ml-3 list-disc space-y-1 text-[11px] leading-snug",children:P.points.map((R,me)=>T.jsx("li",{children:R},me))})]},P.id))}):yt==="share"?T.jsxs("div",{className:"flex flex-col gap-3",children:[T.jsxs("section",{className:`${Ge.layerOption} flex flex-col gap-2`,children:[T.jsxs("div",{className:"flex items-start justify-between gap-2",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-[12px] font-semibold leading-tight",children:"Share code"}),T.jsx("p",{className:Ge.layerOptionDescription,children:"Copy and send this code to share the current route."})]}),T.jsx("button",{type:"button",className:`${Ge.panelButton} ${xi?"":"pointer-events-none opacity-50"}`,onClick:qr,disabled:!xi,children:"Copy code"})]}),q.length>1&&T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("label",{className:"text-[11px] font-semibold opacity-70",children:"Scope:"}),T.jsxs("select",{value:Qt,onChange:P=>mi(P.target.value),className:`${kn} flex-1 rounded-lg px-2 py-1 text-[11px]`,children:[T.jsx("option",{value:"all",children:"All Routes"}),q.map(P=>T.jsx("option",{value:P.id,children:P.name},P.id))]})]}),T.jsxs("div",{className:"flex items-center gap-4",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("input",{type:"checkbox",id:"share-include-names",checked:Lt,onChange:P=>ki(P.target.checked),className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-500 focus:ring-sky-500"}),T.jsx("label",{htmlFor:"share-include-names",className:"text-[11px] font-medium opacity-80",children:"Include names"})]}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("input",{type:"checkbox",id:"share-include-colors",checked:hn,onChange:P=>Oi(P.target.checked),className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-500 focus:ring-sky-500"}),T.jsx("label",{htmlFor:"share-include-colors",className:"text-[11px] font-medium opacity-80",children:"Include colors"})]})]}),T.jsx("p",{className:Ge.layerOptionDescription,children:Br??"Add at least one waypoint to generate a share code."}),T.jsx("textarea",{ref:Ie,className:`${kn} min-h-[90px] w-full rounded-xl px-3 py-2 text-[11px] leading-snug`,value:Li,readOnly:!0,spellCheck:!1,"aria-label":"Current route share code",onFocus:P=>P.target.select()}),Rn&&T.jsx("span",{role:"status","aria-live":"polite",className:`text-[11px] font-semibold ${Be(Rn.tone)}`,children:Rn.message})]}),T.jsxs("section",{className:`${Ge.layerOption} flex flex-col gap-2`,children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-[12px] font-semibold leading-tight",children:"Import route"}),T.jsx("p",{className:Ge.layerOptionDescription,children:"Paste a code received from another teammate to replace your current route."})]}),T.jsx("textarea",{className:`${kn} min-h-[110px] w-full rounded-xl px-3 py-2 text-[11px] leading-snug`,value:We,onChange:pn,onKeyDown:Jr,placeholder:"Paste a share code here",spellCheck:!1,"aria-label":"Paste a share code to import"}),T.jsxs("div",{className:"flex items-center justify-between gap-2",children:[T.jsx("button",{type:"button",className:`${Ge.panelButton} ${We.trim()?"":"pointer-events-none opacity-50"}`,onClick:yi,disabled:!We.trim(),children:"Load route"}),$t?T.jsx("span",{role:"status","aria-live":"polite",className:`text-[11px] font-semibold ${Be($t.tone)}`,children:$t.message}):T.jsx("span",{className:"text-[10px] opacity-60",children:"Press Ctrl/ + Enter to load"})]})]}),T.jsxs("section",{className:`${Ge.layerOption} flex flex-col gap-2`,children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-[12px] font-semibold leading-tight",children:"Plot callout"}),T.jsx("p",{className:Ge.layerOptionDescription,children:"Drop a shared geohash onto the map as a start, checkpoint, or finish marker."})]}),T.jsx("input",{type:"text",className:`${kn} w-full rounded-xl px-3 py-2 text-[11px] uppercase tracking-wide`,value:Ct,onChange:vi,placeholder:"e.g. u4pruydqq",spellCheck:!1,"aria-label":"Enter a location callout code"}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("label",{htmlFor:"callout-target",className:"text-[11px] font-semibold opacity-70",children:"Place as"}),T.jsx("select",{id:"callout-target",className:`${kn} w-full rounded-xl px-3 py-2 text-[11px]`,value:Qn,onChange:Rt,disabled:!0,children:T.jsx("option",{value:"checkpoint",children:"Checkpoint"})})]}),T.jsxs("div",{className:"flex items-center justify-between gap-2",children:[T.jsx("button",{type:"button",className:`${Ge.panelButton} ${Ct.trim()?"":"pointer-events-none opacity-50"}`,onClick:On,disabled:!Ct.trim(),children:"Place callout"}),Kn&&T.jsx("span",{role:"status","aria-live":"polite",className:`text-[11px] font-semibold ${Be(Kn.tone)}`,children:Kn.message})]})]}),Nt.length>0&&T.jsxs("section",{className:`${Ge.layerOption} flex flex-col gap-2`,children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-[12px] font-semibold leading-tight",children:"Location codes"}),T.jsx("p",{className:Ge.layerOptionDescription,children:"Geohash references 5m accuracy for quick callouts."})]}),T.jsx("div",{className:"flex flex-col gap-3",children:Nt.map(P=>T.jsxs("div",{className:"flex flex-col gap-1",children:[T.jsx("div",{className:"border-b border-slate-700/50 pb-1",children:T.jsx("span",{className:"text-[11px] font-semibold text-slate-300",children:P.route})}),T.jsx("ul",{className:"flex flex-col gap-1 text-[11px] font-mono",children:P.codes.map(R=>T.jsxs("li",{className:"flex items-center justify-between gap-3 pl-1",children:[T.jsx("span",{className:"font-semibold uppercase tracking-wide text-[10px] opacity-70",children:R.label}),T.jsx("span",{children:R.code})]},R.key))})]},P.route))})]})]}):T.jsxs(T.Fragment,{children:[T.jsxs("div",{className:"flex items-center justify-between gap-3",children:[T.jsx("span",{className:"font-medium",children:"Toolbar theme"}),T.jsx("button",{type:"button",className:Ge.panelToggle,onClick:pt,children:z==="light"?"Light":"Night"})]}),Fn&&T.jsxs("div",{className:"rounded-lg border border-amber-500/50 bg-amber-500/10 p-3 text-[11px] text-amber-500",children:[T.jsx("p",{className:"font-semibold",children:"Map Error"}),T.jsx("p",{children:Fn})]}),T.jsxs("div",{className:"flex items-center justify-between gap-3",children:[T.jsxs("div",{children:[T.jsx("span",{className:"font-medium",children:"Low data mode"}),T.jsx("p",{className:"text-[11px] opacity-70",children:"Reduce map detail to save data."})]}),T.jsx("button",{type:"button",role:"switch","aria-checked":He,onClick:()=>Bn(!He),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-offset-2 ${He?"bg-orange-500":"bg-slate-600"}`,children:T.jsx("span",{className:`${He?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})})]}),T.jsxs("div",{children:[T.jsx("span",{className:"font-medium",children:"Map layers"}),T.jsx("p",{className:"text-[11px] opacity-70",children:"Choose the basemap that suits your mission."}),T.jsx("div",{className:`${Ge.layerScroll} mt-2`,children:qn.map(P=>{const R=P.id===x;return T.jsxs("button",{type:"button",className:`${Ge.layerOption} ${R?Ge.layerOptionActive:""}`,onClick:()=>ks(P.id),children:[T.jsxs("div",{className:"flex items-start justify-between gap-2",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-[12px] font-semibold leading-tight",children:P.label}),P.category&&T.jsx("p",{className:Ge.layerOptionCategory,children:P.category})]}),R&&T.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide text-sky-500",children:"Current"})]}),T.jsx("p",{className:Ge.layerOptionDescription,children:P.description})]},P.id)})})]}),T.jsxs("div",{className:"flex items-start justify-between gap-3",children:[T.jsxs("div",{children:[T.jsx("span",{className:"font-medium",children:"Cache imagery"}),T.jsx("p",{className:"text-[11px] opacity-70",children:"Download tiles within 2km"})]}),T.jsx("button",{type:"button",className:`${Ge.panelButton} ${qe?"opacity-60 pointer-events-none":""}`,onClick:Ko,disabled:qe,children:st})]}),T.jsxs("section",{className:`${Ge.layerOption} flex flex-col gap-2`,children:[T.jsxs("div",{className:"flex items-start justify-between gap-2",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-[12px] font-semibold leading-tight",children:"Share this route"}),T.jsx("p",{className:Ge.layerOptionDescription,children:"switch to the share view to copy or import a route."})]}),T.jsx("button",{type:"button",className:Ge.panelButton,onClick:_i,children:"Open"})]}),T.jsx("p",{className:Ge.layerOptionDescription,children:Br??"Add at least one waypoint to enable route sharing."})]}),T.jsx("button",{type:"button",className:Ge.panelButton,onClick:at,children:"Center map on my location"})]})})]})]}),Jn.length>0&&T.jsx("div",{className:"pointer-events-none absolute bottom-4 left-1/2 flex w-[min(90vw,18rem)] -translate-x-1/2 flex-col gap-2",children:Jn.map(P=>{const R=P.tone==="emerald"?"border-emerald-500 text-emerald-100":"border-sky-500 text-sky-200";return T.jsx("div",{className:`rounded-lg border bg-slate-950 p-3 text-center text-sm font-semibold shadow-lg shadow-slate-950 ${R}`,children:P.text},P.key)})})]})},Ws=e=>e*Math.PI/180,dv=e=>e*180/Math.PI,Kg=(e,t)=>{if(!e||!t)return null;const n=Ws(e.lat),s=Ws(t.lat),l=Ws(t.lng-e.lng),f=Math.sin(l)*Math.cos(s),m=Math.cos(n)*Math.sin(s)-Math.sin(n)*Math.cos(s)*Math.cos(l),v=Math.atan2(f,m);return(dv(v)+360)%360},qg=(e,t)=>{if(!e||!t)return null;const n=6371e3,s=Ws(e.lat),l=Ws(t.lat),f=Ws(t.lat-e.lat),m=Ws(t.lng-e.lng),v=Math.sin(f/2)*Math.sin(f/2)+Math.cos(s)*Math.cos(l)*Math.sin(m/2)*Math.sin(m/2),_=2*Math.atan2(Math.sqrt(v),Math.sqrt(1-v));return n*_},Jg=(e,t)=>e==null||t==null?null:(t-e+360)%360,pv=e=>{const[t,n]=Y.useState(null),[s,l]=Y.useState(null),[f,m]=Y.useState(null),[v,_]=Y.useState(!1),[x,E]=Y.useState(!0),[b,M]=Y.useState(!1),[F,z]=Y.useState(!1),[U,re]=Y.useState(!1),H=Y.useRef(null),D=Y.useRef(null),B=Y.useRef(typeof navigator<"u"&&"geolocation"in navigator);Y.useEffect(()=>{if(!(typeof window>"u")){if(typeof DeviceOrientationEvent>"u"){E(!1),m(V=>V??"Compass not supported on this device");return}typeof DeviceOrientationEvent.requestPermission=="function"&&_(!0)}},[]);const $=Y.useCallback(V=>{if(typeof V.alpha=="number"){const le=V.webkitCompassHeading??360-V.alpha;n((le+360)%360)}},[]),fe=Y.useCallback(()=>{if(!B.current)return m("Geolocation not supported"),!1;H.current!==null&&(navigator.geolocation.clearWatch(H.current),H.current=null);const V=ce=>{const{latitude:ue,longitude:Q}=ce.coords;l({lat:ue,lng:Q}),M(!0),z(!0),re(!1),m(null)},le=ce=>{var ue;(ce==null?void 0:ce.code)===1?(m("Location permission denied"),M(!1)):(ce==null?void 0:ce.code)===2?m("Location unavailable"):(ce==null?void 0:ce.code)===3?m("Location request timed out"):m((ce==null?void 0:ce.message)??"Unable to access location"),z(!1),M(!1),re(!1),H.current!==null&&((ue=navigator.geolocation)!=null&&ue.clearWatch)&&(navigator.geolocation.clearWatch(H.current),H.current=null)};try{return re(!0),navigator.geolocation.getCurrentPosition(V,le,{enableHighAccuracy:!0,maximumAge:0,timeout:15e3}),H.current=navigator.geolocation.watchPosition(V,le,{enableHighAccuracy:!0,maximumAge:0,timeout:15e3}),!0}catch(ce){return m(ce.message??"Unable to access location"),re(!1),M(!1),!1}},[]),pe=Y.useCallback(async()=>{if(typeof DeviceOrientationEvent<"u"&&typeof DeviceOrientationEvent.requestPermission=="function")try{await DeviceOrientationEvent.requestPermission()==="granted"?(window.removeEventListener("deviceorientation",$),window.addEventListener("deviceorientation",$),D.current="deviceorientation",fe(),_(!1)):m("Compass permission denied")}catch(V){m(V.message??"Compass permission error")}},[$,fe]);Y.useEffect(()=>{if(!B.current)return()=>{};if(typeof window>"u"||!window.isSecureContext)return()=>{};let V=!1;return(async()=>{var ce;if((ce=navigator.permissions)!=null&&ce.query)try{const ue=await navigator.permissions.query({name:"geolocation"});if(V)return;ue.state==="granted"?fe():ue.state==="denied"&&m(Q=>Q??"Location permission denied"),ue.onchange=()=>{V||(ue.state==="granted"?fe():ue.state==="denied"&&(m("Location permission denied"),M(!1),z(!1)))}}catch(ue){m(Q=>Q??ue.message??"Geolocation unavailable")}})(),()=>{var ce;H.current!==null&&((ce=navigator.geolocation)!=null&&ce.clearWatch)&&navigator.geolocation.clearWatch(H.current),H.current=null,V=!0}},[fe]),Y.useEffect(()=>{if(typeof window>"u")return()=>{};if(!x)return()=>{};if(typeof DeviceOrientationEvent<"u"&&typeof DeviceOrientationEvent.requestPermission=="function")return()=>{window.removeEventListener("deviceorientation",$)};const V="ondeviceorientationabsolute"in window?"deviceorientationabsolute":"deviceorientation";return window.addEventListener(V,$),D.current=V,()=>{D.current&&window.removeEventListener(D.current,$)}},[$,x]);const K=Kg(s,e),q=qg(s,e);return{heading:t,bearing:K,distance:q,geolocation:s,error:f,needsPermission:v,isSupported:x,locationEnabled:b,hasLocationFix:F,isRequestingLocation:U,requestPermission:pe,startGeolocation:fe}},W0=e=>e==null?"N/A":e<1e3?`${e.toFixed(0)} m`:`${(e/1e3).toFixed(2)} km`,gv=3200/Math.PI,mv=({heading:e,bearing:t,distance:n,error:s,enableCompass:l,onEnableLocation:f,needsPermission:m,isSupported:v,locationEnabled:_,hasLocationFix:x,isRequestingLocation:E,targets:b=[],selectedTarget:M=null,onSelectTarget:F,bearingUnit:z="degrees",onToggleBearingUnit:U,routes:re=[],activeRouteId:H=null,onSelectRoute:D=null})=>{const B=Y.useMemo(()=>Jg(e,t),[e,t]),$=()=>{typeof f=="function"&&f()},fe=()=>{typeof l=="function"&&l()},pe=x?"Location Active":E?"Locating":_?"Retry Location":"Enable Location",K=E||x,q=typeof U!="function",V=!v&&!m,le=typeof F=="function",ce=we=>{if(!we)return null;const{lat:Le,lng:ge}=we;return typeof Le!="number"||typeof ge!="number"?null:`${Le.toFixed(4)}, ${ge.toFixed(4)}`},ue=we=>{le&&F(we)},Q=M?"Other checkpoints":"Select a checkpoint",ne=ce(M==null?void 0:M.position),Z=we=>{if(we==null)return null;const Le=(we%360+360)%360;return z==="mils"?(Le*Math.PI/180*gv+6400)%6400:Le},ye=we=>{if(we==null)return"N/A";const Le=Z(we);return Le==null?"N/A":z==="mils"?`${Le.toFixed(1)} mil`:`${Le.toFixed(0)}`},he=()=>{q||U()},J=t!=null&&e!=null,de=J?B??0:null,ae=e!=null?(360-e)%360:null,Ce=m||!v,Ne=Ce?"border border-rose-500 text-rose-200":"border border-slate-800 text-slate-100",Qe=Ce?"border-rose-500 bg-slate-800":"border-sky-500 bg-slate-950";return T.jsxs("div",{className:`flex flex-col items-center gap-4 rounded-2xl bg-slate-900 p-5 text-center shadow-lg shadow-slate-950 ${Ne}`,children:[re&&re.length>1&&D&&T.jsxs("div",{className:"w-full max-w-xs",children:[T.jsx("label",{className:"mb-1 block text-left text-xs font-medium text-slate-400",children:"Target Route"}),T.jsx("select",{value:H,onChange:we=>D(we.target.value),className:"w-full rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-sm text-slate-200 focus:border-sky-500 focus:outline-none",children:re.map(we=>T.jsx("option",{value:we.id,children:we.name},we.id))})]}),T.jsxs("div",{className:"flex w-full flex-wrap items-center justify-center gap-2",children:[T.jsx("h2",{className:"text-base font-semibold text-sky-200",children:"Compass"}),T.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[T.jsx("button",{type:"button",className:"rounded-full border border-emerald-500 px-3 py-1 text-[11px] font-semibold text-emerald-200 hover:bg-emerald-700 hover:text-emerald-100 disabled:cursor-not-allowed disabled:opacity-60",onClick:$,disabled:K,children:pe}),T.jsx("button",{type:"button",className:"rounded-full border border-sky-500 px-3 py-1 text-[11px] font-semibold text-sky-200 hover:bg-sky-700 hover:text-sky-100 disabled:cursor-not-allowed disabled:opacity-60",onClick:fe,disabled:V,children:"Enable Compass"}),T.jsx("button",{type:"button",className:"rounded-full border border-slate-700 px-3 py-1 text-[11px] font-semibold text-slate-200 hover:border-sky-500 hover:text-sky-200 disabled:cursor-not-allowed disabled:opacity-60",onClick:he,disabled:q,children:z==="degrees"?"Show mils":"Show degrees"})]})]}),T.jsxs("div",{className:`relative flex h-44 w-44 items-center justify-center rounded-full shadow-inner shadow-slate-950/40 ${Qe}`,children:[T.jsx("div",{className:"absolute inset-3 rounded-full border border-slate-800","aria-hidden":"true"}),T.jsx("div",{className:"absolute inset-0","aria-hidden":"true",children:T.jsx("div",{className:"absolute left-1/2 top-0 h-1/2 w-[3px] -translate-x-1/2 rounded-full bg-slate-200 opacity-40"})}),ae!=null&&T.jsxs("div",{className:"absolute inset-0",style:{transform:`rotate(${ae}deg)`},"aria-hidden":"true",children:[[0,30,60,90,120,150,180,210,240,270,300,330].map(we=>{const Le=we%90===0;return T.jsx("div",{className:"absolute inset-0",style:{transform:`rotate(${we}deg)`},children:T.jsx("div",{className:`absolute left-1/2 top-3 -translate-x-1/2 rounded-full bg-slate-600 ${Le?"h-3 w-[2px]":"h-1.5 w-[1px]"}`})},we)}),T.jsx("span",{className:"absolute left-1/2 top-2 -translate-x-1/2 rounded-full border border-slate-600 bg-slate-950 px-2 py-[2px] text-[10px] font-semibold uppercase tracking-[0.25em] text-sky-200 shadow-sm shadow-slate-950/40",children:"N"})]}),J&&de!=null&&T.jsx("div",{className:"absolute inset-0",style:{transform:`rotate(${de}deg)`},"aria-hidden":"true",children:T.jsx("div",{className:"absolute left-1/2 top-1 flex h-10 w-10 -translate-x-1/2 items-start justify-center drop-shadow-[0_0_8px_rgba(249,115,22,0.6)]",children:T.jsxs("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-orange-500",children:[T.jsx("path",{d:"M12 2L15 10H9L12 2Z",fill:"currentColor",stroke:"#c2410c",strokeWidth:"1.5",strokeLinejoin:"round"}),T.jsx("path",{d:"M12 22L9 14H15L12 22Z",fill:"currentColor",opacity:"0.5"})]})})}),Ce&&T.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center rounded-full bg-slate-950 text-center",style:{backgroundColor:"rgba(2, 6, 23, 0.85)"},children:[T.jsx("p",{className:"text-lg font-bold uppercase tracking-wide text-rose-200",children:"Compass not enabled"}),m&&T.jsx("p",{className:"mt-1 text-xs text-rose-200/80",children:"Tap Enable Compass to allow motion access."}),!m&&!v&&T.jsx("p",{className:"mt-1 text-xs text-rose-200/80",children:"This device does not expose compass sensors."})]}),T.jsx("span",{className:"absolute bottom-4 text-xs text-slate-300",children:e!=null?ye(e):""})]}),T.jsxs("div",{className:"space-y-1 text-xs text-slate-300",children:[T.jsxs("p",{children:["Target bearing: ",ye(t)]}),T.jsxs("p",{children:["Distance: ",W0(n)]}),(E||_&&!x)&&T.jsx("p",{className:"text-[11px] text-slate-400",children:"Awaiting GPS fix keep the device in the open."}),m&&v&&T.jsx("p",{className:"text-[11px] text-slate-400",children:"Tap Enable Compass to grant motion and orientation access."}),!v&&T.jsx("p",{className:"text-amber-400",children:"Compass not supported on this device."}),s&&T.jsxs("p",{className:"text-rose-400",children:["Error: ",s]})]}),T.jsxs("div",{className:"w-full rounded-xl border border-slate-800 bg-slate-950 p-3 text-left",children:[T.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-sky-300",children:"Active checkpoint"}),M?T.jsxs("div",{className:"mt-2",children:[T.jsx("p",{className:"text-sm font-semibold text-slate-100",children:M.label}),ne&&T.jsx("p",{className:"text-[11px] text-slate-400",children:ne})]}):T.jsx("p",{className:"mt-2 text-[11px] text-slate-400",children:b.length>0?"Pick a checkpoint below to set the compass target.":"Add checkpoints from the Route tools to set the compass target."})]}),b.length>0&&T.jsxs("div",{className:"w-full rounded-xl border border-slate-800 bg-slate-950 p-3 text-left",children:[T.jsx("p",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-sky-300",children:Q}),T.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:b.map(we=>T.jsxs("div",{role:le?"button":void 0,tabIndex:le?0:void 0,className:`flex items-center justify-between gap-3 rounded-md border px-3 py-2 text-xs text-slate-200 transition ${le?"cursor-pointer border-slate-700 bg-slate-900 hover:border-sky-500 hover:bg-sky-900 focus:outline-none focus:ring-2 focus:ring-sky-500/60":"border-slate-800 bg-slate-900"}`,onClick:le?()=>ue(we.id):void 0,onKeyDown:le?Le=>{(Le.key==="Enter"||Le.key===" ")&&(Le.preventDefault(),ue(we.id))}:void 0,children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full border border-slate-700 bg-slate-950",children:T.jsx("svg",{viewBox:"0 0 24 24",className:"h-4 w-4 text-sky-300",style:{transform:`rotate(${we.relativeBearing??0}deg)`,transformOrigin:"50% 50%"},children:T.jsx("path",{d:"M12 3l4.5 9H13l3 9-4-7-4 7 3-9H7.5z",fill:"currentColor"})})}),T.jsxs("div",{children:[T.jsx("p",{className:"font-semibold text-slate-100",children:we.label}),T.jsx("p",{className:"text-[11px] text-slate-400",children:we.bearing!=null?ye(we.bearing):""})]})]}),T.jsx("span",{className:"text-[11px] text-slate-400",children:W0(we.distance)})]},we.id))})]})]})},Z0="rounded border border-slate-700 px-2 py-1 text-[11px] font-medium text-slate-200 transition hover:border-sky-500 hover:bg-slate-800",G0="border-sky-500 bg-sky-900 text-sky-100",xv=({route:e,isActive:t,onActivate:n,checkpointMap:s,onUpdateRoute:l,onRemoveRoute:f,canRemove:m,selectedId:v,onSelectCheckpoint:_,onMoveCheckpoint:x,onRemoveCheckpoint:E,onAddCheckpoint:b,placementMode:M,onSetPlacementMode:F})=>{const[z,U]=Y.useState(!1),re=Y.useMemo(()=>e.items.map((q,V)=>{const le=s[q];return le?{type:"checkpoint",id:le.id,label:le.name||`Point ${V+1}`,position:le.position,index:V,callout:nd(le.position)}:null}).filter(Boolean),[e.items,s]),H=q=>V=>{V.dataTransfer.setData("application/x-cadet-map-checkpoint-id",q.id),V.dataTransfer.effectAllowed="move";const le=V.target.closest("li");le&&V.dataTransfer.setDragImage(le,10,10)},D=q=>{q.preventDefault(),q.dataTransfer.dropEffect="move"},B=q=>{q.preventDefault(),q.dataTransfer.dropEffect="move"},$=q=>V=>{V.preventDefault();const le=V.dataTransfer.getData("application/x-cadet-map-checkpoint-id");!le||le===q.id||x(le,q.index)},fe=(M==null?void 0:M.type)??null,pe=typeof(M==null?void 0:M.insertIndex)=="number"?M.insertIndex:null,K=q=>{q.index,q.index,re.length-1;const V=t&&fe==="checkpoint"&&pe===q.index,le=t&&fe==="checkpoint"&&pe===q.index+1;return T.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[T.jsx("button",{type:"button",className:`${Z0} ${V?G0:""}`,onClick:ce=>{ce.stopPropagation(),F({type:"checkpoint",insertIndex:q.index})},children:"Insert Before"}),T.jsx("button",{type:"button",className:`${Z0} ${le?G0:""}`,onClick:ce=>{ce.stopPropagation(),F({type:"checkpoint",insertIndex:q.index+1})},children:"Insert After"}),T.jsx("button",{type:"button",className:"rounded border border-rose-500 px-2 py-1 text-[11px] font-medium text-rose-300 transition hover:bg-rose-900 hover:text-rose-100",onClick:ce=>{ce.stopPropagation(),E(q.id)},children:"Remove"})]})};return T.jsxs("div",{className:`border-b border-slate-700/50 ${t?"bg-slate-800/30":""}`,children:[T.jsxs("div",{className:"flex cursor-pointer items-center gap-3 p-4 hover:bg-slate-800/50",onClick:n,children:[T.jsx("div",{className:`transition-transform duration-200 ${t?"rotate-90":""}`,children:T.jsx("svg",{className:"h-4 w-4 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),T.jsx("input",{type:"color",value:e.color,onClick:q=>q.stopPropagation(),onChange:q=>l(e.id,{color:q.target.value}),className:"h-5 w-5 cursor-pointer rounded border-0 bg-transparent p-0",title:"Route color"}),T.jsx("div",{className:"flex-1",children:T.jsx("input",{type:"text",value:e.name,onClick:q=>q.stopPropagation(),onChange:q=>l(e.id,{name:q.target.value}),className:"w-full bg-transparent text-sm font-medium text-slate-200 placeholder-slate-500 focus:outline-none",placeholder:"Route Name"})}),m&&T.jsx("button",{onClick:q=>{q.stopPropagation(),f(e.id)},className:"rounded p-1 text-slate-400 hover:bg-red-500/10 hover:text-red-400",title:"Delete route",children:T.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),t&&T.jsxs("div",{className:"px-4 pb-4",children:[T.jsxs("ul",{className:"space-y-2 text-sm text-slate-200",children:[re.length===0&&T.jsx("li",{className:"text-xs text-slate-500",children:"No markers yet. Add one below."}),re.map(q=>T.jsxs("li",{onDragEnter:D,onDragOver:B,onDrop:$(q),className:`flex items-start gap-2 rounded-md border px-3 py-2 transition ${v===q.id?"border-sky-500 bg-sky-900 text-sky-100":"cursor-pointer border-slate-800 hover:border-slate-600 hover:bg-slate-800"}`,onClick:()=>_(q.id),children:[T.jsx("div",{draggable:"true",onDragStart:H(q),className:"drag-handle mt-1 flex h-8 w-8 shrink-0 cursor-grab items-center justify-center rounded border border-slate-700 bg-slate-800 text-slate-400 touch-none hover:bg-slate-700 hover:text-slate-200 active:cursor-grabbing",onClick:V=>V.stopPropagation(),children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"h-5 w-5",children:T.jsx("path",{fillRule:"evenodd",d:"M10 3a1.5 1.5 0 100-3 1.5 1.5 0 000 3zM10 8.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3zM11.5 15.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z",clipRule:"evenodd"})})}),T.jsxs("div",{className:"flex-1",children:[T.jsx("div",{className:"font-semibold",children:q.label}),T.jsxs("div",{className:"text-xs text-slate-400",children:[q.position.lat.toFixed(4),", ",q.position.lng.toFixed(4)]}),q.callout&&T.jsxs("div",{className:"text-[11px] font-mono uppercase text-amber-300",children:["Callout: ",q.callout]}),K(q)]})]},q.id))]}),T.jsx("button",{onClick:b,style:fe==="checkpoint"&&!pe?{borderColor:e.color,color:e.color,backgroundColor:`${e.color}20`}:{},className:`mt-3 w-full rounded border border-dashed border-slate-600 py-2 text-xs font-medium text-slate-400 transition hover:bg-slate-800 ${fe==="checkpoint"&&!pe?"":"hover:border-sky-500 hover:text-sky-400"}`,children:"+ Add Checkpoint"})]})]})},yv=({onEnterPlacingMode:e})=>{const{checkpointMap:t,routes:n,activeRouteId:s,setActiveRoute:l,addRoute:f,removeRoute:m,updateRoute:v,selectedId:_,selectCheckpoint:x,connectVia:E,toggleConnectMode:b,clearAll:M,setPlacementMode:F,moveCheckpoint:z,removeCheckpoint:U,placementMode:re}=$o(),[H,D]=Y.useState(s),B=$=>{H===$?D(null):(D($),l($))};return T.jsxs("div",{className:"flex h-full flex-col bg-slate-900/95 backdrop-blur-md",children:[T.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n.map($=>T.jsx(xv,{route:$,isActive:$.id===H,onActivate:()=>B($.id),checkpointMap:t,onUpdateRoute:v,onRemoveRoute:m,canRemove:n.length>1,selectedId:_,onSelectCheckpoint:x,onMoveCheckpoint:z,onRemoveCheckpoint:U,onAddCheckpoint:()=>{l($.id),F({type:"checkpoint"}),e&&e()},placementMode:re,onSetPlacementMode:F},$.id)),T.jsx("div",{className:"p-4",children:T.jsxs("button",{onClick:()=>f(),className:"flex w-full items-center justify-center gap-2 rounded-lg border border-slate-600 bg-slate-800 py-2 text-sm text-slate-200 hover:border-sky-500 hover:bg-slate-700",children:[T.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add New Route"]})})]}),T.jsxs("div",{className:"border-t border-slate-700/50 p-4",children:[T.jsx("div",{className:"flex gap-2",children:T.jsx("button",{onClick:b,className:`flex-1 rounded border border-slate-600 py-2 text-xs font-medium transition ${E==="route"?"border-sky-500 bg-sky-900/20 text-sky-400":"text-slate-400 hover:border-sky-500 hover:bg-slate-800 hover:text-sky-400"}`,children:E==="route"?"Routing: Road":"Routing: Direct"})}),T.jsx("button",{onClick:M,className:"mt-2 w-full rounded border border-red-900/30 py-2 text-xs font-medium text-red-400 transition hover:bg-red-900/20 hover:text-red-300",children:"Clear All"})]})]})},Y0=e=>e===4?4:3,X0={origin:null,originReference:null,precision:3},_v=td(e=>({...X0,setPrecision:t=>e(n=>{const s=Y0(t);return{precision:s,originReference:n.originReference?{...n.originReference,precision:s}:null}}),setOrigin:t=>e({origin:t}),setOriginReference:t=>e(n=>({originReference:t?{...t,precision:Y0(t.precision??n.precision)}:null})),resetGrid:()=>e(X0)})),vv=()=>_v(e=>({origin:e.origin,originReference:e.originReference,precision:e.precision,setOrigin:e.setOrigin,setOriginReference:e.setOriginReference,setPrecision:e.setPrecision,resetGrid:e.resetGrid})),rl=6371e3,ec=e=>e*Math.PI/180,$0=e=>e*180/Math.PI,wv=e=>(e+540)%360-180,rd=e=>{if(e===3||e===4)return e;throw new Error("Unsupported grid precision. Use 3 or 4 figure references.")},id=e=>rd(e)===3?100:10,jl=(e,t)=>{if(e==null)return null;const n=String(e).trim();if(!n)return null;if(!/^\d+$/.test(n))throw new Error("Grid references must contain digits only.");if(n.length!==t)throw new Error(`Expected ${t} digits for this precision setting.`);return parseInt(n,10)},Cv=({lat:e,lng:t},n,s)=>{const l=ec(e),f=e+s/rl*(180/Math.PI),m=t+n/(rl*Math.cos(l))*180/Math.PI;return{lat:f,lng:m}},Ev=({origin:e,bearingDegrees:t,distanceMeters:n})=>{if(!e)throw new Error("Provide a valid origin location first.");if(t==null||Number.isNaN(t))throw new Error("Bearing must be a number.");if(n==null||Number.isNaN(n)||n<0)throw new Error("Distance must be a non-negative number.");const s=n/rl,l=ec(t),f=ec(e.lat),m=ec(e.lng),v=Math.sin(f),_=Math.cos(f),x=Math.sin(s),E=Math.cos(s),b=Math.asin(v*E+_*x*Math.cos(l)),M=m+Math.atan2(Math.sin(l)*x*_,E-v*Math.sin(b));return{lat:$0(b),lng:wv($0(M))}},bv=({origin:e,originReference:t,targetReference:n,precision:s})=>{if(!e)throw new Error("Set a grid origin location first.");if(!t)throw new Error("Set a grid origin reference first.");const l=rd(s??t.precision??(n==null?void 0:n.precision)??3),f=jl(t.easting,l),m=jl(t.northing,l),v=jl(n.easting,l),_=jl(n.northing,l),x=id(l),E=(v-f)*x,b=(_-m)*x;return Cv(e,E,b)},Sv=({origin:e,originReference:t,point:n,precision:s})=>{if(!e||!t)throw new Error("Grid origin must be configured.");const l=rd(s??t.precision??3),f=id(l),m=e.lat*Math.PI/180,v=(n.lat-e.lat)*Math.PI*rl/180,_=(n.lng-e.lng)*Math.PI*rl*Math.cos(m)/180,x=Math.round(t.easting+_/f),E=Math.round(t.northing+v/f),b=M=>M.toString().padStart(l,"0");return{easting:b(x),northing:b(E),precision:l}},zl=e=>e!=null?e.toFixed(6):"",Av=e=>e==null||Number.isNaN(e)?"":e>=1e3?`${(e/1e3).toFixed(2)} km`:e>=10?`${e.toFixed(0)} m`:`${e.toFixed(1)} m`,zu=({show:e,onToggle:t})=>T.jsx("button",{type:"button",onClick:t,className:`flex h-5 w-5 items-center justify-center rounded-full border text-[10px] font-bold transition ${e?"border-sky-500 bg-sky-500 text-slate-900":"border-slate-600 text-slate-400 hover:border-sky-500 hover:text-sky-200"}`,"aria-label":"Toggle help",children:"?"}),Tv=({userLocation:e,selectedPosition:t,onPreviewLocationChange:n})=>{const{origin:s,originReference:l,precision:f,setOrigin:m,setOriginReference:v,setPrecision:_,resetGrid:x}=vv(),{addCheckpoint:E}=$o(),[b,M]=Y.useState(""),[F,z]=Y.useState(""),[U,re]=Y.useState(""),[H,D]=Y.useState(""),[B,$]=Y.useState(null),[fe,pe]=Y.useState(null),[K,q]=Y.useState(null),[V,le]=Y.useState("user"),[ce,ue]=Y.useState(""),[Q,ne]=Y.useState("degrees"),[Z,ye]=Y.useState(""),[he,J]=Y.useState(null),[de,ae]=Y.useState(null),[Ce,Ne]=Y.useState("origin"),[Qe,we]=Y.useState(!1);Y.useEffect(()=>{var Oe,We;l&&(M(((Oe=l.easting)==null?void 0:Oe.toString().padStart(f,"0"))??""),z(((We=l.northing)==null?void 0:We.toString().padStart(f,"0"))??""))},[l,f]);const Le=Y.useMemo(()=>{if(!s||!l)return null;try{const Oe=Sv({origin:s,originReference:l,point:s,precision:f});return`${Oe.easting} / ${Oe.northing}`}catch(Oe){return console.warn(Oe),null}},[s,l,f]),ge=Y.useMemo(()=>{if(!ce)return null;const Oe=Number(ce);return Number.isNaN(Oe)?null:Q==="mils"?Oe*360/6400:Oe},[ce,Q]),mt=Y.useMemo(()=>ge==null?null:ge*6400/360,[ge]),He=(de==null?void 0:de.bearingDegrees)??null,Bn=He!=null?He*6400/360:null,Fn=()=>{let Oe=e;if(!Oe)if(t)Oe=t;else{q("Waiting for GPS location (or select a point on the map).");return}const We=b.trim(),Xe=F.trim();if(!We||!Xe){q("Enter grid reference digits.");return}if(We.length!==Xe.length){q("Easting and Northing must have same number of digits.");return}let $t=3;if(We.length===3)$t=3;else if(We.length===4)$t=4;else{q("Grid ref must be 3 or 4 digits (e.g. 123 456).");return}try{const Te=Number(We),Lt=Number(Xe);if(Number.isNaN(Te)||Number.isNaN(Lt))throw new Error("Grid reference must be numbers.");m(Oe),v({easting:Te,northing:Lt,precision:$t}),_($t),q(null),$(`Grid calibrated to ${$t}-figure reference.`)}catch(Te){q(Te.message)}},Ot=()=>{if(V==="user"){if(!e)throw new Error("No user location fix yet.");return e}if(V==="selected"){if(!t)throw new Error("Select a marker on the map to use as the origin.");return t}throw new Error("Select a valid start point.")},yt=()=>{try{if(!ce)throw new Error("Enter a bearing value.");if(!Z)throw new Error("Enter a distance in meters.");const Oe=Ot(),We=Number(ce),Xe=Number(Z);if(Number.isNaN(We))throw new Error("Bearing must be a number.");if(Number.isNaN(Xe)||Xe<0)throw new Error("Distance must be zero or greater.");const Te=((Q==="mils"?We*360/6400:We)%360+360)%360,Lt=Ev({origin:Oe,bearingDegrees:Te,distanceMeters:Xe});J(Lt),ae({bearingDegrees:Te,bearingInput:We,bearingUnit:Q,distanceMeters:Xe,origin:Oe}),$("Projected point from bearing and distance."),q(null)}catch(Oe){J(null),ae(null),q(Oe.message??"Unable to project bearing.")}},$e=()=>{if(!U||!H){q("Enter both easting and northing for the grid reference.");return}try{const Oe=bv({origin:s,originReference:l,targetReference:{easting:U,northing:H,precision:f},precision:f});pe(Oe),$("Grid reference resolved."),q(null)}catch(Oe){pe(null),q(Oe.message)}},Sn=(Oe=fe,We="grid reference")=>{if(!Oe){q(`Resolve a ${We} first.`);return}E(Oe),$(`Checkpoint added from ${We}.`),q(null)},Xt=()=>{x(),M(""),z(""),re(""),D(""),pe(null),le("user"),ue(""),ne("degrees"),ye(""),J(null),ae(null),$("Grid settings cleared."),q(null)},Rn=id(f);return Y.useEffect(()=>{n&&n(Ce==="convert"&&fe?{position:fe,source:s}:Ce==="project"&&he?{position:he,source:(de==null?void 0:de.origin)??null}:null)},[Ce,fe,he,de,s,n]),T.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl bg-slate-900 p-4 text-xs text-slate-200 shadow-lg shadow-slate-950",children:[T.jsxs("div",{className:"flex items-center justify-between gap-2",children:[T.jsx("h2",{className:"text-base font-semibold text-sky-200",children:"Grid Tools"}),T.jsx("div",{className:"flex gap-1",children:T.jsxs("span",{className:"rounded-full border border-slate-700 px-2 py-1 text-[10px] font-semibold text-slate-400",children:[f,"-fig mode"]})})]}),T.jsxs("div",{className:"flex gap-1 rounded-lg border border-slate-800 bg-slate-950 p-1",children:[T.jsx("button",{type:"button",onClick:()=>Ne("origin"),className:`flex-1 rounded-md py-1.5 text-[11px] font-semibold transition ${Ce==="origin"?"bg-slate-800 text-sky-200 shadow-sm":"text-slate-400 hover:bg-slate-900 hover:text-slate-200"}`,children:"Origin"}),T.jsx("button",{type:"button",onClick:()=>Ne("convert"),className:`flex-1 rounded-md py-1.5 text-[11px] font-semibold transition ${Ce==="convert"?"bg-slate-800 text-sky-200 shadow-sm":"text-slate-400 hover:bg-slate-900 hover:text-slate-200"}`,children:"Convert"}),T.jsx("button",{type:"button",onClick:()=>Ne("project"),className:`flex-1 rounded-md py-1.5 text-[11px] font-semibold transition ${Ce==="project"?"bg-slate-800 text-sky-200 shadow-sm":"text-slate-400 hover:bg-slate-900 hover:text-slate-200"}`,children:"Project"})]}),Ce==="origin"&&T.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-950 p-3",children:[T.jsxs("div",{className:"mb-3 flex items-start justify-between gap-2",children:[T.jsxs("div",{children:[T.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-sky-300",children:"Calibrate Grid Origin"}),T.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"Sync your current location to a grid reference."})]}),T.jsx(zu,{show:Qe,onToggle:()=>we(!Qe)})]}),Qe&&T.jsxs("div",{className:"mb-4 rounded-lg bg-slate-900 p-2 text-[11px] text-slate-300",children:[T.jsx("p",{className:"mb-1 font-semibold text-sky-200",children:"How to calibrate:"}),T.jsx("p",{className:"text-slate-400",children:"Enter the Grid Reference for your current location (e.g. from a paper map) and tap 'Set Origin'. The app will link your GPS position to that grid reference."}),T.jsx("p",{className:"mt-2 text-slate-500 italic",children:"Note: If GPS is unavailable, select a point on the map first."})]}),T.jsxs("div",{className:"flex flex-col gap-3",children:[T.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[T.jsxs("label",{className:"flex flex-col gap-1",children:[T.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Easting"}),T.jsx("input",{value:b,onChange:Oe=>M(Oe.target.value),className:"rounded-md border border-slate-700 bg-slate-950 px-2 py-1 text-xs text-slate-100 focus:border-sky-500 focus:outline-none",placeholder:"e.g. 123"})]}),T.jsxs("label",{className:"flex flex-col gap-1",children:[T.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Northing"}),T.jsx("input",{value:F,onChange:Oe=>z(Oe.target.value),className:"rounded-md border border-slate-700 bg-slate-950 px-2 py-1 text-xs text-slate-100 focus:border-sky-500 focus:outline-none",placeholder:"e.g. 456"})]})]}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{type:"button",className:"flex-1 rounded-md border border-sky-500 bg-sky-500/10 px-3 py-2 font-semibold text-sky-200 hover:bg-sky-500/20",onClick:Fn,children:"Set Origin"}),T.jsx("button",{type:"button",className:"rounded-md border border-slate-700 px-3 py-2 font-semibold text-slate-300 hover:border-rose-500 hover:text-rose-200",onClick:Xt,children:"Clear"})]}),T.jsx("div",{className:"mt-1 text-center text-[11px]",children:Le?T.jsxs("span",{className:"text-emerald-400",children:["Active: ",Le," (",f,"-fig)"]}):T.jsx("span",{className:"text-slate-500",children:"Origin not set"})})]})]}),Ce==="convert"&&T.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-950 p-3",children:[T.jsxs("div",{className:"mb-3 flex items-start justify-between gap-2",children:[T.jsxs("div",{children:[T.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-sky-300",children:"Convert Grid Ref"}),T.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"Enter a grid reference to find its location on the map relative to your origin."})]}),T.jsx(zu,{show:Qe,onToggle:()=>we(!Qe)})]}),Qe&&T.jsxs("div",{className:"mb-4 rounded-lg bg-slate-900 p-2 text-[11px] text-slate-300",children:[T.jsx("p",{className:"mb-1 font-semibold text-sky-200",children:"How to convert:"}),T.jsx("p",{className:"text-slate-400",children:'Once you have calibrated the origin, you can enter any other grid reference here. The app will calculate the offset from the origin, show you where that point lands, and the "Add checkpoint" button will drop it into your active route.'})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[T.jsxs("label",{className:"flex flex-col gap-1",children:[T.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Easting"}),T.jsx("input",{value:U,onChange:Oe=>re(Oe.target.value),className:"rounded-md border border-slate-700 bg-slate-950 px-2 py-1 text-xs text-slate-100 focus:border-sky-500 focus:outline-none",placeholder:"e.g. ".concat("2".repeat(f))})]}),T.jsxs("label",{className:"flex flex-col gap-1",children:[T.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Northing"}),T.jsx("input",{value:H,onChange:Oe=>D(Oe.target.value),className:"rounded-md border border-slate-700 bg-slate-950 px-2 py-1 text-xs text-slate-100 focus:border-sky-500 focus:outline-none",placeholder:"e.g. ".concat("3".repeat(f))})]})]}),T.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[T.jsx("button",{type:"button",className:"rounded-md border border-sky-500 px-3 py-1 text-[11px] font-semibold text-sky-200 hover:bg-sky-900",onClick:$e,children:"Preview location"}),T.jsxs("span",{className:"text-[11px] text-slate-400",children:["1 digit = ",Rn," m offset"]})]}),fe&&T.jsxs("div",{className:"mt-3 rounded-md border border-slate-800 bg-slate-900 p-3 text-[11px] text-slate-200",children:[T.jsx("p",{className:"font-semibold text-sky-200",children:"Resolved coordinates"}),T.jsxs("p",{className:"mt-1 text-slate-300",children:["Lat ",zl(fe.lat)," | Lng ",zl(fe.lng)]}),T.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:T.jsx("button",{type:"button",className:"rounded-md border border-sky-500 px-3 py-1 text-[11px] font-semibold text-sky-200 hover:bg-sky-900",onClick:()=>Sn(fe,"grid reference"),children:"Add checkpoint"})})]})]}),Ce==="project"&&T.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-950 p-3",children:[T.jsxs("div",{className:"mb-3 flex items-start justify-between gap-2",children:[T.jsxs("div",{children:[T.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-sky-300",children:"Project by bearing"}),T.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"Calculate a new point by moving a specific distance and bearing from a starting point."})]}),T.jsx(zu,{show:Qe,onToggle:()=>we(!Qe)})]}),Qe&&T.jsxs("div",{className:"mb-4 rounded-lg bg-slate-900 p-2 text-[11px] text-slate-300",children:[T.jsx("p",{className:"mb-1 font-semibold text-sky-200",children:"How to project:"}),T.jsxs("ol",{className:"list-decimal space-y-1 pl-4 text-slate-400",children:[T.jsx("li",{children:"Choose a start point (your current GPS fix or a checkpoint you selected on the map)."}),T.jsx("li",{children:"Enter the bearing (direction) and distance to travel."}),T.jsx("li",{children:"Click 'Project location' to see the destination on the map, then use 'Add checkpoint' to store it in the active route."})]})]}),T.jsxs("div",{className:"mb-3",children:[T.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Start Point"}),T.jsxs("div",{className:"mt-1 flex gap-2",children:[T.jsx("button",{type:"button",onClick:()=>le("user"),className:`flex-1 rounded-md border py-2 text-[11px] font-semibold transition ${V==="user"?"border-sky-500 bg-sky-500/10 text-sky-200":"border-slate-700 text-slate-400 hover:border-slate-500 hover:text-slate-200"}`,children:"My Location"}),T.jsx("button",{type:"button",onClick:()=>le("selected"),className:`flex-1 rounded-md border py-2 text-[11px] font-semibold transition ${V==="selected"?"border-sky-500 bg-sky-500/10 text-sky-200":"border-slate-700 text-slate-400 hover:border-slate-500 hover:text-slate-200"}`,children:"Selected Marker"})]}),!e&&V==="user"&&T.jsx("p",{className:"mt-1 text-[10px] text-rose-400",children:"Waiting for GPS fix..."}),!t&&V==="selected"&&T.jsx("p",{className:"mt-1 text-[10px] text-rose-400",children:"No marker selected on map."})]}),T.jsxs("div",{className:"mt-3 grid gap-2 sm:grid-cols-2",children:[T.jsxs("label",{className:"flex flex-col gap-1",children:[T.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Bearing"}),T.jsx("input",{value:ce,onChange:Oe=>ue(Oe.target.value),className:"rounded-md border border-slate-700 bg-slate-950 px-2 py-1 text-xs text-slate-100 focus:border-sky-500 focus:outline-none",placeholder:Q==="degrees"?"0  360":"0  6400 mil"})]}),T.jsxs("div",{className:"flex flex-col gap-1",children:[T.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Units"}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{type:"button",className:`flex-1 rounded-md px-2 py-1 text-[11px] font-semibold ${Q==="degrees"?"border border-sky-500 text-sky-200":"border border-slate-700 text-slate-200 hover:border-sky-500 hover:text-sky-200"}`,onClick:()=>ne("degrees"),children:"Degrees"}),T.jsx("button",{type:"button",className:`flex-1 rounded-md px-2 py-1 text-[11px] font-semibold ${Q==="mils"?"border border-sky-500 text-sky-200":"border border-slate-700 text-slate-200 hover:border-sky-500 hover:text-sky-200"}`,onClick:()=>ne("mils"),children:"Mils"})]})]})]}),T.jsxs("div",{className:"mt-3 grid gap-2 sm:grid-cols-2",children:[T.jsxs("label",{className:"flex flex-col gap-1",children:[T.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Distance (m)"}),T.jsx("input",{value:Z,onChange:Oe=>ye(Oe.target.value),className:"rounded-md border border-slate-700 bg-slate-950 px-2 py-1 text-xs text-slate-100 focus:border-sky-500 focus:outline-none",placeholder:"e.g. 250"})]}),T.jsx("div",{className:"flex flex-col justify-end text-[11px] text-slate-400",children:T.jsx("span",{children:ge!=null?` ${ge.toFixed(1)} / ${(mt==null?void 0:mt.toFixed(0))??""} mil`:"Enter a bearing to preview conversions."})})]}),T.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[T.jsx("button",{type:"button",className:"rounded-md border border-sky-500 px-3 py-1 text-[11px] font-semibold text-sky-200 hover:bg-sky-900",onClick:yt,children:"Project location"}),T.jsx("span",{className:"text-[11px] text-slate-400",children:"Distance measured in straight line"})]}),he&&T.jsxs("div",{className:"mt-3 rounded-md border border-slate-800 bg-slate-900 p-3 text-[11px] text-slate-200",children:[T.jsx("p",{className:"font-semibold text-sky-200",children:"Projected coordinates"}),T.jsxs("p",{className:"mt-1 text-slate-300",children:["Lat ",zl(he.lat)," | Lng ",zl(he.lng)]}),T.jsxs("p",{className:"text-slate-400",children:["Bearing used:"," ",He!=null?`${He.toFixed(1)}${Bn!=null?` (${Bn.toFixed(0)} mil)`:""}`:""]}),(de==null?void 0:de.distanceMeters)!=null&&T.jsxs("p",{className:"text-slate-400",children:["Distance: ",Av(de.distanceMeters)]}),T.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:T.jsx("button",{type:"button",className:"rounded-md border border-sky-500 px-3 py-1 text-[11px] font-semibold text-sky-200 hover:bg-sky-900",onClick:()=>Sn(he,"bearing projection"),children:"Add checkpoint"})})]})]}),(K||B)&&T.jsxs("div",{className:"rounded-md border border-slate-800 bg-slate-950 p-3 text-[11px]",children:[K&&T.jsx("p",{className:"text-rose-400",children:K}),B&&T.jsx("p",{className:"text-emerald-300",children:B})]}),T.jsx("button",{type:"button",className:"rounded-md border border-slate-700 px-3 py-1 text-[11px] font-semibold text-slate-300 hover:border-rose-500 hover:text-rose-200",onClick:Xt,children:"Clear grid settings"})]})},Iv=({type:e,color:t})=>{const n=Y.useRef(null),s=m=>{m.dataTransfer.setData("application/x-cadet-map-item",e),m.dataTransfer.effectAllowed="copy",n.current&&m.dataTransfer.setDragImage(n.current,10,20)},l={borderColor:t,backgroundColor:`${t}33`},f={backgroundColor:t};return T.jsxs(T.Fragment,{children:[T.jsx("div",{draggable:!0,onDragStart:s,className:"flex h-16 w-16 cursor-grab items-center justify-center rounded-full border-2 shadow-lg backdrop-blur-sm transition hover:scale-110 active:cursor-grabbing active:scale-95 touch-none",style:l,children:T.jsx("div",{className:"h-4 w-4 rounded-full",style:f})}),T.jsx("div",{ref:n,className:"absolute -top-[1000px] left-0 h-5 w-5 rounded-full border-2",style:l})]})},Nv=()=>{const{routes:e,activeRouteId:t}=$o(),n=e.find(l=>l.id===t)||e[0],s=(n==null?void 0:n.color)||"#38bdf8";return T.jsx("div",{className:"pointer-events-auto flex gap-6 p-4",children:T.jsx(Iv,{type:"checkpoint",color:s})})};var Mv=Object.defineProperty,kc=Object.getOwnPropertySymbols,em=Object.prototype.hasOwnProperty,tm=Object.prototype.propertyIsEnumerable,Q0=(e,t,n)=>t in e?Mv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Wf=(e,t)=>{for(var n in t||(t={}))em.call(t,n)&&Q0(e,n,t[n]);if(kc)for(var n of kc(t))tm.call(t,n)&&Q0(e,n,t[n]);return e},Zf=(e,t)=>{var n={};for(var s in e)em.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&kc)for(var s of kc(e))t.indexOf(s)<0&&tm.call(e,s)&&(n[s]=e[s]);return n};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var qs;(e=>{const t=class ct{constructor(_,x,E,b){if(this.version=_,this.errorCorrectionLevel=x,this.modules=[],this.isFunction=[],_<ct.MIN_VERSION||_>ct.MAX_VERSION)throw new RangeError("Version value out of range");if(b<-1||b>7)throw new RangeError("Mask value out of range");this.size=_*4+17;let M=[];for(let z=0;z<this.size;z++)M.push(!1);for(let z=0;z<this.size;z++)this.modules.push(M.slice()),this.isFunction.push(M.slice());this.drawFunctionPatterns();const F=this.addEccAndInterleave(E);if(this.drawCodewords(F),b==-1){let z=1e9;for(let U=0;U<8;U++){this.applyMask(U),this.drawFormatBits(U);const re=this.getPenaltyScore();re<z&&(b=U,z=re),this.applyMask(U)}}l(0<=b&&b<=7),this.mask=b,this.applyMask(b),this.drawFormatBits(b),this.isFunction=[]}static encodeText(_,x){const E=e.QrSegment.makeSegments(_);return ct.encodeSegments(E,x)}static encodeBinary(_,x){const E=e.QrSegment.makeBytes(_);return ct.encodeSegments([E],x)}static encodeSegments(_,x,E=1,b=40,M=-1,F=!0){if(!(ct.MIN_VERSION<=E&&E<=b&&b<=ct.MAX_VERSION)||M<-1||M>7)throw new RangeError("Invalid value");let z,U;for(z=E;;z++){const B=ct.getNumDataCodewords(z,x)*8,$=m.getTotalBits(_,z);if($<=B){U=$;break}if(z>=b)throw new RangeError("Data too long")}for(const B of[ct.Ecc.MEDIUM,ct.Ecc.QUARTILE,ct.Ecc.HIGH])F&&U<=ct.getNumDataCodewords(z,B)*8&&(x=B);let re=[];for(const B of _){n(B.mode.modeBits,4,re),n(B.numChars,B.mode.numCharCountBits(z),re);for(const $ of B.getData())re.push($)}l(re.length==U);const H=ct.getNumDataCodewords(z,x)*8;l(re.length<=H),n(0,Math.min(4,H-re.length),re),n(0,(8-re.length%8)%8,re),l(re.length%8==0);for(let B=236;re.length<H;B^=253)n(B,8,re);let D=[];for(;D.length*8<re.length;)D.push(0);return re.forEach((B,$)=>D[$>>>3]|=B<<7-($&7)),new ct(z,x,D,M)}getModule(_,x){return 0<=_&&_<this.size&&0<=x&&x<this.size&&this.modules[x][_]}getModules(){return this.modules}drawFunctionPatterns(){for(let E=0;E<this.size;E++)this.setFunctionModule(6,E,E%2==0),this.setFunctionModule(E,6,E%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const _=this.getAlignmentPatternPositions(),x=_.length;for(let E=0;E<x;E++)for(let b=0;b<x;b++)E==0&&b==0||E==0&&b==x-1||E==x-1&&b==0||this.drawAlignmentPattern(_[E],_[b]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(_){const x=this.errorCorrectionLevel.formatBits<<3|_;let E=x;for(let M=0;M<10;M++)E=E<<1^(E>>>9)*1335;const b=(x<<10|E)^21522;l(b>>>15==0);for(let M=0;M<=5;M++)this.setFunctionModule(8,M,s(b,M));this.setFunctionModule(8,7,s(b,6)),this.setFunctionModule(8,8,s(b,7)),this.setFunctionModule(7,8,s(b,8));for(let M=9;M<15;M++)this.setFunctionModule(14-M,8,s(b,M));for(let M=0;M<8;M++)this.setFunctionModule(this.size-1-M,8,s(b,M));for(let M=8;M<15;M++)this.setFunctionModule(8,this.size-15+M,s(b,M));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let _=this.version;for(let E=0;E<12;E++)_=_<<1^(_>>>11)*7973;const x=this.version<<12|_;l(x>>>18==0);for(let E=0;E<18;E++){const b=s(x,E),M=this.size-11+E%3,F=Math.floor(E/3);this.setFunctionModule(M,F,b),this.setFunctionModule(F,M,b)}}drawFinderPattern(_,x){for(let E=-4;E<=4;E++)for(let b=-4;b<=4;b++){const M=Math.max(Math.abs(b),Math.abs(E)),F=_+b,z=x+E;0<=F&&F<this.size&&0<=z&&z<this.size&&this.setFunctionModule(F,z,M!=2&&M!=4)}}drawAlignmentPattern(_,x){for(let E=-2;E<=2;E++)for(let b=-2;b<=2;b++)this.setFunctionModule(_+b,x+E,Math.max(Math.abs(b),Math.abs(E))!=1)}setFunctionModule(_,x,E){this.modules[x][_]=E,this.isFunction[x][_]=!0}addEccAndInterleave(_){const x=this.version,E=this.errorCorrectionLevel;if(_.length!=ct.getNumDataCodewords(x,E))throw new RangeError("Invalid argument");const b=ct.NUM_ERROR_CORRECTION_BLOCKS[E.ordinal][x],M=ct.ECC_CODEWORDS_PER_BLOCK[E.ordinal][x],F=Math.floor(ct.getNumRawDataModules(x)/8),z=b-F%b,U=Math.floor(F/b);let re=[];const H=ct.reedSolomonComputeDivisor(M);for(let B=0,$=0;B<b;B++){let fe=_.slice($,$+U-M+(B<z?0:1));$+=fe.length;const pe=ct.reedSolomonComputeRemainder(fe,H);B<z&&fe.push(0),re.push(fe.concat(pe))}let D=[];for(let B=0;B<re[0].length;B++)re.forEach(($,fe)=>{(B!=U-M||fe>=z)&&D.push($[B])});return l(D.length==F),D}drawCodewords(_){if(_.length!=Math.floor(ct.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let x=0;for(let E=this.size-1;E>=1;E-=2){E==6&&(E=5);for(let b=0;b<this.size;b++)for(let M=0;M<2;M++){const F=E-M,U=(E+1&2)==0?this.size-1-b:b;!this.isFunction[U][F]&&x<_.length*8&&(this.modules[U][F]=s(_[x>>>3],7-(x&7)),x++)}}l(x==_.length*8)}applyMask(_){if(_<0||_>7)throw new RangeError("Mask value out of range");for(let x=0;x<this.size;x++)for(let E=0;E<this.size;E++){let b;switch(_){case 0:b=(E+x)%2==0;break;case 1:b=x%2==0;break;case 2:b=E%3==0;break;case 3:b=(E+x)%3==0;break;case 4:b=(Math.floor(E/3)+Math.floor(x/2))%2==0;break;case 5:b=E*x%2+E*x%3==0;break;case 6:b=(E*x%2+E*x%3)%2==0;break;case 7:b=((E+x)%2+E*x%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[x][E]&&b&&(this.modules[x][E]=!this.modules[x][E])}}getPenaltyScore(){let _=0;for(let M=0;M<this.size;M++){let F=!1,z=0,U=[0,0,0,0,0,0,0];for(let re=0;re<this.size;re++)this.modules[M][re]==F?(z++,z==5?_+=ct.PENALTY_N1:z>5&&_++):(this.finderPenaltyAddHistory(z,U),F||(_+=this.finderPenaltyCountPatterns(U)*ct.PENALTY_N3),F=this.modules[M][re],z=1);_+=this.finderPenaltyTerminateAndCount(F,z,U)*ct.PENALTY_N3}for(let M=0;M<this.size;M++){let F=!1,z=0,U=[0,0,0,0,0,0,0];for(let re=0;re<this.size;re++)this.modules[re][M]==F?(z++,z==5?_+=ct.PENALTY_N1:z>5&&_++):(this.finderPenaltyAddHistory(z,U),F||(_+=this.finderPenaltyCountPatterns(U)*ct.PENALTY_N3),F=this.modules[re][M],z=1);_+=this.finderPenaltyTerminateAndCount(F,z,U)*ct.PENALTY_N3}for(let M=0;M<this.size-1;M++)for(let F=0;F<this.size-1;F++){const z=this.modules[M][F];z==this.modules[M][F+1]&&z==this.modules[M+1][F]&&z==this.modules[M+1][F+1]&&(_+=ct.PENALTY_N2)}let x=0;for(const M of this.modules)x=M.reduce((F,z)=>F+(z?1:0),x);const E=this.size*this.size,b=Math.ceil(Math.abs(x*20-E*10)/E)-1;return l(0<=b&&b<=9),_+=b*ct.PENALTY_N4,l(0<=_&&_<=2568888),_}getAlignmentPatternPositions(){if(this.version==1)return[];{const _=Math.floor(this.version/7)+2,x=this.version==32?26:Math.ceil((this.version*4+4)/(_*2-2))*2;let E=[6];for(let b=this.size-7;E.length<_;b-=x)E.splice(1,0,b);return E}}static getNumRawDataModules(_){if(_<ct.MIN_VERSION||_>ct.MAX_VERSION)throw new RangeError("Version number out of range");let x=(16*_+128)*_+64;if(_>=2){const E=Math.floor(_/7)+2;x-=(25*E-10)*E-55,_>=7&&(x-=36)}return l(208<=x&&x<=29648),x}static getNumDataCodewords(_,x){return Math.floor(ct.getNumRawDataModules(_)/8)-ct.ECC_CODEWORDS_PER_BLOCK[x.ordinal][_]*ct.NUM_ERROR_CORRECTION_BLOCKS[x.ordinal][_]}static reedSolomonComputeDivisor(_){if(_<1||_>255)throw new RangeError("Degree out of range");let x=[];for(let b=0;b<_-1;b++)x.push(0);x.push(1);let E=1;for(let b=0;b<_;b++){for(let M=0;M<x.length;M++)x[M]=ct.reedSolomonMultiply(x[M],E),M+1<x.length&&(x[M]^=x[M+1]);E=ct.reedSolomonMultiply(E,2)}return x}static reedSolomonComputeRemainder(_,x){let E=x.map(b=>0);for(const b of _){const M=b^E.shift();E.push(0),x.forEach((F,z)=>E[z]^=ct.reedSolomonMultiply(F,M))}return E}static reedSolomonMultiply(_,x){if(_>>>8||x>>>8)throw new RangeError("Byte out of range");let E=0;for(let b=7;b>=0;b--)E=E<<1^(E>>>7)*285,E^=(x>>>b&1)*_;return l(E>>>8==0),E}finderPenaltyCountPatterns(_){const x=_[1];l(x<=this.size*3);const E=x>0&&_[2]==x&&_[3]==x*3&&_[4]==x&&_[5]==x;return(E&&_[0]>=x*4&&_[6]>=x?1:0)+(E&&_[6]>=x*4&&_[0]>=x?1:0)}finderPenaltyTerminateAndCount(_,x,E){return _&&(this.finderPenaltyAddHistory(x,E),x=0),x+=this.size,this.finderPenaltyAddHistory(x,E),this.finderPenaltyCountPatterns(E)}finderPenaltyAddHistory(_,x){x[0]==0&&(_+=this.size),x.pop(),x.unshift(_)}};t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;function n(v,_,x){if(_<0||_>31||v>>>_)throw new RangeError("Value out of range");for(let E=_-1;E>=0;E--)x.push(v>>>E&1)}function s(v,_){return(v>>>_&1)!=0}function l(v){if(!v)throw new Error("Assertion error")}const f=class tn{constructor(_,x,E){if(this.mode=_,this.numChars=x,this.bitData=E,x<0)throw new RangeError("Invalid argument");this.bitData=E.slice()}static makeBytes(_){let x=[];for(const E of _)n(E,8,x);return new tn(tn.Mode.BYTE,_.length,x)}static makeNumeric(_){if(!tn.isNumeric(_))throw new RangeError("String contains non-numeric characters");let x=[];for(let E=0;E<_.length;){const b=Math.min(_.length-E,3);n(parseInt(_.substring(E,E+b),10),b*3+1,x),E+=b}return new tn(tn.Mode.NUMERIC,_.length,x)}static makeAlphanumeric(_){if(!tn.isAlphanumeric(_))throw new RangeError("String contains unencodable characters in alphanumeric mode");let x=[],E;for(E=0;E+2<=_.length;E+=2){let b=tn.ALPHANUMERIC_CHARSET.indexOf(_.charAt(E))*45;b+=tn.ALPHANUMERIC_CHARSET.indexOf(_.charAt(E+1)),n(b,11,x)}return E<_.length&&n(tn.ALPHANUMERIC_CHARSET.indexOf(_.charAt(E)),6,x),new tn(tn.Mode.ALPHANUMERIC,_.length,x)}static makeSegments(_){return _==""?[]:tn.isNumeric(_)?[tn.makeNumeric(_)]:tn.isAlphanumeric(_)?[tn.makeAlphanumeric(_)]:[tn.makeBytes(tn.toUtf8ByteArray(_))]}static makeEci(_){let x=[];if(_<0)throw new RangeError("ECI assignment value out of range");if(_<128)n(_,8,x);else if(_<16384)n(2,2,x),n(_,14,x);else if(_<1e6)n(6,3,x),n(_,21,x);else throw new RangeError("ECI assignment value out of range");return new tn(tn.Mode.ECI,0,x)}static isNumeric(_){return tn.NUMERIC_REGEX.test(_)}static isAlphanumeric(_){return tn.ALPHANUMERIC_REGEX.test(_)}getData(){return this.bitData.slice()}static getTotalBits(_,x){let E=0;for(const b of _){const M=b.mode.numCharCountBits(x);if(b.numChars>=1<<M)return 1/0;E+=4+M+b.bitData.length}return E}static toUtf8ByteArray(_){_=encodeURI(_);let x=[];for(let E=0;E<_.length;E++)_.charAt(E)!="%"?x.push(_.charCodeAt(E)):(x.push(parseInt(_.substring(E+1,E+3),16)),E+=2);return x}};f.NUMERIC_REGEX=/^[0-9]*$/,f.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,f.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let m=f;e.QrSegment=f})(qs||(qs={}));(e=>{(t=>{const n=class{constructor(l,f){this.ordinal=l,this.formatBits=f}};n.LOW=new n(0,1),n.MEDIUM=new n(1,0),n.QUARTILE=new n(2,3),n.HIGH=new n(3,2),t.Ecc=n})(e.QrCode||(e.QrCode={}))})(qs||(qs={}));(e=>{(t=>{const n=class{constructor(l,f){this.modeBits=l,this.numBitsCharCount=f}numCharCountBits(l){return this.numBitsCharCount[Math.floor((l+7)/17)]}};n.NUMERIC=new n(1,[10,12,14]),n.ALPHANUMERIC=new n(2,[9,11,13]),n.BYTE=new n(4,[8,16,16]),n.KANJI=new n(8,[8,10,12]),n.ECI=new n(7,[0,0,0]),t.Mode=n})(e.QrSegment||(e.QrSegment={}))})(qs||(qs={}));var To=qs;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Rv={L:To.QrCode.Ecc.LOW,M:To.QrCode.Ecc.MEDIUM,Q:To.QrCode.Ecc.QUARTILE,H:To.QrCode.Ecc.HIGH},nm=128,rm="L",im="#FFFFFF",sm="#000000",om=!1,am=1,kv=4,Ov=0,Lv=.1;function lm(e,t=0){const n=[];return e.forEach(function(s,l){let f=null;s.forEach(function(m,v){if(!m&&f!==null){n.push(`M${f+t} ${l+t}h${v-f}v1H${f+t}z`),f=null;return}if(v===s.length-1){if(!m)return;f===null?n.push(`M${v+t},${l+t} h1v1H${v+t}z`):n.push(`M${f+t},${l+t} h${v+1-f}v1H${f+t}z`);return}m&&f===null&&(f=v)})}),n.join("")}function cm(e,t){return e.slice().map((n,s)=>s<t.y||s>=t.y+t.h?n:n.map((l,f)=>f<t.x||f>=t.x+t.w?l:!1))}function Pv(e,t,n,s){if(s==null)return null;const l=e.length+n*2,f=Math.floor(t*Lv),m=l/t,v=(s.width||f)*m,_=(s.height||f)*m,x=s.x==null?e.length/2-v/2:s.x*m,E=s.y==null?e.length/2-_/2:s.y*m,b=s.opacity==null?1:s.opacity;let M=null;if(s.excavate){let z=Math.floor(x),U=Math.floor(E),re=Math.ceil(v+x-z),H=Math.ceil(_+E-U);M={x:z,y:U,w:re,h:H}}const F=s.crossOrigin;return{x,y:E,h:_,w:v,excavation:M,opacity:b,crossOrigin:F}}function Dv(e,t){return t!=null?Math.max(Math.floor(t),0):e?kv:Ov}function um({value:e,level:t,minVersion:n,includeMargin:s,marginSize:l,imageSettings:f,size:m,boostLevel:v}){let _=Gt.useMemo(()=>{const z=(Array.isArray(e)?e:[e]).reduce((U,re)=>(U.push(...To.QrSegment.makeSegments(re)),U),[]);return To.QrCode.encodeSegments(z,Rv[t],n,void 0,void 0,v)},[e,t,n,v]);const{cells:x,margin:E,numCells:b,calculatedImageSettings:M}=Gt.useMemo(()=>{let F=_.getModules();const z=Dv(s,l),U=F.length+z*2,re=Pv(F,m,z,f);return{cells:F,margin:z,numCells:U,calculatedImageSettings:re}},[_,m,f,s,l]);return{qrcode:_,margin:E,cells:x,numCells:b,calculatedImageSettings:M}}var Bv=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Fv=Gt.forwardRef(function(t,n){const s=t,{value:l,size:f=nm,level:m=rm,bgColor:v=im,fgColor:_=sm,includeMargin:x=om,minVersion:E=am,boostLevel:b,marginSize:M,imageSettings:F}=s,U=Zf(s,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:re}=U,H=Zf(U,["style"]),D=F==null?void 0:F.src,B=Gt.useRef(null),$=Gt.useRef(null),fe=Gt.useCallback(ne=>{B.current=ne,typeof n=="function"?n(ne):n&&(n.current=ne)},[n]),[pe,K]=Gt.useState(!1),{margin:q,cells:V,numCells:le,calculatedImageSettings:ce}=um({value:l,level:m,minVersion:E,boostLevel:b,includeMargin:x,marginSize:M,imageSettings:F,size:f});Gt.useEffect(()=>{if(B.current!=null){const ne=B.current,Z=ne.getContext("2d");if(!Z)return;let ye=V;const he=$.current,J=ce!=null&&he!==null&&he.complete&&he.naturalHeight!==0&&he.naturalWidth!==0;J&&ce.excavation!=null&&(ye=cm(V,ce.excavation));const de=window.devicePixelRatio||1;ne.height=ne.width=f*de;const ae=f/le*de;Z.scale(ae,ae),Z.fillStyle=v,Z.fillRect(0,0,le,le),Z.fillStyle=_,Bv?Z.fill(new Path2D(lm(ye,q))):V.forEach(function(Ce,Ne){Ce.forEach(function(Qe,we){Qe&&Z.fillRect(we+q,Ne+q,1,1)})}),ce&&(Z.globalAlpha=ce.opacity),J&&Z.drawImage(he,ce.x+q,ce.y+q,ce.w,ce.h)}}),Gt.useEffect(()=>{K(!1)},[D]);const ue=Wf({height:f,width:f},re);let Q=null;return D!=null&&(Q=Gt.createElement("img",{src:D,key:D,style:{display:"none"},onLoad:()=>{K(!0)},ref:$,crossOrigin:ce==null?void 0:ce.crossOrigin})),Gt.createElement(Gt.Fragment,null,Gt.createElement("canvas",Wf({style:ue,height:f,width:f,ref:fe,role:"img"},H)),Q)});Fv.displayName="QRCodeCanvas";var fm=Gt.forwardRef(function(t,n){const s=t,{value:l,size:f=nm,level:m=rm,bgColor:v=im,fgColor:_=sm,includeMargin:x=om,minVersion:E=am,boostLevel:b,title:M,marginSize:F,imageSettings:z}=s,U=Zf(s,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:re,cells:H,numCells:D,calculatedImageSettings:B}=um({value:l,level:m,minVersion:E,boostLevel:b,includeMargin:x,marginSize:F,imageSettings:z,size:f});let $=H,fe=null;z!=null&&B!=null&&(B.excavation!=null&&($=cm(H,B.excavation)),fe=Gt.createElement("image",{href:z.src,height:B.h,width:B.w,x:B.x+re,y:B.y+re,preserveAspectRatio:"none",opacity:B.opacity,crossOrigin:B.crossOrigin}));const pe=lm($,re);return Gt.createElement("svg",Wf({height:f,width:f,viewBox:`0 0 ${D} ${D}`,ref:n,role:"img"},U),!!M&&Gt.createElement("title",null,M),Gt.createElement("path",{fill:v,d:`M0,0 h${D}v${D}H0z`,shapeRendering:"crispEdges"}),Gt.createElement("path",{fill:_,d:pe,shapeRendering:"crispEdges"}),fe)});fm.displayName="QRCodeSVG";var Fe;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Fe||(Fe={}));var K0=new Map([[Fe.QR_CODE,"QR_CODE"],[Fe.AZTEC,"AZTEC"],[Fe.CODABAR,"CODABAR"],[Fe.CODE_39,"CODE_39"],[Fe.CODE_93,"CODE_93"],[Fe.CODE_128,"CODE_128"],[Fe.DATA_MATRIX,"DATA_MATRIX"],[Fe.MAXICODE,"MAXICODE"],[Fe.ITF,"ITF"],[Fe.EAN_13,"EAN_13"],[Fe.EAN_8,"EAN_8"],[Fe.PDF_417,"PDF_417"],[Fe.RSS_14,"RSS_14"],[Fe.RSS_EXPANDED,"RSS_EXPANDED"],[Fe.UPC_A,"UPC_A"],[Fe.UPC_E,"UPC_E"],[Fe.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),q0;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(q0||(q0={}));function jv(e){return Object.values(Fe).includes(e)}var Ts;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Ts||(Ts={}));var ui=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[Ts.SCAN_TYPE_CAMERA,Ts.SCAN_TYPE_FILE],e}(),hm=function(){function e(t,n){this.format=t,this.formatName=n}return e.prototype.toString=function(){return this.formatName},e.create=function(t){if(!K0.has(t))throw"".concat(t," not in html5QrcodeSupportedFormatsTextMap");return new e(t,K0.get(t))},e}(),J0=function(){function e(){}return e.createFromText=function(t){var n={text:t};return{decodedText:t,result:n}},e.createFromQrcodeResult=function(t){return{decodedText:t.text,result:t}},e}(),Gf;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Gf||(Gf={}));var dm=function(){function e(){}return e.createFrom=function(t){return{errorMessage:t,type:Gf.UNKWOWN_ERROR}},e}(),pm=function(){function e(t){this.verbose=t}return e.prototype.log=function(t){this.verbose&&console.log(t)},e.prototype.warn=function(t){this.verbose&&console.warn(t)},e.prototype.logError=function(t,n){(this.verbose||n===!0)&&console.error(t)},e.prototype.logErrors=function(t){if(t.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(t)},e}();function Ii(e){return typeof e>"u"||e===null}function zv(e,t,n){return e>n?n:e<t?t:e}var Io=function(){function e(){}return e.codeParseError=function(t){return"QR code parse error, error = ".concat(t)},e.errorGettingUserMedia=function(t){return"Error getting userMedia, error = ".concat(t)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),At=function(){function e(){}return e.scanningStatus=function(){return"Scanning"},e.idleStatus=function(){return"Idle"},e.errorStatus=function(){return"Error"},e.permissionStatus=function(){return"Permission"},e.noCameraFoundErrorStatus=function(){return"No Cameras"},e.lastMatch=function(t){return"Last Match: ".concat(t)},e.codeScannerTitle=function(){return"Code Scanner"},e.cameraPermissionTitle=function(){return"Request Camera Permissions"},e.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},e.noCameraFound=function(){return"No camera found"},e.scanButtonStopScanningText=function(){return"Stop Scanning"},e.scanButtonStartScanningText=function(){return"Start Scanning"},e.torchOnButton=function(){return"Switch On Torch"},e.torchOffButton=function(){return"Switch Off Torch"},e.torchOnFailedMessage=function(){return"Failed to turn on torch"},e.torchOffFailedMessage=function(){return"Failed to turn off torch"},e.scanButtonScanningStarting=function(){return"Launching Camera..."},e.textIfCameraScanSelected=function(){return"Scan an Image File"},e.textIfFileScanSelected=function(){return"Scan using camera directly"},e.selectCamera=function(){return"Select Camera"},e.fileSelectionChooseImage=function(){return"Choose Image"},e.fileSelectionChooseAnother=function(){return"Choose Another"},e.fileSelectionNoImageSelected=function(){return"No image choosen"},e.anonymousCameraPrefix=function(){return"Anonymous Camera"},e.dragAndDropMessage=function(){return"Or drop an image to scan"},e.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},e.zoom=function(){return"zoom"},e.loadingImage=function(){return"Loading image..."},e.cameraScanAltText=function(){return"Camera based scan"},e.fileScanAltText=function(){return"Fule based scan"},e}(),e1=function(){function e(){}return e.poweredBy=function(){return"Powered by "},e.reportIssues=function(){return"Report issues"},e}(),gm=function(){function e(){}return e.isMediaStreamConstraintsValid=function(t,n){if(typeof t!="object"){var s=typeof t;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(s,"."),!0),!1}for(var l=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],f=new Set(l),m=Object.keys(t),v=0,_=m;v<_.length;v++){var x=_[v];if(f.has(x))return n.logError("".concat(x," is not supported videoConstaints."),!0),!1}return!0},e}(),Yf={exports:{}};(function(e,t){(function(n,s){s(t)})(us,function(n){function s(I){return I==null}var l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,r){I.__proto__=r}||function(I,r){for(var i in r)r.hasOwnProperty(i)&&(I[i]=r[i])};function f(I,r){l(I,r);function i(){this.constructor=I}I.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}function m(I,r){var i=Object.setPrototypeOf;i?i(I,r):I.__proto__=r}function v(I,r){r===void 0&&(r=I.constructor);var i=Error.captureStackTrace;i&&i(I,r)}var _=function(I){f(r,I);function r(i){var a=this.constructor,c=I.call(this,i)||this;return Object.defineProperty(c,"name",{value:a.name,enumerable:!1}),m(c,a.prototype),v(c),c}return r}(Error);class x extends _{constructor(r=void 0){super(r),this.message=r}getKind(){return this.constructor.kind}}x.kind="Exception";class E extends x{}E.kind="ArgumentException";class b extends x{}b.kind="IllegalArgumentException";class M{constructor(r){if(this.binarizer=r,r===null)throw new b("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(r,i){return this.binarizer.getBlackRow(r,i)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(r,i,a,c){const u=this.binarizer.getLuminanceSource().crop(r,i,a,c);return new M(this.binarizer.createBinarizer(u))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new M(this.binarizer.createBinarizer(r))}rotateCounterClockwise45(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new M(this.binarizer.createBinarizer(r))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class F extends x{static getChecksumInstance(){return new F}}F.kind="ChecksumException";class z{constructor(r){this.source=r}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class U{static arraycopy(r,i,a,c,u){for(;u--;)a[c++]=r[i++]}static currentTimeMillis(){return Date.now()}}class re extends x{}re.kind="IndexOutOfBoundsException";class H extends re{constructor(r=void 0,i=void 0){super(i),this.index=r,this.message=i}}H.kind="ArrayIndexOutOfBoundsException";class D{static fill(r,i){for(let a=0,c=r.length;a<c;a++)r[a]=i}static fillWithin(r,i,a,c){D.rangeCheck(r.length,i,a);for(let u=i;u<a;u++)r[u]=c}static rangeCheck(r,i,a){if(i>a)throw new b("fromIndex("+i+") > toIndex("+a+")");if(i<0)throw new H(i);if(a>r)throw new H(a)}static asList(...r){return r}static create(r,i,a){return Array.from({length:r}).map(u=>Array.from({length:i}).fill(a))}static createInt32Array(r,i,a){return Array.from({length:r}).map(u=>Int32Array.from({length:i}).fill(a))}static equals(r,i){if(!r||!i||!r.length||!i.length||r.length!==i.length)return!1;for(let a=0,c=r.length;a<c;a++)if(r[a]!==i[a])return!1;return!0}static hashCode(r){if(r===null)return 0;let i=1;for(const a of r)i=31*i+a;return i}static fillUint8Array(r,i){for(let a=0;a!==r.length;a++)r[a]=i}static copyOf(r,i){return r.slice(0,i)}static copyOfUint8Array(r,i){if(r.length<=i){const a=new Uint8Array(i);return a.set(r),a}return r.slice(0,i)}static copyOfRange(r,i,a){const c=a-i,u=new Int32Array(c);return U.arraycopy(r,i,u,0,c),u}static binarySearch(r,i,a){a===void 0&&(a=D.numberComparator);let c=0,u=r.length-1;for(;c<=u;){const d=u+c>>1,p=a(i,r[d]);if(p>0)c=d+1;else if(p<0)u=d-1;else return d}return-c-1}static numberComparator(r,i){return r-i}}class B{static numberOfTrailingZeros(r){let i;if(r===0)return 32;let a=31;return i=r<<16,i!==0&&(a-=16,r=i),i=r<<8,i!==0&&(a-=8,r=i),i=r<<4,i!==0&&(a-=4,r=i),i=r<<2,i!==0&&(a-=2,r=i),a-(r<<1>>>31)}static numberOfLeadingZeros(r){if(r===0)return 32;let i=1;return r>>>16||(i+=16,r<<=16),r>>>24||(i+=8,r<<=8),r>>>28||(i+=4,r<<=4),r>>>30||(i+=2,r<<=2),i-=r>>>31,i}static toHexString(r){return r.toString(16)}static toBinaryString(r){return String(parseInt(String(r),2))}static bitCount(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),r=r+(r>>>4)&252645135,r=r+(r>>>8),r=r+(r>>>16),r&63}static truncDivision(r,i){return Math.trunc(r/i)}static parseInt(r,i=void 0){return parseInt(r,i)}}B.MIN_VALUE_32_BITS=-2147483648,B.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ${constructor(r,i){r===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=r,i==null?this.bits=$.makeArray(r):this.bits=i)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(r){if(r>this.bits.length*32){const i=$.makeArray(r);U.arraycopy(this.bits,0,i,0,this.bits.length),this.bits=i}}get(r){return(this.bits[Math.floor(r/32)]&1<<(r&31))!==0}set(r){this.bits[Math.floor(r/32)]|=1<<(r&31)}flip(r){this.bits[Math.floor(r/32)]^=1<<(r&31)}getNextSet(r){const i=this.size;if(r>=i)return i;const a=this.bits;let c=Math.floor(r/32),u=a[c];u&=~((1<<(r&31))-1);const d=a.length;for(;u===0;){if(++c===d)return i;u=a[c]}const p=c*32+B.numberOfTrailingZeros(u);return p>i?i:p}getNextUnset(r){const i=this.size;if(r>=i)return i;const a=this.bits;let c=Math.floor(r/32),u=~a[c];u&=~((1<<(r&31))-1);const d=a.length;for(;u===0;){if(++c===d)return i;u=~a[c]}const p=c*32+B.numberOfTrailingZeros(u);return p>i?i:p}setBulk(r,i){this.bits[Math.floor(r/32)]=i}setRange(r,i){if(i<r||r<0||i>this.size)throw new b;if(i===r)return;i--;const a=Math.floor(r/32),c=Math.floor(i/32),u=this.bits;for(let d=a;d<=c;d++){const p=d>a?0:r&31,w=(2<<(d<c?31:i&31))-(1<<p);u[d]|=w}}clear(){const r=this.bits.length,i=this.bits;for(let a=0;a<r;a++)i[a]=0}isRange(r,i,a){if(i<r||r<0||i>this.size)throw new b;if(i===r)return!0;i--;const c=Math.floor(r/32),u=Math.floor(i/32),d=this.bits;for(let p=c;p<=u;p++){const y=p>c?0:r&31,S=(2<<(p<u?31:i&31))-(1<<y)&4294967295;if((d[p]&S)!==(a?S:0))return!1}return!0}appendBit(r){this.ensureCapacity(this.size+1),r&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(r,i){if(i<0||i>32)throw new b("Num bits must be between 0 and 32");this.ensureCapacity(this.size+i);for(let a=i;a>0;a--)this.appendBit((r>>a-1&1)===1)}appendBitArray(r){const i=r.size;this.ensureCapacity(this.size+i);for(let a=0;a<i;a++)this.appendBit(r.get(a))}xor(r){if(this.size!==r.size)throw new b("Sizes don't match");const i=this.bits;for(let a=0,c=i.length;a<c;a++)i[a]^=r.bits[a]}toBytes(r,i,a,c){for(let u=0;u<c;u++){let d=0;for(let p=0;p<8;p++)this.get(r)&&(d|=1<<7-p),r++;i[a+u]=d}}getBitArray(){return this.bits}reverse(){const r=new Int32Array(this.bits.length),i=Math.floor((this.size-1)/32),a=i+1,c=this.bits;for(let u=0;u<a;u++){let d=c[u];d=d>>1&1431655765|(d&1431655765)<<1,d=d>>2&858993459|(d&858993459)<<2,d=d>>4&252645135|(d&252645135)<<4,d=d>>8&16711935|(d&16711935)<<8,d=d>>16&65535|(d&65535)<<16,r[i-u]=d}if(this.size!==a*32){const u=a*32-this.size;let d=r[0]>>>u;for(let p=1;p<a;p++){const y=r[p];d|=y<<32-u,r[p-1]=d,d=y>>>u}r[a-1]=d}this.bits=r}static makeArray(r){return new Int32Array(Math.floor((r+31)/32))}equals(r){if(!(r instanceof $))return!1;const i=r;return this.size===i.size&&D.equals(this.bits,i.bits)}hashCode(){return 31*this.size+D.hashCode(this.bits)}toString(){let r="";for(let i=0,a=this.size;i<a;i++)i&7||(r+=" "),r+=this.get(i)?"X":".";return r}clone(){return new $(this.size,this.bits.slice())}}var fe;(function(I){I[I.OTHER=0]="OTHER",I[I.PURE_BARCODE=1]="PURE_BARCODE",I[I.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",I[I.TRY_HARDER=3]="TRY_HARDER",I[I.CHARACTER_SET=4]="CHARACTER_SET",I[I.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",I[I.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",I[I.ASSUME_GS1=7]="ASSUME_GS1",I[I.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",I[I.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",I[I.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(fe||(fe={}));var pe=fe;class K extends x{static getFormatInstance(){return new K}}K.kind="FormatException";var q;(function(I){I[I.Cp437=0]="Cp437",I[I.ISO8859_1=1]="ISO8859_1",I[I.ISO8859_2=2]="ISO8859_2",I[I.ISO8859_3=3]="ISO8859_3",I[I.ISO8859_4=4]="ISO8859_4",I[I.ISO8859_5=5]="ISO8859_5",I[I.ISO8859_6=6]="ISO8859_6",I[I.ISO8859_7=7]="ISO8859_7",I[I.ISO8859_8=8]="ISO8859_8",I[I.ISO8859_9=9]="ISO8859_9",I[I.ISO8859_10=10]="ISO8859_10",I[I.ISO8859_11=11]="ISO8859_11",I[I.ISO8859_13=12]="ISO8859_13",I[I.ISO8859_14=13]="ISO8859_14",I[I.ISO8859_15=14]="ISO8859_15",I[I.ISO8859_16=15]="ISO8859_16",I[I.SJIS=16]="SJIS",I[I.Cp1250=17]="Cp1250",I[I.Cp1251=18]="Cp1251",I[I.Cp1252=19]="Cp1252",I[I.Cp1256=20]="Cp1256",I[I.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",I[I.UTF8=22]="UTF8",I[I.ASCII=23]="ASCII",I[I.Big5=24]="Big5",I[I.GB18030=25]="GB18030",I[I.EUC_KR=26]="EUC_KR"})(q||(q={}));class V{constructor(r,i,a,...c){this.valueIdentifier=r,this.name=a,typeof i=="number"?this.values=Int32Array.from([i]):this.values=i,this.otherEncodingNames=c,V.VALUE_IDENTIFIER_TO_ECI.set(r,this),V.NAME_TO_ECI.set(a,this);const u=this.values;for(let d=0,p=u.length;d!==p;d++){const y=u[d];V.VALUES_TO_ECI.set(y,this)}for(const d of c)V.NAME_TO_ECI.set(d,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(r){if(r<0||r>=900)throw new K("incorect value");const i=V.VALUES_TO_ECI.get(r);if(i===void 0)throw new K("incorect value");return i}static getCharacterSetECIByName(r){const i=V.NAME_TO_ECI.get(r);if(i===void 0)throw new K("incorect value");return i}equals(r){if(!(r instanceof V))return!1;const i=r;return this.getName()===i.getName()}}V.VALUE_IDENTIFIER_TO_ECI=new Map,V.VALUES_TO_ECI=new Map,V.NAME_TO_ECI=new Map,V.Cp437=new V(q.Cp437,Int32Array.from([0,2]),"Cp437"),V.ISO8859_1=new V(q.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),V.ISO8859_2=new V(q.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),V.ISO8859_3=new V(q.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),V.ISO8859_4=new V(q.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),V.ISO8859_5=new V(q.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),V.ISO8859_6=new V(q.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),V.ISO8859_7=new V(q.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),V.ISO8859_8=new V(q.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),V.ISO8859_9=new V(q.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),V.ISO8859_10=new V(q.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),V.ISO8859_11=new V(q.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),V.ISO8859_13=new V(q.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),V.ISO8859_14=new V(q.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),V.ISO8859_15=new V(q.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),V.ISO8859_16=new V(q.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),V.SJIS=new V(q.SJIS,20,"SJIS","Shift_JIS"),V.Cp1250=new V(q.Cp1250,21,"Cp1250","windows-1250"),V.Cp1251=new V(q.Cp1251,22,"Cp1251","windows-1251"),V.Cp1252=new V(q.Cp1252,23,"Cp1252","windows-1252"),V.Cp1256=new V(q.Cp1256,24,"Cp1256","windows-1256"),V.UnicodeBigUnmarked=new V(q.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),V.UTF8=new V(q.UTF8,26,"UTF8","UTF-8"),V.ASCII=new V(q.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),V.Big5=new V(q.Big5,28,"Big5"),V.GB18030=new V(q.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),V.EUC_KR=new V(q.EUC_KR,30,"EUC_KR","EUC-KR");class le extends x{}le.kind="UnsupportedOperationException";class ce{static decode(r,i){const a=this.encodingName(i);return this.customDecoder?this.customDecoder(r,a):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(a)?this.decodeFallback(r,a):new TextDecoder(a).decode(r)}static shouldDecodeOnFallback(r){return!ce.isBrowser()&&r==="ISO-8859-1"}static encode(r,i){const a=this.encodingName(i);return this.customEncoder?this.customEncoder(r,a):typeof TextEncoder>"u"?this.encodeFallback(r):new TextEncoder().encode(r)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(r){return typeof r=="string"?r:r.getName()}static encodingCharacterSet(r){return r instanceof V?r:V.getCharacterSetECIByName(r)}static decodeFallback(r,i){const a=this.encodingCharacterSet(i);if(ce.isDecodeFallbackSupported(a)){let c="";for(let u=0,d=r.length;u<d;u++){let p=r[u].toString(16);p.length<2&&(p="0"+p),c+="%"+p}return decodeURIComponent(c)}if(a.equals(V.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(r.buffer));throw new le(`Encoding ${this.encodingName(i)} not supported by fallback.`)}static isDecodeFallbackSupported(r){return r.equals(V.UTF8)||r.equals(V.ISO8859_1)||r.equals(V.ASCII)}static encodeFallback(r){const a=btoa(unescape(encodeURIComponent(r))).split(""),c=[];for(let u=0;u<a.length;u++)c.push(a[u].charCodeAt(0));return new Uint8Array(c)}}class ue{static castAsNonUtf8Char(r,i=null){const a=i?i.getName():this.ISO88591;return ce.decode(new Uint8Array([r]),a)}static guessEncoding(r,i){if(i!=null&&i.get(pe.CHARACTER_SET)!==void 0)return i.get(pe.CHARACTER_SET).toString();const a=r.length;let c=!0,u=!0,d=!0,p=0,y=0,w=0,S=0,N=0,k=0,j=0,G=0,X=0,ee=0,ie=0;const Ee=r.length>3&&r[0]===239&&r[1]===187&&r[2]===191;for(let be=0;be<a&&(c||u||d);be++){const ve=r[be]&255;d&&(p>0?ve&128?p--:d=!1:ve&128&&(ve&64?(p++,ve&32?(p++,ve&16?(p++,ve&8?d=!1:S++):w++):y++):d=!1)),c&&(ve>127&&ve<160?c=!1:ve>159&&(ve<192||ve===215||ve===247)&&ie++),u&&(N>0?ve<64||ve===127||ve>252?u=!1:N--:ve===128||ve===160||ve>239?u=!1:ve>160&&ve<224?(k++,G=0,j++,j>X&&(X=j)):ve>127?(N++,j=0,G++,G>ee&&(ee=G)):(j=0,G=0))}return d&&p>0&&(d=!1),u&&N>0&&(u=!1),d&&(Ee||y+w+S>0)?ue.UTF8:u&&(ue.ASSUME_SHIFT_JIS||X>=3||ee>=3)?ue.SHIFT_JIS:c&&u?X===2&&k===2||ie*10>=a?ue.SHIFT_JIS:ue.ISO88591:c?ue.ISO88591:u?ue.SHIFT_JIS:d?ue.UTF8:ue.PLATFORM_DEFAULT_ENCODING}static format(r,...i){let a=-1;function c(d,p,y,w,S,N){if(d==="%%")return"%";if(i[++a]===void 0)return;d=w?parseInt(w.substr(1)):void 0;let k=S?parseInt(S.substr(1)):void 0,j;switch(N){case"s":j=i[a];break;case"c":j=i[a][0];break;case"f":j=parseFloat(i[a]).toFixed(d);break;case"p":j=parseFloat(i[a]).toPrecision(d);break;case"e":j=parseFloat(i[a]).toExponential(d);break;case"x":j=parseInt(i[a]).toString(k||16);break;case"d":j=parseFloat(parseInt(i[a],k||10).toPrecision(d)).toFixed(0);break}j=typeof j=="object"?JSON.stringify(j):(+j).toString(k);let G=parseInt(y),X=y&&y[0]+""=="0"?"0":" ";for(;j.length<G;)j=p!==void 0?j+X:X+j;return j}let u=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(u,c)}static getBytes(r,i){return ce.encode(r,i)}static getCharCode(r,i=0){return r.charCodeAt(i)}static getCharAt(r){return String.fromCharCode(r)}}ue.SHIFT_JIS=V.SJIS.getName(),ue.GB2312="GB2312",ue.ISO88591=V.ISO8859_1.getName(),ue.EUC_JP="EUC_JP",ue.UTF8=V.UTF8.getName(),ue.PLATFORM_DEFAULT_ENCODING=ue.UTF8,ue.ASSUME_SHIFT_JIS=!1;class Q{constructor(r=""){this.value=r}enableDecoding(r){return this.encoding=r,this}append(r){return typeof r=="string"?this.value+=r.toString():this.encoding?this.value+=ue.castAsNonUtf8Char(r,this.encoding):this.value+=String.fromCharCode(r),this}appendChars(r,i,a){for(let c=i;i<i+a;c++)this.append(r[c]);return this}length(){return this.value.length}charAt(r){return this.value.charAt(r)}deleteCharAt(r){this.value=this.value.substr(0,r)+this.value.substring(r+1)}setCharAt(r,i){this.value=this.value.substr(0,r)+i+this.value.substr(r+1)}substring(r,i){return this.value.substring(r,i)}setLengthToZero(){this.value=""}toString(){return this.value}insert(r,i){this.value=this.value.substr(0,r)+i+this.value.substr(r+i.length)}}class ne{constructor(r,i,a,c){if(this.width=r,this.height=i,this.rowSize=a,this.bits=c,i==null&&(i=r),this.height=i,r<1||i<1)throw new b("Both dimensions must be greater than 0");a==null&&(a=Math.floor((r+31)/32)),this.rowSize=a,c==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(r){const i=r.length,a=r[0].length,c=new ne(a,i);for(let u=0;u<i;u++){const d=r[u];for(let p=0;p<a;p++)d[p]&&c.set(p,u)}return c}static parseFromString(r,i,a){if(r===null)throw new b("stringRepresentation cannot be null");const c=new Array(r.length);let u=0,d=0,p=-1,y=0,w=0;for(;w<r.length;)if(r.charAt(w)===`
`||r.charAt(w)==="\r"){if(u>d){if(p===-1)p=u-d;else if(u-d!==p)throw new b("row lengths do not match");d=u,y++}w++}else if(r.substring(w,w+i.length)===i)w+=i.length,c[u]=!0,u++;else if(r.substring(w,w+a.length)===a)w+=a.length,c[u]=!1,u++;else throw new b("illegal character encountered: "+r.substring(w));if(u>d){if(p===-1)p=u-d;else if(u-d!==p)throw new b("row lengths do not match");y++}const S=new ne(p,y);for(let N=0;N<u;N++)c[N]&&S.set(Math.floor(N%p),Math.floor(N/p));return S}get(r,i){const a=i*this.rowSize+Math.floor(r/32);return(this.bits[a]>>>(r&31)&1)!==0}set(r,i){const a=i*this.rowSize+Math.floor(r/32);this.bits[a]|=1<<(r&31)&4294967295}unset(r,i){const a=i*this.rowSize+Math.floor(r/32);this.bits[a]&=~(1<<(r&31)&4294967295)}flip(r,i){const a=i*this.rowSize+Math.floor(r/32);this.bits[a]^=1<<(r&31)&4294967295}xor(r){if(this.width!==r.getWidth()||this.height!==r.getHeight()||this.rowSize!==r.getRowSize())throw new b("input matrix dimensions do not match");const i=new $(Math.floor(this.width/32)+1),a=this.rowSize,c=this.bits;for(let u=0,d=this.height;u<d;u++){const p=u*a,y=r.getRow(u,i).getBitArray();for(let w=0;w<a;w++)c[p+w]^=y[w]}}clear(){const r=this.bits,i=r.length;for(let a=0;a<i;a++)r[a]=0}setRegion(r,i,a,c){if(i<0||r<0)throw new b("Left and top must be nonnegative");if(c<1||a<1)throw new b("Height and width must be at least 1");const u=r+a,d=i+c;if(d>this.height||u>this.width)throw new b("The region must fit inside the matrix");const p=this.rowSize,y=this.bits;for(let w=i;w<d;w++){const S=w*p;for(let N=r;N<u;N++)y[S+Math.floor(N/32)]|=1<<(N&31)&4294967295}}getRow(r,i){i==null||i.getSize()<this.width?i=new $(this.width):i.clear();const a=this.rowSize,c=this.bits,u=r*a;for(let d=0;d<a;d++)i.setBulk(d*32,c[u+d]);return i}setRow(r,i){U.arraycopy(i.getBitArray(),0,this.bits,r*this.rowSize,this.rowSize)}rotate180(){const r=this.getWidth(),i=this.getHeight();let a=new $(r),c=new $(r);for(let u=0,d=Math.floor((i+1)/2);u<d;u++)a=this.getRow(u,a),c=this.getRow(i-1-u,c),a.reverse(),c.reverse(),this.setRow(u,c),this.setRow(i-1-u,a)}getEnclosingRectangle(){const r=this.width,i=this.height,a=this.rowSize,c=this.bits;let u=r,d=i,p=-1,y=-1;for(let w=0;w<i;w++)for(let S=0;S<a;S++){const N=c[w*a+S];if(N!==0){if(w<d&&(d=w),w>y&&(y=w),S*32<u){let k=0;for(;!(N<<31-k&4294967295);)k++;S*32+k<u&&(u=S*32+k)}if(S*32+31>p){let k=31;for(;!(N>>>k);)k--;S*32+k>p&&(p=S*32+k)}}}return p<u||y<d?null:Int32Array.from([u,d,p-u+1,y-d+1])}getTopLeftOnBit(){const r=this.rowSize,i=this.bits;let a=0;for(;a<i.length&&i[a]===0;)a++;if(a===i.length)return null;const c=a/r;let u=a%r*32;const d=i[a];let p=0;for(;!(d<<31-p&4294967295);)p++;return u+=p,Int32Array.from([u,c])}getBottomRightOnBit(){const r=this.rowSize,i=this.bits;let a=i.length-1;for(;a>=0&&i[a]===0;)a--;if(a<0)return null;const c=Math.floor(a/r);let u=Math.floor(a%r)*32;const d=i[a];let p=31;for(;!(d>>>p);)p--;return u+=p,Int32Array.from([u,c])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(r){if(!(r instanceof ne))return!1;const i=r;return this.width===i.width&&this.height===i.height&&this.rowSize===i.rowSize&&D.equals(this.bits,i.bits)}hashCode(){let r=this.width;return r=31*r+this.width,r=31*r+this.height,r=31*r+this.rowSize,r=31*r+D.hashCode(this.bits),r}toString(r="X ",i="  ",a=`
`){return this.buildToString(r,i,a)}buildToString(r,i,a){let c=new Q;for(let u=0,d=this.height;u<d;u++){for(let p=0,y=this.width;p<y;p++)c.append(this.get(p,u)?r:i);c.append(a)}return c.toString()}clone(){return new ne(this.width,this.height,this.rowSize,this.bits.slice())}}class Z extends x{static getNotFoundInstance(){return new Z}}Z.kind="NotFoundException";class ye extends z{constructor(r){super(r),this.luminances=ye.EMPTY,this.buckets=new Int32Array(ye.LUMINANCE_BUCKETS)}getBlackRow(r,i){const a=this.getLuminanceSource(),c=a.getWidth();i==null||i.getSize()<c?i=new $(c):i.clear(),this.initArrays(c);const u=a.getRow(r,this.luminances),d=this.buckets;for(let y=0;y<c;y++)d[(u[y]&255)>>ye.LUMINANCE_SHIFT]++;const p=ye.estimateBlackPoint(d);if(c<3)for(let y=0;y<c;y++)(u[y]&255)<p&&i.set(y);else{let y=u[0]&255,w=u[1]&255;for(let S=1;S<c-1;S++){const N=u[S+1]&255;(w*4-y-N)/2<p&&i.set(S),y=w,w=N}}return i}getBlackMatrix(){const r=this.getLuminanceSource(),i=r.getWidth(),a=r.getHeight(),c=new ne(i,a);this.initArrays(i);const u=this.buckets;for(let y=1;y<5;y++){const w=Math.floor(a*y/5),S=r.getRow(w,this.luminances),N=Math.floor(i*4/5);for(let k=Math.floor(i/5);k<N;k++){const j=S[k]&255;u[j>>ye.LUMINANCE_SHIFT]++}}const d=ye.estimateBlackPoint(u),p=r.getMatrix();for(let y=0;y<a;y++){const w=y*i;for(let S=0;S<i;S++)(p[w+S]&255)<d&&c.set(S,y)}return c}createBinarizer(r){return new ye(r)}initArrays(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));const i=this.buckets;for(let a=0;a<ye.LUMINANCE_BUCKETS;a++)i[a]=0}static estimateBlackPoint(r){const i=r.length;let a=0,c=0,u=0;for(let S=0;S<i;S++)r[S]>u&&(c=S,u=r[S]),r[S]>a&&(a=r[S]);let d=0,p=0;for(let S=0;S<i;S++){const N=S-c,k=r[S]*N*N;k>p&&(d=S,p=k)}if(c>d){const S=c;c=d,d=S}if(d-c<=i/16)throw new Z;let y=d-1,w=-1;for(let S=d-1;S>c;S--){const N=S-c,k=N*N*(d-S)*(a-r[S]);k>w&&(y=S,w=k)}return y<<ye.LUMINANCE_SHIFT}}ye.LUMINANCE_BITS=5,ye.LUMINANCE_SHIFT=8-ye.LUMINANCE_BITS,ye.LUMINANCE_BUCKETS=1<<ye.LUMINANCE_BITS,ye.EMPTY=Uint8ClampedArray.from([0]);class he extends ye{constructor(r){super(r),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const r=this.getLuminanceSource(),i=r.getWidth(),a=r.getHeight();if(i>=he.MINIMUM_DIMENSION&&a>=he.MINIMUM_DIMENSION){const c=r.getMatrix();let u=i>>he.BLOCK_SIZE_POWER;i&he.BLOCK_SIZE_MASK&&u++;let d=a>>he.BLOCK_SIZE_POWER;a&he.BLOCK_SIZE_MASK&&d++;const p=he.calculateBlackPoints(c,u,d,i,a),y=new ne(i,a);he.calculateThresholdForBlock(c,u,d,i,a,p,y),this.matrix=y}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(r){return new he(r)}static calculateThresholdForBlock(r,i,a,c,u,d,p){const y=u-he.BLOCK_SIZE,w=c-he.BLOCK_SIZE;for(let S=0;S<a;S++){let N=S<<he.BLOCK_SIZE_POWER;N>y&&(N=y);const k=he.cap(S,2,a-3);for(let j=0;j<i;j++){let G=j<<he.BLOCK_SIZE_POWER;G>w&&(G=w);const X=he.cap(j,2,i-3);let ee=0;for(let Ee=-2;Ee<=2;Ee++){const be=d[k+Ee];ee+=be[X-2]+be[X-1]+be[X]+be[X+1]+be[X+2]}const ie=ee/25;he.thresholdBlock(r,G,N,ie,c,p)}}}static cap(r,i,a){return r<i?i:r>a?a:r}static thresholdBlock(r,i,a,c,u,d){for(let p=0,y=a*u+i;p<he.BLOCK_SIZE;p++,y+=u)for(let w=0;w<he.BLOCK_SIZE;w++)(r[y+w]&255)<=c&&d.set(i+w,a+p)}static calculateBlackPoints(r,i,a,c,u){const d=u-he.BLOCK_SIZE,p=c-he.BLOCK_SIZE,y=new Array(a);for(let w=0;w<a;w++){y[w]=new Int32Array(i);let S=w<<he.BLOCK_SIZE_POWER;S>d&&(S=d);for(let N=0;N<i;N++){let k=N<<he.BLOCK_SIZE_POWER;k>p&&(k=p);let j=0,G=255,X=0;for(let ie=0,Ee=S*c+k;ie<he.BLOCK_SIZE;ie++,Ee+=c){for(let be=0;be<he.BLOCK_SIZE;be++){const ve=r[Ee+be]&255;j+=ve,ve<G&&(G=ve),ve>X&&(X=ve)}if(X-G>he.MIN_DYNAMIC_RANGE)for(ie++,Ee+=c;ie<he.BLOCK_SIZE;ie++,Ee+=c)for(let be=0;be<he.BLOCK_SIZE;be++)j+=r[Ee+be]&255}let ee=j>>he.BLOCK_SIZE_POWER*2;if(X-G<=he.MIN_DYNAMIC_RANGE&&(ee=G/2,w>0&&N>0)){const ie=(y[w-1][N]+2*y[w][N-1]+y[w-1][N-1])/4;G<ie&&(ee=ie)}y[w][N]=ee}}return y}}he.BLOCK_SIZE_POWER=3,he.BLOCK_SIZE=1<<he.BLOCK_SIZE_POWER,he.BLOCK_SIZE_MASK=he.BLOCK_SIZE-1,he.MINIMUM_DIMENSION=he.BLOCK_SIZE*5,he.MIN_DYNAMIC_RANGE=24;class J{constructor(r,i){this.width=r,this.height=i}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(r,i,a,c){throw new le("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new le("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new le("This luminance source does not support rotation by 45 degrees.")}toString(){const r=new Uint8ClampedArray(this.width);let i=new Q;for(let a=0;a<this.height;a++){const c=this.getRow(a,r);for(let u=0;u<this.width;u++){const d=c[u]&255;let p;d<64?p="#":d<128?p="+":d<192?p=".":p=" ",i.append(p)}i.append(`
`)}return i.toString()}}class de extends J{constructor(r){super(r.getWidth(),r.getHeight()),this.delegate=r}getRow(r,i){const a=this.delegate.getRow(r,i),c=this.getWidth();for(let u=0;u<c;u++)a[u]=255-(a[u]&255);return a}getMatrix(){const r=this.delegate.getMatrix(),i=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(i);for(let c=0;c<i;c++)a[c]=255-(r[c]&255);return a}isCropSupported(){return this.delegate.isCropSupported()}crop(r,i,a,c){return new de(this.delegate.crop(r,i,a,c))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new de(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new de(this.delegate.rotateCounterClockwise45())}}class ae extends J{constructor(r){super(r.width,r.height),this.canvas=r,this.tempCanvasElement=null,this.buffer=ae.makeBufferFromCanvasImageData(r)}static makeBufferFromCanvasImageData(r){const i=r.getContext("2d").getImageData(0,0,r.width,r.height);return ae.toGrayscaleBuffer(i.data,r.width,r.height)}static toGrayscaleBuffer(r,i,a){const c=new Uint8ClampedArray(i*a);for(let u=0,d=0,p=r.length;u<p;u+=4,d++){let y;if(r[u+3]===0)y=255;else{const S=r[u],N=r[u+1],k=r[u+2];y=306*S+601*N+117*k+512>>10}c[d]=y}return c}getRow(r,i){if(r<0||r>=this.getHeight())throw new b("Requested row is outside the image: "+r);const a=this.getWidth(),c=r*a;return i===null?i=this.buffer.slice(c,c+a):(i.length<a&&(i=new Uint8ClampedArray(a)),i.set(this.buffer.slice(c,c+a))),i}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(r,i,a,c){return super.crop(r,i,a,c),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement}rotate(r){const i=this.getTempCanvasElement(),a=i.getContext("2d"),c=r*ae.DEGREE_TO_RADIANS,u=this.canvas.width,d=this.canvas.height,p=Math.ceil(Math.abs(Math.cos(c))*u+Math.abs(Math.sin(c))*d),y=Math.ceil(Math.abs(Math.sin(c))*u+Math.abs(Math.cos(c))*d);return i.width=p,i.height=y,a.translate(p/2,y/2),a.rotate(c),a.drawImage(this.canvas,u/-2,d/-2),this.buffer=ae.makeBufferFromCanvasImageData(i),this}invert(){return new de(this)}}ae.DEGREE_TO_RADIANS=Math.PI/180;class Ce{constructor(r,i,a){this.deviceId=r,this.label=i,this.kind="videoinput",this.groupId=a||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Ne=(globalThis||us||self||window||void 0)&&(globalThis||us||self||window||void 0).__awaiter||function(I,r,i,a){function c(u){return u instanceof i?u:new i(function(d){d(u)})}return new(i||(i=Promise))(function(u,d){function p(S){try{w(a.next(S))}catch(N){d(N)}}function y(S){try{w(a.throw(S))}catch(N){d(N)}}function w(S){S.done?u(S.value):c(S.value).then(p,y)}w((a=a.apply(I,r||[])).next())})};class Qe{constructor(r,i=500,a){this.reader=r,this.timeBetweenScansMillis=i,this._hints=a,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(r){this._timeBetweenDecodingAttempts=r<0?0:r}set hints(r){this._hints=r||null}get hints(){return this._hints}listVideoInputDevices(){return Ne(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const r=yield navigator.mediaDevices.enumerateDevices(),i=[];for(const a of r){const c=a.kind==="video"?"videoinput":a.kind;if(c!=="videoinput")continue;const u=a.deviceId||a.id,d=a.label||`Video device ${i.length+1}`,p=a.groupId,y={deviceId:u,label:d,kind:c,groupId:p};i.push(y)}return i})}getVideoInputDevices(){return Ne(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(i=>new Ce(i.deviceId,i.label))})}findDeviceById(r){return Ne(this,void 0,void 0,function*(){const i=yield this.listVideoInputDevices();return i?i.find(a=>a.deviceId===r):null})}decodeFromInputVideoDevice(r,i){return Ne(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(r,i)})}decodeOnceFromVideoDevice(r,i){return Ne(this,void 0,void 0,function*(){this.reset();let a;r?a={deviceId:{exact:r}}:a={facingMode:"environment"};const c={video:a};return yield this.decodeOnceFromConstraints(c,i)})}decodeOnceFromConstraints(r,i){return Ne(this,void 0,void 0,function*(){const a=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeOnceFromStream(a,i)})}decodeOnceFromStream(r,i){return Ne(this,void 0,void 0,function*(){this.reset();const a=yield this.attachStreamToVideo(r,i);return yield this.decodeOnce(a)})}decodeFromInputVideoDeviceContinuously(r,i,a){return Ne(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(r,i,a)})}decodeFromVideoDevice(r,i,a){return Ne(this,void 0,void 0,function*(){let c;r?c={deviceId:{exact:r}}:c={facingMode:"environment"};const u={video:c};return yield this.decodeFromConstraints(u,i,a)})}decodeFromConstraints(r,i,a){return Ne(this,void 0,void 0,function*(){const c=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeFromStream(c,i,a)})}decodeFromStream(r,i,a){return Ne(this,void 0,void 0,function*(){this.reset();const c=yield this.attachStreamToVideo(r,i);return yield this.decodeContinuously(c,a)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(r,i){return Ne(this,void 0,void 0,function*(){const a=this.prepareVideoElement(i);return this.addVideoSource(a,r),this.videoElement=a,this.stream=r,yield this.playVideoOnLoadAsync(a),a})}playVideoOnLoadAsync(r){return new Promise((i,a)=>this.playVideoOnLoad(r,()=>i()))}playVideoOnLoad(r,i){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(r),r.addEventListener("ended",this.videoEndedListener),r.addEventListener("canplay",this.videoCanPlayListener),r.addEventListener("playing",i),this.tryPlayVideo(r)}isVideoPlaying(r){return r.currentTime>0&&!r.paused&&!r.ended&&r.readyState>2}tryPlayVideo(r){return Ne(this,void 0,void 0,function*(){if(this.isVideoPlaying(r)){console.warn("Trying to play video that is already playing.");return}try{yield r.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(r,i){const a=document.getElementById(r);if(!a)throw new E(`element with id '${r}' not found`);if(a.nodeName.toLowerCase()!==i.toLowerCase())throw new E(`element with id '${r}' must be an ${i} element`);return a}decodeFromImage(r,i){if(!r&&!i)throw new E("either imageElement with a src set or an url must be provided");return i&&!r?this.decodeFromImageUrl(i):this.decodeFromImageElement(r)}decodeFromVideo(r,i){if(!r&&!i)throw new E("Either an element with a src set or an URL must be provided");return i&&!r?this.decodeFromVideoUrl(i):this.decodeFromVideoElement(r)}decodeFromVideoContinuously(r,i,a){if(r===void 0&&i===void 0)throw new E("Either an element with a src set or an URL must be provided");return i&&!r?this.decodeFromVideoUrlContinuously(i,a):this.decodeFromVideoElementContinuously(r,a)}decodeFromImageElement(r){if(!r)throw new E("An image element must be provided.");this.reset();const i=this.prepareImageElement(r);this.imageElement=i;let a;return this.isImageLoaded(i)?a=this.decodeOnce(i,!1,!0):a=this._decodeOnLoadImage(i),a}decodeFromVideoElement(r){const i=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideo(i)}decodeFromVideoElementContinuously(r,i){const a=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideoContinuously(a,i)}_decodeFromVideoElementSetup(r){if(!r)throw new E("A video element must be provided.");this.reset();const i=this.prepareVideoElement(r);return this.videoElement=i,i}decodeFromImageUrl(r){if(!r)throw new E("An URL must be provided.");this.reset();const i=this.prepareImageElement();this.imageElement=i;const a=this._decodeOnLoadImage(i);return i.src=r,a}decodeFromVideoUrl(r){if(!r)throw new E("An URL must be provided.");this.reset();const i=this.prepareVideoElement(),a=this.decodeFromVideoElement(i);return i.src=r,a}decodeFromVideoUrlContinuously(r,i){if(!r)throw new E("An URL must be provided.");this.reset();const a=this.prepareVideoElement(),c=this.decodeFromVideoElementContinuously(a,i);return a.src=r,c}_decodeOnLoadImage(r){return new Promise((i,a)=>{this.imageLoadedListener=()=>this.decodeOnce(r,!1,!0).then(i,a),r.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(r){return Ne(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(r),yield this.decodeOnce(r)})}_decodeOnLoadVideoContinuously(r,i){return Ne(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(r),this.decodeContinuously(r,i)})}isImageLoaded(r){return!(!r.complete||r.naturalWidth===0)}prepareImageElement(r){let i;return typeof r>"u"&&(i=document.createElement("img"),i.width=200,i.height=200),typeof r=="string"&&(i=this.getMediaElement(r,"img")),r instanceof HTMLImageElement&&(i=r),i}prepareVideoElement(r){let i;return!r&&typeof document<"u"&&(i=document.createElement("video"),i.width=200,i.height=200),typeof r=="string"&&(i=this.getMediaElement(r,"video")),r instanceof HTMLVideoElement&&(i=r),i.setAttribute("autoplay","true"),i.setAttribute("muted","true"),i.setAttribute("playsinline","true"),i}decodeOnce(r,i=!0,a=!0){this._stopAsyncDecode=!1;const c=(u,d)=>{if(this._stopAsyncDecode){d(new Z("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const p=this.decode(r);u(p)}catch(p){const y=i&&p instanceof Z,S=(p instanceof F||p instanceof K)&&a;if(y||S)return setTimeout(c,this._timeBetweenDecodingAttempts,u,d);d(p)}};return new Promise((u,d)=>c(u,d))}decodeContinuously(r,i){this._stopContinuousDecode=!1;const a=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const c=this.decode(r);i(c,null),setTimeout(a,this.timeBetweenScansMillis)}catch(c){i(null,c);const u=c instanceof F||c instanceof K,d=c instanceof Z;(u||d)&&setTimeout(a,this._timeBetweenDecodingAttempts)}};a()}decode(r){const i=this.createBinaryBitmap(r);return this.decodeBitmap(i)}_isHTMLVideoElement(r){return r.videoWidth!==0}drawFrameOnCanvas(r,i,a){i||(i={sx:0,sy:0,sWidth:r.videoWidth,sHeight:r.videoHeight,dx:0,dy:0,dWidth:r.videoWidth,dHeight:r.videoHeight}),a||(a=this.captureCanvasContext),a.drawImage(r,i.sx,i.sy,i.sWidth,i.sHeight,i.dx,i.dy,i.dWidth,i.dHeight)}drawImageOnCanvas(r,i,a=this.captureCanvasContext){i||(i={sx:0,sy:0,sWidth:r.naturalWidth,sHeight:r.naturalHeight,dx:0,dy:0,dWidth:r.naturalWidth,dHeight:r.naturalHeight}),a||(a=this.captureCanvasContext),a.drawImage(r,i.sx,i.sy,i.sWidth,i.sHeight,i.dx,i.dy,i.dWidth,i.dHeight)}createBinaryBitmap(r){this.getCaptureCanvasContext(r),this._isHTMLVideoElement(r)?this.drawFrameOnCanvas(r):this.drawImageOnCanvas(r);const i=this.getCaptureCanvas(r),a=new ae(i),c=new he(a);return new M(c)}getCaptureCanvasContext(r){if(!this.captureCanvasContext){const a=this.getCaptureCanvas(r).getContext("2d");this.captureCanvasContext=a}return this.captureCanvasContext}getCaptureCanvas(r){if(!this.captureCanvas){const i=this.createCaptureCanvas(r);this.captureCanvas=i}return this.captureCanvas}decodeBitmap(r){return this.reader.decode(r,this._hints)}createCaptureCanvas(r){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const i=document.createElement("canvas");let a,c;return typeof r<"u"&&(r instanceof HTMLVideoElement?(a=r.videoWidth,c=r.videoHeight):r instanceof HTMLImageElement&&(a=r.naturalWidth||r.width,c=r.naturalHeight||r.height)),i.style.width=a+"px",i.style.height=c+"px",i.width=a,i.height=c,i}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(r=>r.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(r,i){try{r.srcObject=i}catch{r.src=URL.createObjectURL(i)}}cleanVideoSource(r){try{r.srcObject=null}catch{r.src=""}this.videoElement.removeAttribute("src")}}class we{constructor(r,i,a=i==null?0:8*i.length,c,u,d=U.currentTimeMillis()){this.text=r,this.rawBytes=i,this.numBits=a,this.resultPoints=c,this.format=u,this.timestamp=d,this.text=r,this.rawBytes=i,a==null?this.numBits=i==null?0:8*i.length:this.numBits=a,this.resultPoints=c,this.format=u,this.resultMetadata=null,d==null?this.timestamp=U.currentTimeMillis():this.timestamp=d}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(r,i){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(r,i)}putAllMetadata(r){r!==null&&(this.resultMetadata===null?this.resultMetadata=r:this.resultMetadata=new Map(r))}addResultPoints(r){const i=this.resultPoints;if(i===null)this.resultPoints=r;else if(r!==null&&r.length>0){const a=new Array(i.length+r.length);U.arraycopy(i,0,a,0,i.length),U.arraycopy(r,0,a,i.length,r.length),this.resultPoints=a}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Le;(function(I){I[I.AZTEC=0]="AZTEC",I[I.CODABAR=1]="CODABAR",I[I.CODE_39=2]="CODE_39",I[I.CODE_93=3]="CODE_93",I[I.CODE_128=4]="CODE_128",I[I.DATA_MATRIX=5]="DATA_MATRIX",I[I.EAN_8=6]="EAN_8",I[I.EAN_13=7]="EAN_13",I[I.ITF=8]="ITF",I[I.MAXICODE=9]="MAXICODE",I[I.PDF_417=10]="PDF_417",I[I.QR_CODE=11]="QR_CODE",I[I.RSS_14=12]="RSS_14",I[I.RSS_EXPANDED=13]="RSS_EXPANDED",I[I.UPC_A=14]="UPC_A",I[I.UPC_E=15]="UPC_E",I[I.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Le||(Le={}));var ge=Le,mt;(function(I){I[I.OTHER=0]="OTHER",I[I.ORIENTATION=1]="ORIENTATION",I[I.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",I[I.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",I[I.ISSUE_NUMBER=4]="ISSUE_NUMBER",I[I.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",I[I.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",I[I.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",I[I.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",I[I.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",I[I.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(mt||(mt={}));var He=mt;class Bn{constructor(r,i,a,c,u=-1,d=-1){this.rawBytes=r,this.text=i,this.byteSegments=a,this.ecLevel=c,this.structuredAppendSequenceNumber=u,this.structuredAppendParity=d,this.numBits=r==null?0:8*r.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(r){this.numBits=r}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(r){this.errorsCorrected=r}getErasures(){return this.erasures}setErasures(r){this.erasures=r}getOther(){return this.other}setOther(r){this.other=r}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Fn{exp(r){return this.expTable[r]}log(r){if(r===0)throw new b;return this.logTable[r]}static addOrSubtract(r,i){return r^i}}class Ot{constructor(r,i){if(i.length===0)throw new b;this.field=r;const a=i.length;if(a>1&&i[0]===0){let c=1;for(;c<a&&i[c]===0;)c++;c===a?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(a-c),U.arraycopy(i,c,this.coefficients,0,this.coefficients.length))}else this.coefficients=i}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);const i=this.coefficients;let a;if(r===1){a=0;for(let d=0,p=i.length;d!==p;d++){const y=i[d];a=Fn.addOrSubtract(a,y)}return a}a=i[0];const c=i.length,u=this.field;for(let d=1;d<c;d++)a=Fn.addOrSubtract(u.multiply(r,a),i[d]);return a}addOrSubtract(r){if(!this.field.equals(r.field))throw new b("GenericGFPolys do not have same GenericGF field");if(this.isZero())return r;if(r.isZero())return this;let i=this.coefficients,a=r.coefficients;if(i.length>a.length){const d=i;i=a,a=d}let c=new Int32Array(a.length);const u=a.length-i.length;U.arraycopy(a,0,c,0,u);for(let d=u;d<a.length;d++)c[d]=Fn.addOrSubtract(i[d-u],a[d]);return new Ot(this.field,c)}multiply(r){if(!this.field.equals(r.field))throw new b("GenericGFPolys do not have same GenericGF field");if(this.isZero()||r.isZero())return this.field.getZero();const i=this.coefficients,a=i.length,c=r.coefficients,u=c.length,d=new Int32Array(a+u-1),p=this.field;for(let y=0;y<a;y++){const w=i[y];for(let S=0;S<u;S++)d[y+S]=Fn.addOrSubtract(d[y+S],p.multiply(w,c[S]))}return new Ot(p,d)}multiplyScalar(r){if(r===0)return this.field.getZero();if(r===1)return this;const i=this.coefficients.length,a=this.field,c=new Int32Array(i),u=this.coefficients;for(let d=0;d<i;d++)c[d]=a.multiply(u[d],r);return new Ot(a,c)}multiplyByMonomial(r,i){if(r<0)throw new b;if(i===0)return this.field.getZero();const a=this.coefficients,c=a.length,u=new Int32Array(c+r),d=this.field;for(let p=0;p<c;p++)u[p]=d.multiply(a[p],i);return new Ot(d,u)}divide(r){if(!this.field.equals(r.field))throw new b("GenericGFPolys do not have same GenericGF field");if(r.isZero())throw new b("Divide by 0");const i=this.field;let a=i.getZero(),c=this;const u=r.getCoefficient(r.getDegree()),d=i.inverse(u);for(;c.getDegree()>=r.getDegree()&&!c.isZero();){const p=c.getDegree()-r.getDegree(),y=i.multiply(c.getCoefficient(c.getDegree()),d),w=r.multiplyByMonomial(p,y),S=i.buildMonomial(p,y);a=a.addOrSubtract(S),c=c.addOrSubtract(w)}return[a,c]}toString(){let r="";for(let i=this.getDegree();i>=0;i--){let a=this.getCoefficient(i);if(a!==0){if(a<0?(r+=" - ",a=-a):r.length>0&&(r+=" + "),i===0||a!==1){const c=this.field.log(a);c===0?r+="1":c===1?r+="a":(r+="a^",r+=c)}i!==0&&(i===1?r+="x":(r+="x^",r+=i))}}return r}}class yt extends x{}yt.kind="ArithmeticException";class $e extends Fn{constructor(r,i,a){super(),this.primitive=r,this.size=i,this.generatorBase=a;const c=new Int32Array(i);let u=1;for(let p=0;p<i;p++)c[p]=u,u*=2,u>=i&&(u^=r,u&=i-1);this.expTable=c;const d=new Int32Array(i);for(let p=0;p<i-1;p++)d[c[p]]=p;this.logTable=d,this.zero=new Ot(this,Int32Array.from([0])),this.one=new Ot(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,i){if(r<0)throw new b;if(i===0)return this.zero;const a=new Int32Array(r+1);return a[0]=i,new Ot(this,a)}inverse(r){if(r===0)throw new yt;return this.expTable[this.size-this.logTable[r]-1]}multiply(r,i){return r===0||i===0?0:this.expTable[(this.logTable[r]+this.logTable[i])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+B.toHexString(this.primitive)+","+this.size+")"}equals(r){return r===this}}$e.AZTEC_DATA_12=new $e(4201,4096,1),$e.AZTEC_DATA_10=new $e(1033,1024,1),$e.AZTEC_DATA_6=new $e(67,64,1),$e.AZTEC_PARAM=new $e(19,16,1),$e.QR_CODE_FIELD_256=new $e(285,256,0),$e.DATA_MATRIX_FIELD_256=new $e(301,256,1),$e.AZTEC_DATA_8=$e.DATA_MATRIX_FIELD_256,$e.MAXICODE_FIELD_64=$e.AZTEC_DATA_6;class Sn extends x{}Sn.kind="ReedSolomonException";class Xt extends x{}Xt.kind="IllegalStateException";class Rn{constructor(r){this.field=r}decode(r,i){const a=this.field,c=new Ot(a,r),u=new Int32Array(i);let d=!0;for(let j=0;j<i;j++){const G=c.evaluateAt(a.exp(j+a.getGeneratorBase()));u[u.length-1-j]=G,G!==0&&(d=!1)}if(d)return;const p=new Ot(a,u),y=this.runEuclideanAlgorithm(a.buildMonomial(i,1),p,i),w=y[0],S=y[1],N=this.findErrorLocations(w),k=this.findErrorMagnitudes(S,N);for(let j=0;j<N.length;j++){const G=r.length-1-a.log(N[j]);if(G<0)throw new Sn("Bad error location");r[G]=$e.addOrSubtract(r[G],k[j])}}runEuclideanAlgorithm(r,i,a){if(r.getDegree()<i.getDegree()){const j=r;r=i,i=j}const c=this.field;let u=r,d=i,p=c.getZero(),y=c.getOne();for(;d.getDegree()>=(a/2|0);){let j=u,G=p;if(u=d,p=y,u.isZero())throw new Sn("r_{i-1} was zero");d=j;let X=c.getZero();const ee=u.getCoefficient(u.getDegree()),ie=c.inverse(ee);for(;d.getDegree()>=u.getDegree()&&!d.isZero();){const Ee=d.getDegree()-u.getDegree(),be=c.multiply(d.getCoefficient(d.getDegree()),ie);X=X.addOrSubtract(c.buildMonomial(Ee,be)),d=d.addOrSubtract(u.multiplyByMonomial(Ee,be))}if(y=X.multiply(p).addOrSubtract(G),d.getDegree()>=u.getDegree())throw new Xt("Division algorithm failed to reduce polynomial?")}const w=y.getCoefficient(0);if(w===0)throw new Sn("sigmaTilde(0) was zero");const S=c.inverse(w),N=y.multiplyScalar(S),k=d.multiplyScalar(S);return[N,k]}findErrorLocations(r){const i=r.getDegree();if(i===1)return Int32Array.from([r.getCoefficient(1)]);const a=new Int32Array(i);let c=0;const u=this.field;for(let d=1;d<u.getSize()&&c<i;d++)r.evaluateAt(d)===0&&(a[c]=u.inverse(d),c++);if(c!==i)throw new Sn("Error locator degree does not match number of roots");return a}findErrorMagnitudes(r,i){const a=i.length,c=new Int32Array(a),u=this.field;for(let d=0;d<a;d++){const p=u.inverse(i[d]);let y=1;for(let w=0;w<a;w++)if(d!==w){const S=u.multiply(i[w],p),N=S&1?S&-2:S|1;y=u.multiply(y,N)}c[d]=u.multiply(r.evaluateAt(p),u.inverse(y)),u.getGeneratorBase()!==0&&(c[d]=u.multiply(c[d],p))}return c}}var Oe;(function(I){I[I.UPPER=0]="UPPER",I[I.LOWER=1]="LOWER",I[I.MIXED=2]="MIXED",I[I.DIGIT=3]="DIGIT",I[I.PUNCT=4]="PUNCT",I[I.BINARY=5]="BINARY"})(Oe||(Oe={}));class We{decode(r){this.ddata=r;let i=r.getBits(),a=this.extractBits(i),c=this.correctBits(a),u=We.convertBoolArrayToByteArray(c),d=We.getEncodedData(c),p=new Bn(u,d,null,null);return p.setNumBits(c.length),p}static highLevelDecode(r){return this.getEncodedData(r)}static getEncodedData(r){let i=r.length,a=Oe.UPPER,c=Oe.UPPER,u="",d=0;for(;d<i;)if(c===Oe.BINARY){if(i-d<5)break;let p=We.readCode(r,d,5);if(d+=5,p===0){if(i-d<11)break;p=We.readCode(r,d,11)+31,d+=11}for(let y=0;y<p;y++){if(i-d<8){d=i;break}const w=We.readCode(r,d,8);u+=ue.castAsNonUtf8Char(w),d+=8}c=a}else{let p=c===Oe.DIGIT?4:5;if(i-d<p)break;let y=We.readCode(r,d,p);d+=p;let w=We.getCharacter(c,y);w.startsWith("CTRL_")?(a=c,c=We.getTable(w.charAt(5)),w.charAt(6)==="L"&&(a=c)):(u+=w,c=a)}return u}static getTable(r){switch(r){case"L":return Oe.LOWER;case"P":return Oe.PUNCT;case"M":return Oe.MIXED;case"D":return Oe.DIGIT;case"B":return Oe.BINARY;case"U":default:return Oe.UPPER}}static getCharacter(r,i){switch(r){case Oe.UPPER:return We.UPPER_TABLE[i];case Oe.LOWER:return We.LOWER_TABLE[i];case Oe.MIXED:return We.MIXED_TABLE[i];case Oe.PUNCT:return We.PUNCT_TABLE[i];case Oe.DIGIT:return We.DIGIT_TABLE[i];default:throw new Xt("Bad table")}}correctBits(r){let i,a;this.ddata.getNbLayers()<=2?(a=6,i=$e.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(a=8,i=$e.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(a=10,i=$e.AZTEC_DATA_10):(a=12,i=$e.AZTEC_DATA_12);let c=this.ddata.getNbDatablocks(),u=r.length/a;if(u<c)throw new K;let d=r.length%a,p=new Int32Array(u);for(let k=0;k<u;k++,d+=a)p[k]=We.readCode(r,d,a);try{new Rn(i).decode(p,u-c)}catch(k){throw new K(k)}let y=(1<<a)-1,w=0;for(let k=0;k<c;k++){let j=p[k];if(j===0||j===y)throw new K;(j===1||j===y-1)&&w++}let S=new Array(c*a-w),N=0;for(let k=0;k<c;k++){let j=p[k];if(j===1||j===y-1)S.fill(j>1,N,N+a-1),N+=a-1;else for(let G=a-1;G>=0;--G)S[N++]=(j&1<<G)!==0}return S}extractBits(r){let i=this.ddata.isCompact(),a=this.ddata.getNbLayers(),c=(i?11:14)+a*4,u=new Int32Array(c),d=new Array(this.totalBitsInLayer(a,i));if(i)for(let p=0;p<u.length;p++)u[p]=p;else{let p=c+1+2*B.truncDivision(B.truncDivision(c,2)-1,15),y=c/2,w=B.truncDivision(p,2);for(let S=0;S<y;S++){let N=S+B.truncDivision(S,15);u[y-S-1]=w-N-1,u[y+S]=w+N+1}}for(let p=0,y=0;p<a;p++){let w=(a-p)*4+(i?9:12),S=p*2,N=c-1-S;for(let k=0;k<w;k++){let j=k*2;for(let G=0;G<2;G++)d[y+j+G]=r.get(u[S+G],u[S+k]),d[y+2*w+j+G]=r.get(u[S+k],u[N-G]),d[y+4*w+j+G]=r.get(u[N-G],u[N-k]),d[y+6*w+j+G]=r.get(u[N-k],u[S+G])}y+=w*8}return d}static readCode(r,i,a){let c=0;for(let u=i;u<i+a;u++)c<<=1,r[u]&&(c|=1);return c}static readByte(r,i){let a=r.length-i;return a>=8?We.readCode(r,i,8):We.readCode(r,i,a)<<8-a}static convertBoolArrayToByteArray(r){let i=new Uint8Array((r.length+7)/8);for(let a=0;a<i.length;a++)i[a]=We.readByte(r,8*a);return i}totalBitsInLayer(r,i){return((i?88:112)+16*r)*r}}We.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],We.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],We.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],We.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],We.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Xe{constructor(){}static round(r){return r===NaN?0:r<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:r>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:r+(r<0?-.5:.5)|0}static distance(r,i,a,c){const u=r-a,d=i-c;return Math.sqrt(u*u+d*d)}static sum(r){let i=0;for(let a=0,c=r.length;a!==c;a++){const u=r[a];i+=u}return i}}class $t{static floatToIntBits(r){return r}}$t.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Te{constructor(r,i){this.x=r,this.y=i}getX(){return this.x}getY(){return this.y}equals(r){if(r instanceof Te){const i=r;return this.x===i.x&&this.y===i.y}return!1}hashCode(){return 31*$t.floatToIntBits(this.x)+$t.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(r){const i=this.distance(r[0],r[1]),a=this.distance(r[1],r[2]),c=this.distance(r[0],r[2]);let u,d,p;if(a>=i&&a>=c?(d=r[0],u=r[1],p=r[2]):c>=a&&c>=i?(d=r[1],u=r[0],p=r[2]):(d=r[2],u=r[0],p=r[1]),this.crossProductZ(u,d,p)<0){const y=u;u=p,p=y}r[0]=u,r[1]=d,r[2]=p}static distance(r,i){return Xe.distance(r.x,r.y,i.x,i.y)}static crossProductZ(r,i,a){const c=i.x,u=i.y;return(a.x-c)*(r.y-u)-(a.y-u)*(r.x-c)}}class Lt{constructor(r,i){this.bits=r,this.points=i}getBits(){return this.bits}getPoints(){return this.points}}class ki extends Lt{constructor(r,i,a,c,u){super(r,i),this.compact=a,this.nbDatablocks=c,this.nbLayers=u}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class hn{constructor(r,i,a,c){this.image=r,this.height=r.getHeight(),this.width=r.getWidth(),i==null&&(i=hn.INIT_SIZE),a==null&&(a=r.getWidth()/2|0),c==null&&(c=r.getHeight()/2|0);const u=i/2|0;if(this.leftInit=a-u,this.rightInit=a+u,this.upInit=c-u,this.downInit=c+u,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new Z}detect(){let r=this.leftInit,i=this.rightInit,a=this.upInit,c=this.downInit,u=!1,d=!0,p=!1,y=!1,w=!1,S=!1,N=!1;const k=this.width,j=this.height;for(;d;){d=!1;let G=!0;for(;(G||!y)&&i<k;)G=this.containsBlackPoint(a,c,i,!1),G?(i++,d=!0,y=!0):y||i++;if(i>=k){u=!0;break}let X=!0;for(;(X||!w)&&c<j;)X=this.containsBlackPoint(r,i,c,!0),X?(c++,d=!0,w=!0):w||c++;if(c>=j){u=!0;break}let ee=!0;for(;(ee||!S)&&r>=0;)ee=this.containsBlackPoint(a,c,r,!1),ee?(r--,d=!0,S=!0):S||r--;if(r<0){u=!0;break}let ie=!0;for(;(ie||!N)&&a>=0;)ie=this.containsBlackPoint(r,i,a,!0),ie?(a--,d=!0,N=!0):N||a--;if(a<0){u=!0;break}d&&(p=!0)}if(!u&&p){const G=i-r;let X=null;for(let be=1;X===null&&be<G;be++)X=this.getBlackPointOnSegment(r,c-be,r+be,c);if(X==null)throw new Z;let ee=null;for(let be=1;ee===null&&be<G;be++)ee=this.getBlackPointOnSegment(r,a+be,r+be,a);if(ee==null)throw new Z;let ie=null;for(let be=1;ie===null&&be<G;be++)ie=this.getBlackPointOnSegment(i,a+be,i-be,a);if(ie==null)throw new Z;let Ee=null;for(let be=1;Ee===null&&be<G;be++)Ee=this.getBlackPointOnSegment(i,c-be,i-be,c);if(Ee==null)throw new Z;return this.centerEdges(Ee,X,ie,ee)}else throw new Z}getBlackPointOnSegment(r,i,a,c){const u=Xe.round(Xe.distance(r,i,a,c)),d=(a-r)/u,p=(c-i)/u,y=this.image;for(let w=0;w<u;w++){const S=Xe.round(r+w*d),N=Xe.round(i+w*p);if(y.get(S,N))return new Te(S,N)}return null}centerEdges(r,i,a,c){const u=r.getX(),d=r.getY(),p=i.getX(),y=i.getY(),w=a.getX(),S=a.getY(),N=c.getX(),k=c.getY(),j=hn.CORR;return u<this.width/2?[new Te(N-j,k+j),new Te(p+j,y+j),new Te(w-j,S-j),new Te(u+j,d-j)]:[new Te(N+j,k+j),new Te(p+j,y-j),new Te(w-j,S+j),new Te(u-j,d-j)]}containsBlackPoint(r,i,a,c){const u=this.image;if(c){for(let d=r;d<=i;d++)if(u.get(d,a))return!0}else for(let d=r;d<=i;d++)if(u.get(a,d))return!0;return!1}}hn.INIT_SIZE=10,hn.CORR=1;class Oi{static checkAndNudgePoints(r,i){const a=r.getWidth(),c=r.getHeight();let u=!0;for(let d=0;d<i.length&&u;d+=2){const p=Math.floor(i[d]),y=Math.floor(i[d+1]);if(p<-1||p>a||y<-1||y>c)throw new Z;u=!1,p===-1?(i[d]=0,u=!0):p===a&&(i[d]=a-1,u=!0),y===-1?(i[d+1]=0,u=!0):y===c&&(i[d+1]=c-1,u=!0)}u=!0;for(let d=i.length-2;d>=0&&u;d-=2){const p=Math.floor(i[d]),y=Math.floor(i[d+1]);if(p<-1||p>a||y<-1||y>c)throw new Z;u=!1,p===-1?(i[d]=0,u=!0):p===a&&(i[d]=a-1,u=!0),y===-1?(i[d+1]=0,u=!0):y===c&&(i[d+1]=c-1,u=!0)}}}class Ct{constructor(r,i,a,c,u,d,p,y,w){this.a11=r,this.a21=i,this.a31=a,this.a12=c,this.a22=u,this.a32=d,this.a13=p,this.a23=y,this.a33=w}static quadrilateralToQuadrilateral(r,i,a,c,u,d,p,y,w,S,N,k,j,G,X,ee){const ie=Ct.quadrilateralToSquare(r,i,a,c,u,d,p,y);return Ct.squareToQuadrilateral(w,S,N,k,j,G,X,ee).times(ie)}transformPoints(r){const i=r.length,a=this.a11,c=this.a12,u=this.a13,d=this.a21,p=this.a22,y=this.a23,w=this.a31,S=this.a32,N=this.a33;for(let k=0;k<i;k+=2){const j=r[k],G=r[k+1],X=u*j+y*G+N;r[k]=(a*j+d*G+w)/X,r[k+1]=(c*j+p*G+S)/X}}transformPointsWithValues(r,i){const a=this.a11,c=this.a12,u=this.a13,d=this.a21,p=this.a22,y=this.a23,w=this.a31,S=this.a32,N=this.a33,k=r.length;for(let j=0;j<k;j++){const G=r[j],X=i[j],ee=u*G+y*X+N;r[j]=(a*G+d*X+w)/ee,i[j]=(c*G+p*X+S)/ee}}static squareToQuadrilateral(r,i,a,c,u,d,p,y){const w=r-a+u-p,S=i-c+d-y;if(w===0&&S===0)return new Ct(a-r,u-a,r,c-i,d-c,i,0,0,1);{const N=a-u,k=p-u,j=c-d,G=y-d,X=N*G-k*j,ee=(w*G-k*S)/X,ie=(N*S-w*j)/X;return new Ct(a-r+ee*a,p-r+ie*p,r,c-i+ee*c,y-i+ie*y,i,ee,ie,1)}}static quadrilateralToSquare(r,i,a,c,u,d,p,y){return Ct.squareToQuadrilateral(r,i,a,c,u,d,p,y).buildAdjoint()}buildAdjoint(){return new Ct(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(r){return new Ct(this.a11*r.a11+this.a21*r.a12+this.a31*r.a13,this.a11*r.a21+this.a21*r.a22+this.a31*r.a23,this.a11*r.a31+this.a21*r.a32+this.a31*r.a33,this.a12*r.a11+this.a22*r.a12+this.a32*r.a13,this.a12*r.a21+this.a22*r.a22+this.a32*r.a23,this.a12*r.a31+this.a22*r.a32+this.a32*r.a33,this.a13*r.a11+this.a23*r.a12+this.a33*r.a13,this.a13*r.a21+this.a23*r.a22+this.a33*r.a23,this.a13*r.a31+this.a23*r.a32+this.a33*r.a33)}}class gi extends Oi{sampleGrid(r,i,a,c,u,d,p,y,w,S,N,k,j,G,X,ee,ie,Ee,be){const ve=Ct.quadrilateralToQuadrilateral(c,u,d,p,y,w,S,N,k,j,G,X,ee,ie,Ee,be);return this.sampleGridWithTransform(r,i,a,ve)}sampleGridWithTransform(r,i,a,c){if(i<=0||a<=0)throw new Z;const u=new ne(i,a),d=new Float32Array(2*i);for(let p=0;p<a;p++){const y=d.length,w=p+.5;for(let S=0;S<y;S+=2)d[S]=S/2+.5,d[S+1]=w;c.transformPoints(d),Oi.checkAndNudgePoints(r,d);try{for(let S=0;S<y;S+=2)r.get(Math.floor(d[S]),Math.floor(d[S+1]))&&u.set(S/2,p)}catch{throw new Z}}return u}}class Qn{static setGridSampler(r){Qn.gridSampler=r}static getInstance(){return Qn.gridSampler}}Qn.gridSampler=new gi;class Pt{constructor(r,i){this.x=r,this.y=i}toResultPoint(){return new Te(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Kn{constructor(r){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=r}detect(){return this.detectMirror(!1)}detectMirror(r){let i=this.getMatrixCenter(),a=this.getBullsEyeCorners(i);if(r){let d=a[0];a[0]=a[2],a[2]=d}this.extractParameters(a);let c=this.sampleGrid(this.image,a[this.shift%4],a[(this.shift+1)%4],a[(this.shift+2)%4],a[(this.shift+3)%4]),u=this.getMatrixCornerPoints(a);return new ki(c,u,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(r){if(!this.isValidPoint(r[0])||!this.isValidPoint(r[1])||!this.isValidPoint(r[2])||!this.isValidPoint(r[3]))throw new Z;let i=2*this.nbCenterLayers,a=new Int32Array([this.sampleLine(r[0],r[1],i),this.sampleLine(r[1],r[2],i),this.sampleLine(r[2],r[3],i),this.sampleLine(r[3],r[0],i)]);this.shift=this.getRotation(a,i);let c=0;for(let d=0;d<4;d++){let p=a[(this.shift+d)%4];this.compact?(c<<=7,c+=p>>1&127):(c<<=10,c+=(p>>2&992)+(p>>1&31))}let u=this.getCorrectedParameterData(c,this.compact);this.compact?(this.nbLayers=(u>>6)+1,this.nbDataBlocks=(u&63)+1):(this.nbLayers=(u>>11)+1,this.nbDataBlocks=(u&2047)+1)}getRotation(r,i){let a=0;r.forEach((c,u,d)=>{let p=(c>>i-2<<1)+(c&1);a=(a<<3)+p}),a=((a&1)<<11)+(a>>1);for(let c=0;c<4;c++)if(B.bitCount(a^this.EXPECTED_CORNER_BITS[c])<=2)return c;throw new Z}getCorrectedParameterData(r,i){let a,c;i?(a=7,c=2):(a=10,c=4);let u=a-c,d=new Int32Array(a);for(let y=a-1;y>=0;--y)d[y]=r&15,r>>=4;try{new Rn($e.AZTEC_PARAM).decode(d,u)}catch{throw new Z}let p=0;for(let y=0;y<c;y++)p=(p<<4)+d[y];return p}getBullsEyeCorners(r){let i=r,a=r,c=r,u=r,d=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let N=this.getFirstDifferent(i,d,1,-1),k=this.getFirstDifferent(a,d,1,1),j=this.getFirstDifferent(c,d,-1,1),G=this.getFirstDifferent(u,d,-1,-1);if(this.nbCenterLayers>2){let X=this.distancePoint(G,N)*this.nbCenterLayers/(this.distancePoint(u,i)*(this.nbCenterLayers+2));if(X<.75||X>1.25||!this.isWhiteOrBlackRectangle(N,k,j,G))break}i=N,a=k,c=j,u=G,d=!d}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new Z;this.compact=this.nbCenterLayers===5;let p=new Te(i.getX()+.5,i.getY()-.5),y=new Te(a.getX()+.5,a.getY()+.5),w=new Te(c.getX()-.5,c.getY()+.5),S=new Te(u.getX()-.5,u.getY()-.5);return this.expandSquare([p,y,w,S],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let r,i,a,c;try{let p=new hn(this.image).detect();r=p[0],i=p[1],a=p[2],c=p[3]}catch{let y=this.image.getWidth()/2,w=this.image.getHeight()/2;r=this.getFirstDifferent(new Pt(y+7,w-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new Pt(y+7,w+7),!1,1,1).toResultPoint(),a=this.getFirstDifferent(new Pt(y-7,w+7),!1,-1,1).toResultPoint(),c=this.getFirstDifferent(new Pt(y-7,w-7),!1,-1,-1).toResultPoint()}let u=Xe.round((r.getX()+c.getX()+i.getX()+a.getX())/4),d=Xe.round((r.getY()+c.getY()+i.getY()+a.getY())/4);try{let p=new hn(this.image,15,u,d).detect();r=p[0],i=p[1],a=p[2],c=p[3]}catch{r=this.getFirstDifferent(new Pt(u+7,d-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new Pt(u+7,d+7),!1,1,1).toResultPoint(),a=this.getFirstDifferent(new Pt(u-7,d+7),!1,-1,1).toResultPoint(),c=this.getFirstDifferent(new Pt(u-7,d-7),!1,-1,-1).toResultPoint()}return u=Xe.round((r.getX()+c.getX()+i.getX()+a.getX())/4),d=Xe.round((r.getY()+c.getY()+i.getY()+a.getY())/4),new Pt(u,d)}getMatrixCornerPoints(r){return this.expandSquare(r,2*this.nbCenterLayers,this.getDimension())}sampleGrid(r,i,a,c,u){let d=Qn.getInstance(),p=this.getDimension(),y=p/2-this.nbCenterLayers,w=p/2+this.nbCenterLayers;return d.sampleGrid(r,p,p,y,y,w,y,w,w,y,w,i.getX(),i.getY(),a.getX(),a.getY(),c.getX(),c.getY(),u.getX(),u.getY())}sampleLine(r,i,a){let c=0,u=this.distanceResultPoint(r,i),d=u/a,p=r.getX(),y=r.getY(),w=d*(i.getX()-r.getX())/u,S=d*(i.getY()-r.getY())/u;for(let N=0;N<a;N++)this.image.get(Xe.round(p+N*w),Xe.round(y+N*S))&&(c|=1<<a-N-1);return c}isWhiteOrBlackRectangle(r,i,a,c){let u=3;r=new Pt(r.getX()-u,r.getY()+u),i=new Pt(i.getX()-u,i.getY()-u),a=new Pt(a.getX()+u,a.getY()-u),c=new Pt(c.getX()+u,c.getY()+u);let d=this.getColor(c,r);if(d===0)return!1;let p=this.getColor(r,i);return p!==d||(p=this.getColor(i,a),p!==d)?!1:(p=this.getColor(a,c),p===d)}getColor(r,i){let a=this.distancePoint(r,i),c=(i.getX()-r.getX())/a,u=(i.getY()-r.getY())/a,d=0,p=r.getX(),y=r.getY(),w=this.image.get(r.getX(),r.getY()),S=Math.ceil(a);for(let k=0;k<S;k++)p+=c,y+=u,this.image.get(Xe.round(p),Xe.round(y))!==w&&d++;let N=d/a;return N>.1&&N<.9?0:N<=.1===w?1:-1}getFirstDifferent(r,i,a,c){let u=r.getX()+a,d=r.getY()+c;for(;this.isValid(u,d)&&this.image.get(u,d)===i;)u+=a,d+=c;for(u-=a,d-=c;this.isValid(u,d)&&this.image.get(u,d)===i;)u+=a;for(u-=a;this.isValid(u,d)&&this.image.get(u,d)===i;)d+=c;return d-=c,new Pt(u,d)}expandSquare(r,i,a){let c=a/(2*i),u=r[0].getX()-r[2].getX(),d=r[0].getY()-r[2].getY(),p=(r[0].getX()+r[2].getX())/2,y=(r[0].getY()+r[2].getY())/2,w=new Te(p+c*u,y+c*d),S=new Te(p-c*u,y-c*d);u=r[1].getX()-r[3].getX(),d=r[1].getY()-r[3].getY(),p=(r[1].getX()+r[3].getX())/2,y=(r[1].getY()+r[3].getY())/2;let N=new Te(p+c*u,y+c*d),k=new Te(p-c*u,y-c*d);return[w,N,S,k]}isValid(r,i){return r>=0&&r<this.image.getWidth()&&i>0&&i<this.image.getHeight()}isValidPoint(r){let i=Xe.round(r.getX()),a=Xe.round(r.getY());return this.isValid(i,a)}distancePoint(r,i){return Xe.distance(r.getX(),r.getY(),i.getX(),i.getY())}distanceResultPoint(r,i){return Xe.distance(r.getX(),r.getY(),i.getX(),i.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(B.truncDivision(this.nbLayers-4,8)+1)+15}}class An{decode(r,i=null){let a=null,c=new Kn(r.getBlackMatrix()),u=null,d=null;try{let S=c.detectMirror(!1);u=S.getPoints(),this.reportFoundResultPoints(i,u),d=new We().decode(S)}catch(S){a=S}if(d==null)try{let S=c.detectMirror(!0);u=S.getPoints(),this.reportFoundResultPoints(i,u),d=new We().decode(S)}catch(S){throw a??S}let p=new we(d.getText(),d.getRawBytes(),d.getNumBits(),u,ge.AZTEC,U.currentTimeMillis()),y=d.getByteSegments();y!=null&&p.putMetadata(He.BYTE_SEGMENTS,y);let w=d.getECLevel();return w!=null&&p.putMetadata(He.ERROR_CORRECTION_LEVEL,w),p}reportFoundResultPoints(r,i){if(r!=null){let a=r.get(pe.NEED_RESULT_POINT_CALLBACK);a!=null&&i.forEach((c,u,d)=>{a.foundPossibleResultPoint(c)})}}reset(){}}class jn extends Qe{constructor(r=500){super(new An,r)}}class wt{decode(r,i){try{return this.doDecode(r,i)}catch{if(i&&i.get(pe.TRY_HARDER)===!0&&r.isRotateSupported()){const u=r.rotateCounterClockwise(),d=this.doDecode(u,i),p=d.getResultMetadata();let y=270;p!==null&&p.get(He.ORIENTATION)===!0&&(y=y+p.get(He.ORIENTATION)%360),d.putMetadata(He.ORIENTATION,y);const w=d.getResultPoints();if(w!==null){const S=u.getHeight();for(let N=0;N<w.length;N++)w[N]=new Te(S-w[N].getY()-1,w[N].getX())}return d}else throw new Z}}reset(){}doDecode(r,i){const a=r.getWidth(),c=r.getHeight();let u=new $(a);const d=i&&i.get(pe.TRY_HARDER)===!0,p=Math.max(1,c>>(d?8:5));let y;d?y=c:y=15;const w=Math.trunc(c/2);for(let S=0;S<y;S++){const N=Math.trunc((S+1)/2),k=(S&1)===0,j=w+p*(k?N:-N);if(j<0||j>=c)break;try{u=r.getBlackRow(j,u)}catch{continue}for(let G=0;G<2;G++){if(G===1&&(u.reverse(),i&&i.get(pe.NEED_RESULT_POINT_CALLBACK)===!0)){const X=new Map;i.forEach((ee,ie)=>X.set(ie,ee)),X.delete(pe.NEED_RESULT_POINT_CALLBACK),i=X}try{const X=this.decodeRow(j,u,i);if(G===1){X.putMetadata(He.ORIENTATION,180);const ee=X.getResultPoints();ee!==null&&(ee[0]=new Te(a-ee[0].getX()-1,ee[0].getY()),ee[1]=new Te(a-ee[1].getX()-1,ee[1].getY()))}return X}catch{}}}throw new Z}static recordPattern(r,i,a){const c=a.length;for(let w=0;w<c;w++)a[w]=0;const u=r.getSize();if(i>=u)throw new Z;let d=!r.get(i),p=0,y=i;for(;y<u;){if(r.get(y)!==d)a[p]++;else{if(++p===c)break;a[p]=1,d=!d}y++}if(!(p===c||p===c-1&&y===u))throw new Z}static recordPatternInReverse(r,i,a){let c=a.length,u=r.get(i);for(;i>0&&c>=0;)r.get(--i)!==u&&(c--,u=!u);if(c>=0)throw new Z;wt.recordPattern(r,i+1,a)}static patternMatchVariance(r,i,a){const c=r.length;let u=0,d=0;for(let w=0;w<c;w++)u+=r[w],d+=i[w];if(u<d)return Number.POSITIVE_INFINITY;const p=u/d;a*=p;let y=0;for(let w=0;w<c;w++){const S=r[w],N=i[w]*p,k=S>N?S-N:N-S;if(k>a)return Number.POSITIVE_INFINITY;y+=k}return y/u}}class Ae extends wt{static findStartPattern(r){const i=r.getSize(),a=r.getNextSet(0);let c=0,u=Int32Array.from([0,0,0,0,0,0]),d=a,p=!1;const y=6;for(let w=a;w<i;w++)if(r.get(w)!==p)u[c]++;else{if(c===y-1){let S=Ae.MAX_AVG_VARIANCE,N=-1;for(let k=Ae.CODE_START_A;k<=Ae.CODE_START_C;k++){const j=wt.patternMatchVariance(u,Ae.CODE_PATTERNS[k],Ae.MAX_INDIVIDUAL_VARIANCE);j<S&&(S=j,N=k)}if(N>=0&&r.isRange(Math.max(0,d-(w-d)/2),d,!1))return Int32Array.from([d,w,N]);d+=u[0]+u[1],u=u.slice(2,u.length-1),u[c-1]=0,u[c]=0,c--}else c++;u[c]=1,p=!p}throw new Z}static decodeCode(r,i,a){wt.recordPattern(r,a,i);let c=Ae.MAX_AVG_VARIANCE,u=-1;for(let d=0;d<Ae.CODE_PATTERNS.length;d++){const p=Ae.CODE_PATTERNS[d],y=this.patternMatchVariance(i,p,Ae.MAX_INDIVIDUAL_VARIANCE);y<c&&(c=y,u=d)}if(u>=0)return u;throw new Z}decodeRow(r,i,a){const c=a&&a.get(pe.ASSUME_GS1)===!0,u=Ae.findStartPattern(i),d=u[2];let p=0;const y=new Uint8Array(20);y[p++]=d;let w;switch(d){case Ae.CODE_START_A:w=Ae.CODE_CODE_A;break;case Ae.CODE_START_B:w=Ae.CODE_CODE_B;break;case Ae.CODE_START_C:w=Ae.CODE_CODE_C;break;default:throw new K}let S=!1,N=!1,k="",j=u[0],G=u[1];const X=Int32Array.from([0,0,0,0,0,0]);let ee=0,ie=0,Ee=d,be=0,ve=!0,it=!1,et=!1;for(;!S;){const Wr=N;switch(N=!1,ee=ie,ie=Ae.decodeCode(i,X,G),y[p++]=ie,ie!==Ae.CODE_STOP&&(ve=!0),ie!==Ae.CODE_STOP&&(be++,Ee+=be*ie),j=G,G+=X.reduce((uu,ss)=>uu+ss,0),ie){case Ae.CODE_START_A:case Ae.CODE_START_B:case Ae.CODE_START_C:throw new K}switch(w){case Ae.CODE_CODE_A:if(ie<64)et===it?k+=String.fromCharCode(32+ie):k+=String.fromCharCode(32+ie+128),et=!1;else if(ie<96)et===it?k+=String.fromCharCode(ie-64):k+=String.fromCharCode(ie+64),et=!1;else switch(ie!==Ae.CODE_STOP&&(ve=!1),ie){case Ae.CODE_FNC_1:c&&(k.length===0?k+="]C1":k+="");break;case Ae.CODE_FNC_2:case Ae.CODE_FNC_3:break;case Ae.CODE_FNC_4_A:!it&&et?(it=!0,et=!1):it&&et?(it=!1,et=!1):et=!0;break;case Ae.CODE_SHIFT:N=!0,w=Ae.CODE_CODE_B;break;case Ae.CODE_CODE_B:w=Ae.CODE_CODE_B;break;case Ae.CODE_CODE_C:w=Ae.CODE_CODE_C;break;case Ae.CODE_STOP:S=!0;break}break;case Ae.CODE_CODE_B:if(ie<96)et===it?k+=String.fromCharCode(32+ie):k+=String.fromCharCode(32+ie+128),et=!1;else switch(ie!==Ae.CODE_STOP&&(ve=!1),ie){case Ae.CODE_FNC_1:c&&(k.length===0?k+="]C1":k+="");break;case Ae.CODE_FNC_2:case Ae.CODE_FNC_3:break;case Ae.CODE_FNC_4_B:!it&&et?(it=!0,et=!1):it&&et?(it=!1,et=!1):et=!0;break;case Ae.CODE_SHIFT:N=!0,w=Ae.CODE_CODE_A;break;case Ae.CODE_CODE_A:w=Ae.CODE_CODE_A;break;case Ae.CODE_CODE_C:w=Ae.CODE_CODE_C;break;case Ae.CODE_STOP:S=!0;break}break;case Ae.CODE_CODE_C:if(ie<100)ie<10&&(k+="0"),k+=ie;else switch(ie!==Ae.CODE_STOP&&(ve=!1),ie){case Ae.CODE_FNC_1:c&&(k.length===0?k+="]C1":k+="");break;case Ae.CODE_CODE_A:w=Ae.CODE_CODE_A;break;case Ae.CODE_CODE_B:w=Ae.CODE_CODE_B;break;case Ae.CODE_STOP:S=!0;break}break}Wr&&(w=w===Ae.CODE_CODE_A?Ae.CODE_CODE_B:Ae.CODE_CODE_A)}const Ht=G-j;if(G=i.getNextUnset(G),!i.isRange(G,Math.min(i.getSize(),G+(G-j)/2),!1))throw new Z;if(Ee-=be*ee,Ee%103!==ee)throw new F;const Un=k.length;if(Un===0)throw new Z;Un>0&&ve&&(w===Ae.CODE_CODE_C?k=k.substring(0,Un-2):k=k.substring(0,Un-1));const Hn=(u[1]+u[0])/2,vt=j+Ht/2,Cn=y.length,Vn=new Uint8Array(Cn);for(let Wr=0;Wr<Cn;Wr++)Vn[Wr]=y[Wr];const is=[new Te(Hn,r),new Te(vt,r)];return new we(k,Vn,0,is,ge.CODE_128,new Date().getTime())}}Ae.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Ae.MAX_AVG_VARIANCE=.25,Ae.MAX_INDIVIDUAL_VARIANCE=.7,Ae.CODE_SHIFT=98,Ae.CODE_CODE_C=99,Ae.CODE_CODE_B=100,Ae.CODE_CODE_A=101,Ae.CODE_FNC_1=102,Ae.CODE_FNC_2=97,Ae.CODE_FNC_3=96,Ae.CODE_FNC_4_A=101,Ae.CODE_FNC_4_B=100,Ae.CODE_START_A=103,Ae.CODE_START_B=104,Ae.CODE_START_C=105,Ae.CODE_STOP=106;class Ie extends wt{constructor(r=!1,i=!1){super(),this.usingCheckDigit=r,this.extendedMode=i,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(r,i,a){let c=this.counters;c.fill(0),this.decodeRowResult="";let u=Ie.findAsteriskPattern(i,c),d=i.getNextSet(u[1]),p=i.getSize(),y,w;do{Ie.recordPattern(i,d,c);let X=Ie.toNarrowWidePattern(c);if(X<0)throw new Z;y=Ie.patternToChar(X),this.decodeRowResult+=y,w=d;for(let ee of c)d+=ee;d=i.getNextSet(d)}while(y!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let S=0;for(let X of c)S+=X;let N=d-w-S;if(d!==p&&N*2<S)throw new Z;if(this.usingCheckDigit){let X=this.decodeRowResult.length-1,ee=0;for(let ie=0;ie<X;ie++)ee+=Ie.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(ie));if(this.decodeRowResult.charAt(X)!==Ie.ALPHABET_STRING.charAt(ee%43))throw new F;this.decodeRowResult=this.decodeRowResult.substring(0,X)}if(this.decodeRowResult.length===0)throw new Z;let k;this.extendedMode?k=Ie.decodeExtended(this.decodeRowResult):k=this.decodeRowResult;let j=(u[1]+u[0])/2,G=w+S/2;return new we(k,null,0,[new Te(j,r),new Te(G,r)],ge.CODE_39,new Date().getTime())}static findAsteriskPattern(r,i){let a=r.getSize(),c=r.getNextSet(0),u=0,d=c,p=!1,y=i.length;for(let w=c;w<a;w++)if(r.get(w)!==p)i[u]++;else{if(u===y-1){if(this.toNarrowWidePattern(i)===Ie.ASTERISK_ENCODING&&r.isRange(Math.max(0,d-Math.floor((w-d)/2)),d,!1))return[d,w];d+=i[0]+i[1],i.copyWithin(0,2,2+u-1),i[u-1]=0,i[u]=0,u--}else u++;i[u]=1,p=!p}throw new Z}static toNarrowWidePattern(r){let i=r.length,a=0,c;do{let u=2147483647;for(let y of r)y<u&&y>a&&(u=y);a=u,c=0;let d=0,p=0;for(let y=0;y<i;y++){let w=r[y];w>a&&(p|=1<<i-1-y,c++,d+=w)}if(c===3){for(let y=0;y<i&&c>0;y++){let w=r[y];if(w>a&&(c--,w*2>=d))return-1}return p}}while(c>3);return-1}static patternToChar(r){for(let i=0;i<Ie.CHARACTER_ENCODINGS.length;i++)if(Ie.CHARACTER_ENCODINGS[i]===r)return Ie.ALPHABET_STRING.charAt(i);if(r===Ie.ASTERISK_ENCODING)return"*";throw new Z}static decodeExtended(r){let i=r.length,a="";for(let c=0;c<i;c++){let u=r.charAt(c);if(u==="+"||u==="$"||u==="%"||u==="/"){let d=r.charAt(c+1),p="\0";switch(u){case"+":if(d>="A"&&d<="Z")p=String.fromCharCode(d.charCodeAt(0)+32);else throw new K;break;case"$":if(d>="A"&&d<="Z")p=String.fromCharCode(d.charCodeAt(0)-64);else throw new K;break;case"%":if(d>="A"&&d<="E")p=String.fromCharCode(d.charCodeAt(0)-38);else if(d>="F"&&d<="J")p=String.fromCharCode(d.charCodeAt(0)-11);else if(d>="K"&&d<="O")p=String.fromCharCode(d.charCodeAt(0)+16);else if(d>="P"&&d<="T")p=String.fromCharCode(d.charCodeAt(0)+43);else if(d==="U")p="\0";else if(d==="V")p="@";else if(d==="W")p="`";else if(d==="X"||d==="Y"||d==="Z")p="";else throw new K;break;case"/":if(d>="A"&&d<="O")p=String.fromCharCode(d.charCodeAt(0)-32);else if(d==="Z")p=":";else throw new K;break}a+=p,c++}else a+=u}return a}}Ie.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Ie.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Ie.ASTERISK_ENCODING=148;class Me extends wt{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(r,i,a){let c=this.decodeStart(i),u=this.decodeEnd(i),d=new Q;Me.decodeMiddle(i,c[1],u[0],d);let p=d.toString(),y=null;a!=null&&(y=a.get(pe.ALLOWED_LENGTHS)),y==null&&(y=Me.DEFAULT_ALLOWED_LENGTHS);let w=p.length,S=!1,N=0;for(let G of y){if(w===G){S=!0;break}G>N&&(N=G)}if(!S&&w>N&&(S=!0),!S)throw new K;const k=[new Te(c[1],r),new Te(u[0],r)];return new we(p,null,0,k,ge.ITF,new Date().getTime())}static decodeMiddle(r,i,a,c){let u=new Int32Array(10),d=new Int32Array(5),p=new Int32Array(5);for(u.fill(0),d.fill(0),p.fill(0);i<a;){wt.recordPattern(r,i,u);for(let w=0;w<5;w++){let S=2*w;d[w]=u[S],p[w]=u[S+1]}let y=Me.decodeDigit(d);c.append(y.toString()),y=this.decodeDigit(p),c.append(y.toString()),u.forEach(function(w){i+=w})}}decodeStart(r){let i=Me.skipWhiteSpace(r),a=Me.findGuardPattern(r,i,Me.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(r,a[0]),a}validateQuietZone(r,i){let a=this.narrowLineWidth*10;a=a<i?a:i;for(let c=i-1;a>0&&c>=0&&!r.get(c);c--)a--;if(a!==0)throw new Z}static skipWhiteSpace(r){const i=r.getSize(),a=r.getNextSet(0);if(a===i)throw new Z;return a}decodeEnd(r){r.reverse();try{let i=Me.skipWhiteSpace(r),a;try{a=Me.findGuardPattern(r,i,Me.END_PATTERN_REVERSED[0])}catch(u){u instanceof Z&&(a=Me.findGuardPattern(r,i,Me.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,a[0]);let c=a[0];return a[0]=r.getSize()-a[1],a[1]=r.getSize()-c,a}finally{r.reverse()}}static findGuardPattern(r,i,a){let c=a.length,u=new Int32Array(c),d=r.getSize(),p=!1,y=0,w=i;u.fill(0);for(let S=i;S<d;S++)if(r.get(S)!==p)u[y]++;else{if(y===c-1){if(wt.patternMatchVariance(u,a,Me.MAX_INDIVIDUAL_VARIANCE)<Me.MAX_AVG_VARIANCE)return[w,S];w+=u[0]+u[1],U.arraycopy(u,2,u,0,y-1),u[y-1]=0,u[y]=0,y--}else y++;u[y]=1,p=!p}throw new Z}static decodeDigit(r){let i=Me.MAX_AVG_VARIANCE,a=-1,c=Me.PATTERNS.length;for(let u=0;u<c;u++){let d=Me.PATTERNS[u],p=wt.patternMatchVariance(r,d,Me.MAX_INDIVIDUAL_VARIANCE);p<i?(i=p,a=u):p===i&&(a=-1)}if(a>=0)return a%10;throw new Z}}Me.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Me.MAX_AVG_VARIANCE=.38,Me.MAX_INDIVIDUAL_VARIANCE=.5,Me.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Me.START_PATTERN=Int32Array.from([1,1,1,1]),Me.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Ve extends wt{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(r){let i=!1,a,c=0,u=Int32Array.from([0,0,0]);for(;!i;){u=Int32Array.from([0,0,0]),a=Ve.findGuardPattern(r,c,!1,this.START_END_PATTERN,u);let d=a[0];c=a[1];let p=d-(c-d);p>=0&&(i=r.isRange(p,d,!1))}return a}static checkChecksum(r){return Ve.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let i=r.length;if(i===0)return!1;let a=parseInt(r.charAt(i-1),10);return Ve.getStandardUPCEANChecksum(r.substring(0,i-1))===a}static getStandardUPCEANChecksum(r){let i=r.length,a=0;for(let c=i-1;c>=0;c-=2){let u=r.charAt(c).charCodeAt(0)-48;if(u<0||u>9)throw new K;a+=u}a*=3;for(let c=i-2;c>=0;c-=2){let u=r.charAt(c).charCodeAt(0)-48;if(u<0||u>9)throw new K;a+=u}return(1e3-a)%10}static decodeEnd(r,i){return Ve.findGuardPattern(r,i,!1,Ve.START_END_PATTERN,new Int32Array(Ve.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(r,i,a,c){return this.findGuardPattern(r,i,a,c,new Int32Array(c.length))}static findGuardPattern(r,i,a,c,u){let d=r.getSize();i=a?r.getNextUnset(i):r.getNextSet(i);let p=0,y=i,w=c.length,S=a;for(let N=i;N<d;N++)if(r.get(N)!==S)u[p]++;else{if(p===w-1){if(wt.patternMatchVariance(u,c,Ve.MAX_INDIVIDUAL_VARIANCE)<Ve.MAX_AVG_VARIANCE)return Int32Array.from([y,N]);y+=u[0]+u[1];let k=u.slice(2,u.length-1);for(let j=0;j<p-1;j++)u[j]=k[j];u[p-1]=0,u[p]=0,p--}else p++;u[p]=1,S=!S}throw new Z}static decodeDigit(r,i,a,c){this.recordPattern(r,a,i);let u=this.MAX_AVG_VARIANCE,d=-1,p=c.length;for(let y=0;y<p;y++){let w=c[y],S=wt.patternMatchVariance(i,w,Ve.MAX_INDIVIDUAL_VARIANCE);S<u&&(u=S,d=y)}if(d>=0)return d;throw new Z}}Ve.MAX_AVG_VARIANCE=.48,Ve.MAX_INDIVIDUAL_VARIANCE=.7,Ve.START_END_PATTERN=Int32Array.from([1,1,1]),Ve.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Ve.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ve.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class It{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,i,a){let c=this.decodeRowStringBuffer,u=this.decodeMiddle(i,a,c),d=c.toString(),p=It.parseExtensionString(d),y=[new Te((a[0]+a[1])/2,r),new Te(u,r)],w=new we(d,null,0,y,ge.UPC_EAN_EXTENSION,new Date().getTime());return p!=null&&w.putAllMetadata(p),w}decodeMiddle(r,i,a){let c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=r.getSize(),d=i[1],p=0;for(let w=0;w<5&&d<u;w++){let S=Ve.decodeDigit(r,c,d,Ve.L_AND_G_PATTERNS);a+=String.fromCharCode(48+S%10);for(let N of c)d+=N;S>=10&&(p|=1<<4-w),w!==4&&(d=r.getNextSet(d),d=r.getNextUnset(d))}if(a.length!==5)throw new Z;let y=this.determineCheckDigit(p);if(It.extensionChecksum(a.toString())!==y)throw new Z;return d}static extensionChecksum(r){let i=r.length,a=0;for(let c=i-2;c>=0;c-=2)a+=r.charAt(c).charCodeAt(0)-48;a*=3;for(let c=i-1;c>=0;c-=2)a+=r.charAt(c).charCodeAt(0)-48;return a*=3,a%10}determineCheckDigit(r){for(let i=0;i<10;i++)if(r===this.CHECK_DIGIT_ENCODINGS[i])return i;throw new Z}static parseExtensionString(r){if(r.length!==5)return null;let i=It.parseExtension5String(r);return i==null?null:new Map([[He.SUGGESTED_PRICE,i]])}static parseExtension5String(r){let i;switch(r.charAt(0)){case"0":i="";break;case"5":i="$";break;case"9":switch(r){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}i="";break;default:i="";break}let a=parseInt(r.substring(1)),c=(a/100).toString(),u=a%100,d=u<10?"0"+u:u.toString();return i+c+"."+d}}class Dt{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,i,a){let c=this.decodeRowStringBuffer,u=this.decodeMiddle(i,a,c),d=c.toString(),p=Dt.parseExtensionString(d),y=[new Te((a[0]+a[1])/2,r),new Te(u,r)],w=new we(d,null,0,y,ge.UPC_EAN_EXTENSION,new Date().getTime());return p!=null&&w.putAllMetadata(p),w}decodeMiddle(r,i,a){let c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=r.getSize(),d=i[1],p=0;for(let y=0;y<2&&d<u;y++){let w=Ve.decodeDigit(r,c,d,Ve.L_AND_G_PATTERNS);a+=String.fromCharCode(48+w%10);for(let S of c)d+=S;w>=10&&(p|=1<<1-y),y!==1&&(d=r.getNextSet(d),d=r.getNextUnset(d))}if(a.length!==2)throw new Z;if(parseInt(a.toString())%4!==p)throw new Z;return d}static parseExtensionString(r){return r.length!==2?null:new Map([[He.ISSUE_NUMBER,parseInt(r)]])}}class Ge{static decodeRow(r,i,a){let c=Ve.findGuardPattern(i,a,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new It().decodeRow(r,i,c)}catch{return new Dt().decodeRow(r,i,c)}}}Ge.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class ft extends Ve{constructor(){super(),this.decodeRowStringBuffer="",ft.L_AND_G_PATTERNS=ft.L_PATTERNS.map(r=>Int32Array.from(r));for(let r=10;r<20;r++){let i=ft.L_PATTERNS[r-10],a=new Int32Array(i.length);for(let c=0;c<i.length;c++)a[c]=i[i.length-c-1];ft.L_AND_G_PATTERNS[r]=a}}decodeRow(r,i,a){let c=ft.findStartGuardPattern(i),u=a==null?null:a.get(pe.NEED_RESULT_POINT_CALLBACK);if(u!=null){const ve=new Te((c[0]+c[1])/2,r);u.foundPossibleResultPoint(ve)}let d=this.decodeMiddle(i,c,this.decodeRowStringBuffer),p=d.rowOffset,y=d.resultString;if(u!=null){const ve=new Te(p,r);u.foundPossibleResultPoint(ve)}let w=this.decodeEnd(i,p);if(u!=null){const ve=new Te((w[0]+w[1])/2,r);u.foundPossibleResultPoint(ve)}let S=w[1],N=S+(S-w[0]);if(N>=i.getSize()||!i.isRange(S,N,!1))throw new Z;let k=y.toString();if(k.length<8)throw new K;if(!ft.checkChecksum(k))throw new F;let j=(c[1]+c[0])/2,G=(w[1]+w[0])/2,X=this.getBarcodeFormat(),ee=[new Te(j,r),new Te(G,r)],ie=new we(k,null,0,ee,X,new Date().getTime()),Ee=0;try{let ve=Ge.decodeRow(r,i,w[1]);ie.putMetadata(He.UPC_EAN_EXTENSION,ve.getText()),ie.putAllMetadata(ve.getResultMetadata()),ie.addResultPoints(ve.getResultPoints()),Ee=ve.getText().length}catch{}let be=a==null?null:a.get(pe.ALLOWED_EAN_EXTENSIONS);if(be!=null){let ve=!1;for(let it in be)if(Ee.toString()===it){ve=!0;break}if(!ve)throw new Z}return ie}decodeEnd(r,i){return ft.findGuardPattern(r,i,!1,ft.START_END_PATTERN,new Int32Array(ft.START_END_PATTERN.length).fill(0))}static checkChecksum(r){return ft.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let i=r.length;if(i===0)return!1;let a=parseInt(r.charAt(i-1),10);return ft.getStandardUPCEANChecksum(r.substring(0,i-1))===a}static getStandardUPCEANChecksum(r){let i=r.length,a=0;for(let c=i-1;c>=0;c-=2){let u=r.charAt(c).charCodeAt(0)-48;if(u<0||u>9)throw new K;a+=u}a*=3;for(let c=i-2;c>=0;c-=2){let u=r.charAt(c).charCodeAt(0)-48;if(u<0||u>9)throw new K;a+=u}return(1e3-a)%10}}class Dr extends ft{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,i,a){let c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=r.getSize(),d=i[1],p=0;for(let w=0;w<6&&d<u;w++){let S=ft.decodeDigit(r,c,d,ft.L_AND_G_PATTERNS);a+=String.fromCharCode(48+S%10);for(let N of c)d+=N;S>=10&&(p|=1<<5-w)}a=Dr.determineFirstDigit(a,p),d=ft.findGuardPattern(r,d,!0,ft.MIDDLE_PATTERN,new Int32Array(ft.MIDDLE_PATTERN.length).fill(0))[1];for(let w=0;w<6&&d<u;w++){let S=ft.decodeDigit(r,c,d,ft.L_PATTERNS);a+=String.fromCharCode(48+S);for(let N of c)d+=N}return{rowOffset:d,resultString:a}}getBarcodeFormat(){return ge.EAN_13}static determineFirstDigit(r,i){for(let a=0;a<10;a++)if(i===this.FIRST_DIGIT_ENCODINGS[a])return r=String.fromCharCode(48+a)+r,r;throw new Z}}Dr.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class io extends ft{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,i,a){const c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=r.getSize(),d=i[1];for(let y=0;y<4&&d<u;y++){let w=ft.decodeDigit(r,c,d,ft.L_PATTERNS);a+=String.fromCharCode(48+w);for(let S of c)d+=S}d=ft.findGuardPattern(r,d,!0,ft.MIDDLE_PATTERN,new Int32Array(ft.MIDDLE_PATTERN.length).fill(0))[1];for(let y=0;y<4&&d<u;y++){let w=ft.decodeDigit(r,c,d,ft.L_PATTERNS);a+=String.fromCharCode(48+w);for(let S of c)d+=S}return{rowOffset:d,resultString:a}}getBarcodeFormat(){return ge.EAN_8}}class _n extends ft{constructor(){super(...arguments),this.ean13Reader=new Dr}getBarcodeFormat(){return ge.UPC_A}decode(r,i){return this.maybeReturnResult(this.ean13Reader.decode(r))}decodeRow(r,i,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,i,a))}decodeMiddle(r,i,a){return this.ean13Reader.decodeMiddle(r,i,a)}maybeReturnResult(r){let i=r.getText();if(i.charAt(0)==="0"){let a=new we(i.substring(1),null,null,r.getResultPoints(),ge.UPC_A);return r.getResultMetadata()!=null&&a.putAllMetadata(r.getResultMetadata()),a}else throw new Z}reset(){this.ean13Reader.reset()}}class qn extends ft{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(r,i,a){const c=this.decodeMiddleCounters.map(w=>w);c[0]=0,c[1]=0,c[2]=0,c[3]=0;const u=r.getSize();let d=i[1],p=0;for(let w=0;w<6&&d<u;w++){const S=qn.decodeDigit(r,c,d,qn.L_AND_G_PATTERNS);a+=String.fromCharCode(48+S%10);for(let N of c)d+=N;S>=10&&(p|=1<<5-w)}let y=qn.determineNumSysAndCheckDigit(a,p);return{rowOffset:d,resultString:y}}decodeEnd(r,i){return qn.findGuardPatternWithoutCounters(r,i,!0,qn.MIDDLE_END_PATTERN)}checkChecksum(r){return ft.checkChecksum(qn.convertUPCEtoUPCA(r))}static determineNumSysAndCheckDigit(r,i){for(let a=0;a<=1;a++)for(let c=0;c<10;c++)if(i===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][c]){let u=String.fromCharCode(48+a),d=String.fromCharCode(48+c);return u+r+d}throw Z.getNotFoundInstance()}getBarcodeFormat(){return ge.UPC_E}static convertUPCEtoUPCA(r){const i=r.slice(1,7).split("").map(u=>u.charCodeAt(0)),a=new Q;a.append(r.charAt(0));let c=i[5];switch(c){case 0:case 1:case 2:a.appendChars(i,0,2),a.append(c),a.append("0000"),a.appendChars(i,2,3);break;case 3:a.appendChars(i,0,3),a.append("00000"),a.appendChars(i,3,2);break;case 4:a.appendChars(i,0,4),a.append("00000"),a.append(i[4]);break;default:a.appendChars(i,0,5),a.append("0000"),a.append(c);break}return r.length>=8&&a.append(r.charAt(7)),a.toString()}}qn.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),qn.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Rs extends wt{constructor(r){super();let i=r==null?null:r.get(pe.POSSIBLE_FORMATS),a=[];s(i)?(a.push(new Dr),a.push(new _n),a.push(new io),a.push(new qn)):(i.indexOf(ge.EAN_13)>-1&&a.push(new Dr),i.indexOf(ge.UPC_A)>-1&&a.push(new _n),i.indexOf(ge.EAN_8)>-1&&a.push(new io),i.indexOf(ge.UPC_E)>-1&&a.push(new qn)),this.readers=a}decodeRow(r,i,a){for(let c of this.readers)try{const u=c.decodeRow(r,i,a),d=u.getBarcodeFormat()===ge.EAN_13&&u.getText().charAt(0)==="0",p=a==null?null:a.get(pe.POSSIBLE_FORMATS),y=p==null||p.includes(ge.UPC_A);if(d&&y){const w=u.getRawBytes(),S=new we(u.getText().substring(1),w,w?w.length:null,u.getResultPoints(),ge.UPC_A);return S.putAllMetadata(u.getResultMetadata()),S}return u}catch{}throw new Z}reset(){for(let r of this.readers)r.reset()}}class Qt extends wt{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(r,i){for(let a=0;a<i.length;a++)if(wt.patternMatchVariance(r,i[a],Qt.MAX_INDIVIDUAL_VARIANCE)<Qt.MAX_AVG_VARIANCE)return a;throw new Z}static count(r){return Xe.sum(new Int32Array(r))}static increment(r,i){let a=0,c=i[0];for(let u=1;u<r.length;u++)i[u]>c&&(c=i[u],a=u);r[a]++}static decrement(r,i){let a=0,c=i[0];for(let u=1;u<r.length;u++)i[u]<c&&(c=i[u],a=u);r[a]--}static isFinderPattern(r){let i=r[0]+r[1],a=i+r[2]+r[3],c=i/a;if(c>=Qt.MIN_FINDER_PATTERN_RATIO&&c<=Qt.MAX_FINDER_PATTERN_RATIO){let u=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER;for(let p of r)p>d&&(d=p),p<u&&(u=p);return d<10*u}return!1}}Qt.MAX_AVG_VARIANCE=.2,Qt.MAX_INDIVIDUAL_VARIANCE=.45,Qt.MIN_FINDER_PATTERN_RATIO=9.5/12,Qt.MAX_FINDER_PATTERN_RATIO=12.5/14;class mi{constructor(r,i){this.value=r,this.checksumPortion=i}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(r){if(!(r instanceof mi))return!1;const i=r;return this.value===i.value&&this.checksumPortion===i.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class vr{constructor(r,i,a,c,u){this.value=r,this.startEnd=i,this.value=r,this.startEnd=i,this.resultPoints=new Array,this.resultPoints.push(new Te(a,u)),this.resultPoints.push(new Te(c,u))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(r){if(!(r instanceof vr))return!1;const i=r;return this.value===i.value}hashCode(){return this.value}}class jt{constructor(){}static getRSSvalue(r,i,a){let c=0;for(let y of r)c+=y;let u=0,d=0,p=r.length;for(let y=0;y<p-1;y++){let w;for(w=1,d|=1<<y;w<r[y];w++,d&=~(1<<y)){let S=jt.combins(c-w-1,p-y-2);if(a&&d===0&&c-w-(p-y-1)>=p-y-1&&(S-=jt.combins(c-w-(p-y),p-y-2)),p-y-1>1){let N=0;for(let k=c-w-(p-y-2);k>i;k--)N+=jt.combins(c-w-k-1,p-y-3);S-=N*(p-1-y)}else c-w>i&&S--;u+=S}c-=w}return u}static combins(r,i){let a,c;r-i>i?(c=i,a=r-i):(c=r-i,a=i);let u=1,d=1;for(let p=r;p>a;p--)u*=p,d<=c&&(u/=d,d++);for(;d<=c;)u/=d,d++;return u}}class Li{static buildBitArray(r){let i=r.length*2-1;r[r.length-1].getRightChar()==null&&(i-=1);let a=12*i,c=new $(a),u=0,p=r[0].getRightChar().getValue();for(let y=11;y>=0;--y)p&1<<y&&c.set(u),u++;for(let y=1;y<r.length;++y){let w=r[y],S=w.getLeftChar().getValue();for(let N=11;N>=0;--N)S&1<<N&&c.set(u),u++;if(w.getRightChar()!=null){let N=w.getRightChar().getValue();for(let k=11;k>=0;--k)N&1<<k&&c.set(u),u++}}return c}}class Br{constructor(r,i){i?this.decodedInformation=null:(this.finished=r,this.decodedInformation=i)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class xi{constructor(r){this.newPosition=r}getNewPosition(){return this.newPosition}}class Nt extends xi{constructor(r,i){super(r),this.value=i}getValue(){return this.value}isFNC1(){return this.value===Nt.FNC1}}Nt.FNC1="$";class Be extends xi{constructor(r,i,a){super(r),a?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=i}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class dn extends xi{constructor(r,i,a){if(super(r),i<0||i>10||a<0||a>10)throw new K;this.firstDigit=i,this.secondDigit=a}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===dn.FNC1}isSecondDigitFNC1(){return this.secondDigit===dn.FNC1}isAnyFNC1(){return this.firstDigit===dn.FNC1||this.secondDigit===dn.FNC1}}dn.FNC1=10;class ke{constructor(){}static parseFieldsInGeneralPurpose(r){if(!r)return null;if(r.length<2)throw new Z;let i=r.substring(0,2);for(let u of ke.TWO_DIGIT_DATA_LENGTH)if(u[0]===i)return u[1]===ke.VARIABLE_LENGTH?ke.processVariableAI(2,u[2],r):ke.processFixedAI(2,u[1],r);if(r.length<3)throw new Z;let a=r.substring(0,3);for(let u of ke.THREE_DIGIT_DATA_LENGTH)if(u[0]===a)return u[1]===ke.VARIABLE_LENGTH?ke.processVariableAI(3,u[2],r):ke.processFixedAI(3,u[1],r);for(let u of ke.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(u[0]===a)return u[1]===ke.VARIABLE_LENGTH?ke.processVariableAI(4,u[2],r):ke.processFixedAI(4,u[1],r);if(r.length<4)throw new Z;let c=r.substring(0,4);for(let u of ke.FOUR_DIGIT_DATA_LENGTH)if(u[0]===c)return u[1]===ke.VARIABLE_LENGTH?ke.processVariableAI(4,u[2],r):ke.processFixedAI(4,u[1],r);throw new Z}static processFixedAI(r,i,a){if(a.length<r)throw new Z;let c=a.substring(0,r);if(a.length<r+i)throw new Z;let u=a.substring(r,r+i),d=a.substring(r+i),p="("+c+")"+u,y=ke.parseFieldsInGeneralPurpose(d);return y==null?p:p+y}static processVariableAI(r,i,a){let c=a.substring(0,r),u;a.length<r+i?u=a.length:u=r+i;let d=a.substring(r,u),p=a.substring(u),y="("+c+")"+d,w=ke.parseFieldsInGeneralPurpose(p);return w==null?y:y+w}}ke.VARIABLE_LENGTH=[],ke.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",ke.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",ke.VARIABLE_LENGTH,20],["22",ke.VARIABLE_LENGTH,29],["30",ke.VARIABLE_LENGTH,8],["37",ke.VARIABLE_LENGTH,8],["90",ke.VARIABLE_LENGTH,30],["91",ke.VARIABLE_LENGTH,30],["92",ke.VARIABLE_LENGTH,30],["93",ke.VARIABLE_LENGTH,30],["94",ke.VARIABLE_LENGTH,30],["95",ke.VARIABLE_LENGTH,30],["96",ke.VARIABLE_LENGTH,30],["97",ke.VARIABLE_LENGTH,3],["98",ke.VARIABLE_LENGTH,30],["99",ke.VARIABLE_LENGTH,30]],ke.THREE_DIGIT_DATA_LENGTH=[["240",ke.VARIABLE_LENGTH,30],["241",ke.VARIABLE_LENGTH,30],["242",ke.VARIABLE_LENGTH,6],["250",ke.VARIABLE_LENGTH,30],["251",ke.VARIABLE_LENGTH,30],["253",ke.VARIABLE_LENGTH,17],["254",ke.VARIABLE_LENGTH,20],["400",ke.VARIABLE_LENGTH,30],["401",ke.VARIABLE_LENGTH,30],["402",17],["403",ke.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",ke.VARIABLE_LENGTH,20],["421",ke.VARIABLE_LENGTH,15],["422",3],["423",ke.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],ke.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",ke.VARIABLE_LENGTH,15],["391",ke.VARIABLE_LENGTH,18],["392",ke.VARIABLE_LENGTH,15],["393",ke.VARIABLE_LENGTH,18],["703",ke.VARIABLE_LENGTH,30]],ke.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",ke.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",ke.VARIABLE_LENGTH,20],["8003",ke.VARIABLE_LENGTH,30],["8004",ke.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",ke.VARIABLE_LENGTH,30],["8008",ke.VARIABLE_LENGTH,12],["8018",18],["8020",ke.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",ke.VARIABLE_LENGTH,70],["8200",ke.VARIABLE_LENGTH,70]];class qr{constructor(r){this.buffer=new Q,this.information=r}decodeAllCodes(r,i){let a=i,c=null;do{let u=this.decodeGeneralPurposeField(a,c),d=ke.parseFieldsInGeneralPurpose(u.getNewString());if(d!=null&&r.append(d),u.isRemaining()?c=""+u.getRemainingValue():c=null,a===u.getNewPosition())break;a=u.getNewPosition()}while(!0);return r.toString()}isStillNumeric(r){if(r+7>this.information.getSize())return r+4<=this.information.getSize();for(let i=r;i<r+3;++i)if(this.information.get(i))return!0;return this.information.get(r+3)}decodeNumeric(r){if(r+7>this.information.getSize()){let u=this.extractNumericValueFromBitArray(r,4);return u===0?new dn(this.information.getSize(),dn.FNC1,dn.FNC1):new dn(this.information.getSize(),u-1,dn.FNC1)}let i=this.extractNumericValueFromBitArray(r,7),a=(i-8)/11,c=(i-8)%11;return new dn(r+7,a,c)}extractNumericValueFromBitArray(r,i){return qr.extractNumericValueFromBitArray(this.information,r,i)}static extractNumericValueFromBitArray(r,i,a){let c=0;for(let u=0;u<a;++u)r.get(i+u)&&(c|=1<<a-u-1);return c}decodeGeneralPurposeField(r,i){this.buffer.setLengthToZero(),i!=null&&this.buffer.append(i),this.current.setPosition(r);let a=this.parseBlocks();return a!=null&&a.isRemaining()?new Be(this.current.getPosition(),this.buffer.toString(),a.getRemainingValue()):new Be(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let r,i;do{let a=this.current.getPosition();if(this.current.isAlpha()?(i=this.parseAlphaBlock(),r=i.isFinished()):this.current.isIsoIec646()?(i=this.parseIsoIec646Block(),r=i.isFinished()):(i=this.parseNumericBlock(),r=i.isFinished()),!(a!==this.current.getPosition())&&!r)break}while(!r);return i.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let r=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFirstDigitFNC1()){let i;return r.isSecondDigitFNC1()?i=new Be(this.current.getPosition(),this.buffer.toString()):i=new Be(this.current.getPosition(),this.buffer.toString(),r.getSecondDigit()),new Br(!0,i)}if(this.buffer.append(r.getFirstDigit()),r.isSecondDigitFNC1()){let i=new Be(this.current.getPosition(),this.buffer.toString());return new Br(!0,i)}this.buffer.append(r.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Br(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let r=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let i=new Be(this.current.getPosition(),this.buffer.toString());return new Br(!0,i)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Br(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let r=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let i=new Be(this.current.getPosition(),this.buffer.toString());return new Br(!0,i)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Br(!1)}isStillIsoIec646(r){if(r+5>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(r,5);if(i>=5&&i<16)return!0;if(r+7>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(r,7);if(a>=64&&a<116)return!0;if(r+8>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(r,8);return c>=232&&c<253}decodeIsoIec646(r){let i=this.extractNumericValueFromBitArray(r,5);if(i===15)return new Nt(r+5,Nt.FNC1);if(i>=5&&i<15)return new Nt(r+5,"0"+(i-5));let a=this.extractNumericValueFromBitArray(r,7);if(a>=64&&a<90)return new Nt(r+7,""+(a+1));if(a>=90&&a<116)return new Nt(r+7,""+(a+7));let c=this.extractNumericValueFromBitArray(r,8),u;switch(c){case 232:u="!";break;case 233:u='"';break;case 234:u="%";break;case 235:u="&";break;case 236:u="'";break;case 237:u="(";break;case 238:u=")";break;case 239:u="*";break;case 240:u="+";break;case 241:u=",";break;case 242:u="-";break;case 243:u=".";break;case 244:u="/";break;case 245:u=":";break;case 246:u=";";break;case 247:u="<";break;case 248:u="=";break;case 249:u=">";break;case 250:u="?";break;case 251:u="_";break;case 252:u=" ";break;default:throw new K}return new Nt(r+8,u)}isStillAlpha(r){if(r+5>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(r,5);if(i>=5&&i<16)return!0;if(r+6>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(r,6);return a>=16&&a<63}decodeAlphanumeric(r){let i=this.extractNumericValueFromBitArray(r,5);if(i===15)return new Nt(r+5,Nt.FNC1);if(i>=5&&i<15)return new Nt(r+5,"0"+(i-5));let a=this.extractNumericValueFromBitArray(r,6);if(a>=32&&a<58)return new Nt(r+6,""+(a+33));let c;switch(a){case 58:c="*";break;case 59:c=",";break;case 60:c="-";break;case 61:c=".";break;case 62:c="/";break;default:throw new Xt("Decoding invalid alphanumeric value: "+a)}return new Nt(r+6,c)}isAlphaTo646ToAlphaLatch(r){if(r+1>this.information.getSize())return!1;for(let i=0;i<5&&i+r<this.information.getSize();++i)if(i===2){if(!this.information.get(r+2))return!1}else if(this.information.get(r+i))return!1;return!0}isAlphaOr646ToNumericLatch(r){if(r+3>this.information.getSize())return!1;for(let i=r;i<r+3;++i)if(this.information.get(i))return!1;return!0}isNumericToAlphaNumericLatch(r){if(r+1>this.information.getSize())return!1;for(let i=0;i<4&&i+r<this.information.getSize();++i)if(this.information.get(r+i))return!1;return!0}}class yi{constructor(r){this.information=r,this.generalDecoder=new qr(r)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class pn extends yi{constructor(r){super(r)}encodeCompressedGtin(r,i){r.append("(01)");let a=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,i,a)}encodeCompressedGtinWithoutAI(r,i,a){for(let c=0;c<4;++c){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(i+10*c,10);u/100===0&&r.append("0"),u/10===0&&r.append("0"),r.append(u)}pn.appendCheckDigit(r,a)}static appendCheckDigit(r,i){let a=0;for(let c=0;c<13;c++){let u=r.charAt(c+i).charCodeAt(0)-48;a+=c&1?u:3*u}a=10-a%10,a===10&&(a=0),r.append(a)}}pn.GTIN_SIZE=40;class Jr extends pn{constructor(r){super(r)}parseInformation(){let r=new Q;r.append("(01)");let i=r.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(Jr.HEADER_SIZE,4);return r.append(a),this.encodeCompressedGtinWithoutAI(r,Jr.HEADER_SIZE+4,i),this.getGeneralDecoder().decodeAllCodes(r,Jr.HEADER_SIZE+44)}}Jr.HEADER_SIZE=4;class kn extends yi{constructor(r){super(r)}parseInformation(){let r=new Q;return this.getGeneralDecoder().decodeAllCodes(r,kn.HEADER_SIZE)}}kn.HEADER_SIZE=5;class ei extends pn{constructor(r){super(r)}encodeCompressedWeight(r,i,a){let c=this.getGeneralDecoder().extractNumericValueFromBitArray(i,a);this.addWeightCode(r,c);let u=this.checkWeight(c),d=1e5;for(let p=0;p<5;++p)u/d===0&&r.append("0"),d/=10;r.append(u)}}class Jn extends ei{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()!=Jn.HEADER_SIZE+ei.GTIN_SIZE+Jn.WEIGHT_SIZE)throw new Z;let r=new Q;return this.encodeCompressedGtin(r,Jn.HEADER_SIZE),this.encodeCompressedWeight(r,Jn.HEADER_SIZE+ei.GTIN_SIZE,Jn.WEIGHT_SIZE),r.toString()}}Jn.HEADER_SIZE=5,Jn.WEIGHT_SIZE=15;class sn extends Jn{constructor(r){super(r)}addWeightCode(r,i){r.append("(3103)")}checkWeight(r){return r}}class Qo extends Jn{constructor(r){super(r)}addWeightCode(r,i){i<1e4?r.append("(3202)"):r.append("(3203)")}checkWeight(r){return r<1e4?r:r-1e4}}class er extends pn{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<er.HEADER_SIZE+pn.GTIN_SIZE)throw new Z;let r=new Q;this.encodeCompressedGtin(r,er.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(er.HEADER_SIZE+pn.GTIN_SIZE,er.LAST_DIGIT_SIZE);r.append("(392"),r.append(i),r.append(")");let a=this.getGeneralDecoder().decodeGeneralPurposeField(er.HEADER_SIZE+pn.GTIN_SIZE+er.LAST_DIGIT_SIZE,null);return r.append(a.getNewString()),r.toString()}}er.HEADER_SIZE=8,er.LAST_DIGIT_SIZE=2;class on extends pn{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<on.HEADER_SIZE+pn.GTIN_SIZE)throw new Z;let r=new Q;this.encodeCompressedGtin(r,on.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(on.HEADER_SIZE+pn.GTIN_SIZE,on.LAST_DIGIT_SIZE);r.append("(393"),r.append(i),r.append(")");let a=this.getGeneralDecoder().extractNumericValueFromBitArray(on.HEADER_SIZE+pn.GTIN_SIZE+on.LAST_DIGIT_SIZE,on.FIRST_THREE_DIGITS_SIZE);a/100==0&&r.append("0"),a/10==0&&r.append("0"),r.append(a);let c=this.getGeneralDecoder().decodeGeneralPurposeField(on.HEADER_SIZE+pn.GTIN_SIZE+on.LAST_DIGIT_SIZE+on.FIRST_THREE_DIGITS_SIZE,null);return r.append(c.getNewString()),r.toString()}}on.HEADER_SIZE=8,on.LAST_DIGIT_SIZE=2,on.FIRST_THREE_DIGITS_SIZE=10;class Mt extends ei{constructor(r,i,a){super(r),this.dateCode=a,this.firstAIdigits=i}parseInformation(){if(this.getInformation().getSize()!=Mt.HEADER_SIZE+Mt.GTIN_SIZE+Mt.WEIGHT_SIZE+Mt.DATE_SIZE)throw new Z;let r=new Q;return this.encodeCompressedGtin(r,Mt.HEADER_SIZE),this.encodeCompressedWeight(r,Mt.HEADER_SIZE+Mt.GTIN_SIZE,Mt.WEIGHT_SIZE),this.encodeCompressedDate(r,Mt.HEADER_SIZE+Mt.GTIN_SIZE+Mt.WEIGHT_SIZE),r.toString()}encodeCompressedDate(r,i){let a=this.getGeneralDecoder().extractNumericValueFromBitArray(i,Mt.DATE_SIZE);if(a==38400)return;r.append("("),r.append(this.dateCode),r.append(")");let c=a%32;a/=32;let u=a%12+1;a/=12;let d=a;d/10==0&&r.append("0"),r.append(d),u/10==0&&r.append("0"),r.append(u),c/10==0&&r.append("0"),r.append(c)}addWeightCode(r,i){r.append("("),r.append(this.firstAIdigits),r.append(i/1e5),r.append(")")}checkWeight(r){return r%1e5}}Mt.HEADER_SIZE=8,Mt.WEIGHT_SIZE=20,Mt.DATE_SIZE=16;function Pi(I){try{if(I.get(1))return new Jr(I);if(!I.get(2))return new kn(I);switch(qr.extractNumericValueFromBitArray(I,1,4)){case 4:return new sn(I);case 5:return new Qo(I)}switch(qr.extractNumericValueFromBitArray(I,1,5)){case 12:return new er(I);case 13:return new on(I)}switch(qr.extractNumericValueFromBitArray(I,1,7)){case 56:return new Mt(I,"310","11");case 57:return new Mt(I,"320","11");case 58:return new Mt(I,"310","13");case 59:return new Mt(I,"320","13");case 60:return new Mt(I,"310","15");case 61:return new Mt(I,"320","15");case 62:return new Mt(I,"310","17");case 63:return new Mt(I,"320","17")}}catch(r){throw console.log(r),new Xt("unknown decoder: "+I)}}class Fr{constructor(r,i,a,c){this.leftchar=r,this.rightchar=i,this.finderpattern=a,this.maybeLast=c}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(r,i){return r instanceof Fr?Fr.equalsOrNull(r.leftchar,i.leftchar)&&Fr.equalsOrNull(r.rightchar,i.rightchar)&&Fr.equalsOrNull(r.finderpattern,i.finderpattern):!1}static equalsOrNull(r,i){return r===null?i===null:Fr.equals(r,i)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class ks{constructor(r,i,a){this.pairs=r,this.rowNumber=i,this.wasReversed=a}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(r){return this.checkEqualitity(this,r)}toString(){return"{ "+this.pairs+" }"}equals(r,i){return r instanceof ks?this.checkEqualitity(r,i)&&r.wasReversed===i.wasReversed:!1}checkEqualitity(r,i){if(!r||!i)return;let a;return r.forEach((c,u)=>{i.forEach(d=>{c.getLeftChar().getValue()===d.getLeftChar().getValue()&&c.getRightChar().getValue()===d.getRightChar().getValue()&&c.getFinderPatter().getValue()===d.getFinderPatter().getValue()&&(a=!0)})}),a}}class xe extends Qt{constructor(r){super(...arguments),this.pairs=new Array(xe.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=r===!0}decodeRow(r,i,a){this.pairs.length=0,this.startFromEven=!1;try{return xe.constructResult(this.decodeRow2pairs(r,i))}catch(c){this.verbose&&console.log(c)}return this.pairs.length=0,this.startFromEven=!0,xe.constructResult(this.decodeRow2pairs(r,i))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(r,i){let a=!1;for(;!a;)try{this.pairs.push(this.retrieveNextPair(i,this.pairs,r))}catch(u){if(u instanceof Z){if(!this.pairs.length)throw new Z;a=!0}}if(this.checkChecksum())return this.pairs;let c;if(this.rows.length?c=!0:c=!1,this.storeRow(r,!1),c){let u=this.checkRowsBoolean(!1);if(u!=null||(u=this.checkRowsBoolean(!0),u!=null))return u}throw new Z}checkRowsBoolean(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());let i=null;try{i=this.checkRows(new Array,0)}catch(a){this.verbose&&console.log(a)}return r&&(this.rows=this.rows.reverse()),i}checkRows(r,i){for(let a=i;a<this.rows.length;a++){let c=this.rows[a];this.pairs.length=0;for(let d of r)this.pairs.push(d.getPairs());if(this.pairs.push(c.getPairs()),!xe.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let u=new Array(r);u.push(c);try{return this.checkRows(u,a+1)}catch(d){this.verbose&&console.log(d)}}throw new Z}static isValidSequence(r){for(let i of xe.FINDER_PATTERN_SEQUENCES){if(r.length>i.length)continue;let a=!0;for(let c=0;c<r.length;c++)if(r[c].getFinderPattern().getValue()!=i[c]){a=!1;break}if(a)return!0}return!1}storeRow(r,i){let a=0,c=!1,u=!1;for(;a<this.rows.length;){let d=this.rows[a];if(d.getRowNumber()>r){u=d.isEquivalent(this.pairs);break}c=d.isEquivalent(this.pairs),a++}u||c||xe.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new ks(this.pairs,r,i)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(r,i){for(let a of i)if(a.getPairs().length!==r.length){for(let c of a.getPairs())for(let u of r)if(Fr.equals(c,u))break}}static isPartialRow(r,i){for(let a of i){let c=!0;for(let u of r){let d=!1;for(let p of a.getPairs())if(u.equals(p)){d=!0;break}if(!d){c=!1;break}}if(c)return!0}return!1}getRows(){return this.rows}static constructResult(r){let i=Li.buildBitArray(r),c=Pi(i).parseInformation(),u=r[0].getFinderPattern().getResultPoints(),d=r[r.length-1].getFinderPattern().getResultPoints(),p=[u[0],u[1],d[0],d[1]];return new we(c,null,null,p,ge.RSS_EXPANDED,null)}checkChecksum(){let r=this.pairs.get(0),i=r.getLeftChar(),a=r.getRightChar();if(a==null)return!1;let c=a.getChecksumPortion(),u=2;for(let p=1;p<this.pairs.size();++p){let y=this.pairs.get(p);c+=y.getLeftChar().getChecksumPortion(),u++;let w=y.getRightChar();w!=null&&(c+=w.getChecksumPortion(),u++)}return c%=211,211*(u-4)+c==i.getValue()}static getNextSecondBar(r,i){let a;return r.get(i)?(a=r.getNextUnset(i),a=r.getNextSet(a)):(a=r.getNextSet(i),a=r.getNextUnset(a)),a}retrieveNextPair(r,i,a){let c=i.length%2==0;this.startFromEven&&(c=!c);let u,d=!0,p=-1;do this.findNextPair(r,i,p),u=this.parseFoundFinderPattern(r,a,c),u==null?p=xe.getNextSecondBar(r,this.startEnd[0]):d=!1;while(d);let y=this.decodeDataCharacter(r,u,c,!0);if(!this.isEmptyPair(i)&&i[i.length-1].mustBeLast())throw new Z;let w;try{w=this.decodeDataCharacter(r,u,c,!1)}catch(S){w=null,this.verbose&&console.log(S)}return new Fr(y,w,u,!0)}isEmptyPair(r){return r.length===0}findNextPair(r,i,a){let c=this.getDecodeFinderCounters();c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=r.getSize(),d;a>=0?d=a:this.isEmptyPair(i)?d=0:d=i[i.length-1].getFinderPattern().getStartEnd()[1];let p=i.length%2!=0;this.startFromEven&&(p=!p);let y=!1;for(;d<u&&(y=!r.get(d),!!y);)d++;let w=0,S=d;for(let N=d;N<u;N++)if(r.get(N)!=y)c[w]++;else{if(w==3){if(p&&xe.reverseCounters(c),xe.isFinderPattern(c)){this.startEnd[0]=S,this.startEnd[1]=N;return}p&&xe.reverseCounters(c),S+=c[0]+c[1],c[0]=c[2],c[1]=c[3],c[2]=0,c[3]=0,w--}else w++;c[w]=1,y=!y}throw new Z}static reverseCounters(r){let i=r.length;for(let a=0;a<i/2;++a){let c=r[a];r[a]=r[i-a-1],r[i-a-1]=c}}parseFoundFinderPattern(r,i,a){let c,u,d;if(a){let w=this.startEnd[0]-1;for(;w>=0&&!r.get(w);)w--;w++,c=this.startEnd[0]-w,u=w,d=this.startEnd[1]}else u=this.startEnd[0],d=r.getNextUnset(this.startEnd[1]+1),c=d-this.startEnd[1];let p=this.getDecodeFinderCounters();U.arraycopy(p,0,p,1,p.length-1),p[0]=c;let y;try{y=this.parseFinderValue(p,xe.FINDER_PATTERNS)}catch{return null}return new vr(y,[u,d],u,d,i)}decodeDataCharacter(r,i,a,c){let u=this.getDataCharacterCounters();for(let vt=0;vt<u.length;vt++)u[vt]=0;if(c)xe.recordPatternInReverse(r,i.getStartEnd()[0],u);else{xe.recordPattern(r,i.getStartEnd()[1],u);for(let vt=0,Cn=u.length-1;vt<Cn;vt++,Cn--){let Vn=u[vt];u[vt]=u[Cn],u[Cn]=Vn}}let d=17,p=Xe.sum(new Int32Array(u))/d,y=(i.getStartEnd()[1]-i.getStartEnd()[0])/15;if(Math.abs(p-y)/y>.3)throw new Z;let w=this.getOddCounts(),S=this.getEvenCounts(),N=this.getOddRoundingErrors(),k=this.getEvenRoundingErrors();for(let vt=0;vt<u.length;vt++){let Cn=1*u[vt]/p,Vn=Cn+.5;if(Vn<1){if(Cn<.3)throw new Z;Vn=1}else if(Vn>8){if(Cn>8.7)throw new Z;Vn=8}let is=vt/2;vt&1?(S[is]=Vn,k[is]=Cn-Vn):(w[is]=Vn,N[is]=Cn-Vn)}this.adjustOddEvenCounts(d);let j=4*i.getValue()+(a?0:2)+(c?0:1)-1,G=0,X=0;for(let vt=w.length-1;vt>=0;vt--){if(xe.isNotA1left(i,a,c)){let Cn=xe.WEIGHTS[j][2*vt];X+=w[vt]*Cn}G+=w[vt]}let ee=0;for(let vt=S.length-1;vt>=0;vt--)if(xe.isNotA1left(i,a,c)){let Cn=xe.WEIGHTS[j][2*vt+1];ee+=S[vt]*Cn}let ie=X+ee;if(G&1||G>13||G<4)throw new Z;let Ee=(13-G)/2,be=xe.SYMBOL_WIDEST[Ee],ve=9-be,it=jt.getRSSvalue(w,be,!0),et=jt.getRSSvalue(S,ve,!1),Ht=xe.EVEN_TOTAL_SUBSET[Ee],Un=xe.GSUM[Ee],Hn=it*Ht+et+Un;return new mi(Hn,ie)}static isNotA1left(r,i,a){return!(r.getValue()==0&&i&&a)}adjustOddEvenCounts(r){let i=Xe.sum(new Int32Array(this.getOddCounts())),a=Xe.sum(new Int32Array(this.getEvenCounts())),c=!1,u=!1;i>13?u=!0:i<4&&(c=!0);let d=!1,p=!1;a>13?p=!0:a<4&&(d=!0);let y=i+a-r,w=(i&1)==1,S=(a&1)==0;if(y==1)if(w){if(S)throw new Z;u=!0}else{if(!S)throw new Z;p=!0}else if(y==-1)if(w){if(S)throw new Z;c=!0}else{if(!S)throw new Z;d=!0}else if(y==0){if(w){if(!S)throw new Z;i<a?(c=!0,p=!0):(u=!0,d=!0)}else if(S)throw new Z}else throw new Z;if(c){if(u)throw new Z;xe.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(u&&xe.decrement(this.getOddCounts(),this.getOddRoundingErrors()),d){if(p)throw new Z;xe.increment(this.getEvenCounts(),this.getOddRoundingErrors())}p&&xe.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}xe.SYMBOL_WIDEST=[7,5,4,3,1],xe.EVEN_TOTAL_SUBSET=[4,20,52,104,204],xe.GSUM=[0,348,1388,2948,3988],xe.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],xe.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],xe.FINDER_PAT_A=0,xe.FINDER_PAT_B=1,xe.FINDER_PAT_C=2,xe.FINDER_PAT_D=3,xe.FINDER_PAT_E=4,xe.FINDER_PAT_F=5,xe.FINDER_PATTERN_SEQUENCES=[[xe.FINDER_PAT_A,xe.FINDER_PAT_A],[xe.FINDER_PAT_A,xe.FINDER_PAT_B,xe.FINDER_PAT_B],[xe.FINDER_PAT_A,xe.FINDER_PAT_C,xe.FINDER_PAT_B,xe.FINDER_PAT_D],[xe.FINDER_PAT_A,xe.FINDER_PAT_E,xe.FINDER_PAT_B,xe.FINDER_PAT_D,xe.FINDER_PAT_C],[xe.FINDER_PAT_A,xe.FINDER_PAT_E,xe.FINDER_PAT_B,xe.FINDER_PAT_D,xe.FINDER_PAT_D,xe.FINDER_PAT_F],[xe.FINDER_PAT_A,xe.FINDER_PAT_E,xe.FINDER_PAT_B,xe.FINDER_PAT_D,xe.FINDER_PAT_E,xe.FINDER_PAT_F,xe.FINDER_PAT_F],[xe.FINDER_PAT_A,xe.FINDER_PAT_A,xe.FINDER_PAT_B,xe.FINDER_PAT_B,xe.FINDER_PAT_C,xe.FINDER_PAT_C,xe.FINDER_PAT_D,xe.FINDER_PAT_D],[xe.FINDER_PAT_A,xe.FINDER_PAT_A,xe.FINDER_PAT_B,xe.FINDER_PAT_B,xe.FINDER_PAT_C,xe.FINDER_PAT_C,xe.FINDER_PAT_D,xe.FINDER_PAT_E,xe.FINDER_PAT_E],[xe.FINDER_PAT_A,xe.FINDER_PAT_A,xe.FINDER_PAT_B,xe.FINDER_PAT_B,xe.FINDER_PAT_C,xe.FINDER_PAT_C,xe.FINDER_PAT_D,xe.FINDER_PAT_E,xe.FINDER_PAT_F,xe.FINDER_PAT_F],[xe.FINDER_PAT_A,xe.FINDER_PAT_A,xe.FINDER_PAT_B,xe.FINDER_PAT_B,xe.FINDER_PAT_C,xe.FINDER_PAT_D,xe.FINDER_PAT_D,xe.FINDER_PAT_E,xe.FINDER_PAT_E,xe.FINDER_PAT_F,xe.FINDER_PAT_F]],xe.MAX_PAIRS=11;class Ko extends mi{constructor(r,i,a){super(r,i),this.count=0,this.finderPattern=a}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Bt extends Qt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(r,i,a){const c=this.decodePair(i,!1,r,a);Bt.addOrTally(this.possibleLeftPairs,c),i.reverse();let u=this.decodePair(i,!0,r,a);Bt.addOrTally(this.possibleRightPairs,u),i.reverse();for(let d of this.possibleLeftPairs)if(d.getCount()>1){for(let p of this.possibleRightPairs)if(p.getCount()>1&&Bt.checkChecksum(d,p))return Bt.constructResult(d,p)}throw new Z}static addOrTally(r,i){if(i==null)return;let a=!1;for(let c of r)if(c.getValue()===i.getValue()){c.incrementCount(),a=!0;break}a||r.push(i)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(r,i){let a=4537077*r.getValue()+i.getValue(),c=new String(a).toString(),u=new Q;for(let w=13-c.length;w>0;w--)u.append("0");u.append(c);let d=0;for(let w=0;w<13;w++){let S=u.charAt(w).charCodeAt(0)-48;d+=w&1?S:3*S}d=10-d%10,d===10&&(d=0),u.append(d.toString());let p=r.getFinderPattern().getResultPoints(),y=i.getFinderPattern().getResultPoints();return new we(u.toString(),null,0,[p[0],p[1],y[0],y[1]],ge.RSS_14,new Date().getTime())}static checkChecksum(r,i){let a=(r.getChecksumPortion()+16*i.getChecksumPortion())%79,c=9*r.getFinderPattern().getValue()+i.getFinderPattern().getValue();return c>72&&c--,c>8&&c--,a===c}decodePair(r,i,a,c){try{let u=this.findFinderPattern(r,i),d=this.parseFoundFinderPattern(r,a,i,u),p=c==null?null:c.get(pe.NEED_RESULT_POINT_CALLBACK);if(p!=null){let S=(u[0]+u[1])/2;i&&(S=r.getSize()-1-S),p.foundPossibleResultPoint(new Te(S,a))}let y=this.decodeDataCharacter(r,d,!0),w=this.decodeDataCharacter(r,d,!1);return new Ko(1597*y.getValue()+w.getValue(),y.getChecksumPortion()+4*w.getChecksumPortion(),d)}catch{return null}}decodeDataCharacter(r,i,a){let c=this.getDataCharacterCounters();for(let ee=0;ee<c.length;ee++)c[ee]=0;if(a)wt.recordPatternInReverse(r,i.getStartEnd()[0],c);else{wt.recordPattern(r,i.getStartEnd()[1]+1,c);for(let ee=0,ie=c.length-1;ee<ie;ee++,ie--){let Ee=c[ee];c[ee]=c[ie],c[ie]=Ee}}let u=a?16:15,d=Xe.sum(new Int32Array(c))/u,p=this.getOddCounts(),y=this.getEvenCounts(),w=this.getOddRoundingErrors(),S=this.getEvenRoundingErrors();for(let ee=0;ee<c.length;ee++){let ie=c[ee]/d,Ee=Math.floor(ie+.5);Ee<1?Ee=1:Ee>8&&(Ee=8);let be=Math.floor(ee/2);ee&1?(y[be]=Ee,S[be]=ie-Ee):(p[be]=Ee,w[be]=ie-Ee)}this.adjustOddEvenCounts(a,u);let N=0,k=0;for(let ee=p.length-1;ee>=0;ee--)k*=9,k+=p[ee],N+=p[ee];let j=0,G=0;for(let ee=y.length-1;ee>=0;ee--)j*=9,j+=y[ee],G+=y[ee];let X=k+3*j;if(a){if(N&1||N>12||N<4)throw new Z;let ee=(12-N)/2,ie=Bt.OUTSIDE_ODD_WIDEST[ee],Ee=9-ie,be=jt.getRSSvalue(p,ie,!1),ve=jt.getRSSvalue(y,Ee,!0),it=Bt.OUTSIDE_EVEN_TOTAL_SUBSET[ee],et=Bt.OUTSIDE_GSUM[ee];return new mi(be*it+ve+et,X)}else{if(G&1||G>10||G<4)throw new Z;let ee=(10-G)/2,ie=Bt.INSIDE_ODD_WIDEST[ee],Ee=9-ie,be=jt.getRSSvalue(p,ie,!0),ve=jt.getRSSvalue(y,Ee,!1),it=Bt.INSIDE_ODD_TOTAL_SUBSET[ee],et=Bt.INSIDE_GSUM[ee];return new mi(ve*it+be+et,X)}}findFinderPattern(r,i){let a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;let c=r.getSize(),u=!1,d=0;for(;d<c&&(u=!r.get(d),i!==u);)d++;let p=0,y=d;for(let w=d;w<c;w++)if(r.get(w)!==u)a[p]++;else{if(p===3){if(Qt.isFinderPattern(a))return[y,w];y+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,p--}else p++;a[p]=1,u=!u}throw new Z}parseFoundFinderPattern(r,i,a,c){let u=r.get(c[0]),d=c[0]-1;for(;d>=0&&u!==r.get(d);)d--;d++;const p=c[0]-d,y=this.getDecodeFinderCounters(),w=new Int32Array(y.length);U.arraycopy(y,0,w,1,y.length-1),w[0]=p;const S=this.parseFinderValue(w,Bt.FINDER_PATTERNS);let N=d,k=c[1];return a&&(N=r.getSize()-1-N,k=r.getSize()-1-k),new vr(S,[d,c[1]],N,k,i)}adjustOddEvenCounts(r,i){let a=Xe.sum(new Int32Array(this.getOddCounts())),c=Xe.sum(new Int32Array(this.getEvenCounts())),u=!1,d=!1,p=!1,y=!1;r?(a>12?d=!0:a<4&&(u=!0),c>12?y=!0:c<4&&(p=!0)):(a>11?d=!0:a<5&&(u=!0),c>10?y=!0:c<4&&(p=!0));let w=a+c-i,S=(a&1)===(r?1:0),N=(c&1)===1;if(w===1)if(S){if(N)throw new Z;d=!0}else{if(!N)throw new Z;y=!0}else if(w===-1)if(S){if(N)throw new Z;u=!0}else{if(!N)throw new Z;p=!0}else if(w===0){if(S){if(!N)throw new Z;a<c?(u=!0,y=!0):(d=!0,p=!0)}else if(N)throw new Z}else throw new Z;if(u){if(d)throw new Z;Qt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&Qt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),p){if(y)throw new Z;Qt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}y&&Qt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Bt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Bt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Bt.OUTSIDE_GSUM=[0,161,961,2015,2715],Bt.INSIDE_GSUM=[0,336,1036,1516],Bt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Bt.INSIDE_ODD_WIDEST=[2,4,6,8],Bt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class jr extends wt{constructor(r,i){super(),this.readers=[],this.verbose=i===!0;const a=r?r.get(pe.POSSIBLE_FORMATS):null,c=r&&r.get(pe.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;a?((a.includes(ge.EAN_13)||a.includes(ge.UPC_A)||a.includes(ge.EAN_8)||a.includes(ge.UPC_E))&&this.readers.push(new Rs(r)),a.includes(ge.CODE_39)&&this.readers.push(new Ie(c)),a.includes(ge.CODE_128)&&this.readers.push(new Ae),a.includes(ge.ITF)&&this.readers.push(new Me),a.includes(ge.RSS_14)&&this.readers.push(new Bt),a.includes(ge.RSS_EXPANDED)&&this.readers.push(new xe(this.verbose))):(this.readers.push(new Rs(r)),this.readers.push(new Ie),this.readers.push(new Rs(r)),this.readers.push(new Ae),this.readers.push(new Me),this.readers.push(new Bt),this.readers.push(new xe(this.verbose)))}decodeRow(r,i,a){for(let c=0;c<this.readers.length;c++)try{return this.readers[c].decodeRow(r,i,a)}catch{}throw new Z}reset(){this.readers.forEach(r=>r.reset())}}class _i extends Qe{constructor(r=500,i){super(new jr(i),r,i)}}class pt{constructor(r,i,a){this.ecCodewords=r,this.ecBlocks=[i],a&&this.ecBlocks.push(a)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class at{constructor(r,i){this.count=r,this.dataCodewords=i}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class qe{constructor(r,i,a,c,u,d){this.versionNumber=r,this.symbolSizeRows=i,this.symbolSizeColumns=a,this.dataRegionSizeRows=c,this.dataRegionSizeColumns=u,this.ecBlocks=d;let p=0;const y=d.getECCodewords(),w=d.getECBlocks();for(let S of w)p+=S.getCount()*(S.getDataCodewords()+y);this.totalCodewords=p}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(r,i){if(r&1||i&1)throw new K;for(let a of qe.VERSIONS)if(a.symbolSizeRows===r&&a.symbolSizeColumns===i)return a;throw new K}toString(){return""+this.versionNumber}static buildVersions(){return[new qe(1,10,10,8,8,new pt(5,new at(1,3))),new qe(2,12,12,10,10,new pt(7,new at(1,5))),new qe(3,14,14,12,12,new pt(10,new at(1,8))),new qe(4,16,16,14,14,new pt(12,new at(1,12))),new qe(5,18,18,16,16,new pt(14,new at(1,18))),new qe(6,20,20,18,18,new pt(18,new at(1,22))),new qe(7,22,22,20,20,new pt(20,new at(1,30))),new qe(8,24,24,22,22,new pt(24,new at(1,36))),new qe(9,26,26,24,24,new pt(28,new at(1,44))),new qe(10,32,32,14,14,new pt(36,new at(1,62))),new qe(11,36,36,16,16,new pt(42,new at(1,86))),new qe(12,40,40,18,18,new pt(48,new at(1,114))),new qe(13,44,44,20,20,new pt(56,new at(1,144))),new qe(14,48,48,22,22,new pt(68,new at(1,174))),new qe(15,52,52,24,24,new pt(42,new at(2,102))),new qe(16,64,64,14,14,new pt(56,new at(2,140))),new qe(17,72,72,16,16,new pt(36,new at(4,92))),new qe(18,80,80,18,18,new pt(48,new at(4,114))),new qe(19,88,88,20,20,new pt(56,new at(4,144))),new qe(20,96,96,22,22,new pt(68,new at(4,174))),new qe(21,104,104,24,24,new pt(56,new at(6,136))),new qe(22,120,120,18,18,new pt(68,new at(6,175))),new qe(23,132,132,20,20,new pt(62,new at(8,163))),new qe(24,144,144,22,22,new pt(62,new at(8,156),new at(2,155))),new qe(25,8,18,6,16,new pt(7,new at(1,5))),new qe(26,8,32,6,14,new pt(11,new at(1,10))),new qe(27,12,26,10,24,new pt(14,new at(1,16))),new qe(28,12,36,10,16,new pt(18,new at(1,22))),new qe(29,16,36,14,16,new pt(24,new at(1,32))),new qe(30,16,48,14,22,new pt(28,new at(1,49)))]}}qe.VERSIONS=qe.buildVersions();class st{constructor(r){const i=r.getHeight();if(i<8||i>144||i&1)throw new K;this.version=st.readVersion(r),this.mappingBitMatrix=this.extractDataRegion(r),this.readMappingMatrix=new ne(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(r){const i=r.getHeight(),a=r.getWidth();return qe.getVersionForDimensions(i,a)}readCodewords(){const r=new Int8Array(this.version.getTotalCodewords());let i=0,a=4,c=0;const u=this.mappingBitMatrix.getHeight(),d=this.mappingBitMatrix.getWidth();let p=!1,y=!1,w=!1,S=!1;do if(a===u&&c===0&&!p)r[i++]=this.readCorner1(u,d)&255,a-=2,c+=2,p=!0;else if(a===u-2&&c===0&&d&3&&!y)r[i++]=this.readCorner2(u,d)&255,a-=2,c+=2,y=!0;else if(a===u+4&&c===2&&!(d&7)&&!w)r[i++]=this.readCorner3(u,d)&255,a-=2,c+=2,w=!0;else if(a===u-2&&c===0&&(d&7)===4&&!S)r[i++]=this.readCorner4(u,d)&255,a-=2,c+=2,S=!0;else{do a<u&&c>=0&&!this.readMappingMatrix.get(c,a)&&(r[i++]=this.readUtah(a,c,u,d)&255),a-=2,c+=2;while(a>=0&&c<d);a+=1,c+=3;do a>=0&&c<d&&!this.readMappingMatrix.get(c,a)&&(r[i++]=this.readUtah(a,c,u,d)&255),a+=2,c-=2;while(a<u&&c>=0);a+=3,c+=1}while(a<u||c<d);if(i!==this.version.getTotalCodewords())throw new K;return r}readModule(r,i,a,c){return r<0&&(r+=a,i+=4-(a+4&7)),i<0&&(i+=c,r+=4-(c+4&7)),this.readMappingMatrix.set(i,r),this.mappingBitMatrix.get(i,r)}readUtah(r,i,a,c){let u=0;return this.readModule(r-2,i-2,a,c)&&(u|=1),u<<=1,this.readModule(r-2,i-1,a,c)&&(u|=1),u<<=1,this.readModule(r-1,i-2,a,c)&&(u|=1),u<<=1,this.readModule(r-1,i-1,a,c)&&(u|=1),u<<=1,this.readModule(r-1,i,a,c)&&(u|=1),u<<=1,this.readModule(r,i-2,a,c)&&(u|=1),u<<=1,this.readModule(r,i-1,a,c)&&(u|=1),u<<=1,this.readModule(r,i,a,c)&&(u|=1),u}readCorner1(r,i){let a=0;return this.readModule(r-1,0,r,i)&&(a|=1),a<<=1,this.readModule(r-1,1,r,i)&&(a|=1),a<<=1,this.readModule(r-1,2,r,i)&&(a|=1),a<<=1,this.readModule(0,i-2,r,i)&&(a|=1),a<<=1,this.readModule(0,i-1,r,i)&&(a|=1),a<<=1,this.readModule(1,i-1,r,i)&&(a|=1),a<<=1,this.readModule(2,i-1,r,i)&&(a|=1),a<<=1,this.readModule(3,i-1,r,i)&&(a|=1),a}readCorner2(r,i){let a=0;return this.readModule(r-3,0,r,i)&&(a|=1),a<<=1,this.readModule(r-2,0,r,i)&&(a|=1),a<<=1,this.readModule(r-1,0,r,i)&&(a|=1),a<<=1,this.readModule(0,i-4,r,i)&&(a|=1),a<<=1,this.readModule(0,i-3,r,i)&&(a|=1),a<<=1,this.readModule(0,i-2,r,i)&&(a|=1),a<<=1,this.readModule(0,i-1,r,i)&&(a|=1),a<<=1,this.readModule(1,i-1,r,i)&&(a|=1),a}readCorner3(r,i){let a=0;return this.readModule(r-1,0,r,i)&&(a|=1),a<<=1,this.readModule(r-1,i-1,r,i)&&(a|=1),a<<=1,this.readModule(0,i-3,r,i)&&(a|=1),a<<=1,this.readModule(0,i-2,r,i)&&(a|=1),a<<=1,this.readModule(0,i-1,r,i)&&(a|=1),a<<=1,this.readModule(1,i-3,r,i)&&(a|=1),a<<=1,this.readModule(1,i-2,r,i)&&(a|=1),a<<=1,this.readModule(1,i-1,r,i)&&(a|=1),a}readCorner4(r,i){let a=0;return this.readModule(r-3,0,r,i)&&(a|=1),a<<=1,this.readModule(r-2,0,r,i)&&(a|=1),a<<=1,this.readModule(r-1,0,r,i)&&(a|=1),a<<=1,this.readModule(0,i-2,r,i)&&(a|=1),a<<=1,this.readModule(0,i-1,r,i)&&(a|=1),a<<=1,this.readModule(1,i-1,r,i)&&(a|=1),a<<=1,this.readModule(2,i-1,r,i)&&(a|=1),a<<=1,this.readModule(3,i-1,r,i)&&(a|=1),a}extractDataRegion(r){const i=this.version.getSymbolSizeRows(),a=this.version.getSymbolSizeColumns();if(r.getHeight()!==i)throw new b("Dimension of bitMatrix must match the version size");const c=this.version.getDataRegionSizeRows(),u=this.version.getDataRegionSizeColumns(),d=i/c|0,p=a/u|0,y=d*c,w=p*u,S=new ne(w,y);for(let N=0;N<d;++N){const k=N*c;for(let j=0;j<p;++j){const G=j*u;for(let X=0;X<c;++X){const ee=N*(c+2)+1+X,ie=k+X;for(let Ee=0;Ee<u;++Ee){const be=j*(u+2)+1+Ee;if(r.get(be,ee)){const ve=G+Ee;S.set(ve,ie)}}}}}return S}}class bt{constructor(r,i){this.numDataCodewords=r,this.codewords=i}static getDataBlocks(r,i){const a=i.getECBlocks();let c=0;const u=a.getECBlocks();for(let X of u)c+=X.getCount();const d=new Array(c);let p=0;for(let X of u)for(let ee=0;ee<X.getCount();ee++){const ie=X.getDataCodewords(),Ee=a.getECCodewords()+ie;d[p++]=new bt(ie,new Uint8Array(Ee))}const w=d[0].codewords.length-a.getECCodewords(),S=w-1;let N=0;for(let X=0;X<S;X++)for(let ee=0;ee<p;ee++)d[ee].codewords[X]=r[N++];const k=i.getVersionNumber()===24,j=k?8:p;for(let X=0;X<j;X++)d[X].codewords[w-1]=r[N++];const G=d[0].codewords.length;for(let X=w;X<G;X++)for(let ee=0;ee<p;ee++){const ie=k?(ee+8)%p:ee,Ee=k&&ie>7?X-1:X;d[ie].codewords[Ee]=r[N++]}if(N!==r.length)throw new b;return d}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class vi{constructor(r){this.bytes=r,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(r){if(r<1||r>32||r>this.available())throw new b(""+r);let i=0,a=this.bitOffset,c=this.byteOffset;const u=this.bytes;if(a>0){const d=8-a,p=r<d?r:d,y=d-p,w=255>>8-p<<y;i=(u[c]&w)>>y,r-=p,a+=p,a===8&&(a=0,c++)}if(r>0){for(;r>=8;)i=i<<8|u[c]&255,c++,r-=8;if(r>0){const d=8-r,p=255>>d<<d;i=i<<r|(u[c]&p)>>d,a+=r}}return this.bitOffset=a,this.byteOffset=c,i}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Rt;(function(I){I[I.PAD_ENCODE=0]="PAD_ENCODE",I[I.ASCII_ENCODE=1]="ASCII_ENCODE",I[I.C40_ENCODE=2]="C40_ENCODE",I[I.TEXT_ENCODE=3]="TEXT_ENCODE",I[I.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",I[I.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",I[I.BASE256_ENCODE=6]="BASE256_ENCODE"})(Rt||(Rt={}));class On{static decode(r){const i=new vi(r),a=new Q,c=new Q,u=new Array;let d=Rt.ASCII_ENCODE;do if(d===Rt.ASCII_ENCODE)d=this.decodeAsciiSegment(i,a,c);else{switch(d){case Rt.C40_ENCODE:this.decodeC40Segment(i,a);break;case Rt.TEXT_ENCODE:this.decodeTextSegment(i,a);break;case Rt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(i,a);break;case Rt.EDIFACT_ENCODE:this.decodeEdifactSegment(i,a);break;case Rt.BASE256_ENCODE:this.decodeBase256Segment(i,a,u);break;default:throw new K}d=Rt.ASCII_ENCODE}while(d!==Rt.PAD_ENCODE&&i.available()>0);return c.length()>0&&a.append(c.toString()),new Bn(r,a.toString(),u.length===0?null:u,null)}static decodeAsciiSegment(r,i,a){let c=!1;do{let u=r.readBits(8);if(u===0)throw new K;if(u<=128)return c&&(u+=128),i.append(String.fromCharCode(u-1)),Rt.ASCII_ENCODE;if(u===129)return Rt.PAD_ENCODE;if(u<=229){const d=u-130;d<10&&i.append("0"),i.append(""+d)}else switch(u){case 230:return Rt.C40_ENCODE;case 231:return Rt.BASE256_ENCODE;case 232:i.append("");break;case 233:case 234:break;case 235:c=!0;break;case 236:i.append("[)>05"),a.insert(0,"");break;case 237:i.append("[)>06"),a.insert(0,"");break;case 238:return Rt.ANSIX12_ENCODE;case 239:return Rt.TEXT_ENCODE;case 240:return Rt.EDIFACT_ENCODE;case 241:break;default:if(u!==254||r.available()!==0)throw new K;break}}while(r.available()>0);return Rt.ASCII_ENCODE}static decodeC40Segment(r,i){let a=!1;const c=[];let u=0;do{if(r.available()===8)return;const d=r.readBits(8);if(d===254)return;this.parseTwoBytes(d,r.readBits(8),c);for(let p=0;p<3;p++){const y=c[p];switch(u){case 0:if(y<3)u=y+1;else if(y<this.C40_BASIC_SET_CHARS.length){const w=this.C40_BASIC_SET_CHARS[y];a?(i.append(String.fromCharCode(w.charCodeAt(0)+128)),a=!1):i.append(w)}else throw new K;break;case 1:a?(i.append(String.fromCharCode(y+128)),a=!1):i.append(String.fromCharCode(y)),u=0;break;case 2:if(y<this.C40_SHIFT2_SET_CHARS.length){const w=this.C40_SHIFT2_SET_CHARS[y];a?(i.append(String.fromCharCode(w.charCodeAt(0)+128)),a=!1):i.append(w)}else switch(y){case 27:i.append("");break;case 30:a=!0;break;default:throw new K}u=0;break;case 3:a?(i.append(String.fromCharCode(y+224)),a=!1):i.append(String.fromCharCode(y+96)),u=0;break;default:throw new K}}}while(r.available()>0)}static decodeTextSegment(r,i){let a=!1,c=[],u=0;do{if(r.available()===8)return;const d=r.readBits(8);if(d===254)return;this.parseTwoBytes(d,r.readBits(8),c);for(let p=0;p<3;p++){const y=c[p];switch(u){case 0:if(y<3)u=y+1;else if(y<this.TEXT_BASIC_SET_CHARS.length){const w=this.TEXT_BASIC_SET_CHARS[y];a?(i.append(String.fromCharCode(w.charCodeAt(0)+128)),a=!1):i.append(w)}else throw new K;break;case 1:a?(i.append(String.fromCharCode(y+128)),a=!1):i.append(String.fromCharCode(y)),u=0;break;case 2:if(y<this.TEXT_SHIFT2_SET_CHARS.length){const w=this.TEXT_SHIFT2_SET_CHARS[y];a?(i.append(String.fromCharCode(w.charCodeAt(0)+128)),a=!1):i.append(w)}else switch(y){case 27:i.append("");break;case 30:a=!0;break;default:throw new K}u=0;break;case 3:if(y<this.TEXT_SHIFT3_SET_CHARS.length){const w=this.TEXT_SHIFT3_SET_CHARS[y];a?(i.append(String.fromCharCode(w.charCodeAt(0)+128)),a=!1):i.append(w),u=0}else throw new K;break;default:throw new K}}}while(r.available()>0)}static decodeAnsiX12Segment(r,i){const a=[];do{if(r.available()===8)return;const c=r.readBits(8);if(c===254)return;this.parseTwoBytes(c,r.readBits(8),a);for(let u=0;u<3;u++){const d=a[u];switch(d){case 0:i.append("\r");break;case 1:i.append("*");break;case 2:i.append(">");break;case 3:i.append(" ");break;default:if(d<14)i.append(String.fromCharCode(d+44));else if(d<40)i.append(String.fromCharCode(d+51));else throw new K;break}}}while(r.available()>0)}static parseTwoBytes(r,i,a){let c=(r<<8)+i-1,u=Math.floor(c/1600);a[0]=u,c-=u*1600,u=Math.floor(c/40),a[1]=u,a[2]=c-u*40}static decodeEdifactSegment(r,i){do{if(r.available()<=16)return;for(let a=0;a<4;a++){let c=r.readBits(6);if(c===31){const u=8-r.getBitOffset();u!==8&&r.readBits(u);return}c&32||(c|=64),i.append(String.fromCharCode(c))}}while(r.available()>0)}static decodeBase256Segment(r,i,a){let c=1+r.getByteOffset();const u=this.unrandomize255State(r.readBits(8),c++);let d;if(u===0?d=r.available()/8|0:u<250?d=u:d=250*(u-249)+this.unrandomize255State(r.readBits(8),c++),d<0)throw new K;const p=new Uint8Array(d);for(let y=0;y<d;y++){if(r.available()<8)throw new K;p[y]=this.unrandomize255State(r.readBits(8),c++)}a.push(p);try{i.append(ce.decode(p,ue.ISO88591))}catch(y){throw new Xt("Platform does not support required encoding: "+y.message)}}static unrandomize255State(r,i){const a=149*i%255+1,c=r-a;return c>=0?c:c+256}}On.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],On.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],On.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],On.TEXT_SHIFT2_SET_CHARS=On.C40_SHIFT2_SET_CHARS,On.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Os{constructor(){this.rsDecoder=new Rn($e.DATA_MATRIX_FIELD_256)}decode(r){const i=new st(r),a=i.getVersion(),c=i.readCodewords(),u=bt.getDataBlocks(c,a);let d=0;for(let w of u)d+=w.getNumDataCodewords();const p=new Uint8Array(d),y=u.length;for(let w=0;w<y;w++){const S=u[w],N=S.getCodewords(),k=S.getNumDataCodewords();this.correctErrors(N,k);for(let j=0;j<k;j++)p[j*y+w]=N[j]}return On.decode(p)}correctErrors(r,i){const a=new Int32Array(r);try{this.rsDecoder.decode(a,r.length-i)}catch{throw new F}for(let c=0;c<i;c++)r[c]=a[c]}}class ze{constructor(r){this.image=r,this.rectangleDetector=new hn(this.image)}detect(){const r=this.rectangleDetector.detect();let i=this.detectSolid1(r);if(i=this.detectSolid2(i),i[3]=this.correctTopRight(i),!i[3])throw new Z;i=this.shiftToModuleCenter(i);const a=i[0],c=i[1],u=i[2],d=i[3];let p=this.transitionsBetween(a,d)+1,y=this.transitionsBetween(u,d)+1;(p&1)===1&&(p+=1),(y&1)===1&&(y+=1),4*p<7*y&&4*y<7*p&&(p=y=Math.max(p,y));let w=ze.sampleGrid(this.image,a,c,u,d,p,y);return new Lt(w,[a,c,u,d])}static shiftPoint(r,i,a){let c=(i.getX()-r.getX())/(a+1),u=(i.getY()-r.getY())/(a+1);return new Te(r.getX()+c,r.getY()+u)}static moveAway(r,i,a){let c=r.getX(),u=r.getY();return c<i?c-=1:c+=1,u<a?u-=1:u+=1,new Te(c,u)}detectSolid1(r){let i=r[0],a=r[1],c=r[3],u=r[2],d=this.transitionsBetween(i,a),p=this.transitionsBetween(a,c),y=this.transitionsBetween(c,u),w=this.transitionsBetween(u,i),S=d,N=[u,i,a,c];return S>p&&(S=p,N[0]=i,N[1]=a,N[2]=c,N[3]=u),S>y&&(S=y,N[0]=a,N[1]=c,N[2]=u,N[3]=i),S>w&&(N[0]=c,N[1]=u,N[2]=i,N[3]=a),N}detectSolid2(r){let i=r[0],a=r[1],c=r[2],u=r[3],d=this.transitionsBetween(i,u),p=ze.shiftPoint(a,c,(d+1)*4),y=ze.shiftPoint(c,a,(d+1)*4),w=this.transitionsBetween(p,i),S=this.transitionsBetween(y,u);return w<S?(r[0]=i,r[1]=a,r[2]=c,r[3]=u):(r[0]=a,r[1]=c,r[2]=u,r[3]=i),r}correctTopRight(r){let i=r[0],a=r[1],c=r[2],u=r[3],d=this.transitionsBetween(i,u),p=this.transitionsBetween(a,u),y=ze.shiftPoint(i,a,(p+1)*4),w=ze.shiftPoint(c,a,(d+1)*4);d=this.transitionsBetween(y,u),p=this.transitionsBetween(w,u);let S=new Te(u.getX()+(c.getX()-a.getX())/(d+1),u.getY()+(c.getY()-a.getY())/(d+1)),N=new Te(u.getX()+(i.getX()-a.getX())/(p+1),u.getY()+(i.getY()-a.getY())/(p+1));if(!this.isValid(S))return this.isValid(N)?N:null;if(!this.isValid(N))return S;let k=this.transitionsBetween(y,S)+this.transitionsBetween(w,S),j=this.transitionsBetween(y,N)+this.transitionsBetween(w,N);return k>j?S:N}shiftToModuleCenter(r){let i=r[0],a=r[1],c=r[2],u=r[3],d=this.transitionsBetween(i,u)+1,p=this.transitionsBetween(c,u)+1,y=ze.shiftPoint(i,a,p*4),w=ze.shiftPoint(c,a,d*4);d=this.transitionsBetween(y,u)+1,p=this.transitionsBetween(w,u)+1,(d&1)===1&&(d+=1),(p&1)===1&&(p+=1);let S=(i.getX()+a.getX()+c.getX()+u.getX())/4,N=(i.getY()+a.getY()+c.getY()+u.getY())/4;i=ze.moveAway(i,S,N),a=ze.moveAway(a,S,N),c=ze.moveAway(c,S,N),u=ze.moveAway(u,S,N);let k,j;return y=ze.shiftPoint(i,a,p*4),y=ze.shiftPoint(y,u,d*4),k=ze.shiftPoint(a,i,p*4),k=ze.shiftPoint(k,c,d*4),w=ze.shiftPoint(c,u,p*4),w=ze.shiftPoint(w,a,d*4),j=ze.shiftPoint(u,c,p*4),j=ze.shiftPoint(j,i,d*4),[y,k,w,j]}isValid(r){return r.getX()>=0&&r.getX()<this.image.getWidth()&&r.getY()>0&&r.getY()<this.image.getHeight()}static sampleGrid(r,i,a,c,u,d,p){return Qn.getInstance().sampleGrid(r,d,p,.5,.5,d-.5,.5,d-.5,p-.5,.5,p-.5,i.getX(),i.getY(),u.getX(),u.getY(),c.getX(),c.getY(),a.getX(),a.getY())}transitionsBetween(r,i){let a=Math.trunc(r.getX()),c=Math.trunc(r.getY()),u=Math.trunc(i.getX()),d=Math.trunc(i.getY()),p=Math.abs(d-c)>Math.abs(u-a);if(p){let X=a;a=c,c=X,X=u,u=d,d=X}let y=Math.abs(u-a),w=Math.abs(d-c),S=-y/2,N=c<d?1:-1,k=a<u?1:-1,j=0,G=this.image.get(p?c:a,p?a:c);for(let X=a,ee=c;X!==u;X+=k){let ie=this.image.get(p?ee:X,p?X:ee);if(ie!==G&&(j++,G=ie),S+=w,S>0){if(ee===d)break;ee+=N,S-=y}}return j}}class _t{constructor(){this.decoder=new Os}decode(r,i=null){let a,c;if(i!=null&&i.has(pe.PURE_BARCODE)){const w=_t.extractPureBits(r.getBlackMatrix());a=this.decoder.decode(w),c=_t.NO_POINTS}else{const w=new ze(r.getBlackMatrix()).detect();a=this.decoder.decode(w.getBits()),c=w.getPoints()}const u=a.getRawBytes(),d=new we(a.getText(),u,8*u.length,c,ge.DATA_MATRIX,U.currentTimeMillis()),p=a.getByteSegments();p!=null&&d.putMetadata(He.BYTE_SEGMENTS,p);const y=a.getECLevel();return y!=null&&d.putMetadata(He.ERROR_CORRECTION_LEVEL,y),d}reset(){}static extractPureBits(r){const i=r.getTopLeftOnBit(),a=r.getBottomRightOnBit();if(i==null||a==null)throw new Z;const c=this.moduleSize(i,r);let u=i[1];const d=a[1];let p=i[0];const w=(a[0]-p+1)/c,S=(d-u+1)/c;if(w<=0||S<=0)throw new Z;const N=c/2;u+=N,p+=N;const k=new ne(w,S);for(let j=0;j<S;j++){const G=u+j*c;for(let X=0;X<w;X++)r.get(p+X*c,G)&&k.set(X,j)}return k}static moduleSize(r,i){const a=i.getWidth();let c=r[0];const u=r[1];for(;c<a&&i.get(c,u);)c++;if(c===a)throw new Z;const d=c-r[0];if(d===0)throw new Z;return d}}_t.NO_POINTS=[];class Ls extends Qe{constructor(r=500){super(new _t,r)}}var tr;(function(I){I[I.L=0]="L",I[I.M=1]="M",I[I.Q=2]="Q",I[I.H=3]="H"})(tr||(tr={}));class nt{constructor(r,i,a){this.value=r,this.stringValue=i,this.bits=a,nt.FOR_BITS.set(a,this),nt.FOR_VALUE.set(r,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(r){switch(r){case"L":return nt.L;case"M":return nt.M;case"Q":return nt.Q;case"H":return nt.H;default:throw new E(r+"not available")}}toString(){return this.stringValue}equals(r){if(!(r instanceof nt))return!1;const i=r;return this.value===i.value}static forBits(r){if(r<0||r>=nt.FOR_BITS.size)throw new b;return nt.FOR_BITS.get(r)}}nt.FOR_BITS=new Map,nt.FOR_VALUE=new Map,nt.L=new nt(tr.L,"L",1),nt.M=new nt(tr.M,"M",0),nt.Q=new nt(tr.Q,"Q",3),nt.H=new nt(tr.H,"H",2);class an{constructor(r){this.errorCorrectionLevel=nt.forBits(r>>3&3),this.dataMask=r&7}static numBitsDiffering(r,i){return B.bitCount(r^i)}static decodeFormatInformation(r,i){const a=an.doDecodeFormatInformation(r,i);return a!==null?a:an.doDecodeFormatInformation(r^an.FORMAT_INFO_MASK_QR,i^an.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(r,i){let a=Number.MAX_SAFE_INTEGER,c=0;for(const u of an.FORMAT_INFO_DECODE_LOOKUP){const d=u[0];if(d===r||d===i)return new an(u[1]);let p=an.numBitsDiffering(r,d);p<a&&(c=u[1],a=p),r!==i&&(p=an.numBitsDiffering(i,d),p<a&&(c=u[1],a=p))}return a<=3?new an(c):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(r){if(!(r instanceof an))return!1;const i=r;return this.errorCorrectionLevel===i.errorCorrectionLevel&&this.dataMask===i.dataMask}}an.FORMAT_INFO_MASK_QR=21522,an.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class P{constructor(r,...i){this.ecCodewordsPerBlock=r,this.ecBlocks=i}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let r=0;const i=this.ecBlocks;for(const a of i)r+=a.getCount();return r}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class R{constructor(r,i){this.count=r,this.dataCodewords=i}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class me{constructor(r,i,...a){this.versionNumber=r,this.alignmentPatternCenters=i,this.ecBlocks=a;let c=0;const u=a[0].getECCodewordsPerBlock(),d=a[0].getECBlocks();for(const p of d)c+=p.getCount()*(p.getDataCodewords()+u);this.totalCodewords=c}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(r){return this.ecBlocks[r.getValue()]}static getProvisionalVersionForDimension(r){if(r%4!==1)throw new K;try{return this.getVersionForNumber((r-17)/4)}catch{throw new K}}static getVersionForNumber(r){if(r<1||r>40)throw new b;return me.VERSIONS[r-1]}static decodeVersionInformation(r){let i=Number.MAX_SAFE_INTEGER,a=0;for(let c=0;c<me.VERSION_DECODE_INFO.length;c++){const u=me.VERSION_DECODE_INFO[c];if(u===r)return me.getVersionForNumber(c+7);const d=an.numBitsDiffering(r,u);d<i&&(a=c+7,i=d)}return i<=3?me.getVersionForNumber(a):null}buildFunctionPattern(){const r=this.getDimensionForVersion(),i=new ne(r);i.setRegion(0,0,9,9),i.setRegion(r-8,0,8,9),i.setRegion(0,r-8,9,8);const a=this.alignmentPatternCenters.length;for(let c=0;c<a;c++){const u=this.alignmentPatternCenters[c]-2;for(let d=0;d<a;d++)c===0&&(d===0||d===a-1)||c===a-1&&d===0||i.setRegion(this.alignmentPatternCenters[d]-2,u,5,5)}return i.setRegion(6,9,1,r-17),i.setRegion(9,6,r-17,1),this.versionNumber>6&&(i.setRegion(r-11,0,3,6),i.setRegion(0,r-11,6,3)),i}toString(){return""+this.versionNumber}}me.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),me.VERSIONS=[new me(1,new Int32Array(0),new P(7,new R(1,19)),new P(10,new R(1,16)),new P(13,new R(1,13)),new P(17,new R(1,9))),new me(2,Int32Array.from([6,18]),new P(10,new R(1,34)),new P(16,new R(1,28)),new P(22,new R(1,22)),new P(28,new R(1,16))),new me(3,Int32Array.from([6,22]),new P(15,new R(1,55)),new P(26,new R(1,44)),new P(18,new R(2,17)),new P(22,new R(2,13))),new me(4,Int32Array.from([6,26]),new P(20,new R(1,80)),new P(18,new R(2,32)),new P(26,new R(2,24)),new P(16,new R(4,9))),new me(5,Int32Array.from([6,30]),new P(26,new R(1,108)),new P(24,new R(2,43)),new P(18,new R(2,15),new R(2,16)),new P(22,new R(2,11),new R(2,12))),new me(6,Int32Array.from([6,34]),new P(18,new R(2,68)),new P(16,new R(4,27)),new P(24,new R(4,19)),new P(28,new R(4,15))),new me(7,Int32Array.from([6,22,38]),new P(20,new R(2,78)),new P(18,new R(4,31)),new P(18,new R(2,14),new R(4,15)),new P(26,new R(4,13),new R(1,14))),new me(8,Int32Array.from([6,24,42]),new P(24,new R(2,97)),new P(22,new R(2,38),new R(2,39)),new P(22,new R(4,18),new R(2,19)),new P(26,new R(4,14),new R(2,15))),new me(9,Int32Array.from([6,26,46]),new P(30,new R(2,116)),new P(22,new R(3,36),new R(2,37)),new P(20,new R(4,16),new R(4,17)),new P(24,new R(4,12),new R(4,13))),new me(10,Int32Array.from([6,28,50]),new P(18,new R(2,68),new R(2,69)),new P(26,new R(4,43),new R(1,44)),new P(24,new R(6,19),new R(2,20)),new P(28,new R(6,15),new R(2,16))),new me(11,Int32Array.from([6,30,54]),new P(20,new R(4,81)),new P(30,new R(1,50),new R(4,51)),new P(28,new R(4,22),new R(4,23)),new P(24,new R(3,12),new R(8,13))),new me(12,Int32Array.from([6,32,58]),new P(24,new R(2,92),new R(2,93)),new P(22,new R(6,36),new R(2,37)),new P(26,new R(4,20),new R(6,21)),new P(28,new R(7,14),new R(4,15))),new me(13,Int32Array.from([6,34,62]),new P(26,new R(4,107)),new P(22,new R(8,37),new R(1,38)),new P(24,new R(8,20),new R(4,21)),new P(22,new R(12,11),new R(4,12))),new me(14,Int32Array.from([6,26,46,66]),new P(30,new R(3,115),new R(1,116)),new P(24,new R(4,40),new R(5,41)),new P(20,new R(11,16),new R(5,17)),new P(24,new R(11,12),new R(5,13))),new me(15,Int32Array.from([6,26,48,70]),new P(22,new R(5,87),new R(1,88)),new P(24,new R(5,41),new R(5,42)),new P(30,new R(5,24),new R(7,25)),new P(24,new R(11,12),new R(7,13))),new me(16,Int32Array.from([6,26,50,74]),new P(24,new R(5,98),new R(1,99)),new P(28,new R(7,45),new R(3,46)),new P(24,new R(15,19),new R(2,20)),new P(30,new R(3,15),new R(13,16))),new me(17,Int32Array.from([6,30,54,78]),new P(28,new R(1,107),new R(5,108)),new P(28,new R(10,46),new R(1,47)),new P(28,new R(1,22),new R(15,23)),new P(28,new R(2,14),new R(17,15))),new me(18,Int32Array.from([6,30,56,82]),new P(30,new R(5,120),new R(1,121)),new P(26,new R(9,43),new R(4,44)),new P(28,new R(17,22),new R(1,23)),new P(28,new R(2,14),new R(19,15))),new me(19,Int32Array.from([6,30,58,86]),new P(28,new R(3,113),new R(4,114)),new P(26,new R(3,44),new R(11,45)),new P(26,new R(17,21),new R(4,22)),new P(26,new R(9,13),new R(16,14))),new me(20,Int32Array.from([6,34,62,90]),new P(28,new R(3,107),new R(5,108)),new P(26,new R(3,41),new R(13,42)),new P(30,new R(15,24),new R(5,25)),new P(28,new R(15,15),new R(10,16))),new me(21,Int32Array.from([6,28,50,72,94]),new P(28,new R(4,116),new R(4,117)),new P(26,new R(17,42)),new P(28,new R(17,22),new R(6,23)),new P(30,new R(19,16),new R(6,17))),new me(22,Int32Array.from([6,26,50,74,98]),new P(28,new R(2,111),new R(7,112)),new P(28,new R(17,46)),new P(30,new R(7,24),new R(16,25)),new P(24,new R(34,13))),new me(23,Int32Array.from([6,30,54,78,102]),new P(30,new R(4,121),new R(5,122)),new P(28,new R(4,47),new R(14,48)),new P(30,new R(11,24),new R(14,25)),new P(30,new R(16,15),new R(14,16))),new me(24,Int32Array.from([6,28,54,80,106]),new P(30,new R(6,117),new R(4,118)),new P(28,new R(6,45),new R(14,46)),new P(30,new R(11,24),new R(16,25)),new P(30,new R(30,16),new R(2,17))),new me(25,Int32Array.from([6,32,58,84,110]),new P(26,new R(8,106),new R(4,107)),new P(28,new R(8,47),new R(13,48)),new P(30,new R(7,24),new R(22,25)),new P(30,new R(22,15),new R(13,16))),new me(26,Int32Array.from([6,30,58,86,114]),new P(28,new R(10,114),new R(2,115)),new P(28,new R(19,46),new R(4,47)),new P(28,new R(28,22),new R(6,23)),new P(30,new R(33,16),new R(4,17))),new me(27,Int32Array.from([6,34,62,90,118]),new P(30,new R(8,122),new R(4,123)),new P(28,new R(22,45),new R(3,46)),new P(30,new R(8,23),new R(26,24)),new P(30,new R(12,15),new R(28,16))),new me(28,Int32Array.from([6,26,50,74,98,122]),new P(30,new R(3,117),new R(10,118)),new P(28,new R(3,45),new R(23,46)),new P(30,new R(4,24),new R(31,25)),new P(30,new R(11,15),new R(31,16))),new me(29,Int32Array.from([6,30,54,78,102,126]),new P(30,new R(7,116),new R(7,117)),new P(28,new R(21,45),new R(7,46)),new P(30,new R(1,23),new R(37,24)),new P(30,new R(19,15),new R(26,16))),new me(30,Int32Array.from([6,26,52,78,104,130]),new P(30,new R(5,115),new R(10,116)),new P(28,new R(19,47),new R(10,48)),new P(30,new R(15,24),new R(25,25)),new P(30,new R(23,15),new R(25,16))),new me(31,Int32Array.from([6,30,56,82,108,134]),new P(30,new R(13,115),new R(3,116)),new P(28,new R(2,46),new R(29,47)),new P(30,new R(42,24),new R(1,25)),new P(30,new R(23,15),new R(28,16))),new me(32,Int32Array.from([6,34,60,86,112,138]),new P(30,new R(17,115)),new P(28,new R(10,46),new R(23,47)),new P(30,new R(10,24),new R(35,25)),new P(30,new R(19,15),new R(35,16))),new me(33,Int32Array.from([6,30,58,86,114,142]),new P(30,new R(17,115),new R(1,116)),new P(28,new R(14,46),new R(21,47)),new P(30,new R(29,24),new R(19,25)),new P(30,new R(11,15),new R(46,16))),new me(34,Int32Array.from([6,34,62,90,118,146]),new P(30,new R(13,115),new R(6,116)),new P(28,new R(14,46),new R(23,47)),new P(30,new R(44,24),new R(7,25)),new P(30,new R(59,16),new R(1,17))),new me(35,Int32Array.from([6,30,54,78,102,126,150]),new P(30,new R(12,121),new R(7,122)),new P(28,new R(12,47),new R(26,48)),new P(30,new R(39,24),new R(14,25)),new P(30,new R(22,15),new R(41,16))),new me(36,Int32Array.from([6,24,50,76,102,128,154]),new P(30,new R(6,121),new R(14,122)),new P(28,new R(6,47),new R(34,48)),new P(30,new R(46,24),new R(10,25)),new P(30,new R(2,15),new R(64,16))),new me(37,Int32Array.from([6,28,54,80,106,132,158]),new P(30,new R(17,122),new R(4,123)),new P(28,new R(29,46),new R(14,47)),new P(30,new R(49,24),new R(10,25)),new P(30,new R(24,15),new R(46,16))),new me(38,Int32Array.from([6,32,58,84,110,136,162]),new P(30,new R(4,122),new R(18,123)),new P(28,new R(13,46),new R(32,47)),new P(30,new R(48,24),new R(14,25)),new P(30,new R(42,15),new R(32,16))),new me(39,Int32Array.from([6,26,54,82,110,138,166]),new P(30,new R(20,117),new R(4,118)),new P(28,new R(40,47),new R(7,48)),new P(30,new R(43,24),new R(22,25)),new P(30,new R(10,15),new R(67,16))),new me(40,Int32Array.from([6,30,58,86,114,142,170]),new P(30,new R(19,118),new R(6,119)),new P(28,new R(18,47),new R(31,48)),new P(30,new R(34,24),new R(34,25)),new P(30,new R(20,15),new R(61,16)))];var rt;(function(I){I[I.DATA_MASK_000=0]="DATA_MASK_000",I[I.DATA_MASK_001=1]="DATA_MASK_001",I[I.DATA_MASK_010=2]="DATA_MASK_010",I[I.DATA_MASK_011=3]="DATA_MASK_011",I[I.DATA_MASK_100=4]="DATA_MASK_100",I[I.DATA_MASK_101=5]="DATA_MASK_101",I[I.DATA_MASK_110=6]="DATA_MASK_110",I[I.DATA_MASK_111=7]="DATA_MASK_111"})(rt||(rt={}));class zt{constructor(r,i){this.value=r,this.isMasked=i}unmaskBitMatrix(r,i){for(let a=0;a<i;a++)for(let c=0;c<i;c++)this.isMasked(a,c)&&r.flip(c,a)}}zt.values=new Map([[rt.DATA_MASK_000,new zt(rt.DATA_MASK_000,(I,r)=>(I+r&1)===0)],[rt.DATA_MASK_001,new zt(rt.DATA_MASK_001,(I,r)=>(I&1)===0)],[rt.DATA_MASK_010,new zt(rt.DATA_MASK_010,(I,r)=>r%3===0)],[rt.DATA_MASK_011,new zt(rt.DATA_MASK_011,(I,r)=>(I+r)%3===0)],[rt.DATA_MASK_100,new zt(rt.DATA_MASK_100,(I,r)=>(Math.floor(I/2)+Math.floor(r/3)&1)===0)],[rt.DATA_MASK_101,new zt(rt.DATA_MASK_101,(I,r)=>I*r%6===0)],[rt.DATA_MASK_110,new zt(rt.DATA_MASK_110,(I,r)=>I*r%6<3)],[rt.DATA_MASK_111,new zt(rt.DATA_MASK_111,(I,r)=>(I+r+I*r%3&1)===0)]]);class wi{constructor(r){const i=r.getHeight();if(i<21||(i&3)!==1)throw new K;this.bitMatrix=r}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let r=0;for(let u=0;u<6;u++)r=this.copyBit(u,8,r);r=this.copyBit(7,8,r),r=this.copyBit(8,8,r),r=this.copyBit(8,7,r);for(let u=5;u>=0;u--)r=this.copyBit(8,u,r);const i=this.bitMatrix.getHeight();let a=0;const c=i-7;for(let u=i-1;u>=c;u--)a=this.copyBit(8,u,a);for(let u=i-8;u<i;u++)a=this.copyBit(u,8,a);if(this.parsedFormatInfo=an.decodeFormatInformation(r,a),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new K}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const r=this.bitMatrix.getHeight(),i=Math.floor((r-17)/4);if(i<=6)return me.getVersionForNumber(i);let a=0;const c=r-11;for(let d=5;d>=0;d--)for(let p=r-9;p>=c;p--)a=this.copyBit(p,d,a);let u=me.decodeVersionInformation(a);if(u!==null&&u.getDimensionForVersion()===r)return this.parsedVersion=u,u;a=0;for(let d=5;d>=0;d--)for(let p=r-9;p>=c;p--)a=this.copyBit(d,p,a);if(u=me.decodeVersionInformation(a),u!==null&&u.getDimensionForVersion()===r)return this.parsedVersion=u,u;throw new K}copyBit(r,i,a){return(this.isMirror?this.bitMatrix.get(i,r):this.bitMatrix.get(r,i))?a<<1|1:a<<1}readCodewords(){const r=this.readFormatInformation(),i=this.readVersion(),a=zt.values.get(r.getDataMask()),c=this.bitMatrix.getHeight();a.unmaskBitMatrix(this.bitMatrix,c);const u=i.buildFunctionPattern();let d=!0;const p=new Uint8Array(i.getTotalCodewords());let y=0,w=0,S=0;for(let N=c-1;N>0;N-=2){N===6&&N--;for(let k=0;k<c;k++){const j=d?c-1-k:k;for(let G=0;G<2;G++)u.get(N-G,j)||(S++,w<<=1,this.bitMatrix.get(N-G,j)&&(w|=1),S===8&&(p[y++]=w,S=0,w=0))}d=!d}if(y!==i.getTotalCodewords())throw new K;return p}remask(){if(this.parsedFormatInfo===null)return;const r=zt.values[this.parsedFormatInfo.getDataMask()],i=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,i)}setMirror(r){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=r}mirror(){const r=this.bitMatrix;for(let i=0,a=r.getWidth();i<a;i++)for(let c=i+1,u=r.getHeight();c<u;c++)r.get(i,c)!==r.get(c,i)&&(r.flip(c,i),r.flip(i,c))}}class ti{constructor(r,i){this.numDataCodewords=r,this.codewords=i}static getDataBlocks(r,i,a){if(r.length!==i.getTotalCodewords())throw new b;const c=i.getECBlocksForLevel(a);let u=0;const d=c.getECBlocks();for(const G of d)u+=G.getCount();const p=new Array(u);let y=0;for(const G of d)for(let X=0;X<G.getCount();X++){const ee=G.getDataCodewords(),ie=c.getECCodewordsPerBlock()+ee;p[y++]=new ti(ee,new Uint8Array(ie))}const w=p[0].codewords.length;let S=p.length-1;for(;S>=0&&p[S].codewords.length!==w;)S--;S++;const N=w-c.getECCodewordsPerBlock();let k=0;for(let G=0;G<N;G++)for(let X=0;X<y;X++)p[X].codewords[G]=r[k++];for(let G=S;G<y;G++)p[G].codewords[N]=r[k++];const j=p[0].codewords.length;for(let G=N;G<j;G++)for(let X=0;X<y;X++){const ee=X<S?G:G+1;p[X].codewords[ee]=r[k++]}return p}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var ln;(function(I){I[I.TERMINATOR=0]="TERMINATOR",I[I.NUMERIC=1]="NUMERIC",I[I.ALPHANUMERIC=2]="ALPHANUMERIC",I[I.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",I[I.BYTE=4]="BYTE",I[I.ECI=5]="ECI",I[I.KANJI=6]="KANJI",I[I.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",I[I.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",I[I.HANZI=9]="HANZI"})(ln||(ln={}));class Pe{constructor(r,i,a,c){this.value=r,this.stringValue=i,this.characterCountBitsForVersions=a,this.bits=c,Pe.FOR_BITS.set(c,this),Pe.FOR_VALUE.set(r,this)}static forBits(r){const i=Pe.FOR_BITS.get(r);if(i===void 0)throw new b;return i}getCharacterCountBits(r){const i=r.getVersionNumber();let a;return i<=9?a=0:i<=26?a=1:a=2,this.characterCountBitsForVersions[a]}getValue(){return this.value}getBits(){return this.bits}equals(r){if(!(r instanceof Pe))return!1;const i=r;return this.value===i.value}toString(){return this.stringValue}}Pe.FOR_BITS=new Map,Pe.FOR_VALUE=new Map,Pe.TERMINATOR=new Pe(ln.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Pe.NUMERIC=new Pe(ln.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Pe.ALPHANUMERIC=new Pe(ln.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Pe.STRUCTURED_APPEND=new Pe(ln.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Pe.BYTE=new Pe(ln.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Pe.ECI=new Pe(ln.ECI,"ECI",Int32Array.from([0,0,0]),7),Pe.KANJI=new Pe(ln.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Pe.FNC1_FIRST_POSITION=new Pe(ln.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Pe.FNC1_SECOND_POSITION=new Pe(ln.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Pe.HANZI=new Pe(ln.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class ht{static decode(r,i,a,c){const u=new vi(r);let d=new Q;const p=new Array;let y=-1,w=-1;try{let S=null,N=!1,k;do{if(u.available()<4)k=Pe.TERMINATOR;else{const j=u.readBits(4);k=Pe.forBits(j)}switch(k){case Pe.TERMINATOR:break;case Pe.FNC1_FIRST_POSITION:case Pe.FNC1_SECOND_POSITION:N=!0;break;case Pe.STRUCTURED_APPEND:if(u.available()<16)throw new K;y=u.readBits(8),w=u.readBits(8);break;case Pe.ECI:const j=ht.parseECIValue(u);if(S=V.getCharacterSetECIByValue(j),S===null)throw new K;break;case Pe.HANZI:const G=u.readBits(4),X=u.readBits(k.getCharacterCountBits(i));G===ht.GB2312_SUBSET&&ht.decodeHanziSegment(u,d,X);break;default:const ee=u.readBits(k.getCharacterCountBits(i));switch(k){case Pe.NUMERIC:ht.decodeNumericSegment(u,d,ee);break;case Pe.ALPHANUMERIC:ht.decodeAlphanumericSegment(u,d,ee,N);break;case Pe.BYTE:ht.decodeByteSegment(u,d,ee,S,p,c);break;case Pe.KANJI:ht.decodeKanjiSegment(u,d,ee);break;default:throw new K}break}}while(k!==Pe.TERMINATOR)}catch{throw new K}return new Bn(r,d.toString(),p.length===0?null:p,a===null?null:a.toString(),y,w)}static decodeHanziSegment(r,i,a){if(a*13>r.available())throw new K;const c=new Uint8Array(2*a);let u=0;for(;a>0;){const d=r.readBits(13);let p=d/96<<8&4294967295|d%96;p<959?p+=41377:p+=42657,c[u]=p>>8&255,c[u+1]=p&255,u+=2,a--}try{i.append(ce.decode(c,ue.GB2312))}catch(d){throw new K(d)}}static decodeKanjiSegment(r,i,a){if(a*13>r.available())throw new K;const c=new Uint8Array(2*a);let u=0;for(;a>0;){const d=r.readBits(13);let p=d/192<<8&4294967295|d%192;p<7936?p+=33088:p+=49472,c[u]=p>>8,c[u+1]=p,u+=2,a--}try{i.append(ce.decode(c,ue.SHIFT_JIS))}catch(d){throw new K(d)}}static decodeByteSegment(r,i,a,c,u,d){if(8*a>r.available())throw new K;const p=new Uint8Array(a);for(let w=0;w<a;w++)p[w]=r.readBits(8);let y;c===null?y=ue.guessEncoding(p,d):y=c.getName();try{i.append(ce.decode(p,y))}catch(w){throw new K(w)}u.push(p)}static toAlphaNumericChar(r){if(r>=ht.ALPHANUMERIC_CHARS.length)throw new K;return ht.ALPHANUMERIC_CHARS[r]}static decodeAlphanumericSegment(r,i,a,c){const u=i.length();for(;a>1;){if(r.available()<11)throw new K;const d=r.readBits(11);i.append(ht.toAlphaNumericChar(Math.floor(d/45))),i.append(ht.toAlphaNumericChar(d%45)),a-=2}if(a===1){if(r.available()<6)throw new K;i.append(ht.toAlphaNumericChar(r.readBits(6)))}if(c)for(let d=u;d<i.length();d++)i.charAt(d)==="%"&&(d<i.length()-1&&i.charAt(d+1)==="%"?i.deleteCharAt(d+1):i.setCharAt(d,""))}static decodeNumericSegment(r,i,a){for(;a>=3;){if(r.available()<10)throw new K;const c=r.readBits(10);if(c>=1e3)throw new K;i.append(ht.toAlphaNumericChar(Math.floor(c/100))),i.append(ht.toAlphaNumericChar(Math.floor(c/10)%10)),i.append(ht.toAlphaNumericChar(c%10)),a-=3}if(a===2){if(r.available()<7)throw new K;const c=r.readBits(7);if(c>=100)throw new K;i.append(ht.toAlphaNumericChar(Math.floor(c/10))),i.append(ht.toAlphaNumericChar(c%10))}else if(a===1){if(r.available()<4)throw new K;const c=r.readBits(4);if(c>=10)throw new K;i.append(ht.toAlphaNumericChar(c))}}static parseECIValue(r){const i=r.readBits(8);if(!(i&128))return i&127;if((i&192)===128){const a=r.readBits(8);return(i&63)<<8&4294967295|a}if((i&224)===192){const a=r.readBits(16);return(i&31)<<16&4294967295|a}throw new K}}ht.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",ht.GB2312_SUBSET=1;class Tn{constructor(r){this.mirrored=r}isMirrored(){return this.mirrored}applyMirroredCorrection(r){if(!this.mirrored||r===null||r.length<3)return;const i=r[0];r[0]=r[2],r[2]=i}}class wr{constructor(){this.rsDecoder=new Rn($e.QR_CODE_FIELD_256)}decodeBooleanArray(r,i){return this.decodeBitMatrix(ne.parseFromBooleanArray(r),i)}decodeBitMatrix(r,i){const a=new wi(r);let c=null;try{return this.decodeBitMatrixParser(a,i)}catch(u){c=u}try{a.remask(),a.setMirror(!0),a.readVersion(),a.readFormatInformation(),a.mirror();const u=this.decodeBitMatrixParser(a,i);return u.setOther(new Tn(!0)),u}catch(u){throw c!==null?c:u}}decodeBitMatrixParser(r,i){const a=r.readVersion(),c=r.readFormatInformation().getErrorCorrectionLevel(),u=r.readCodewords(),d=ti.getDataBlocks(u,a,c);let p=0;for(const S of d)p+=S.getNumDataCodewords();const y=new Uint8Array(p);let w=0;for(const S of d){const N=S.getCodewords(),k=S.getNumDataCodewords();this.correctErrors(N,k);for(let j=0;j<k;j++)y[w++]=N[j]}return ht.decode(y,a,c,i)}correctErrors(r,i){const a=new Int32Array(r);try{this.rsDecoder.decode(a,r.length-i)}catch{throw new F}for(let c=0;c<i;c++)r[c]=a[c]}}class Cr extends Te{constructor(r,i,a){super(r,i),this.estimatedModuleSize=a}aboutEquals(r,i,a){if(Math.abs(i-this.getY())<=r&&Math.abs(a-this.getX())<=r){const c=Math.abs(r-this.estimatedModuleSize);return c<=1||c<=this.estimatedModuleSize}return!1}combineEstimate(r,i,a){const c=(this.getX()+i)/2,u=(this.getY()+r)/2,d=(this.estimatedModuleSize+a)/2;return new Cr(c,u,d)}}class Er{constructor(r,i,a,c,u,d,p){this.image=r,this.startX=i,this.startY=a,this.width=c,this.height=u,this.moduleSize=d,this.resultPointCallback=p,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const r=this.startX,i=this.height,a=this.width,c=r+a,u=this.startY+i/2,d=new Int32Array(3),p=this.image;for(let y=0;y<i;y++){const w=u+(y&1?-Math.floor((y+1)/2):Math.floor((y+1)/2));d[0]=0,d[1]=0,d[2]=0;let S=r;for(;S<c&&!p.get(S,w);)S++;let N=0;for(;S<c;){if(p.get(S,w))if(N===1)d[1]++;else if(N===2){if(this.foundPatternCross(d)){const k=this.handlePossibleCenter(d,w,S);if(k!==null)return k}d[0]=d[2],d[1]=1,d[2]=0,N=1}else d[++N]++;else N===1&&N++,d[N]++;S++}if(this.foundPatternCross(d)){const k=this.handlePossibleCenter(d,w,c);if(k!==null)return k}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new Z}static centerFromEnd(r,i){return i-r[2]-r[1]/2}foundPatternCross(r){const i=this.moduleSize,a=i/2;for(let c=0;c<3;c++)if(Math.abs(i-r[c])>=a)return!1;return!0}crossCheckVertical(r,i,a,c){const u=this.image,d=u.getHeight(),p=this.crossCheckStateCount;p[0]=0,p[1]=0,p[2]=0;let y=r;for(;y>=0&&u.get(i,y)&&p[1]<=a;)p[1]++,y--;if(y<0||p[1]>a)return NaN;for(;y>=0&&!u.get(i,y)&&p[0]<=a;)p[0]++,y--;if(p[0]>a)return NaN;for(y=r+1;y<d&&u.get(i,y)&&p[1]<=a;)p[1]++,y++;if(y===d||p[1]>a)return NaN;for(;y<d&&!u.get(i,y)&&p[2]<=a;)p[2]++,y++;if(p[2]>a)return NaN;const w=p[0]+p[1]+p[2];return 5*Math.abs(w-c)>=2*c?NaN:this.foundPatternCross(p)?Er.centerFromEnd(p,y):NaN}handlePossibleCenter(r,i,a){const c=r[0]+r[1]+r[2],u=Er.centerFromEnd(r,a),d=this.crossCheckVertical(i,u,2*r[1],c);if(!isNaN(d)){const p=(r[0]+r[1]+r[2])/3;for(const w of this.possibleCenters)if(w.aboutEquals(p,d,u))return w.combineEstimate(d,u,p);const y=new Cr(u,d,p);this.possibleCenters.push(y),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(y)}return null}}class fr extends Te{constructor(r,i,a,c){super(r,i),this.estimatedModuleSize=a,this.count=c,c===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(r,i,a){if(Math.abs(i-this.getY())<=r&&Math.abs(a-this.getX())<=r){const c=Math.abs(r-this.estimatedModuleSize);return c<=1||c<=this.estimatedModuleSize}return!1}combineEstimate(r,i,a){const c=this.count+1,u=(this.count*this.getX()+i)/c,d=(this.count*this.getY()+r)/c,p=(this.count*this.estimatedModuleSize+a)/c;return new fr(u,d,p,c)}}class ni{constructor(r){this.bottomLeft=r[0],this.topLeft=r[1],this.topRight=r[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class dt{constructor(r,i){this.image=r,this.resultPointCallback=i,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=i}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(r){const i=r!=null&&r.get(pe.TRY_HARDER)!==void 0,a=r!=null&&r.get(pe.PURE_BARCODE)!==void 0,c=this.image,u=c.getHeight(),d=c.getWidth();let p=Math.floor(3*u/(4*dt.MAX_MODULES));(p<dt.MIN_SKIP||i)&&(p=dt.MIN_SKIP);let y=!1;const w=new Int32Array(5);for(let N=p-1;N<u&&!y;N+=p){w[0]=0,w[1]=0,w[2]=0,w[3]=0,w[4]=0;let k=0;for(let j=0;j<d;j++)if(c.get(j,N))(k&1)===1&&k++,w[k]++;else if(k&1)w[k]++;else if(k===4)if(dt.foundPatternCross(w)){if(this.handlePossibleCenter(w,N,j,a)===!0)if(p=2,this.hasSkipped===!0)y=this.haveMultiplyConfirmedCenters();else{const X=this.findRowSkip();X>w[2]&&(N+=X-w[2]-p,j=d-1)}else{w[0]=w[2],w[1]=w[3],w[2]=w[4],w[3]=1,w[4]=0,k=3;continue}k=0,w[0]=0,w[1]=0,w[2]=0,w[3]=0,w[4]=0}else w[0]=w[2],w[1]=w[3],w[2]=w[4],w[3]=1,w[4]=0,k=3;else w[++k]++;dt.foundPatternCross(w)&&this.handlePossibleCenter(w,N,d,a)===!0&&(p=w[0],this.hasSkipped&&(y=this.haveMultiplyConfirmedCenters()))}const S=this.selectBestPatterns();return Te.orderBestPatterns(S),new ni(S)}static centerFromEnd(r,i){return i-r[4]-r[3]-r[2]/2}static foundPatternCross(r){let i=0;for(let u=0;u<5;u++){const d=r[u];if(d===0)return!1;i+=d}if(i<7)return!1;const a=i/7,c=a/2;return Math.abs(a-r[0])<c&&Math.abs(a-r[1])<c&&Math.abs(3*a-r[2])<3*c&&Math.abs(a-r[3])<c&&Math.abs(a-r[4])<c}getCrossCheckStateCount(){const r=this.crossCheckStateCount;return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r}crossCheckDiagonal(r,i,a,c){const u=this.getCrossCheckStateCount();let d=0;const p=this.image;for(;r>=d&&i>=d&&p.get(i-d,r-d);)u[2]++,d++;if(r<d||i<d)return!1;for(;r>=d&&i>=d&&!p.get(i-d,r-d)&&u[1]<=a;)u[1]++,d++;if(r<d||i<d||u[1]>a)return!1;for(;r>=d&&i>=d&&p.get(i-d,r-d)&&u[0]<=a;)u[0]++,d++;if(u[0]>a)return!1;const y=p.getHeight(),w=p.getWidth();for(d=1;r+d<y&&i+d<w&&p.get(i+d,r+d);)u[2]++,d++;if(r+d>=y||i+d>=w)return!1;for(;r+d<y&&i+d<w&&!p.get(i+d,r+d)&&u[3]<a;)u[3]++,d++;if(r+d>=y||i+d>=w||u[3]>=a)return!1;for(;r+d<y&&i+d<w&&p.get(i+d,r+d)&&u[4]<a;)u[4]++,d++;if(u[4]>=a)return!1;const S=u[0]+u[1]+u[2]+u[3]+u[4];return Math.abs(S-c)<2*c&&dt.foundPatternCross(u)}crossCheckVertical(r,i,a,c){const u=this.image,d=u.getHeight(),p=this.getCrossCheckStateCount();let y=r;for(;y>=0&&u.get(i,y);)p[2]++,y--;if(y<0)return NaN;for(;y>=0&&!u.get(i,y)&&p[1]<=a;)p[1]++,y--;if(y<0||p[1]>a)return NaN;for(;y>=0&&u.get(i,y)&&p[0]<=a;)p[0]++,y--;if(p[0]>a)return NaN;for(y=r+1;y<d&&u.get(i,y);)p[2]++,y++;if(y===d)return NaN;for(;y<d&&!u.get(i,y)&&p[3]<a;)p[3]++,y++;if(y===d||p[3]>=a)return NaN;for(;y<d&&u.get(i,y)&&p[4]<a;)p[4]++,y++;if(p[4]>=a)return NaN;const w=p[0]+p[1]+p[2]+p[3]+p[4];return 5*Math.abs(w-c)>=2*c?NaN:dt.foundPatternCross(p)?dt.centerFromEnd(p,y):NaN}crossCheckHorizontal(r,i,a,c){const u=this.image,d=u.getWidth(),p=this.getCrossCheckStateCount();let y=r;for(;y>=0&&u.get(y,i);)p[2]++,y--;if(y<0)return NaN;for(;y>=0&&!u.get(y,i)&&p[1]<=a;)p[1]++,y--;if(y<0||p[1]>a)return NaN;for(;y>=0&&u.get(y,i)&&p[0]<=a;)p[0]++,y--;if(p[0]>a)return NaN;for(y=r+1;y<d&&u.get(y,i);)p[2]++,y++;if(y===d)return NaN;for(;y<d&&!u.get(y,i)&&p[3]<a;)p[3]++,y++;if(y===d||p[3]>=a)return NaN;for(;y<d&&u.get(y,i)&&p[4]<a;)p[4]++,y++;if(p[4]>=a)return NaN;const w=p[0]+p[1]+p[2]+p[3]+p[4];return 5*Math.abs(w-c)>=c?NaN:dt.foundPatternCross(p)?dt.centerFromEnd(p,y):NaN}handlePossibleCenter(r,i,a,c){const u=r[0]+r[1]+r[2]+r[3]+r[4];let d=dt.centerFromEnd(r,a),p=this.crossCheckVertical(i,Math.floor(d),r[2],u);if(!isNaN(p)&&(d=this.crossCheckHorizontal(Math.floor(d),Math.floor(p),r[2],u),!isNaN(d)&&(!c||this.crossCheckDiagonal(Math.floor(p),Math.floor(d),r[2],u)))){const y=u/7;let w=!1;const S=this.possibleCenters;for(let N=0,k=S.length;N<k;N++){const j=S[N];if(j.aboutEquals(y,p,d)){S[N]=j.combineEstimate(p,d,y),w=!0;break}}if(!w){const N=new fr(d,p,y);S.push(N),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(N)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let i=null;for(const a of this.possibleCenters)if(a.getCount()>=dt.CENTER_QUORUM)if(i==null)i=a;else return this.hasSkipped=!0,Math.floor((Math.abs(i.getX()-a.getX())-Math.abs(i.getY()-a.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let r=0,i=0;const a=this.possibleCenters.length;for(const d of this.possibleCenters)d.getCount()>=dt.CENTER_QUORUM&&(r++,i+=d.getEstimatedModuleSize());if(r<3)return!1;const c=i/a;let u=0;for(const d of this.possibleCenters)u+=Math.abs(d.getEstimatedModuleSize()-c);return u<=.05*i}selectBestPatterns(){const r=this.possibleCenters.length;if(r<3)throw new Z;const i=this.possibleCenters;let a;if(r>3){let c=0,u=0;for(const y of this.possibleCenters){const w=y.getEstimatedModuleSize();c+=w,u+=w*w}a=c/r;let d=Math.sqrt(u/r-a*a);i.sort((y,w)=>{const S=Math.abs(w.getEstimatedModuleSize()-a),N=Math.abs(y.getEstimatedModuleSize()-a);return S<N?-1:S>N?1:0});const p=Math.max(.2*a,d);for(let y=0;y<i.length&&i.length>3;y++){const w=i[y];Math.abs(w.getEstimatedModuleSize()-a)>p&&(i.splice(y,1),y--)}}if(i.length>3){let c=0;for(const u of i)c+=u.getEstimatedModuleSize();a=c/i.length,i.sort((u,d)=>{if(d.getCount()===u.getCount()){const p=Math.abs(d.getEstimatedModuleSize()-a),y=Math.abs(u.getEstimatedModuleSize()-a);return p<y?1:p>y?-1:0}else return d.getCount()-u.getCount()}),i.splice(3)}return[i[0],i[1],i[2]]}}dt.CENTER_QUORUM=2,dt.MIN_SKIP=3,dt.MAX_MODULES=57;class Ye{constructor(r){this.image=r}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(r){this.resultPointCallback=r==null?null:r.get(pe.NEED_RESULT_POINT_CALLBACK);const a=new dt(this.image,this.resultPointCallback).find(r);return this.processFinderPatternInfo(a)}processFinderPatternInfo(r){const i=r.getTopLeft(),a=r.getTopRight(),c=r.getBottomLeft(),u=this.calculateModuleSize(i,a,c);if(u<1)throw new Z("No pattern found in proccess finder.");const d=Ye.computeDimension(i,a,c,u),p=me.getProvisionalVersionForDimension(d),y=p.getDimensionForVersion()-7;let w=null;if(p.getAlignmentPatternCenters().length>0){const j=a.getX()-i.getX()+c.getX(),G=a.getY()-i.getY()+c.getY(),X=1-3/y,ee=Math.floor(i.getX()+X*(j-i.getX())),ie=Math.floor(i.getY()+X*(G-i.getY()));for(let Ee=4;Ee<=16;Ee<<=1)try{w=this.findAlignmentInRegion(u,ee,ie,Ee);break}catch(be){if(!(be instanceof Z))throw be}}const S=Ye.createTransform(i,a,c,w,d),N=Ye.sampleGrid(this.image,S,d);let k;return w===null?k=[c,i,a]:k=[c,i,a,w],new Lt(N,k)}static createTransform(r,i,a,c,u){const d=u-3.5;let p,y,w,S;return c!==null?(p=c.getX(),y=c.getY(),w=d-3,S=w):(p=i.getX()-r.getX()+a.getX(),y=i.getY()-r.getY()+a.getY(),w=d,S=d),Ct.quadrilateralToQuadrilateral(3.5,3.5,d,3.5,w,S,3.5,d,r.getX(),r.getY(),i.getX(),i.getY(),p,y,a.getX(),a.getY())}static sampleGrid(r,i,a){return Qn.getInstance().sampleGridWithTransform(r,a,a,i)}static computeDimension(r,i,a,c){const u=Xe.round(Te.distance(r,i)/c),d=Xe.round(Te.distance(r,a)/c);let p=Math.floor((u+d)/2)+7;switch(p&3){case 0:p++;break;case 2:p--;break;case 3:throw new Z("Dimensions could be not found.")}return p}calculateModuleSize(r,i,a){return(this.calculateModuleSizeOneWay(r,i)+this.calculateModuleSizeOneWay(r,a))/2}calculateModuleSizeOneWay(r,i){const a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(i.getX()),Math.floor(i.getY())),c=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(i.getX()),Math.floor(i.getY()),Math.floor(r.getX()),Math.floor(r.getY()));return isNaN(a)?c/7:isNaN(c)?a/7:(a+c)/14}sizeOfBlackWhiteBlackRunBothWays(r,i,a,c){let u=this.sizeOfBlackWhiteBlackRun(r,i,a,c),d=1,p=r-(a-r);p<0?(d=r/(r-p),p=0):p>=this.image.getWidth()&&(d=(this.image.getWidth()-1-r)/(p-r),p=this.image.getWidth()-1);let y=Math.floor(i-(c-i)*d);return d=1,y<0?(d=i/(i-y),y=0):y>=this.image.getHeight()&&(d=(this.image.getHeight()-1-i)/(y-i),y=this.image.getHeight()-1),p=Math.floor(r+(p-r)*d),u+=this.sizeOfBlackWhiteBlackRun(r,i,p,y),u-1}sizeOfBlackWhiteBlackRun(r,i,a,c){const u=Math.abs(c-i)>Math.abs(a-r);if(u){let j=r;r=i,i=j,j=a,a=c,c=j}const d=Math.abs(a-r),p=Math.abs(c-i);let y=-d/2;const w=r<a?1:-1,S=i<c?1:-1;let N=0;const k=a+w;for(let j=r,G=i;j!==k;j+=w){const X=u?G:j,ee=u?j:G;if(N===1===this.image.get(X,ee)){if(N===2)return Xe.distance(j,G,r,i);N++}if(y+=p,y>0){if(G===c)break;G+=S,y-=d}}return N===2?Xe.distance(a+w,c,r,i):NaN}findAlignmentInRegion(r,i,a,c){const u=Math.floor(c*r),d=Math.max(0,i-u),p=Math.min(this.image.getWidth()-1,i+u);if(p-d<r*3)throw new Z("Alignment top exceeds estimated module size.");const y=Math.max(0,a-u),w=Math.min(this.image.getHeight()-1,a+u);if(w-y<r*3)throw new Z("Alignment bottom exceeds estimated module size.");return new Er(this.image,d,y,p-d,w-y,r,this.resultPointCallback).find()}}class cn{constructor(){this.decoder=new wr}getDecoder(){return this.decoder}decode(r,i){let a,c;if(i!=null&&i.get(pe.PURE_BARCODE)!==void 0){const y=cn.extractPureBits(r.getBlackMatrix());a=this.decoder.decodeBitMatrix(y,i),c=cn.NO_POINTS}else{const y=new Ye(r.getBlackMatrix()).detect(i);a=this.decoder.decodeBitMatrix(y.getBits(),i),c=y.getPoints()}a.getOther()instanceof Tn&&a.getOther().applyMirroredCorrection(c);const u=new we(a.getText(),a.getRawBytes(),void 0,c,ge.QR_CODE,void 0),d=a.getByteSegments();d!==null&&u.putMetadata(He.BYTE_SEGMENTS,d);const p=a.getECLevel();return p!==null&&u.putMetadata(He.ERROR_CORRECTION_LEVEL,p),a.hasStructuredAppend()&&(u.putMetadata(He.STRUCTURED_APPEND_SEQUENCE,a.getStructuredAppendSequenceNumber()),u.putMetadata(He.STRUCTURED_APPEND_PARITY,a.getStructuredAppendParity())),u}reset(){}static extractPureBits(r){const i=r.getTopLeftOnBit(),a=r.getBottomRightOnBit();if(i===null||a===null)throw new Z;const c=this.moduleSize(i,r);let u=i[1],d=a[1],p=i[0],y=a[0];if(p>=y||u>=d)throw new Z;if(d-u!==y-p&&(y=p+(d-u),y>=r.getWidth()))throw new Z;const w=Math.round((y-p+1)/c),S=Math.round((d-u+1)/c);if(w<=0||S<=0)throw new Z;if(S!==w)throw new Z;const N=Math.floor(c/2);u+=N,p+=N;const k=p+Math.floor((w-1)*c)-y;if(k>0){if(k>N)throw new Z;p-=k}const j=u+Math.floor((S-1)*c)-d;if(j>0){if(j>N)throw new Z;u-=j}const G=new ne(w,S);for(let X=0;X<S;X++){const ee=u+Math.floor(X*c);for(let ie=0;ie<w;ie++)r.get(p+Math.floor(ie*c),ee)&&G.set(ie,X)}return G}static moduleSize(r,i){const a=i.getHeight(),c=i.getWidth();let u=r[0],d=r[1],p=!0,y=0;for(;u<c&&d<a;){if(p!==i.get(u,d)){if(++y===5)break;p=!p}u++,d++}if(u===c||d===a)throw new Z;return(u-r[0])/7}}cn.NO_POINTS=new Array;class Re{PDF417Common(){}static getBitCountSum(r){return Xe.sum(r)}static toIntArray(r){if(r==null||!r.length)return Re.EMPTY_INT_ARRAY;const i=new Int32Array(r.length);let a=0;for(const c of r)i[a++]=c;return i}static getCodeword(r){const i=D.binarySearch(Re.SYMBOL_TABLE,r&262143);return i<0?-1:(Re.CODEWORD_TABLE[i]-1)%Re.NUMBER_OF_CODEWORDS}}Re.NUMBER_OF_CODEWORDS=929,Re.MAX_CODEWORDS_IN_BARCODE=Re.NUMBER_OF_CODEWORDS-1,Re.MIN_ROWS_IN_BARCODE=3,Re.MAX_ROWS_IN_BARCODE=90,Re.MODULES_IN_CODEWORD=17,Re.MODULES_IN_STOP_PATTERN=18,Re.BARS_IN_MODULE=8,Re.EMPTY_INT_ARRAY=new Int32Array([]),Re.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Re.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class hl{constructor(r,i){this.bits=r,this.points=i}getBits(){return this.bits}getPoints(){return this.points}}class Je{static detectMultiple(r,i,a){let c=r.getBlackMatrix(),u=Je.detect(a,c);return u.length||(c=c.clone(),c.rotate180(),u=Je.detect(a,c)),new hl(c,u)}static detect(r,i){const a=new Array;let c=0,u=0,d=!1;for(;c<i.getHeight();){const p=Je.findVertices(i,c,u);if(p[0]==null&&p[3]==null){if(!d)break;d=!1,u=0;for(const y of a)y[1]!=null&&(c=Math.trunc(Math.max(c,y[1].getY()))),y[3]!=null&&(c=Math.max(c,Math.trunc(y[3].getY())));c+=Je.ROW_STEP;continue}if(d=!0,a.push(p),!r)break;p[2]!=null?(u=Math.trunc(p[2].getX()),c=Math.trunc(p[2].getY())):(u=Math.trunc(p[4].getX()),c=Math.trunc(p[4].getY()))}return a}static findVertices(r,i,a){const c=r.getHeight(),u=r.getWidth(),d=new Array(8);return Je.copyToResult(d,Je.findRowsWithPattern(r,c,u,i,a,Je.START_PATTERN),Je.INDEXES_START_PATTERN),d[4]!=null&&(a=Math.trunc(d[4].getX()),i=Math.trunc(d[4].getY())),Je.copyToResult(d,Je.findRowsWithPattern(r,c,u,i,a,Je.STOP_PATTERN),Je.INDEXES_STOP_PATTERN),d}static copyToResult(r,i,a){for(let c=0;c<a.length;c++)r[a[c]]=i[c]}static findRowsWithPattern(r,i,a,c,u,d){const p=new Array(4);let y=!1;const w=new Int32Array(d.length);for(;c<i;c+=Je.ROW_STEP){let N=Je.findGuardPattern(r,u,c,a,!1,d,w);if(N!=null){for(;c>0;){const k=Je.findGuardPattern(r,u,--c,a,!1,d,w);if(k!=null)N=k;else{c++;break}}p[0]=new Te(N[0],c),p[1]=new Te(N[1],c),y=!0;break}}let S=c+1;if(y){let N=0,k=Int32Array.from([Math.trunc(p[0].getX()),Math.trunc(p[1].getX())]);for(;S<i;S++){const j=Je.findGuardPattern(r,k[0],S,a,!1,d,w);if(j!=null&&Math.abs(k[0]-j[0])<Je.MAX_PATTERN_DRIFT&&Math.abs(k[1]-j[1])<Je.MAX_PATTERN_DRIFT)k=j,N=0;else{if(N>Je.SKIPPED_ROW_COUNT_MAX)break;N++}}S-=N+1,p[2]=new Te(k[0],S),p[3]=new Te(k[1],S)}return S-c<Je.BARCODE_MIN_HEIGHT&&D.fill(p,null),p}static findGuardPattern(r,i,a,c,u,d,p){D.fillWithin(p,0,p.length,0);let y=i,w=0;for(;r.get(y,a)&&y>0&&w++<Je.MAX_PIXEL_DRIFT;)y--;let S=y,N=0,k=d.length;for(let j=u;S<c;S++)if(r.get(S,a)!==j)p[N]++;else{if(N===k-1){if(Je.patternMatchVariance(p,d,Je.MAX_INDIVIDUAL_VARIANCE)<Je.MAX_AVG_VARIANCE)return new Int32Array([y,S]);y+=p[0]+p[1],U.arraycopy(p,2,p,0,N-1),p[N-1]=0,p[N]=0,N--}else N++;p[N]=1,j=!j}return N===k-1&&Je.patternMatchVariance(p,d,Je.MAX_INDIVIDUAL_VARIANCE)<Je.MAX_AVG_VARIANCE?new Int32Array([y,S-1]):null}static patternMatchVariance(r,i,a){let c=r.length,u=0,d=0;for(let w=0;w<c;w++)u+=r[w],d+=i[w];if(u<d)return 1/0;let p=u/d;a*=p;let y=0;for(let w=0;w<c;w++){let S=r[w],N=i[w]*p,k=S>N?S-N:N-S;if(k>a)return 1/0;y+=k}return y/u}}Je.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Je.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Je.MAX_AVG_VARIANCE=.42,Je.MAX_INDIVIDUAL_VARIANCE=.8,Je.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Je.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Je.MAX_PIXEL_DRIFT=3,Je.MAX_PATTERN_DRIFT=5,Je.SKIPPED_ROW_COUNT_MAX=25,Je.ROW_STEP=5,Je.BARCODE_MIN_HEIGHT=10;class un{constructor(r,i){if(i.length===0)throw new b;this.field=r;let a=i.length;if(a>1&&i[0]===0){let c=1;for(;c<a&&i[c]===0;)c++;c===a?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(a-c),U.arraycopy(i,c,this.coefficients,0,this.coefficients.length))}else this.coefficients=i}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);if(r===1){let c=0;for(let u of this.coefficients)c=this.field.add(c,u);return c}let i=this.coefficients[0],a=this.coefficients.length;for(let c=1;c<a;c++)i=this.field.add(this.field.multiply(r,i),this.coefficients[c]);return i}add(r){if(!this.field.equals(r.field))throw new b("ModulusPolys do not have same ModulusGF field");if(this.isZero())return r;if(r.isZero())return this;let i=this.coefficients,a=r.coefficients;if(i.length>a.length){let d=i;i=a,a=d}let c=new Int32Array(a.length),u=a.length-i.length;U.arraycopy(a,0,c,0,u);for(let d=u;d<a.length;d++)c[d]=this.field.add(i[d-u],a[d]);return new un(this.field,c)}subtract(r){if(!this.field.equals(r.field))throw new b("ModulusPolys do not have same ModulusGF field");return r.isZero()?this:this.add(r.negative())}multiply(r){return r instanceof un?this.multiplyOther(r):this.multiplyScalar(r)}multiplyOther(r){if(!this.field.equals(r.field))throw new b("ModulusPolys do not have same ModulusGF field");if(this.isZero()||r.isZero())return new un(this.field,new Int32Array([0]));let i=this.coefficients,a=i.length,c=r.coefficients,u=c.length,d=new Int32Array(a+u-1);for(let p=0;p<a;p++){let y=i[p];for(let w=0;w<u;w++)d[p+w]=this.field.add(d[p+w],this.field.multiply(y,c[w]))}return new un(this.field,d)}negative(){let r=this.coefficients.length,i=new Int32Array(r);for(let a=0;a<r;a++)i[a]=this.field.subtract(0,this.coefficients[a]);return new un(this.field,i)}multiplyScalar(r){if(r===0)return new un(this.field,new Int32Array([0]));if(r===1)return this;let i=this.coefficients.length,a=new Int32Array(i);for(let c=0;c<i;c++)a[c]=this.field.multiply(this.coefficients[c],r);return new un(this.field,a)}multiplyByMonomial(r,i){if(r<0)throw new b;if(i===0)return new un(this.field,new Int32Array([0]));let a=this.coefficients.length,c=new Int32Array(a+r);for(let u=0;u<a;u++)c[u]=this.field.multiply(this.coefficients[u],i);return new un(this.field,c)}toString(){let r=new Q;for(let i=this.getDegree();i>=0;i--){let a=this.getCoefficient(i);a!==0&&(a<0?(r.append(" - "),a=-a):r.length()>0&&r.append(" + "),(i===0||a!==1)&&r.append(a),i!==0&&(i===1?r.append("x"):(r.append("x^"),r.append(i))))}return r.toString()}}class qo{add(r,i){return(r+i)%this.modulus}subtract(r,i){return(this.modulus+r-i)%this.modulus}exp(r){return this.expTable[r]}log(r){if(r===0)throw new b;return this.logTable[r]}inverse(r){if(r===0)throw new yt;return this.expTable[this.modulus-this.logTable[r]-1]}multiply(r,i){return r===0||i===0?0:this.expTable[(this.logTable[r]+this.logTable[i])%(this.modulus-1)]}getSize(){return this.modulus}equals(r){return r===this}}class ri extends qo{constructor(r,i){super(),this.modulus=r,this.expTable=new Int32Array(r),this.logTable=new Int32Array(r);let a=1;for(let c=0;c<r;c++)this.expTable[c]=a,a=a*i%r;for(let c=0;c<r-1;c++)this.logTable[this.expTable[c]]=c;this.zero=new un(this,new Int32Array([0])),this.one=new un(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,i){if(r<0)throw new b;if(i===0)return this.zero;let a=new Int32Array(r+1);return a[0]=i,new un(this,a)}}ri.PDF417_GF=new ri(Re.NUMBER_OF_CODEWORDS,3);class so{constructor(){this.field=ri.PDF417_GF}decode(r,i,a){let c=new un(this.field,r),u=new Int32Array(i),d=!1;for(let G=i;G>0;G--){let X=c.evaluateAt(this.field.exp(G));u[i-G]=X,X!==0&&(d=!0)}if(!d)return 0;let p=this.field.getOne();if(a!=null)for(const G of a){let X=this.field.exp(r.length-1-G),ee=new un(this.field,new Int32Array([this.field.subtract(0,X),1]));p=p.multiply(ee)}let y=new un(this.field,u),w=this.runEuclideanAlgorithm(this.field.buildMonomial(i,1),y,i),S=w[0],N=w[1],k=this.findErrorLocations(S),j=this.findErrorMagnitudes(N,S,k);for(let G=0;G<k.length;G++){let X=r.length-1-this.field.log(k[G]);if(X<0)throw F.getChecksumInstance();r[X]=this.field.subtract(r[X],j[G])}return k.length}runEuclideanAlgorithm(r,i,a){if(r.getDegree()<i.getDegree()){let k=r;r=i,i=k}let c=r,u=i,d=this.field.getZero(),p=this.field.getOne();for(;u.getDegree()>=Math.round(a/2);){let k=c,j=d;if(c=u,d=p,c.isZero())throw F.getChecksumInstance();u=k;let G=this.field.getZero(),X=c.getCoefficient(c.getDegree()),ee=this.field.inverse(X);for(;u.getDegree()>=c.getDegree()&&!u.isZero();){let ie=u.getDegree()-c.getDegree(),Ee=this.field.multiply(u.getCoefficient(u.getDegree()),ee);G=G.add(this.field.buildMonomial(ie,Ee)),u=u.subtract(c.multiplyByMonomial(ie,Ee))}p=G.multiply(d).subtract(j).negative()}let y=p.getCoefficient(0);if(y===0)throw F.getChecksumInstance();let w=this.field.inverse(y),S=p.multiply(w),N=u.multiply(w);return[S,N]}findErrorLocations(r){let i=r.getDegree(),a=new Int32Array(i),c=0;for(let u=1;u<this.field.getSize()&&c<i;u++)r.evaluateAt(u)===0&&(a[c]=this.field.inverse(u),c++);if(c!==i)throw F.getChecksumInstance();return a}findErrorMagnitudes(r,i,a){let c=i.getDegree(),u=new Int32Array(c);for(let w=1;w<=c;w++)u[c-w]=this.field.multiply(w,i.getCoefficient(w));let d=new un(this.field,u),p=a.length,y=new Int32Array(p);for(let w=0;w<p;w++){let S=this.field.inverse(a[w]),N=this.field.subtract(0,r.evaluateAt(S)),k=this.field.inverse(d.evaluateAt(S));y[w]=this.field.multiply(N,k)}return y}}class br{constructor(r,i,a,c,u){r instanceof br?this.constructor_2(r):this.constructor_1(r,i,a,c,u)}constructor_1(r,i,a,c,u){const d=i==null||a==null,p=c==null||u==null;if(d&&p)throw new Z;d?(i=new Te(0,c.getY()),a=new Te(0,u.getY())):p&&(c=new Te(r.getWidth()-1,i.getY()),u=new Te(r.getWidth()-1,a.getY())),this.image=r,this.topLeft=i,this.bottomLeft=a,this.topRight=c,this.bottomRight=u,this.minX=Math.trunc(Math.min(i.getX(),a.getX())),this.maxX=Math.trunc(Math.max(c.getX(),u.getX())),this.minY=Math.trunc(Math.min(i.getY(),c.getY())),this.maxY=Math.trunc(Math.max(a.getY(),u.getY()))}constructor_2(r){this.image=r.image,this.topLeft=r.getTopLeft(),this.bottomLeft=r.getBottomLeft(),this.topRight=r.getTopRight(),this.bottomRight=r.getBottomRight(),this.minX=r.getMinX(),this.maxX=r.getMaxX(),this.minY=r.getMinY(),this.maxY=r.getMaxY()}static merge(r,i){return r==null?i:i==null?r:new br(r.image,r.topLeft,r.bottomLeft,i.topRight,i.bottomRight)}addMissingRows(r,i,a){let c=this.topLeft,u=this.bottomLeft,d=this.topRight,p=this.bottomRight;if(r>0){let y=a?this.topLeft:this.topRight,w=Math.trunc(y.getY()-r);w<0&&(w=0);let S=new Te(y.getX(),w);a?c=S:d=S}if(i>0){let y=a?this.bottomLeft:this.bottomRight,w=Math.trunc(y.getY()+i);w>=this.image.getHeight()&&(w=this.image.getHeight()-1);let S=new Te(y.getX(),w);a?u=S:p=S}return new br(this.image,c,u,d,p)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class vn{constructor(r,i,a,c){this.columnCount=r,this.errorCorrectionLevel=c,this.rowCountUpperPart=i,this.rowCountLowerPart=a,this.rowCount=i+a}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Sr{constructor(){this.buffer=""}static form(r,i){let a=-1;function c(d,p,y,w,S,N){if(d==="%%")return"%";if(i[++a]===void 0)return;d=w?parseInt(w.substr(1)):void 0;let k=S?parseInt(S.substr(1)):void 0,j;switch(N){case"s":j=i[a];break;case"c":j=i[a][0];break;case"f":j=parseFloat(i[a]).toFixed(d);break;case"p":j=parseFloat(i[a]).toPrecision(d);break;case"e":j=parseFloat(i[a]).toExponential(d);break;case"x":j=parseInt(i[a]).toString(k||16);break;case"d":j=parseFloat(parseInt(i[a],k||10).toPrecision(d)).toFixed(0);break}j=typeof j=="object"?JSON.stringify(j):(+j).toString(k);let G=parseInt(y),X=y&&y[0]+""=="0"?"0":" ";for(;j.length<G;)j=p!==void 0?j+X:X+j;return j}let u=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(u,c)}format(r,...i){this.buffer+=Sr.form(r,i)}toString(){return this.buffer}}class qi{constructor(r){this.boundingBox=new br(r),this.codewords=new Array(r.getMaxY()-r.getMinY()+1)}getCodewordNearby(r){let i=this.getCodeword(r);if(i!=null)return i;for(let a=1;a<qi.MAX_NEARBY_DISTANCE;a++){let c=this.imageRowToCodewordIndex(r)-a;if(c>=0&&(i=this.codewords[c],i!=null)||(c=this.imageRowToCodewordIndex(r)+a,c<this.codewords.length&&(i=this.codewords[c],i!=null)))return i}return null}imageRowToCodewordIndex(r){return r-this.boundingBox.getMinY()}setCodeword(r,i){this.codewords[this.imageRowToCodewordIndex(r)]=i}getCodeword(r){return this.codewords[this.imageRowToCodewordIndex(r)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const r=new Sr;let i=0;for(const a of this.codewords){if(a==null){r.format("%3d:    |   %n",i++);continue}r.format("%3d: %3d|%3d%n",i++,a.getRowNumber(),a.getValue())}return r.toString()}}qi.MAX_NEARBY_DISTANCE=5;class Ji{constructor(){this.values=new Map}setValue(r){r=Math.trunc(r);let i=this.values.get(r);i==null&&(i=0),i++,this.values.set(r,i)}getValue(){let r=-1,i=new Array;for(const[a,c]of this.values.entries()){const u={getKey:()=>a,getValue:()=>c};u.getValue()>r?(r=u.getValue(),i=[],i.push(u.getKey())):u.getValue()===r&&i.push(u.getKey())}return Re.toIntArray(i)}getConfidence(r){return this.values.get(r)}}class dl extends qi{constructor(r,i){super(r),this._isLeft=i}setRowNumbers(){for(let r of this.getCodewords())r!=null&&r.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(r){let i=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(i,r);let a=this.getBoundingBox(),c=this._isLeft?a.getTopLeft():a.getTopRight(),u=this._isLeft?a.getBottomLeft():a.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(c.getY())),p=this.imageRowToCodewordIndex(Math.trunc(u.getY())),y=-1,w=1,S=0;for(let N=d;N<p;N++){if(i[N]==null)continue;let k=i[N],j=k.getRowNumber()-y;if(j===0)S++;else if(j===1)w=Math.max(w,S),S=1,y=k.getRowNumber();else if(j<0||k.getRowNumber()>=r.getRowCount()||j>N)i[N]=null;else{let G;w>2?G=(w-2)*j:G=j;let X=G>=N;for(let ee=1;ee<=G&&!X;ee++)X=i[N-ee]!=null;X?i[N]=null:(y=k.getRowNumber(),S=1)}}}getRowHeights(){let r=this.getBarcodeMetadata();if(r==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(r);let i=new Int32Array(r.getRowCount());for(let a of this.getCodewords())if(a!=null){let c=a.getRowNumber();if(c>=i.length)continue;i[c]++}return i}adjustIncompleteIndicatorColumnRowNumbers(r){let i=this.getBoundingBox(),a=this._isLeft?i.getTopLeft():i.getTopRight(),c=this._isLeft?i.getBottomLeft():i.getBottomRight(),u=this.imageRowToCodewordIndex(Math.trunc(a.getY())),d=this.imageRowToCodewordIndex(Math.trunc(c.getY())),p=this.getCodewords(),y=-1;for(let w=u;w<d;w++){if(p[w]==null)continue;let S=p[w];S.setRowNumberAsRowIndicatorColumn();let N=S.getRowNumber()-y;N===0||(N===1?y=S.getRowNumber():S.getRowNumber()>=r.getRowCount()?p[w]=null:y=S.getRowNumber())}}getBarcodeMetadata(){let r=this.getCodewords(),i=new Ji,a=new Ji,c=new Ji,u=new Ji;for(let p of r){if(p==null)continue;p.setRowNumberAsRowIndicatorColumn();let y=p.getValue()%30,w=p.getRowNumber();switch(this._isLeft||(w+=2),w%3){case 0:a.setValue(y*3+1);break;case 1:u.setValue(y/3),c.setValue(y%3);break;case 2:i.setValue(y+1);break}}if(i.getValue().length===0||a.getValue().length===0||c.getValue().length===0||u.getValue().length===0||i.getValue()[0]<1||a.getValue()[0]+c.getValue()[0]<Re.MIN_ROWS_IN_BARCODE||a.getValue()[0]+c.getValue()[0]>Re.MAX_ROWS_IN_BARCODE)return null;let d=new vn(i.getValue()[0],a.getValue()[0],c.getValue()[0],u.getValue()[0]);return this.removeIncorrectCodewords(r,d),d}removeIncorrectCodewords(r,i){for(let a=0;a<r.length;a++){let c=r[a];if(r[a]==null)continue;let u=c.getValue()%30,d=c.getRowNumber();if(d>i.getRowCount()){r[a]=null;continue}switch(this._isLeft||(d+=2),d%3){case 0:u*3+1!==i.getRowCountUpperPart()&&(r[a]=null);break;case 1:(Math.trunc(u/3)!==i.getErrorCorrectionLevel()||u%3!==i.getRowCountLowerPart())&&(r[a]=null);break;case 2:u+1!==i.getColumnCount()&&(r[a]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class es{constructor(r,i){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=r,this.barcodeColumnCount=r.getColumnCount(),this.boundingBox=i,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let r=Re.MAX_CODEWORDS_IN_BARCODE,i;do i=r,r=this.adjustRowNumbersAndGetCount();while(r>0&&r<i);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(r){r!=null&&r.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let r=this.adjustRowNumbersByRow();if(r===0)return 0;for(let i=1;i<this.barcodeColumnCount+1;i++){let a=this.detectionResultColumns[i].getCodewords();for(let c=0;c<a.length;c++)a[c]!=null&&(a[c].hasValidRowNumber()||this.adjustRowNumbers(i,c,a))}return r}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let r=this.detectionResultColumns[0].getCodewords(),i=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let a=0;a<r.length;a++)if(r[a]!=null&&i[a]!=null&&r[a].getRowNumber()===i[a].getRowNumber())for(let c=1;c<=this.barcodeColumnCount;c++){let u=this.detectionResultColumns[c].getCodewords()[a];u!=null&&(u.setRowNumber(r[a].getRowNumber()),u.hasValidRowNumber()||(this.detectionResultColumns[c].getCodewords()[a]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let r=0,i=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let a=0;a<i.length;a++){if(i[a]==null)continue;let c=i[a].getRowNumber(),u=0;for(let d=this.barcodeColumnCount+1;d>0&&u<this.ADJUST_ROW_NUMBER_SKIP;d--){let p=this.detectionResultColumns[d].getCodewords()[a];p!=null&&(u=es.adjustRowNumberIfValid(c,u,p),p.hasValidRowNumber()||r++)}}return r}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let r=0,i=this.detectionResultColumns[0].getCodewords();for(let a=0;a<i.length;a++){if(i[a]==null)continue;let c=i[a].getRowNumber(),u=0;for(let d=1;d<this.barcodeColumnCount+1&&u<this.ADJUST_ROW_NUMBER_SKIP;d++){let p=this.detectionResultColumns[d].getCodewords()[a];p!=null&&(u=es.adjustRowNumberIfValid(c,u,p),p.hasValidRowNumber()||r++)}}return r}static adjustRowNumberIfValid(r,i,a){return a==null||a.hasValidRowNumber()||(a.isValidRowNumber(r)?(a.setRowNumber(r),i=0):++i),i}adjustRowNumbers(r,i,a){if(!this.detectionResultColumns[r-1])return;let c=a[i],u=this.detectionResultColumns[r-1].getCodewords(),d=u;this.detectionResultColumns[r+1]!=null&&(d=this.detectionResultColumns[r+1].getCodewords());let p=new Array(14);p[2]=u[i],p[3]=d[i],i>0&&(p[0]=a[i-1],p[4]=u[i-1],p[5]=d[i-1]),i>1&&(p[8]=a[i-2],p[10]=u[i-2],p[11]=d[i-2]),i<a.length-1&&(p[1]=a[i+1],p[6]=u[i+1],p[7]=d[i+1]),i<a.length-2&&(p[9]=a[i+2],p[12]=u[i+2],p[13]=d[i+2]);for(let y of p)if(es.adjustRowNumber(c,y))return}static adjustRowNumber(r,i){return i==null?!1:i.hasValidRowNumber()&&i.getBucket()===r.getBucket()?(r.setRowNumber(i.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(r){this.boundingBox=r}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(r,i){this.detectionResultColumns[r]=i}getDetectionResultColumn(r){return this.detectionResultColumns[r]}toString(){let r=this.detectionResultColumns[0];r==null&&(r=this.detectionResultColumns[this.barcodeColumnCount+1]);let i=new Sr;for(let a=0;a<r.getCodewords().length;a++){i.format("CW %3d:",a);for(let c=0;c<this.barcodeColumnCount+2;c++){if(this.detectionResultColumns[c]==null){i.format("    |   ");continue}let u=this.detectionResultColumns[c].getCodewords()[a];if(u==null){i.format("    |   ");continue}i.format(" %3d|%3d",u.getRowNumber(),u.getValue())}i.format("%n")}return i.toString()}}class Di{constructor(r,i,a,c){this.rowNumber=Di.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(r),this.endX=Math.trunc(i),this.bucket=Math.trunc(a),this.value=Math.trunc(c)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(r){return r!==Di.BARCODE_ROW_UNKNOWN&&this.bucket===r%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(r){this.rowNumber=r}toString(){return this.rowNumber+"|"+this.value}}Di.BARCODE_ROW_UNKNOWN=-1;class zn{static initialize(){for(let r=0;r<Re.SYMBOL_TABLE.length;r++){let i=Re.SYMBOL_TABLE[r],a=i&1;for(let c=0;c<Re.BARS_IN_MODULE;c++){let u=0;for(;(i&1)===a;)u+=1,i>>=1;a=i&1,zn.RATIOS_TABLE[r]||(zn.RATIOS_TABLE[r]=new Array(Re.BARS_IN_MODULE)),zn.RATIOS_TABLE[r][Re.BARS_IN_MODULE-c-1]=Math.fround(u/Re.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(r){let i=zn.getDecodedCodewordValue(zn.sampleBitCounts(r));return i!==-1?i:zn.getClosestDecodedValue(r)}static sampleBitCounts(r){let i=Xe.sum(r),a=new Int32Array(Re.BARS_IN_MODULE),c=0,u=0;for(let d=0;d<Re.MODULES_IN_CODEWORD;d++){let p=i/(2*Re.MODULES_IN_CODEWORD)+d*i/Re.MODULES_IN_CODEWORD;u+r[c]<=p&&(u+=r[c],c++),a[c]++}return a}static getDecodedCodewordValue(r){let i=zn.getBitValue(r);return Re.getCodeword(i)===-1?-1:i}static getBitValue(r){let i=0;for(let a=0;a<r.length;a++)for(let c=0;c<r[a];c++)i=i<<1|(a%2===0?1:0);return Math.trunc(i)}static getClosestDecodedValue(r){let i=Xe.sum(r),a=new Array(Re.BARS_IN_MODULE);if(i>1)for(let d=0;d<a.length;d++)a[d]=Math.fround(r[d]/i);let c=$t.MAX_VALUE,u=-1;this.bSymbolTableReady||zn.initialize();for(let d=0;d<zn.RATIOS_TABLE.length;d++){let p=0,y=zn.RATIOS_TABLE[d];for(let w=0;w<Re.BARS_IN_MODULE;w++){let S=Math.fround(y[w]-a[w]);if(p+=Math.fround(S*S),p>=c)break}p<c&&(c=p,u=Re.SYMBOL_TABLE[d])}return u}}zn.bSymbolTableReady=!1,zn.RATIOS_TABLE=new Array(Re.SYMBOL_TABLE.length).map(I=>new Array(Re.BARS_IN_MODULE));class Jo{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(r){this.segmentIndex=r}getFileId(){return this.fileId}setFileId(r){this.fileId=r}getOptionalData(){return this.optionalData}setOptionalData(r){this.optionalData=r}isLastSegment(){return this.lastSegment}setLastSegment(r){this.lastSegment=r}getSegmentCount(){return this.segmentCount}setSegmentCount(r){this.segmentCount=r}getSender(){return this.sender||null}setSender(r){this.sender=r}getAddressee(){return this.addressee||null}setAddressee(r){this.addressee=r}getFileName(){return this.fileName}setFileName(r){this.fileName=r}getFileSize(){return this.fileSize}setFileSize(r){this.fileSize=r}getChecksum(){return this.checksum}setChecksum(r){this.checksum=r}getTimestamp(){return this.timestamp}setTimestamp(r){this.timestamp=r}}class lt{static parseLong(r,i=void 0){return parseInt(r,i)}}class pl extends x{}pl.kind="NullPointerException";class Ar{writeBytes(r){this.writeBytesOffset(r,0,r.length)}writeBytesOffset(r,i,a){if(r==null)throw new pl;if(i<0||i>r.length||a<0||i+a>r.length||i+a<0)throw new re;if(a===0)return;for(let c=0;c<a;c++)this.write(r[i+c])}flush(){}close(){}}class Ps extends x{}class gl extends Ar{constructor(r=32){if(super(),this.count=0,r<0)throw new b("Negative initial size: "+r);this.buf=new Uint8Array(r)}ensureCapacity(r){r-this.buf.length>0&&this.grow(r)}grow(r){let a=this.buf.length<<1;if(a-r<0&&(a=r),a<0){if(r<0)throw new Ps;a=B.MAX_VALUE}this.buf=D.copyOfUint8Array(this.buf,a)}write(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1}writeBytesOffset(r,i,a){if(i<0||i>r.length||a<0||i+a-r.length>0)throw new re;this.ensureCapacity(this.count+a),U.arraycopy(r,i,this.buf,this.count,a),this.count+=a}writeTo(r){r.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return D.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(r){return new String(this.buf).toString()}toString_number(r){return new String(this.buf).toString()}close(){}}var Et;(function(I){I[I.ALPHA=0]="ALPHA",I[I.LOWER=1]="LOWER",I[I.MIXED=2]="MIXED",I[I.PUNCT=3]="PUNCT",I[I.ALPHA_SHIFT=4]="ALPHA_SHIFT",I[I.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Et||(Et={}));function oo(){if(typeof window<"u")return window.BigInt||null;if(typeof us<"u")return us.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let ao;function ii(I){if(typeof ao>"u"&&(ao=oo()),ao===null)throw new Error("BigInt is not supported!");return ao(I)}function su(){let I=[];I[0]=ii(1);let r=ii(900);I[1]=r;for(let i=2;i<16;i++)I[i]=I[i-1]*r;return I}class se{static decode(r,i){let a=new Q(""),c=V.ISO8859_1;a.enableDecoding(c);let u=1,d=r[u++],p=new Jo;for(;u<r[0];){switch(d){case se.TEXT_COMPACTION_MODE_LATCH:u=se.textCompaction(r,u,a);break;case se.BYTE_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:u=se.byteCompaction(d,r,c,u,a);break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[u++]);break;case se.NUMERIC_COMPACTION_MODE_LATCH:u=se.numericCompaction(r,u,a);break;case se.ECI_CHARSET:V.getCharacterSetECIByValue(r[u++]);break;case se.ECI_GENERAL_PURPOSE:u+=2;break;case se.ECI_USER_DEFINED:u++;break;case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:u=se.decodeMacroBlock(r,u,p);break;case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:throw new K;default:u--,u=se.textCompaction(r,u,a);break}if(u<r.length)d=r[u++];else throw K.getFormatInstance()}if(a.length()===0)throw K.getFormatInstance();let y=new Bn(null,a.toString(),null,i);return y.setOther(p),y}static decodeMacroBlock(r,i,a){if(i+se.NUMBER_OF_SEQUENCE_CODEWORDS>r[0])throw K.getFormatInstance();let c=new Int32Array(se.NUMBER_OF_SEQUENCE_CODEWORDS);for(let p=0;p<se.NUMBER_OF_SEQUENCE_CODEWORDS;p++,i++)c[p]=r[i];a.setSegmentIndex(B.parseInt(se.decodeBase900toBase10(c,se.NUMBER_OF_SEQUENCE_CODEWORDS)));let u=new Q;i=se.textCompaction(r,i,u),a.setFileId(u.toString());let d=-1;for(r[i]===se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(d=i+1);i<r[0];)switch(r[i]){case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(i++,r[i]){case se.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let p=new Q;i=se.textCompaction(r,i+1,p),a.setFileName(p.toString());break;case se.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let y=new Q;i=se.textCompaction(r,i+1,y),a.setSender(y.toString());break;case se.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let w=new Q;i=se.textCompaction(r,i+1,w),a.setAddressee(w.toString());break;case se.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let S=new Q;i=se.numericCompaction(r,i+1,S),a.setSegmentCount(B.parseInt(S.toString()));break;case se.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let N=new Q;i=se.numericCompaction(r,i+1,N),a.setTimestamp(lt.parseLong(N.toString()));break;case se.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let k=new Q;i=se.numericCompaction(r,i+1,k),a.setChecksum(B.parseInt(k.toString()));break;case se.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let j=new Q;i=se.numericCompaction(r,i+1,j),a.setFileSize(lt.parseLong(j.toString()));break;default:throw K.getFormatInstance()}break;case se.MACRO_PDF417_TERMINATOR:i++,a.setLastSegment(!0);break;default:throw K.getFormatInstance()}if(d!==-1){let p=i-d;a.isLastSegment()&&p--,a.setOptionalData(D.copyOfRange(r,d,d+p))}return i}static textCompaction(r,i,a){let c=new Int32Array((r[0]-i)*2),u=new Int32Array((r[0]-i)*2),d=0,p=!1;for(;i<r[0]&&!p;){let y=r[i++];if(y<se.TEXT_COMPACTION_MODE_LATCH)c[d]=y/30,c[d+1]=y%30,d+=2;else switch(y){case se.TEXT_COMPACTION_MODE_LATCH:c[d++]=se.TEXT_COMPACTION_MODE_LATCH;break;case se.BYTE_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:case se.NUMERIC_COMPACTION_MODE_LATCH:case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:i--,p=!0;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c[d]=se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,y=r[i++],u[d]=y,d++;break}}return se.decodeTextCompaction(c,u,d,a),i}static decodeTextCompaction(r,i,a,c){let u=Et.ALPHA,d=Et.ALPHA,p=0;for(;p<a;){let y=r[p],w="";switch(u){case Et.ALPHA:if(y<26)w=String.fromCharCode(65+y);else switch(y){case 26:w=" ";break;case se.LL:u=Et.LOWER;break;case se.ML:u=Et.MIXED;break;case se.PS:d=u,u=Et.PUNCT_SHIFT;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(i[p]);break;case se.TEXT_COMPACTION_MODE_LATCH:u=Et.ALPHA;break}break;case Et.LOWER:if(y<26)w=String.fromCharCode(97+y);else switch(y){case 26:w=" ";break;case se.AS:d=u,u=Et.ALPHA_SHIFT;break;case se.ML:u=Et.MIXED;break;case se.PS:d=u,u=Et.PUNCT_SHIFT;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(i[p]);break;case se.TEXT_COMPACTION_MODE_LATCH:u=Et.ALPHA;break}break;case Et.MIXED:if(y<se.PL)w=se.MIXED_CHARS[y];else switch(y){case se.PL:u=Et.PUNCT;break;case 26:w=" ";break;case se.LL:u=Et.LOWER;break;case se.AL:u=Et.ALPHA;break;case se.PS:d=u,u=Et.PUNCT_SHIFT;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(i[p]);break;case se.TEXT_COMPACTION_MODE_LATCH:u=Et.ALPHA;break}break;case Et.PUNCT:if(y<se.PAL)w=se.PUNCT_CHARS[y];else switch(y){case se.PAL:u=Et.ALPHA;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(i[p]);break;case se.TEXT_COMPACTION_MODE_LATCH:u=Et.ALPHA;break}break;case Et.ALPHA_SHIFT:if(u=d,y<26)w=String.fromCharCode(65+y);else switch(y){case 26:w=" ";break;case se.TEXT_COMPACTION_MODE_LATCH:u=Et.ALPHA;break}break;case Et.PUNCT_SHIFT:if(u=d,y<se.PAL)w=se.PUNCT_CHARS[y];else switch(y){case se.PAL:u=Et.ALPHA;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(i[p]);break;case se.TEXT_COMPACTION_MODE_LATCH:u=Et.ALPHA;break}break}w!==""&&c.append(w),p++}}static byteCompaction(r,i,a,c,u){let d=new gl,p=0,y=0,w=!1;switch(r){case se.BYTE_COMPACTION_MODE_LATCH:let S=new Int32Array(6),N=i[c++];for(;c<i[0]&&!w;)switch(S[p++]=N,y=900*y+N,N=i[c++],N){case se.TEXT_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH:case se.NUMERIC_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:c--,w=!0;break;default:if(p%5===0&&p>0){for(let k=0;k<6;++k)d.write(Number(ii(y)>>ii(8*(5-k))));y=0,p=0}break}c===i[0]&&N<se.TEXT_COMPACTION_MODE_LATCH&&(S[p++]=N);for(let k=0;k<p;k++)d.write(S[k]);break;case se.BYTE_COMPACTION_MODE_LATCH_6:for(;c<i[0]&&!w;){let k=i[c++];if(k<se.TEXT_COMPACTION_MODE_LATCH)p++,y=900*y+k;else switch(k){case se.TEXT_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH:case se.NUMERIC_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:c--,w=!0;break}if(p%5===0&&p>0){for(let j=0;j<6;++j)d.write(Number(ii(y)>>ii(8*(5-j))));y=0,p=0}}break}return u.append(ce.decode(d.toByteArray(),a)),c}static numericCompaction(r,i,a){let c=0,u=!1,d=new Int32Array(se.MAX_NUMERIC_CODEWORDS);for(;i<r[0]&&!u;){let p=r[i++];if(i===r[0]&&(u=!0),p<se.TEXT_COMPACTION_MODE_LATCH)d[c]=p,c++;else switch(p){case se.TEXT_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:i--,u=!0;break}(c%se.MAX_NUMERIC_CODEWORDS===0||p===se.NUMERIC_COMPACTION_MODE_LATCH||u)&&c>0&&(a.append(se.decodeBase900toBase10(d,c)),c=0)}return i}static decodeBase900toBase10(r,i){let a=ii(0);for(let u=0;u<i;u++)a+=se.EXP900[i-u-1]*ii(r[u]);let c=a.toString();if(c.charAt(0)!=="1")throw new K;return c.substring(1)}}se.TEXT_COMPACTION_MODE_LATCH=900,se.BYTE_COMPACTION_MODE_LATCH=901,se.NUMERIC_COMPACTION_MODE_LATCH=902,se.BYTE_COMPACTION_MODE_LATCH_6=924,se.ECI_USER_DEFINED=925,se.ECI_GENERAL_PURPOSE=926,se.ECI_CHARSET=927,se.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,se.MACRO_PDF417_TERMINATOR=922,se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,se.MAX_NUMERIC_CODEWORDS=15,se.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,se.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,se.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,se.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,se.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,se.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,se.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,se.PL=25,se.LL=27,se.AS=27,se.ML=28,se.AL=28,se.PS=29,se.PAL=29,se.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,se.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",se.EXP900=oo()?su():[],se.NUMBER_OF_SEQUENCE_CODEWORDS=2;class tt{constructor(){}static decode(r,i,a,c,u,d,p){let y=new br(r,i,a,c,u),w=null,S=null,N;for(let G=!0;;G=!1){if(i!=null&&(w=tt.getRowIndicatorColumn(r,y,i,!0,d,p)),c!=null&&(S=tt.getRowIndicatorColumn(r,y,c,!1,d,p)),N=tt.merge(w,S),N==null)throw Z.getNotFoundInstance();let X=N.getBoundingBox();if(G&&X!=null&&(X.getMinY()<y.getMinY()||X.getMaxY()>y.getMaxY()))y=X;else break}N.setBoundingBox(y);let k=N.getBarcodeColumnCount()+1;N.setDetectionResultColumn(0,w),N.setDetectionResultColumn(k,S);let j=w!=null;for(let G=1;G<=k;G++){let X=j?G:k-G;if(N.getDetectionResultColumn(X)!==void 0)continue;let ee;X===0||X===k?ee=new dl(y,X===0):ee=new qi(y),N.setDetectionResultColumn(X,ee);let ie=-1,Ee=ie;for(let be=y.getMinY();be<=y.getMaxY();be++){if(ie=tt.getStartColumn(N,X,be,j),ie<0||ie>y.getMaxX()){if(Ee===-1)continue;ie=Ee}let ve=tt.detectCodeword(r,y.getMinX(),y.getMaxX(),j,ie,be,d,p);ve!=null&&(ee.setCodeword(be,ve),Ee=ie,d=Math.min(d,ve.getWidth()),p=Math.max(p,ve.getWidth()))}}return tt.createDecoderResult(N)}static merge(r,i){if(r==null&&i==null)return null;let a=tt.getBarcodeMetadata(r,i);if(a==null)return null;let c=br.merge(tt.adjustBoundingBox(r),tt.adjustBoundingBox(i));return new es(a,c)}static adjustBoundingBox(r){if(r==null)return null;let i=r.getRowHeights();if(i==null)return null;let a=tt.getMax(i),c=0;for(let p of i)if(c+=a-p,p>0)break;let u=r.getCodewords();for(let p=0;c>0&&u[p]==null;p++)c--;let d=0;for(let p=i.length-1;p>=0&&(d+=a-i[p],!(i[p]>0));p--);for(let p=u.length-1;d>0&&u[p]==null;p--)d--;return r.getBoundingBox().addMissingRows(c,d,r.isLeft())}static getMax(r){let i=-1;for(let a of r)i=Math.max(i,a);return i}static getBarcodeMetadata(r,i){let a;if(r==null||(a=r.getBarcodeMetadata())==null)return i==null?null:i.getBarcodeMetadata();let c;return i==null||(c=i.getBarcodeMetadata())==null?a:a.getColumnCount()!==c.getColumnCount()&&a.getErrorCorrectionLevel()!==c.getErrorCorrectionLevel()&&a.getRowCount()!==c.getRowCount()?null:a}static getRowIndicatorColumn(r,i,a,c,u,d){let p=new dl(i,c);for(let y=0;y<2;y++){let w=y===0?1:-1,S=Math.trunc(Math.trunc(a.getX()));for(let N=Math.trunc(Math.trunc(a.getY()));N<=i.getMaxY()&&N>=i.getMinY();N+=w){let k=tt.detectCodeword(r,0,r.getWidth(),c,S,N,u,d);k!=null&&(p.setCodeword(N,k),c?S=k.getStartX():S=k.getEndX())}}return p}static adjustCodewordCount(r,i){let a=i[0][1],c=a.getValue(),u=r.getBarcodeColumnCount()*r.getBarcodeRowCount()-tt.getNumberOfECCodeWords(r.getBarcodeECLevel());if(c.length===0){if(u<1||u>Re.MAX_CODEWORDS_IN_BARCODE)throw Z.getNotFoundInstance();a.setValue(u)}else c[0]!==u&&a.setValue(u)}static createDecoderResult(r){let i=tt.createBarcodeMatrix(r);tt.adjustCodewordCount(r,i);let a=new Array,c=new Int32Array(r.getBarcodeRowCount()*r.getBarcodeColumnCount()),u=[],d=new Array;for(let y=0;y<r.getBarcodeRowCount();y++)for(let w=0;w<r.getBarcodeColumnCount();w++){let S=i[y][w+1].getValue(),N=y*r.getBarcodeColumnCount()+w;S.length===0?a.push(N):S.length===1?c[N]=S[0]:(d.push(N),u.push(S))}let p=new Array(u.length);for(let y=0;y<p.length;y++)p[y]=u[y];return tt.createDecoderResultFromAmbiguousValues(r.getBarcodeECLevel(),c,Re.toIntArray(a),Re.toIntArray(d),p)}static createDecoderResultFromAmbiguousValues(r,i,a,c,u){let d=new Int32Array(c.length),p=100;for(;p-- >0;){for(let y=0;y<d.length;y++)i[c[y]]=u[y][d[y]];try{return tt.decodeCodewords(i,r,a)}catch(y){if(!(y instanceof F))throw y}if(d.length===0)throw F.getChecksumInstance();for(let y=0;y<d.length;y++)if(d[y]<u[y].length-1){d[y]++;break}else if(d[y]=0,y===d.length-1)throw F.getChecksumInstance()}throw F.getChecksumInstance()}static createBarcodeMatrix(r){let i=Array.from({length:r.getBarcodeRowCount()},()=>new Array(r.getBarcodeColumnCount()+2));for(let c=0;c<i.length;c++)for(let u=0;u<i[c].length;u++)i[c][u]=new Ji;let a=0;for(let c of r.getDetectionResultColumns()){if(c!=null){for(let u of c.getCodewords())if(u!=null){let d=u.getRowNumber();if(d>=0){if(d>=i.length)continue;i[d][a].setValue(u.getValue())}}}a++}return i}static isValidBarcodeColumn(r,i){return i>=0&&i<=r.getBarcodeColumnCount()+1}static getStartColumn(r,i,a,c){let u=c?1:-1,d=null;if(tt.isValidBarcodeColumn(r,i-u)&&(d=r.getDetectionResultColumn(i-u).getCodeword(a)),d!=null)return c?d.getEndX():d.getStartX();if(d=r.getDetectionResultColumn(i).getCodewordNearby(a),d!=null)return c?d.getStartX():d.getEndX();if(tt.isValidBarcodeColumn(r,i-u)&&(d=r.getDetectionResultColumn(i-u).getCodewordNearby(a)),d!=null)return c?d.getEndX():d.getStartX();let p=0;for(;tt.isValidBarcodeColumn(r,i-u);){i-=u;for(let y of r.getDetectionResultColumn(i).getCodewords())if(y!=null)return(c?y.getEndX():y.getStartX())+u*p*(y.getEndX()-y.getStartX());p++}return c?r.getBoundingBox().getMinX():r.getBoundingBox().getMaxX()}static detectCodeword(r,i,a,c,u,d,p,y){u=tt.adjustCodewordStartColumn(r,i,a,c,u,d);let w=tt.getModuleBitCount(r,i,a,c,u,d);if(w==null)return null;let S,N=Xe.sum(w);if(c)S=u+N;else{for(let G=0;G<w.length/2;G++){let X=w[G];w[G]=w[w.length-1-G],w[w.length-1-G]=X}S=u,u=S-N}if(!tt.checkCodewordSkew(N,p,y))return null;let k=zn.getDecodedValue(w),j=Re.getCodeword(k);return j===-1?null:new Di(u,S,tt.getCodewordBucketNumber(k),j)}static getModuleBitCount(r,i,a,c,u,d){let p=u,y=new Int32Array(8),w=0,S=c?1:-1,N=c;for(;(c?p<a:p>=i)&&w<y.length;)r.get(p,d)===N?(y[w]++,p+=S):(w++,N=!N);return w===y.length||p===(c?a:i)&&w===y.length-1?y:null}static getNumberOfECCodeWords(r){return 2<<r}static adjustCodewordStartColumn(r,i,a,c,u,d){let p=u,y=c?-1:1;for(let w=0;w<2;w++){for(;(c?p>=i:p<a)&&c===r.get(p,d);){if(Math.abs(u-p)>tt.CODEWORD_SKEW_SIZE)return u;p+=y}y=-y,c=!c}return p}static checkCodewordSkew(r,i,a){return i-tt.CODEWORD_SKEW_SIZE<=r&&r<=a+tt.CODEWORD_SKEW_SIZE}static decodeCodewords(r,i,a){if(r.length===0)throw K.getFormatInstance();let c=1<<i+1,u=tt.correctErrors(r,a,c);tt.verifyCodewordCount(r,c);let d=se.decode(r,""+i);return d.setErrorsCorrected(u),d.setErasures(a.length),d}static correctErrors(r,i,a){if(i!=null&&i.length>a/2+tt.MAX_ERRORS||a<0||a>tt.MAX_EC_CODEWORDS)throw F.getChecksumInstance();return tt.errorCorrection.decode(r,a,i)}static verifyCodewordCount(r,i){if(r.length<4)throw K.getFormatInstance();let a=r[0];if(a>r.length)throw K.getFormatInstance();if(a===0)if(i<r.length)r[0]=r.length-i;else throw K.getFormatInstance()}static getBitCountForCodeword(r){let i=new Int32Array(8),a=0,c=i.length-1;for(;!((r&1)!==a&&(a=r&1,c--,c<0));)i[c]++,r>>=1;return i}static getCodewordBucketNumber(r){return r instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(r):this.getCodewordBucketNumber_number(r)}static getCodewordBucketNumber_number(r){return tt.getCodewordBucketNumber(tt.getBitCountForCodeword(r))}static getCodewordBucketNumber_Int32Array(r){return(r[0]-r[2]+r[4]-r[6]+9)%9}static toString(r){let i=new Sr;for(let a=0;a<r.length;a++){i.format("Row %2d: ",a);for(let c=0;c<r[a].length;c++){let u=r[a][c];u.getValue().length===0?i.format("        ",null):i.format("%4d(%2d)",u.getValue()[0],u.getConfidence(u.getValue()[0]))}i.format("%n")}return i.toString()}}tt.CODEWORD_SKEW_SIZE=2,tt.MAX_ERRORS=3,tt.MAX_EC_CODEWORDS=512,tt.errorCorrection=new so;class wn{decode(r,i=null){let a=wn.decode(r,i,!1);if(a==null||a.length===0||a[0]==null)throw Z.getNotFoundInstance();return a[0]}decodeMultiple(r,i=null){try{return wn.decode(r,i,!0)}catch(a){throw a instanceof K||a instanceof F?Z.getNotFoundInstance():a}}static decode(r,i,a){const c=new Array,u=Je.detectMultiple(r,i,a);for(const d of u.getPoints()){const p=tt.decode(u.getBits(),d[4],d[5],d[6],d[7],wn.getMinCodewordWidth(d),wn.getMaxCodewordWidth(d)),y=new we(p.getText(),p.getRawBytes(),void 0,d,ge.PDF_417);y.putMetadata(He.ERROR_CORRECTION_LEVEL,p.getECLevel());const w=p.getOther();w!=null&&y.putMetadata(He.PDF417_EXTRA_METADATA,w),c.push(y)}return c.map(d=>d)}static getMaxWidth(r,i){return r==null||i==null?0:Math.trunc(Math.abs(r.getX()-i.getX()))}static getMinWidth(r,i){return r==null||i==null?B.MAX_VALUE:Math.trunc(Math.abs(r.getX()-i.getX()))}static getMaxCodewordWidth(r){return Math.floor(Math.max(Math.max(wn.getMaxWidth(r[0],r[4]),wn.getMaxWidth(r[6],r[2])*Re.MODULES_IN_CODEWORD/Re.MODULES_IN_STOP_PATTERN),Math.max(wn.getMaxWidth(r[1],r[5]),wn.getMaxWidth(r[7],r[3])*Re.MODULES_IN_CODEWORD/Re.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(r){return Math.floor(Math.min(Math.min(wn.getMinWidth(r[0],r[4]),wn.getMinWidth(r[6],r[2])*Re.MODULES_IN_CODEWORD/Re.MODULES_IN_STOP_PATTERN),Math.min(wn.getMinWidth(r[1],r[5]),wn.getMinWidth(r[7],r[3])*Re.MODULES_IN_CODEWORD/Re.MODULES_IN_STOP_PATTERN)))}reset(){}}class nr extends x{}nr.kind="ReaderException";class ml{constructor(r,i){this.verbose=r===!0,i&&this.setHints(i)}decode(r,i){return i&&this.setHints(i),this.decodeInternal(r)}decodeWithState(r){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(r)}setHints(r){this.hints=r;const i=!s(r)&&r.get(pe.TRY_HARDER)===!0,a=s(r)?null:r.get(pe.POSSIBLE_FORMATS),c=new Array;if(!s(a)){const u=a.some(d=>d===ge.UPC_A||d===ge.UPC_E||d===ge.EAN_13||d===ge.EAN_8||d===ge.CODABAR||d===ge.CODE_39||d===ge.CODE_93||d===ge.CODE_128||d===ge.ITF||d===ge.RSS_14||d===ge.RSS_EXPANDED);u&&!i&&c.push(new jr(r,this.verbose)),a.includes(ge.QR_CODE)&&c.push(new cn),a.includes(ge.DATA_MATRIX)&&c.push(new _t),a.includes(ge.AZTEC)&&c.push(new An),a.includes(ge.PDF_417)&&c.push(new wn),u&&i&&c.push(new jr(r,this.verbose))}c.length===0&&(i||c.push(new jr(r,this.verbose)),c.push(new cn),c.push(new _t),c.push(new An),c.push(new wn),i&&c.push(new jr(r,this.verbose))),this.readers=c}reset(){if(this.readers!==null)for(const r of this.readers)r.reset()}decodeInternal(r){if(this.readers===null)throw new nr("No readers where selected, nothing can be read.");for(const i of this.readers)try{return i.decode(r,this.hints)}catch(a){if(a instanceof nr)continue}throw new Z("No MultiFormat Readers were able to detect the code.")}}class xl extends Qe{constructor(r=null,i=500){const a=new ml;a.setHints(r),super(a,i)}decodeBitmap(r){return this.reader.decodeWithState(r)}}class Ci extends Qe{constructor(r=500){super(new wn,r)}}class yl extends Qe{constructor(r=500){super(new cn,r)}}var lo;(function(I){I[I.ERROR_CORRECTION=0]="ERROR_CORRECTION",I[I.CHARACTER_SET=1]="CHARACTER_SET",I[I.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",I[I.MIN_SIZE=3]="MIN_SIZE",I[I.MAX_SIZE=4]="MAX_SIZE",I[I.MARGIN=5]="MARGIN",I[I.PDF417_COMPACT=6]="PDF417_COMPACT",I[I.PDF417_COMPACTION=7]="PDF417_COMPACTION",I[I.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",I[I.AZTEC_LAYERS=9]="AZTEC_LAYERS",I[I.QR_VERSION=10]="QR_VERSION"})(lo||(lo={}));var Kt=lo;class ea{constructor(r){this.field=r,this.cachedGenerators=[],this.cachedGenerators.push(new Ot(r,Int32Array.from([1])))}buildGenerator(r){const i=this.cachedGenerators;if(r>=i.length){let a=i[i.length-1];const c=this.field;for(let u=i.length;u<=r;u++){const d=a.multiply(new Ot(c,Int32Array.from([1,c.exp(u-1+c.getGeneratorBase())])));i.push(d),a=d}}return i[r]}encode(r,i){if(i===0)throw new b("No error correction bytes");const a=r.length-i;if(a<=0)throw new b("No data bytes provided");const c=this.buildGenerator(i),u=new Int32Array(a);U.arraycopy(r,0,u,0,a);let d=new Ot(this.field,u);d=d.multiplyByMonomial(i,1);const y=d.divide(c)[1].getCoefficients(),w=i-y.length;for(let S=0;S<w;S++)r[a+S]=0;U.arraycopy(y,0,r,a+w,y.length)}}class Ut{constructor(){}static applyMaskPenaltyRule1(r){return Ut.applyMaskPenaltyRule1Internal(r,!0)+Ut.applyMaskPenaltyRule1Internal(r,!1)}static applyMaskPenaltyRule2(r){let i=0;const a=r.getArray(),c=r.getWidth(),u=r.getHeight();for(let d=0;d<u-1;d++){const p=a[d];for(let y=0;y<c-1;y++){const w=p[y];w===p[y+1]&&w===a[d+1][y]&&w===a[d+1][y+1]&&i++}}return Ut.N2*i}static applyMaskPenaltyRule3(r){let i=0;const a=r.getArray(),c=r.getWidth(),u=r.getHeight();for(let d=0;d<u;d++)for(let p=0;p<c;p++){const y=a[d];p+6<c&&y[p]===1&&y[p+1]===0&&y[p+2]===1&&y[p+3]===1&&y[p+4]===1&&y[p+5]===0&&y[p+6]===1&&(Ut.isWhiteHorizontal(y,p-4,p)||Ut.isWhiteHorizontal(y,p+7,p+11))&&i++,d+6<u&&a[d][p]===1&&a[d+1][p]===0&&a[d+2][p]===1&&a[d+3][p]===1&&a[d+4][p]===1&&a[d+5][p]===0&&a[d+6][p]===1&&(Ut.isWhiteVertical(a,p,d-4,d)||Ut.isWhiteVertical(a,p,d+7,d+11))&&i++}return i*Ut.N3}static isWhiteHorizontal(r,i,a){i=Math.max(i,0),a=Math.min(a,r.length);for(let c=i;c<a;c++)if(r[c]===1)return!1;return!0}static isWhiteVertical(r,i,a,c){a=Math.max(a,0),c=Math.min(c,r.length);for(let u=a;u<c;u++)if(r[u][i]===1)return!1;return!0}static applyMaskPenaltyRule4(r){let i=0;const a=r.getArray(),c=r.getWidth(),u=r.getHeight();for(let y=0;y<u;y++){const w=a[y];for(let S=0;S<c;S++)w[S]===1&&i++}const d=r.getHeight()*r.getWidth();return Math.floor(Math.abs(i*2-d)*10/d)*Ut.N4}static getDataMaskBit(r,i,a){let c,u;switch(r){case 0:c=a+i&1;break;case 1:c=a&1;break;case 2:c=i%3;break;case 3:c=(a+i)%3;break;case 4:c=Math.floor(a/2)+Math.floor(i/3)&1;break;case 5:u=a*i,c=(u&1)+u%3;break;case 6:u=a*i,c=(u&1)+u%3&1;break;case 7:u=a*i,c=u%3+(a+i&1)&1;break;default:throw new b("Invalid mask pattern: "+r)}return c===0}static applyMaskPenaltyRule1Internal(r,i){let a=0;const c=i?r.getHeight():r.getWidth(),u=i?r.getWidth():r.getHeight(),d=r.getArray();for(let p=0;p<c;p++){let y=0,w=-1;for(let S=0;S<u;S++){const N=i?d[p][S]:d[S][p];N===w?y++:(y>=5&&(a+=Ut.N1+(y-5)),y=1,w=N)}y>=5&&(a+=Ut.N1+(y-5))}return a}}Ut.N1=3,Ut.N2=3,Ut.N3=40,Ut.N4=10;class Ds{constructor(r,i){this.width=r,this.height=i;const a=new Array(i);for(let c=0;c!==i;c++)a[c]=new Uint8Array(r);this.bytes=a}getHeight(){return this.height}getWidth(){return this.width}get(r,i){return this.bytes[i][r]}getArray(){return this.bytes}setNumber(r,i,a){this.bytes[i][r]=a}setBoolean(r,i,a){this.bytes[i][r]=a?1:0}clear(r){for(const i of this.bytes)D.fill(i,r)}equals(r){if(!(r instanceof Ds))return!1;const i=r;if(this.width!==i.width||this.height!==i.height)return!1;for(let a=0,c=this.height;a<c;++a){const u=this.bytes[a],d=i.bytes[a];for(let p=0,y=this.width;p<y;++p)if(u[p]!==d[p])return!1}return!0}toString(){const r=new Q;for(let i=0,a=this.height;i<a;++i){const c=this.bytes[i];for(let u=0,d=this.width;u<d;++u)switch(c[u]){case 0:r.append(" 0");break;case 1:r.append(" 1");break;default:r.append("  ");break}r.append(`
`)}return r.toString()}}class Bi{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const r=new Q;return r.append(`<<
`),r.append(" mode: "),r.append(this.mode?this.mode.toString():"null"),r.append(`
 ecLevel: `),r.append(this.ecLevel?this.ecLevel.toString():"null"),r.append(`
 version: `),r.append(this.version?this.version.toString():"null"),r.append(`
 maskPattern: `),r.append(this.maskPattern.toString()),this.matrix?(r.append(`
 matrix:
`),r.append(this.matrix.toString())):r.append(`
 matrix: null
`),r.append(`>>
`),r.toString()}setMode(r){this.mode=r}setECLevel(r){this.ecLevel=r}setVersion(r){this.version=r}setMaskPattern(r){this.maskPattern=r}setMatrix(r){this.matrix=r}static isValidMaskPattern(r){return r>=0&&r<Bi.NUM_MASK_PATTERNS}}Bi.NUM_MASK_PATTERNS=8;class St extends x{}St.kind="WriterException";class Ze{constructor(){}static clearMatrix(r){r.clear(255)}static buildMatrix(r,i,a,c,u){Ze.clearMatrix(u),Ze.embedBasicPatterns(a,u),Ze.embedTypeInfo(i,c,u),Ze.maybeEmbedVersionInfo(a,u),Ze.embedDataBits(r,c,u)}static embedBasicPatterns(r,i){Ze.embedPositionDetectionPatternsAndSeparators(i),Ze.embedDarkDotAtLeftBottomCorner(i),Ze.maybeEmbedPositionAdjustmentPatterns(r,i),Ze.embedTimingPatterns(i)}static embedTypeInfo(r,i,a){const c=new $;Ze.makeTypeInfoBits(r,i,c);for(let u=0,d=c.getSize();u<d;++u){const p=c.get(c.getSize()-1-u),y=Ze.TYPE_INFO_COORDINATES[u],w=y[0],S=y[1];if(a.setBoolean(w,S,p),u<8){const N=a.getWidth()-u-1;a.setBoolean(N,8,p)}else{const k=a.getHeight()-7+(u-8);a.setBoolean(8,k,p)}}}static maybeEmbedVersionInfo(r,i){if(r.getVersionNumber()<7)return;const a=new $;Ze.makeVersionInfoBits(r,a);let c=6*3-1;for(let u=0;u<6;++u)for(let d=0;d<3;++d){const p=a.get(c);c--,i.setBoolean(u,i.getHeight()-11+d,p),i.setBoolean(i.getHeight()-11+d,u,p)}}static embedDataBits(r,i,a){let c=0,u=-1,d=a.getWidth()-1,p=a.getHeight()-1;for(;d>0;){for(d===6&&(d-=1);p>=0&&p<a.getHeight();){for(let y=0;y<2;++y){const w=d-y;if(!Ze.isEmpty(a.get(w,p)))continue;let S;c<r.getSize()?(S=r.get(c),++c):S=!1,i!==255&&Ut.getDataMaskBit(i,w,p)&&(S=!S),a.setBoolean(w,p,S)}p+=u}u=-u,p+=u,d-=2}if(c!==r.getSize())throw new St("Not all bits consumed: "+c+"/"+r.getSize())}static findMSBSet(r){return 32-B.numberOfLeadingZeros(r)}static calculateBCHCode(r,i){if(i===0)throw new b("0 polynomial");const a=Ze.findMSBSet(i);for(r<<=a-1;Ze.findMSBSet(r)>=a;)r^=i<<Ze.findMSBSet(r)-a;return r}static makeTypeInfoBits(r,i,a){if(!Bi.isValidMaskPattern(i))throw new St("Invalid mask pattern");const c=r.getBits()<<3|i;a.appendBits(c,5);const u=Ze.calculateBCHCode(c,Ze.TYPE_INFO_POLY);a.appendBits(u,10);const d=new $;if(d.appendBits(Ze.TYPE_INFO_MASK_PATTERN,15),a.xor(d),a.getSize()!==15)throw new St("should not happen but we got: "+a.getSize())}static makeVersionInfoBits(r,i){i.appendBits(r.getVersionNumber(),6);const a=Ze.calculateBCHCode(r.getVersionNumber(),Ze.VERSION_INFO_POLY);if(i.appendBits(a,12),i.getSize()!==18)throw new St("should not happen but we got: "+i.getSize())}static isEmpty(r){return r===255}static embedTimingPatterns(r){for(let i=8;i<r.getWidth()-8;++i){const a=(i+1)%2;Ze.isEmpty(r.get(i,6))&&r.setNumber(i,6,a),Ze.isEmpty(r.get(6,i))&&r.setNumber(6,i,a)}}static embedDarkDotAtLeftBottomCorner(r){if(r.get(8,r.getHeight()-8)===0)throw new St;r.setNumber(8,r.getHeight()-8,1)}static embedHorizontalSeparationPattern(r,i,a){for(let c=0;c<8;++c){if(!Ze.isEmpty(a.get(r+c,i)))throw new St;a.setNumber(r+c,i,0)}}static embedVerticalSeparationPattern(r,i,a){for(let c=0;c<7;++c){if(!Ze.isEmpty(a.get(r,i+c)))throw new St;a.setNumber(r,i+c,0)}}static embedPositionAdjustmentPattern(r,i,a){for(let c=0;c<5;++c){const u=Ze.POSITION_ADJUSTMENT_PATTERN[c];for(let d=0;d<5;++d)a.setNumber(r+d,i+c,u[d])}}static embedPositionDetectionPattern(r,i,a){for(let c=0;c<7;++c){const u=Ze.POSITION_DETECTION_PATTERN[c];for(let d=0;d<7;++d)a.setNumber(r+d,i+c,u[d])}}static embedPositionDetectionPatternsAndSeparators(r){const i=Ze.POSITION_DETECTION_PATTERN[0].length;Ze.embedPositionDetectionPattern(0,0,r),Ze.embedPositionDetectionPattern(r.getWidth()-i,0,r),Ze.embedPositionDetectionPattern(0,r.getWidth()-i,r);const a=8;Ze.embedHorizontalSeparationPattern(0,a-1,r),Ze.embedHorizontalSeparationPattern(r.getWidth()-a,a-1,r),Ze.embedHorizontalSeparationPattern(0,r.getWidth()-a,r);const c=7;Ze.embedVerticalSeparationPattern(c,0,r),Ze.embedVerticalSeparationPattern(r.getHeight()-c-1,0,r),Ze.embedVerticalSeparationPattern(c,r.getHeight()-c,r)}static maybeEmbedPositionAdjustmentPatterns(r,i){if(r.getVersionNumber()<2)return;const a=r.getVersionNumber()-1,c=Ze.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[a];for(let u=0,d=c.length;u!==d;u++){const p=c[u];if(p>=0)for(let y=0;y!==d;y++){const w=c[y];w>=0&&Ze.isEmpty(i.get(w,p))&&Ze.embedPositionAdjustmentPattern(w-2,p-2,i)}}}}Ze.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Ze.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Ze.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Ze.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Ze.VERSION_INFO_POLY=7973,Ze.TYPE_INFO_POLY=1335,Ze.TYPE_INFO_MASK_PATTERN=21522;class ou{constructor(r,i){this.dataBytes=r,this.errorCorrectionBytes=i}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class kt{constructor(){}static calculateMaskPenalty(r){return Ut.applyMaskPenaltyRule1(r)+Ut.applyMaskPenaltyRule2(r)+Ut.applyMaskPenaltyRule3(r)+Ut.applyMaskPenaltyRule4(r)}static encode(r,i,a=null){let c=kt.DEFAULT_BYTE_MODE_ENCODING;const u=a!==null&&a.get(Kt.CHARACTER_SET)!==void 0;u&&(c=a.get(Kt.CHARACTER_SET).toString());const d=this.chooseMode(r,c),p=new $;if(d===Pe.BYTE&&(u||kt.DEFAULT_BYTE_MODE_ENCODING!==c)){const be=V.getCharacterSetECIByName(c);be!==void 0&&this.appendECI(be,p)}this.appendModeInfo(d,p);const y=new $;this.appendBytes(r,d,y,c);let w;if(a!==null&&a.get(Kt.QR_VERSION)!==void 0){const be=Number.parseInt(a.get(Kt.QR_VERSION).toString(),10);w=me.getVersionForNumber(be);const ve=this.calculateBitsNeeded(d,p,y,w);if(!this.willFit(ve,w,i))throw new St("Data too big for requested version")}else w=this.recommendVersion(i,d,p,y);const S=new $;S.appendBitArray(p);const N=d===Pe.BYTE?y.getSizeInBytes():r.length;this.appendLengthInfo(N,w,d,S),S.appendBitArray(y);const k=w.getECBlocksForLevel(i),j=w.getTotalCodewords()-k.getTotalECCodewords();this.terminateBits(j,S);const G=this.interleaveWithECBytes(S,w.getTotalCodewords(),j,k.getNumBlocks()),X=new Bi;X.setECLevel(i),X.setMode(d),X.setVersion(w);const ee=w.getDimensionForVersion(),ie=new Ds(ee,ee),Ee=this.chooseMaskPattern(G,i,w,ie);return X.setMaskPattern(Ee),Ze.buildMatrix(G,i,w,Ee,ie),X.setMatrix(ie),X}static recommendVersion(r,i,a,c){const u=this.calculateBitsNeeded(i,a,c,me.getVersionForNumber(1)),d=this.chooseVersion(u,r),p=this.calculateBitsNeeded(i,a,c,d);return this.chooseVersion(p,r)}static calculateBitsNeeded(r,i,a,c){return i.getSize()+r.getCharacterCountBits(c)+a.getSize()}static getAlphanumericCode(r){return r<kt.ALPHANUMERIC_TABLE.length?kt.ALPHANUMERIC_TABLE[r]:-1}static chooseMode(r,i=null){if(V.SJIS.getName()===i&&this.isOnlyDoubleByteKanji(r))return Pe.KANJI;let a=!1,c=!1;for(let u=0,d=r.length;u<d;++u){const p=r.charAt(u);if(kt.isDigit(p))a=!0;else if(this.getAlphanumericCode(p.charCodeAt(0))!==-1)c=!0;else return Pe.BYTE}return c?Pe.ALPHANUMERIC:a?Pe.NUMERIC:Pe.BYTE}static isOnlyDoubleByteKanji(r){let i;try{i=ce.encode(r,V.SJIS)}catch{return!1}const a=i.length;if(a%2!==0)return!1;for(let c=0;c<a;c+=2){const u=i[c]&255;if((u<129||u>159)&&(u<224||u>235))return!1}return!0}static chooseMaskPattern(r,i,a,c){let u=Number.MAX_SAFE_INTEGER,d=-1;for(let p=0;p<Bi.NUM_MASK_PATTERNS;p++){Ze.buildMatrix(r,i,a,p,c);let y=this.calculateMaskPenalty(c);y<u&&(u=y,d=p)}return d}static chooseVersion(r,i){for(let a=1;a<=40;a++){const c=me.getVersionForNumber(a);if(kt.willFit(r,c,i))return c}throw new St("Data too big")}static willFit(r,i,a){const c=i.getTotalCodewords(),d=i.getECBlocksForLevel(a).getTotalECCodewords(),p=c-d,y=(r+7)/8;return p>=y}static terminateBits(r,i){const a=r*8;if(i.getSize()>a)throw new St("data bits cannot fit in the QR Code"+i.getSize()+" > "+a);for(let d=0;d<4&&i.getSize()<a;++d)i.appendBit(!1);const c=i.getSize()&7;if(c>0)for(let d=c;d<8;d++)i.appendBit(!1);const u=r-i.getSizeInBytes();for(let d=0;d<u;++d)i.appendBits(d&1?17:236,8);if(i.getSize()!==a)throw new St("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(r,i,a,c,u,d){if(c>=a)throw new St("Block ID too large");const p=r%a,y=a-p,w=Math.floor(r/a),S=w+1,N=Math.floor(i/a),k=N+1,j=w-N,G=S-k;if(j!==G)throw new St("EC bytes mismatch");if(a!==y+p)throw new St("RS blocks mismatch");if(r!==(N+j)*y+(k+G)*p)throw new St("Total bytes mismatch");c<y?(u[0]=N,d[0]=j):(u[0]=k,d[0]=G)}static interleaveWithECBytes(r,i,a,c){if(r.getSizeInBytes()!==a)throw new St("Number of bits and data bytes does not match");let u=0,d=0,p=0;const y=new Array;for(let S=0;S<c;++S){const N=new Int32Array(1),k=new Int32Array(1);kt.getNumDataBytesAndNumECBytesForBlockID(i,a,c,S,N,k);const j=N[0],G=new Uint8Array(j);r.toBytes(8*u,G,0,j);const X=kt.generateECBytes(G,k[0]);y.push(new ou(G,X)),d=Math.max(d,j),p=Math.max(p,X.length),u+=N[0]}if(a!==u)throw new St("Data bytes does not match offset");const w=new $;for(let S=0;S<d;++S)for(const N of y){const k=N.getDataBytes();S<k.length&&w.appendBits(k[S],8)}for(let S=0;S<p;++S)for(const N of y){const k=N.getErrorCorrectionBytes();S<k.length&&w.appendBits(k[S],8)}if(i!==w.getSizeInBytes())throw new St("Interleaving error: "+i+" and "+w.getSizeInBytes()+" differ.");return w}static generateECBytes(r,i){const a=r.length,c=new Int32Array(a+i);for(let d=0;d<a;d++)c[d]=r[d]&255;new ea($e.QR_CODE_FIELD_256).encode(c,i);const u=new Uint8Array(i);for(let d=0;d<i;d++)u[d]=c[a+d];return u}static appendModeInfo(r,i){i.appendBits(r.getBits(),4)}static appendLengthInfo(r,i,a,c){const u=a.getCharacterCountBits(i);if(r>=1<<u)throw new St(r+" is bigger than "+((1<<u)-1));c.appendBits(r,u)}static appendBytes(r,i,a,c){switch(i){case Pe.NUMERIC:kt.appendNumericBytes(r,a);break;case Pe.ALPHANUMERIC:kt.appendAlphanumericBytes(r,a);break;case Pe.BYTE:kt.append8BitBytes(r,a,c);break;case Pe.KANJI:kt.appendKanjiBytes(r,a);break;default:throw new St("Invalid mode: "+i)}}static getDigit(r){return r.charCodeAt(0)-48}static isDigit(r){const i=kt.getDigit(r);return i>=0&&i<=9}static appendNumericBytes(r,i){const a=r.length;let c=0;for(;c<a;){const u=kt.getDigit(r.charAt(c));if(c+2<a){const d=kt.getDigit(r.charAt(c+1)),p=kt.getDigit(r.charAt(c+2));i.appendBits(u*100+d*10+p,10),c+=3}else if(c+1<a){const d=kt.getDigit(r.charAt(c+1));i.appendBits(u*10+d,7),c+=2}else i.appendBits(u,4),c++}}static appendAlphanumericBytes(r,i){const a=r.length;let c=0;for(;c<a;){const u=kt.getAlphanumericCode(r.charCodeAt(c));if(u===-1)throw new St;if(c+1<a){const d=kt.getAlphanumericCode(r.charCodeAt(c+1));if(d===-1)throw new St;i.appendBits(u*45+d,11),c+=2}else i.appendBits(u,6),c++}}static append8BitBytes(r,i,a){let c;try{c=ce.encode(r,a)}catch(u){throw new St(u)}for(let u=0,d=c.length;u!==d;u++){const p=c[u];i.appendBits(p,8)}}static appendKanjiBytes(r,i){let a;try{a=ce.encode(r,V.SJIS)}catch(u){throw new St(u)}const c=a.length;for(let u=0;u<c;u+=2){const d=a[u]&255,p=a[u+1]&255,y=d<<8&4294967295|p;let w=-1;if(y>=33088&&y<=40956?w=y-33088:y>=57408&&y<=60351&&(w=y-49472),w===-1)throw new St("Invalid byte sequence");const S=(w>>8)*192+(w&255);i.appendBits(S,13)}}static appendECI(r,i){i.appendBits(Pe.ECI.getBits(),4),i.appendBits(r.getValue(),8)}}kt.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),kt.DEFAULT_BYTE_MODE_ENCODING=V.UTF8.getName();class Ei{write(r,i,a,c=null){if(r.length===0)throw new b("Found empty contents");if(i<0||a<0)throw new b("Requested dimensions are too small: "+i+"x"+a);let u=nt.L,d=Ei.QUIET_ZONE_SIZE;c!==null&&(c.get(Kt.ERROR_CORRECTION)!==void 0&&(u=nt.fromString(c.get(Kt.ERROR_CORRECTION).toString())),c.get(Kt.MARGIN)!==void 0&&(d=Number.parseInt(c.get(Kt.MARGIN).toString(),10)));const p=kt.encode(r,u,c);return this.renderResult(p,i,a,d)}writeToDom(r,i,a,c,u=null){typeof r=="string"&&(r=document.querySelector(r));const d=this.write(i,a,c,u);r&&r.appendChild(d)}renderResult(r,i,a,c){const u=r.getMatrix();if(u===null)throw new Xt;const d=u.getWidth(),p=u.getHeight(),y=d+c*2,w=p+c*2,S=Math.max(i,y),N=Math.max(a,w),k=Math.min(Math.floor(S/y),Math.floor(N/w)),j=Math.floor((S-d*k)/2),G=Math.floor((N-p*k)/2),X=this.createSVGElement(S,N);for(let ee=0,ie=G;ee<p;ee++,ie+=k)for(let Ee=0,be=j;Ee<d;Ee++,be+=k)if(u.get(Ee,ee)===1){const ve=this.createSvgRectElement(be,ie,k,k);X.appendChild(ve)}return X}createSVGElement(r,i){const a=document.createElementNS(Ei.SVG_NS,"svg");return a.setAttributeNS(null,"height",r.toString()),a.setAttributeNS(null,"width",i.toString()),a}createSvgRectElement(r,i,a,c){const u=document.createElementNS(Ei.SVG_NS,"rect");return u.setAttributeNS(null,"x",r.toString()),u.setAttributeNS(null,"y",i.toString()),u.setAttributeNS(null,"height",a.toString()),u.setAttributeNS(null,"width",c.toString()),u.setAttributeNS(null,"fill","#000000"),u}}Ei.QUIET_ZONE_SIZE=4,Ei.SVG_NS="http://www.w3.org/2000/svg";class si{encode(r,i,a,c,u){if(r.length===0)throw new b("Found empty contents");if(i!==ge.QR_CODE)throw new b("Can only encode QR_CODE, but got "+i);if(a<0||c<0)throw new b(`Requested dimensions are too small: ${a}x${c}`);let d=nt.L,p=si.QUIET_ZONE_SIZE;u!==null&&(u.get(Kt.ERROR_CORRECTION)!==void 0&&(d=nt.fromString(u.get(Kt.ERROR_CORRECTION).toString())),u.get(Kt.MARGIN)!==void 0&&(p=Number.parseInt(u.get(Kt.MARGIN).toString(),10)));const y=kt.encode(r,d,u);return si.renderResult(y,a,c,p)}static renderResult(r,i,a,c){const u=r.getMatrix();if(u===null)throw new Xt;const d=u.getWidth(),p=u.getHeight(),y=d+c*2,w=p+c*2,S=Math.max(i,y),N=Math.max(a,w),k=Math.min(Math.floor(S/y),Math.floor(N/w)),j=Math.floor((S-d*k)/2),G=Math.floor((N-p*k)/2),X=new ne(S,N);for(let ee=0,ie=G;ee<p;ee++,ie+=k)for(let Ee=0,be=j;Ee<d;Ee++,be+=k)u.get(Ee,ee)===1&&X.setRegion(be,ie,k,k);return X}}si.QUIET_ZONE_SIZE=4;class Fi{encode(r,i,a,c,u){let d;switch(i){case ge.QR_CODE:d=new si;break;default:throw new b("No encoder available for format "+i)}return d.encode(r,i,a,c,u)}}class zr extends J{constructor(r,i,a,c,u,d,p,y){if(super(d,p),this.yuvData=r,this.dataWidth=i,this.dataHeight=a,this.left=c,this.top=u,c+d>i||u+p>a)throw new b("Crop rectangle does not fit within image data.");y&&this.reverseHorizontal(d,p)}getRow(r,i){if(r<0||r>=this.getHeight())throw new b("Requested row is outside the image: "+r);const a=this.getWidth();(i==null||i.length<a)&&(i=new Uint8ClampedArray(a));const c=(r+this.top)*this.dataWidth+this.left;return U.arraycopy(this.yuvData,c,i,0,a),i}getMatrix(){const r=this.getWidth(),i=this.getHeight();if(r===this.dataWidth&&i===this.dataHeight)return this.yuvData;const a=r*i,c=new Uint8ClampedArray(a);let u=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return U.arraycopy(this.yuvData,u,c,0,a),c;for(let d=0;d<i;d++){const p=d*r;U.arraycopy(this.yuvData,u,c,p,r),u+=this.dataWidth}return c}isCropSupported(){return!0}crop(r,i,a,c){return new zr(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+i,a,c,!1)}renderThumbnail(){const r=this.getWidth()/zr.THUMBNAIL_SCALE_FACTOR,i=this.getHeight()/zr.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(r*i),c=this.yuvData;let u=this.top*this.dataWidth+this.left;for(let d=0;d<i;d++){const p=d*r;for(let y=0;y<r;y++){const w=c[u+y*zr.THUMBNAIL_SCALE_FACTOR]&255;a[p+y]=4278190080|w*65793}u+=this.dataWidth*zr.THUMBNAIL_SCALE_FACTOR}return a}getThumbnailWidth(){return this.getWidth()/zr.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/zr.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(r,i){const a=this.yuvData;for(let c=0,u=this.top*this.dataWidth+this.left;c<i;c++,u+=this.dataWidth){const d=u+r/2;for(let p=u,y=u+r-1;p<d;p++,y--){const w=a[p];a[p]=a[y],a[y]=w}}}invert(){return new de(this)}}zr.THUMBNAIL_SCALE_FACTOR=2;class ji extends J{constructor(r,i,a,c,u,d,p){if(super(i,a),this.dataWidth=c,this.dataHeight=u,this.left=d,this.top=p,r.BYTES_PER_ELEMENT===4){const y=i*a,w=new Uint8ClampedArray(y);for(let S=0;S<y;S++){const N=r[S],k=N>>16&255,j=N>>7&510,G=N&255;w[S]=(k+j+G)/4&255}this.luminances=w}else this.luminances=r;if(c===void 0&&(this.dataWidth=i),u===void 0&&(this.dataHeight=a),d===void 0&&(this.left=0),p===void 0&&(this.top=0),this.left+i>this.dataWidth||this.top+a>this.dataHeight)throw new b("Crop rectangle does not fit within image data.")}getRow(r,i){if(r<0||r>=this.getHeight())throw new b("Requested row is outside the image: "+r);const a=this.getWidth();(i==null||i.length<a)&&(i=new Uint8ClampedArray(a));const c=(r+this.top)*this.dataWidth+this.left;return U.arraycopy(this.luminances,c,i,0,a),i}getMatrix(){const r=this.getWidth(),i=this.getHeight();if(r===this.dataWidth&&i===this.dataHeight)return this.luminances;const a=r*i,c=new Uint8ClampedArray(a);let u=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return U.arraycopy(this.luminances,u,c,0,a),c;for(let d=0;d<i;d++){const p=d*r;U.arraycopy(this.luminances,u,c,p,r),u+=this.dataWidth}return c}isCropSupported(){return!0}crop(r,i,a,c){return new ji(this.luminances,a,c,this.dataWidth,this.dataHeight,this.left+r,this.top+i)}invert(){return new de(this)}}class rr extends V{static forName(r){return this.getCharacterSetECIByName(r)}}class co{}co.ISO_8859_1=V.ISO8859_1;class ta{isCompact(){return this.compact}setCompact(r){this.compact=r}getSize(){return this.size}setSize(r){this.size=r}getLayers(){return this.layers}setLayers(r){this.layers=r}getCodeWords(){return this.codeWords}setCodeWords(r){this.codeWords=r}getMatrix(){return this.matrix}setMatrix(r){this.matrix=r}}class _l{static singletonList(r){return[r]}static min(r,i){return r.sort(i)[0]}}class na{constructor(r){this.previous=r}getPrevious(){return this.previous}}class bi extends na{constructor(r,i,a){super(r),this.value=i,this.bitCount=a}appendTo(r,i){r.appendBits(this.value,this.bitCount)}add(r,i){return new bi(this,r,i)}addBinaryShift(r,i){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new bi(this,r,i)}toString(){let r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+B.toBinaryString(r|1<<this.bitCount).substring(1)+">"}}class ra extends bi{constructor(r,i,a){super(r,0,0),this.binaryShiftStart=i,this.binaryShiftByteCount=a}appendTo(r,i){for(let a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):a===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(i[this.binaryShiftStart+a],8)}addBinaryShift(r,i){return new ra(this,r,i)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function au(I,r,i){return new ra(I,r,i)}function ts(I,r,i){return new bi(I,r,i)}const lu=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],gn=0,oi=1,hr=2,Ur=3,Hr=4,ns=new bi(null,0,0),ia=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Bs(I){for(let r of I)D.fill(r,-1);return I[gn][Hr]=0,I[oi][Hr]=0,I[oi][gn]=28,I[Ur][Hr]=0,I[hr][Hr]=0,I[hr][gn]=15,I}const sa=Bs(D.createInt32Array(6,6));class ir{constructor(r,i,a,c){this.token=r,this.mode=i,this.binaryShiftByteCount=a,this.bitCount=c}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(r,i){let a=this.bitCount,c=this.token;if(r!==this.mode){let d=ia[this.mode][r];c=ts(c,d&65535,d>>16),a+=d>>16}let u=r===hr?4:5;return c=ts(c,i,u),new ir(c,r,0,a+u)}shiftAndAppend(r,i){let a=this.token,c=this.mode===hr?4:5;return a=ts(a,sa[this.mode][r],c),a=ts(a,i,5),new ir(a,this.mode,0,this.bitCount+c+5)}addBinaryShiftChar(r){let i=this.token,a=this.mode,c=this.bitCount;if(this.mode===Hr||this.mode===hr){let p=ia[a][gn];i=ts(i,p&65535,p>>16),c+=p>>16,a=gn}let u=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,d=new ir(i,a,this.binaryShiftByteCount+1,c+u);return d.binaryShiftByteCount===2078&&(d=d.endBinaryShift(r+1)),d}endBinaryShift(r){if(this.binaryShiftByteCount===0)return this;let i=this.token;return i=au(i,r-this.binaryShiftByteCount,this.binaryShiftByteCount),new ir(i,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(r){let i=this.bitCount+(ia[this.mode][r.mode]>>16);return this.binaryShiftByteCount<r.binaryShiftByteCount?i+=ir.calculateBinaryShiftCost(r)-ir.calculateBinaryShiftCost(this):this.binaryShiftByteCount>r.binaryShiftByteCount&&r.binaryShiftByteCount>0&&(i+=10),i<=r.bitCount}toBitArray(r){let i=[];for(let c=this.endBinaryShift(r.length).token;c!==null;c=c.getPrevious())i.unshift(c);let a=new $;for(const c of i)c.appendTo(a,r);return a}toString(){return ue.format("%s bits=%d bytes=%d",lu[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(r){return r.binaryShiftByteCount>62?21:r.binaryShiftByteCount>31?20:r.binaryShiftByteCount>0?10:0}}ir.INITIAL_STATE=new ir(ns,gn,0,0);function cu(I){const r=ue.getCharCode(" "),i=ue.getCharCode("."),a=ue.getCharCode(",");I[gn][r]=1;const c=ue.getCharCode("Z"),u=ue.getCharCode("A");for(let k=u;k<=c;k++)I[gn][k]=k-u+2;I[oi][r]=1;const d=ue.getCharCode("z"),p=ue.getCharCode("a");for(let k=p;k<=d;k++)I[oi][k]=k-p+2;I[hr][r]=1;const y=ue.getCharCode("9"),w=ue.getCharCode("0");for(let k=w;k<=y;k++)I[hr][k]=k-w+2;I[hr][a]=12,I[hr][i]=13;const S=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let k=0;k<S.length;k++)I[Ur][ue.getCharCode(S[k])]=k;const N=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let k=0;k<N.length;k++)ue.getCharCode(N[k])>0&&(I[Hr][ue.getCharCode(N[k])]=k);return I}const Vr=cu(D.createInt32Array(5,256));class Si{constructor(r){this.text=r}encode(){const r=ue.getCharCode(" "),i=ue.getCharCode(`
`);let a=_l.singletonList(ir.INITIAL_STATE);for(let u=0;u<this.text.length;u++){let d,p=u+1<this.text.length?this.text[u+1]:0;switch(this.text[u]){case ue.getCharCode("\r"):d=p===i?2:0;break;case ue.getCharCode("."):d=p===r?3:0;break;case ue.getCharCode(","):d=p===r?4:0;break;case ue.getCharCode(":"):d=p===r?5:0;break;default:d=0}d>0?(a=Si.updateStateListForPair(a,u,d),u++):a=this.updateStateListForChar(a,u)}return _l.min(a,(u,d)=>u.getBitCount()-d.getBitCount()).toBitArray(this.text)}updateStateListForChar(r,i){const a=[];for(let c of r)this.updateStateForChar(c,i,a);return Si.simplifyStates(a)}updateStateForChar(r,i,a){let c=this.text[i]&255,u=Vr[r.getMode()][c]>0,d=null;for(let p=0;p<=Hr;p++){let y=Vr[p][c];if(y>0){if(d==null&&(d=r.endBinaryShift(i)),!u||p===r.getMode()||p===hr){const w=d.latchAndAppend(p,y);a.push(w)}if(!u&&sa[r.getMode()][p]>=0){const w=d.shiftAndAppend(p,y);a.push(w)}}}if(r.getBinaryShiftByteCount()>0||Vr[r.getMode()][c]===0){let p=r.addBinaryShiftChar(i);a.push(p)}}static updateStateListForPair(r,i,a){const c=[];for(let u of r)this.updateStateForPair(u,i,a,c);return this.simplifyStates(c)}static updateStateForPair(r,i,a,c){let u=r.endBinaryShift(i);if(c.push(u.latchAndAppend(Hr,a)),r.getMode()!==Hr&&c.push(u.shiftAndAppend(Hr,a)),a===3||a===4){let d=u.latchAndAppend(hr,16-a).latchAndAppend(hr,1);c.push(d)}if(r.getBinaryShiftByteCount()>0){let d=r.addBinaryShiftChar(i).addBinaryShiftChar(i+1);c.push(d)}}static simplifyStates(r){let i=[];for(const a of r){let c=!0;for(const u of i){if(u.isBetterThanOrEqualTo(a)){c=!1;break}a.isBetterThanOrEqualTo(u)&&(i=i.filter(d=>d!==u))}c&&i.push(a)}return i}}class gt{constructor(){}static encodeBytes(r){return gt.encode(r,gt.DEFAULT_EC_PERCENT,gt.DEFAULT_AZTEC_LAYERS)}static encode(r,i,a){let c=new Si(r).encode(),u=B.truncDivision(c.getSize()*i,100)+11,d=c.getSize()+u,p,y,w,S,N;if(a!==gt.DEFAULT_AZTEC_LAYERS){if(p=a<0,y=Math.abs(a),y>(p?gt.MAX_NB_BITS_COMPACT:gt.MAX_NB_BITS))throw new b(ue.format("Illegal value %s for layers",a));w=gt.totalBitsInLayer(y,p),S=gt.WORD_SIZE[y];let ve=w-w%S;if(N=gt.stuffBits(c,S),N.getSize()+u>ve)throw new b("Data to large for user specified layer");if(p&&N.getSize()>S*64)throw new b("Data to large for user specified layer")}else{S=0,N=null;for(let ve=0;;ve++){if(ve>gt.MAX_NB_BITS)throw new b("Data too large for an Aztec code");if(p=ve<=3,y=p?ve+1:ve,w=gt.totalBitsInLayer(y,p),d>w)continue;(N==null||S!==gt.WORD_SIZE[y])&&(S=gt.WORD_SIZE[y],N=gt.stuffBits(c,S));let it=w-w%S;if(!(p&&N.getSize()>S*64)&&N.getSize()+u<=it)break}}let k=gt.generateCheckWords(N,w,S),j=N.getSize()/S,G=gt.generateModeMessage(p,y,j),X=(p?11:14)+y*4,ee=new Int32Array(X),ie;if(p){ie=X;for(let ve=0;ve<ee.length;ve++)ee[ve]=ve}else{ie=X+1+2*B.truncDivision(B.truncDivision(X,2)-1,15);let ve=B.truncDivision(X,2),it=B.truncDivision(ie,2);for(let et=0;et<ve;et++){let Ht=et+B.truncDivision(et,15);ee[ve-et-1]=it-Ht-1,ee[ve+et]=it+Ht+1}}let Ee=new ne(ie);for(let ve=0,it=0;ve<y;ve++){let et=(y-ve)*4+(p?9:12);for(let Ht=0;Ht<et;Ht++){let Un=Ht*2;for(let Hn=0;Hn<2;Hn++)k.get(it+Un+Hn)&&Ee.set(ee[ve*2+Hn],ee[ve*2+Ht]),k.get(it+et*2+Un+Hn)&&Ee.set(ee[ve*2+Ht],ee[X-1-ve*2-Hn]),k.get(it+et*4+Un+Hn)&&Ee.set(ee[X-1-ve*2-Hn],ee[X-1-ve*2-Ht]),k.get(it+et*6+Un+Hn)&&Ee.set(ee[X-1-ve*2-Ht],ee[ve*2+Hn])}it+=et*8}if(gt.drawModeMessage(Ee,p,ie,G),p)gt.drawBullsEye(Ee,B.truncDivision(ie,2),5);else{gt.drawBullsEye(Ee,B.truncDivision(ie,2),7);for(let ve=0,it=0;ve<B.truncDivision(X,2)-1;ve+=15,it+=16)for(let et=B.truncDivision(ie,2)&1;et<ie;et+=2)Ee.set(B.truncDivision(ie,2)-it,et),Ee.set(B.truncDivision(ie,2)+it,et),Ee.set(et,B.truncDivision(ie,2)-it),Ee.set(et,B.truncDivision(ie,2)+it)}let be=new ta;return be.setCompact(p),be.setSize(ie),be.setLayers(y),be.setCodeWords(j),be.setMatrix(Ee),be}static drawBullsEye(r,i,a){for(let c=0;c<a;c+=2)for(let u=i-c;u<=i+c;u++)r.set(u,i-c),r.set(u,i+c),r.set(i-c,u),r.set(i+c,u);r.set(i-a,i-a),r.set(i-a+1,i-a),r.set(i-a,i-a+1),r.set(i+a,i-a),r.set(i+a,i-a+1),r.set(i+a,i+a-1)}static generateModeMessage(r,i,a){let c=new $;return r?(c.appendBits(i-1,2),c.appendBits(a-1,6),c=gt.generateCheckWords(c,28,4)):(c.appendBits(i-1,5),c.appendBits(a-1,11),c=gt.generateCheckWords(c,40,4)),c}static drawModeMessage(r,i,a,c){let u=B.truncDivision(a,2);if(i)for(let d=0;d<7;d++){let p=u-3+d;c.get(d)&&r.set(p,u-5),c.get(d+7)&&r.set(u+5,p),c.get(20-d)&&r.set(p,u+5),c.get(27-d)&&r.set(u-5,p)}else for(let d=0;d<10;d++){let p=u-5+d+B.truncDivision(d,5);c.get(d)&&r.set(p,u-7),c.get(d+10)&&r.set(u+7,p),c.get(29-d)&&r.set(p,u+7),c.get(39-d)&&r.set(u-7,p)}}static generateCheckWords(r,i,a){let c=r.getSize()/a,u=new ea(gt.getGF(a)),d=B.truncDivision(i,a),p=gt.bitsToWords(r,a,d);u.encode(p,d-c);let y=i%a,w=new $;w.appendBits(0,y);for(const S of Array.from(p))w.appendBits(S,a);return w}static bitsToWords(r,i,a){let c=new Int32Array(a),u,d;for(u=0,d=r.getSize()/i;u<d;u++){let p=0;for(let y=0;y<i;y++)p|=r.get(u*i+y)?1<<i-y-1:0;c[u]=p}return c}static getGF(r){switch(r){case 4:return $e.AZTEC_PARAM;case 6:return $e.AZTEC_DATA_6;case 8:return $e.AZTEC_DATA_8;case 10:return $e.AZTEC_DATA_10;case 12:return $e.AZTEC_DATA_12;default:throw new b("Unsupported word size "+r)}}static stuffBits(r,i){let a=new $,c=r.getSize(),u=(1<<i)-2;for(let d=0;d<c;d+=i){let p=0;for(let y=0;y<i;y++)(d+y>=c||r.get(d+y))&&(p|=1<<i-1-y);(p&u)===u?(a.appendBits(p&u,i),d--):p&u?a.appendBits(p,i):(a.appendBits(p|1,i),d--)}return a}static totalBitsInLayer(r,i){return((i?88:112)+16*r)*r}}gt.DEFAULT_EC_PERCENT=33,gt.DEFAULT_AZTEC_LAYERS=0,gt.MAX_NB_BITS=32,gt.MAX_NB_BITS_COMPACT=4,gt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class rs{encode(r,i,a,c){return this.encodeWithHints(r,i,a,c,null)}encodeWithHints(r,i,a,c,u){let d=co.ISO_8859_1,p=gt.DEFAULT_EC_PERCENT,y=gt.DEFAULT_AZTEC_LAYERS;return u!=null&&(u.has(Kt.CHARACTER_SET)&&(d=rr.forName(u.get(Kt.CHARACTER_SET).toString())),u.has(Kt.ERROR_CORRECTION)&&(p=B.parseInt(u.get(Kt.ERROR_CORRECTION).toString())),u.has(Kt.AZTEC_LAYERS)&&(y=B.parseInt(u.get(Kt.AZTEC_LAYERS).toString()))),rs.encodeLayers(r,i,a,c,d,p,y)}static encodeLayers(r,i,a,c,u,d,p){if(i!==ge.AZTEC)throw new b("Can only encode AZTEC, but got "+i);let y=gt.encode(ue.getBytes(r,u),d,p);return rs.renderResult(y,a,c)}static renderResult(r,i,a){let c=r.getMatrix();if(c==null)throw new Xt;let u=c.getWidth(),d=c.getHeight(),p=Math.max(i,u),y=Math.max(a,d),w=Math.min(p/u,y/d),S=(p-u*w)/2,N=(y-d*w)/2,k=new ne(p,y);for(let j=0,G=N;j<d;j++,G+=w)for(let X=0,ee=S;X<u;X++,ee+=w)c.get(X,j)&&k.setRegion(ee,G,w,w);return k}}n.AbstractExpandedDecoder=yi,n.ArgumentException=E,n.ArithmeticException=yt,n.AztecCode=ta,n.AztecCodeReader=An,n.AztecCodeWriter=rs,n.AztecDecoder=We,n.AztecDetector=Kn,n.AztecDetectorResult=ki,n.AztecEncoder=gt,n.AztecHighLevelEncoder=Si,n.AztecPoint=Pt,n.BarcodeFormat=ge,n.Binarizer=z,n.BinaryBitmap=M,n.BitArray=$,n.BitMatrix=ne,n.BitSource=vi,n.BrowserAztecCodeReader=jn,n.BrowserBarcodeReader=_i,n.BrowserCodeReader=Qe,n.BrowserDatamatrixCodeReader=Ls,n.BrowserMultiFormatReader=xl,n.BrowserPDF417Reader=Ci,n.BrowserQRCodeReader=yl,n.BrowserQRCodeSvgWriter=Ei,n.CharacterSetECI=V,n.ChecksumException=F,n.Code128Reader=Ae,n.Code39Reader=Ie,n.DataMatrixDecodedBitStreamParser=On,n.DataMatrixReader=_t,n.DecodeHintType=pe,n.DecoderResult=Bn,n.DefaultGridSampler=gi,n.DetectorResult=Lt,n.EAN13Reader=Dr,n.EncodeHintType=Kt,n.Exception=x,n.FormatException=K,n.GenericGF=$e,n.GenericGFPoly=Ot,n.GlobalHistogramBinarizer=ye,n.GridSampler=Oi,n.GridSamplerInstance=Qn,n.HTMLCanvasElementLuminanceSource=ae,n.HybridBinarizer=he,n.ITFReader=Me,n.IllegalArgumentException=b,n.IllegalStateException=Xt,n.InvertedLuminanceSource=de,n.LuminanceSource=J,n.MathUtils=Xe,n.MultiFormatOneDReader=jr,n.MultiFormatReader=ml,n.MultiFormatWriter=Fi,n.NotFoundException=Z,n.OneDReader=wt,n.PDF417DecodedBitStreamParser=se,n.PDF417DecoderErrorCorrection=so,n.PDF417Reader=wn,n.PDF417ResultMetadata=Jo,n.PerspectiveTransform=Ct,n.PlanarYUVLuminanceSource=zr,n.QRCodeByteMatrix=Ds,n.QRCodeDataMask=zt,n.QRCodeDecodedBitStreamParser=ht,n.QRCodeDecoderErrorCorrectionLevel=nt,n.QRCodeDecoderFormatInformation=an,n.QRCodeEncoder=kt,n.QRCodeEncoderQRCode=Bi,n.QRCodeMaskUtil=Ut,n.QRCodeMatrixUtil=Ze,n.QRCodeMode=Pe,n.QRCodeReader=cn,n.QRCodeVersion=me,n.QRCodeWriter=si,n.RGBLuminanceSource=ji,n.RSS14Reader=Bt,n.RSSExpandedReader=xe,n.ReaderException=nr,n.ReedSolomonDecoder=Rn,n.ReedSolomonEncoder=ea,n.ReedSolomonException=Sn,n.Result=we,n.ResultMetadataType=He,n.ResultPoint=Te,n.StringUtils=ue,n.UnsupportedOperationException=le,n.VideoInputDevice=Ce,n.WhiteRectangleDetector=hn,n.WriterException=St,n.ZXingArrays=D,n.ZXingCharset=rr,n.ZXingInteger=B,n.ZXingStandardCharsets=co,n.ZXingStringBuilder=Q,n.ZXingStringEncoding=ce,n.ZXingSystem=U,n.createAbstractExpandedDecoder=Pi,Object.defineProperty(n,"__esModule",{value:!0})})})(Yf,Yf.exports);var Wt=Yf.exports;const Uv=sl(Wt),Hv=w1({__proto__:null,default:Uv},[Wt]);var t1=function(){function e(t,n,s){if(this.formatMap=new Map([[Fe.QR_CODE,Wt.BarcodeFormat.QR_CODE],[Fe.AZTEC,Wt.BarcodeFormat.AZTEC],[Fe.CODABAR,Wt.BarcodeFormat.CODABAR],[Fe.CODE_39,Wt.BarcodeFormat.CODE_39],[Fe.CODE_93,Wt.BarcodeFormat.CODE_93],[Fe.CODE_128,Wt.BarcodeFormat.CODE_128],[Fe.DATA_MATRIX,Wt.BarcodeFormat.DATA_MATRIX],[Fe.MAXICODE,Wt.BarcodeFormat.MAXICODE],[Fe.ITF,Wt.BarcodeFormat.ITF],[Fe.EAN_13,Wt.BarcodeFormat.EAN_13],[Fe.EAN_8,Wt.BarcodeFormat.EAN_8],[Fe.PDF_417,Wt.BarcodeFormat.PDF_417],[Fe.RSS_14,Wt.BarcodeFormat.RSS_14],[Fe.RSS_EXPANDED,Wt.BarcodeFormat.RSS_EXPANDED],[Fe.UPC_A,Wt.BarcodeFormat.UPC_A],[Fe.UPC_E,Wt.BarcodeFormat.UPC_E],[Fe.UPC_EAN_EXTENSION,Wt.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!Hv)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=s;var l=this.createZXingFormats(t),f=new Map;f.set(Wt.DecodeHintType.POSSIBLE_FORMATS,l),f.set(Wt.DecodeHintType.TRY_HARDER,!1),this.hints=f}return e.prototype.decodeAsync=function(t){var n=this;return new Promise(function(s,l){try{s(n.decode(t))}catch(f){l(f)}})},e.prototype.decode=function(t){var n=new Wt.MultiFormatReader(this.verbose,this.hints),s=new Wt.HTMLCanvasElementLuminanceSource(t),l=new Wt.BinaryBitmap(new Wt.HybridBinarizer(s)),f=n.decode(l);return{text:f.text,format:hm.create(this.toHtml5QrcodeSupportedFormats(f.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(n,s,l){t.set(n,s)}),t},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createZXingFormats=function(t){for(var n=[],s=0,l=t;s<l.length;s++){var f=l[s];this.formatMap.has(f)?n.push(this.formatMap.get(f)):this.logger.logError("".concat(f," is not supported by")+"ZXingHtml5QrcodeShim")}return n},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),Vv=function(e,t,n,s){function l(f){return f instanceof n?f:new n(function(m){m(f)})}return new(n||(n=Promise))(function(f,m){function v(E){try{x(s.next(E))}catch(b){m(b)}}function _(E){try{x(s.throw(E))}catch(b){m(b)}}function x(E){E.done?f(E.value):l(E.value).then(v,_)}x((s=s.apply(e,t||[])).next())})},Wv=function(e,t){var n={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},s,l,f,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(x){return function(E){return _([x,E])}}function _(x){if(s)throw new TypeError("Generator is already executing.");for(;m&&(m=0,x[0]&&(n=0)),n;)try{if(s=1,l&&(f=x[0]&2?l.return:x[0]?l.throw||((f=l.return)&&f.call(l),0):l.next)&&!(f=f.call(l,x[1])).done)return f;switch(l=0,f&&(x=[x[0]&2,f.value]),x[0]){case 0:case 1:f=x;break;case 4:return n.label++,{value:x[1],done:!1};case 5:n.label++,l=x[1],x=[0];continue;case 7:x=n.ops.pop(),n.trys.pop();continue;default:if(f=n.trys,!(f=f.length>0&&f[f.length-1])&&(x[0]===6||x[0]===2)){n=0;continue}if(x[0]===3&&(!f||x[1]>f[0]&&x[1]<f[3])){n.label=x[1];break}if(x[0]===6&&n.label<f[1]){n.label=f[1],f=x;break}if(f&&n.label<f[2]){n.label=f[2],n.ops.push(x);break}f[2]&&n.ops.pop(),n.trys.pop();continue}x=t.call(e,n)}catch(E){x=[6,E],l=0}finally{s=f=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},n1=function(){function e(t,n,s){if(this.formatMap=new Map([[Fe.QR_CODE,"qr_code"],[Fe.AZTEC,"aztec"],[Fe.CODABAR,"codabar"],[Fe.CODE_39,"code_39"],[Fe.CODE_93,"code_93"],[Fe.CODE_128,"code_128"],[Fe.DATA_MATRIX,"data_matrix"],[Fe.ITF,"itf"],[Fe.EAN_13,"ean_13"],[Fe.EAN_8,"ean_8"],[Fe.PDF_417,"pdf417"],[Fe.UPC_A,"upc_a"],[Fe.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=s;var l=this.createBarcodeDetectorFormats(t);if(this.detector=new BarcodeDetector(l),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var t=new BarcodeDetector({formats:["qr_code"]});return typeof t<"u"},e.prototype.decodeAsync=function(t){return Vv(this,void 0,void 0,function(){var n,s;return Wv(this,function(l){switch(l.label){case 0:return[4,this.detector.detect(t)];case 1:if(n=l.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return s=this.selectLargestBarcode(n),[2,{text:s.rawValue,format:hm.create(this.toHtml5QrcodeSupportedFormats(s.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(t){for(var n=null,s=0,l=0,f=t;l<f.length;l++){var m=f[l],v=m.boundingBox.width*m.boundingBox.height;v>s&&(s=v,n=m)}if(!n)throw"No largest barcode found";return n},e.prototype.createBarcodeDetectorFormats=function(t){for(var n=[],s=0,l=t;s<l.length;s++){var f=l[s];this.formatMap.has(f)?n.push(this.formatMap.get(f)):this.logger.warn("".concat(f," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(n,s,l){t.set(n,s)}),t},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),r1=function(e,t,n,s){function l(f){return f instanceof n?f:new n(function(m){m(f)})}return new(n||(n=Promise))(function(f,m){function v(E){try{x(s.next(E))}catch(b){m(b)}}function _(E){try{x(s.throw(E))}catch(b){m(b)}}function x(E){E.done?f(E.value):l(E.value).then(v,_)}x((s=s.apply(e,t||[])).next())})},i1=function(e,t){var n={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},s,l,f,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(x){return function(E){return _([x,E])}}function _(x){if(s)throw new TypeError("Generator is already executing.");for(;m&&(m=0,x[0]&&(n=0)),n;)try{if(s=1,l&&(f=x[0]&2?l.return:x[0]?l.throw||((f=l.return)&&f.call(l),0):l.next)&&!(f=f.call(l,x[1])).done)return f;switch(l=0,f&&(x=[x[0]&2,f.value]),x[0]){case 0:case 1:f=x;break;case 4:return n.label++,{value:x[1],done:!1};case 5:n.label++,l=x[1],x=[0];continue;case 7:x=n.ops.pop(),n.trys.pop();continue;default:if(f=n.trys,!(f=f.length>0&&f[f.length-1])&&(x[0]===6||x[0]===2)){n=0;continue}if(x[0]===3&&(!f||x[1]>f[0]&&x[1]<f[3])){n.label=x[1];break}if(x[0]===6&&n.label<f[1]){n.label=f[1],f=x;break}if(f&&n.label<f[2]){n.label=f[2],n.ops.push(x);break}f[2]&&n.ops.pop(),n.trys.pop();continue}x=t.call(e,n)}catch(E){x=[6,E],l=0}finally{s=f=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},Zv=function(){function e(t,n,s,l){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=s,n&&n1.isSupported()?(this.primaryDecoder=new n1(t,s,l),this.secondaryDecoder=new t1(t,s,l)):this.primaryDecoder=new t1(t,s,l)}return e.prototype.decodeAsync=function(t){return r1(this,void 0,void 0,function(){var n;return i1(this,function(s){switch(s.label){case 0:n=performance.now(),s.label=1;case 1:return s.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(t)];case 2:return[2,s.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(t){return r1(this,void 0,void 0,function(){var n,s;return i1(this,function(l){switch(l.label){case 0:n=performance.now(),l.label=1;case 1:return l.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(t)];case 2:return[2,l.sent()];case 3:if(s=l.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(t)];throw s;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(t){if(this.verbose){var n=performance.now()-t;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var t=0,n=0,s=this.executionResults;n<s.length;n++){var l=s[n];t+=l}var f=t/this.executionResults.length;console.log("".concat(f," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e}(),sd=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function s(){this.constructor=t}t.prototype=n===null?Object.create(n):(s.prototype=n.prototype,new s)}}(),Oc=function(e,t,n,s){function l(f){return f instanceof n?f:new n(function(m){m(f)})}return new(n||(n=Promise))(function(f,m){function v(E){try{x(s.next(E))}catch(b){m(b)}}function _(E){try{x(s.throw(E))}catch(b){m(b)}}function x(E){E.done?f(E.value):l(E.value).then(v,_)}x((s=s.apply(e,t||[])).next())})},Lc=function(e,t){var n={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},s,l,f,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(x){return function(E){return _([x,E])}}function _(x){if(s)throw new TypeError("Generator is already executing.");for(;m&&(m=0,x[0]&&(n=0)),n;)try{if(s=1,l&&(f=x[0]&2?l.return:x[0]?l.throw||((f=l.return)&&f.call(l),0):l.next)&&!(f=f.call(l,x[1])).done)return f;switch(l=0,f&&(x=[x[0]&2,f.value]),x[0]){case 0:case 1:f=x;break;case 4:return n.label++,{value:x[1],done:!1};case 5:n.label++,l=x[1],x=[0];continue;case 7:x=n.ops.pop(),n.trys.pop();continue;default:if(f=n.trys,!(f=f.length>0&&f[f.length-1])&&(x[0]===6||x[0]===2)){n=0;continue}if(x[0]===3&&(!f||x[1]>f[0]&&x[1]<f[3])){n.label=x[1];break}if(x[0]===6&&n.label<f[1]){n.label=f[1],f=x;break}if(f&&n.label<f[2]){n.label=f[2],n.ops.push(x);break}f[2]&&n.ops.pop(),n.trys.pop();continue}x=t.call(e,n)}catch(E){x=[6,E],l=0}finally{s=f=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},mm=function(){function e(t,n){this.name=t,this.track=n}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(t){var n={};n[this.name]=t;var s={advanced:[n]};return this.track.applyConstraints(s)},e.prototype.value=function(){var t=this.track.getSettings();if(this.name in t){var n=t[this.name];return n}return null},e}(),Gv=function(e){sd(t,e);function t(n,s){return e.call(this,n,s)||this}return t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(n){var s={};s[this.name]=n;var l={advanced:[s]};return this.track.applyConstraints(l)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),s=n[this.name];return{min:s.min,max:s.max,step:s.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t}(mm),Yv=function(e){sd(t,e);function t(n){return e.call(this,"zoom",n)||this}return t}(Gv),Xv=function(e){sd(t,e);function t(n){return e.call(this,"torch",n)||this}return t}(mm),$v=function(){function e(t){this.track=t}return e.prototype.zoomFeature=function(){return new Yv(this.track)},e.prototype.torchFeature=function(){return new Xv(this.track)},e}(),Qv=function(){function e(t,n,s){this.isClosed=!1,this.parentElement=t,this.mediaStream=n,this.callbacks=s,this.surface=this.createVideoElement(this.parentElement.clientWidth),t.append(this.surface)}return e.prototype.createVideoElement=function(t){var n=document.createElement("video");return n.style.width="".concat(t,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},e.prototype.setupSurface=function(){var t=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var s=t.surface.clientWidth,l=t.surface.clientHeight;t.callbacks.onRenderSurfaceReady(s,l),t.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(t,n,s,l){return Oc(this,void 0,void 0,function(){var f,m;return Lc(this,function(v){switch(v.label){case 0:return f=new e(t,n,l),s.aspectRatio?(m={aspectRatio:s.aspectRatio},[4,f.getFirstTrackOrFail().applyConstraints(m)]):[3,2];case 1:v.sent(),v.label=2;case 2:return f.setupSurface(),[2,f]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(t){this.failIfClosed();var n=this,s=function(){setTimeout(t,200),n.surface.removeEventListener("playing",s)};this.surface.addEventListener("playing",s),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(t){return Oc(this,void 0,void 0,function(){return Lc(this,function(n){if("aspectRatio"in t)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(t)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var t=this;return new Promise(function(n,s){var l=t.mediaStream.getVideoTracks(),f=l.length,m=0;t.mediaStream.getVideoTracks().forEach(function(v){t.mediaStream.removeTrack(v),v.stop(),++m,m>=f&&(t.isClosed=!0,t.parentElement.removeChild(t.surface),n())})})},e.prototype.getCapabilities=function(){return new $v(this.getFirstTrackOrFail())},e}(),Kv=function(){function e(t){this.mediaStream=t}return e.prototype.render=function(t,n,s){return Oc(this,void 0,void 0,function(){return Lc(this,function(l){return[2,Qv.create(t,this.mediaStream,n,s)]})})},e.create=function(t){return Oc(this,void 0,void 0,function(){var n,s;return Lc(this,function(l){switch(l.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:t},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return s=l.sent(),[2,new e(s)]}})})},e}(),s1=function(e,t,n,s){function l(f){return f instanceof n?f:new n(function(m){m(f)})}return new(n||(n=Promise))(function(f,m){function v(E){try{x(s.next(E))}catch(b){m(b)}}function _(E){try{x(s.throw(E))}catch(b){m(b)}}function x(E){E.done?f(E.value):l(E.value).then(v,_)}x((s=s.apply(e,t||[])).next())})},o1=function(e,t){var n={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},s,l,f,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(x){return function(E){return _([x,E])}}function _(x){if(s)throw new TypeError("Generator is already executing.");for(;m&&(m=0,x[0]&&(n=0)),n;)try{if(s=1,l&&(f=x[0]&2?l.return:x[0]?l.throw||((f=l.return)&&f.call(l),0):l.next)&&!(f=f.call(l,x[1])).done)return f;switch(l=0,f&&(x=[x[0]&2,f.value]),x[0]){case 0:case 1:f=x;break;case 4:return n.label++,{value:x[1],done:!1};case 5:n.label++,l=x[1],x=[0];continue;case 7:x=n.ops.pop(),n.trys.pop();continue;default:if(f=n.trys,!(f=f.length>0&&f[f.length-1])&&(x[0]===6||x[0]===2)){n=0;continue}if(x[0]===3&&(!f||x[1]>f[0]&&x[1]<f[3])){n.label=x[1];break}if(x[0]===6&&n.label<f[1]){n.label=f[1],f=x;break}if(f&&n.label<f[2]){n.label=f[2],n.ops.push(x);break}f[2]&&n.ops.pop(),n.trys.pop();continue}x=t.call(e,n)}catch(E){x=[6,E],l=0}finally{s=f=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},qv=function(){function e(){}return e.failIfNotSupported=function(){return s1(this,void 0,void 0,function(){return o1(this,function(t){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(t){return s1(this,void 0,void 0,function(){return o1(this,function(n){return[2,Kv.create(t)]})})},e}(),Jv=function(e,t,n,s){function l(f){return f instanceof n?f:new n(function(m){m(f)})}return new(n||(n=Promise))(function(f,m){function v(E){try{x(s.next(E))}catch(b){m(b)}}function _(E){try{x(s.throw(E))}catch(b){m(b)}}function x(E){E.done?f(E.value):l(E.value).then(v,_)}x((s=s.apply(e,t||[])).next())})},ew=function(e,t){var n={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},s,l,f,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(x){return function(E){return _([x,E])}}function _(x){if(s)throw new TypeError("Generator is already executing.");for(;m&&(m=0,x[0]&&(n=0)),n;)try{if(s=1,l&&(f=x[0]&2?l.return:x[0]?l.throw||((f=l.return)&&f.call(l),0):l.next)&&!(f=f.call(l,x[1])).done)return f;switch(l=0,f&&(x=[x[0]&2,f.value]),x[0]){case 0:case 1:f=x;break;case 4:return n.label++,{value:x[1],done:!1};case 5:n.label++,l=x[1],x=[0];continue;case 7:x=n.ops.pop(),n.trys.pop();continue;default:if(f=n.trys,!(f=f.length>0&&f[f.length-1])&&(x[0]===6||x[0]===2)){n=0;continue}if(x[0]===3&&(!f||x[1]>f[0]&&x[1]<f[3])){n.label=x[1];break}if(x[0]===6&&n.label<f[1]){n.label=f[1],f=x;break}if(f&&n.label<f[2]){n.label=f[2],n.ops.push(x);break}f[2]&&n.ops.pop(),n.trys.pop();continue}x=t.call(e,n)}catch(E){x=[6,E],l=0}finally{s=f=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},tw=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var t=MediaStreamTrack;return MediaStreamTrack&&t.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var t=Io.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(t=Io.insecureContextCameraQueryError()),Promise.reject(t)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var t=location.host.split(":")[0];return t==="127.0.0.1"||t==="localhost"},e.getCamerasFromMediaDevices=function(){return Jv(this,void 0,void 0,function(){var t,n,s,l,f,m,v;return ew(this,function(_){switch(_.label){case 0:return t=function(x){for(var E=x.getVideoTracks(),b=0,M=E;b<M.length;b++){var F=M[b];F.enabled=!1,F.stop(),x.removeTrack(F)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=_.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(s=_.sent(),l=[],f=0,m=s;f<m.length;f++)v=m[f],v.kind==="videoinput"&&l.push({id:v.deviceId,label:v.label});return t(n),[2,l]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(t,n){var s=function(f){for(var m=[],v=0,_=f;v<_.length;v++){var x=_[v];x.kind==="video"&&m.push({id:x.id,label:x.label})}t(m)},l=MediaStreamTrack;l.getSources(s)})},e}(),nn;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(nn||(nn={}));var nw=function(){function e(){this.state=nn.NOT_STARTED,this.onGoingTransactionNewState=nn.UNKNOWN}return e.prototype.directTransition=function(t){this.failIfTransitionOngoing(),this.validateTransition(t),this.state=t},e.prototype.startTransition=function(t){return this.failIfTransitionOngoing(),this.validateTransition(t),this.onGoingTransactionNewState=t,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===nn.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var t=this.onGoingTransactionNewState;this.onGoingTransactionNewState=nn.UNKNOWN,this.directTransition(t)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===nn.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=nn.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==nn.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(t){switch(this.state){case nn.UNKNOWN:throw"Transition from unknown is not allowed";case nn.NOT_STARTED:this.failIfNewStateIs(t,[nn.PAUSED]);break;case nn.SCANNING:break;case nn.PAUSED:break}},e.prototype.failIfNewStateIs=function(t,n){for(var s=0,l=n;s<l.length;s++){var f=l[s];if(t===f)throw"Cannot transition from ".concat(this.state," to ").concat(t)}},e}(),rw=function(){function e(t){this.stateManager=t}return e.prototype.startTransition=function(t){return this.stateManager.startTransition(t)},e.prototype.directTransition=function(t){this.stateManager.directTransition(t)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===nn.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==nn.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===nn.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===nn.PAUSED},e}(),iw=function(){function e(){}return e.create=function(){return new rw(new nw)},e}(),sw=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function s(){this.constructor=t}t.prototype=n===null?Object.create(n):(s.prototype=n.prototype,new s)}}(),Tr=function(e){sw(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.DEFAULT_WIDTH=300,t.DEFAULT_WIDTH_OFFSET=2,t.FILE_SCAN_MIN_HEIGHT=300,t.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,t.MIN_QR_BOX_SIZE=50,t.SHADED_LEFT=1,t.SHADED_RIGHT=2,t.SHADED_TOP=3,t.SHADED_BOTTOM=4,t.SHADED_REGION_ELEMENT_ID="qr-shaded-region",t.VERBOSE=!1,t.BORDER_SHADER_DEFAULT_COLOR="#ffffff",t.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",t}(ui),ow=function(){function e(t,n){this.logger=n,this.fps=Tr.SCAN_DEFAULT_FPS,t?(t.fps&&(this.fps=t.fps),this.disableFlip=t.disableFlip===!0,this.qrbox=t.qrbox,this.aspectRatio=t.aspectRatio,this.videoConstraints=t.videoConstraints):this.disableFlip=Tr.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?gm.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!Ii(this.qrbox)},e.create=function(t,n){return new e(t,n)},e}(),a1=function(){function e(t,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.elementId=t,this.verbose=!1;var s;typeof n=="boolean"?this.verbose=n===!0:n&&(s=n,this.verbose=s.verbose===!0,s.experimentalFeatures),this.logger=new pm(this.verbose),this.qrcode=new Zv(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(s),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=iw.create()}return e.prototype.start=function(t,n,s,l){var f=this;if(!t)throw"cameraIdOrConfig is required";if(!s||typeof s!="function")throw"qrCodeSuccessCallback is required and should be a function.";var m;l?m=l:m=this.verbose?this.logger.log:function(){};var v=ow.create(n,this.logger);this.clearElement();var _=!1;v.videoConstraints&&(v.isMediaStreamConstraintsValid()?_=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var x=_,E=document.getElementById(this.elementId);E.clientWidth?E.clientWidth:Tr.DEFAULT_WIDTH,E.style.position="relative",this.shouldScan=!0,this.element=E;var b=this,M=this.stateManagerProxy.startTransition(nn.SCANNING);return new Promise(function(F,z){var U=x?v.videoConstraints:b.createVideoConstraints(t);if(!U){M.cancel(),z("videoConstraints should be defined");return}var re={};(!x||v.aspectRatio)&&(re.aspectRatio=v.aspectRatio);var H={onRenderSurfaceReady:function(D,B){b.setupUi(D,B,v),b.isScanning=!0,b.foreverScan(v,s,m)}};qv.failIfNotSupported().then(function(D){D.create(U).then(function(B){return B.render(f.element,re,H).then(function($){b.renderedCamera=$,M.execute(),F(null)}).catch(function($){M.cancel(),z($)})}).catch(function(B){M.cancel(),z(Io.errorGettingUserMedia(B))})}).catch(function(D){M.cancel(),z(Io.cameraStreamingNotSupported())})})},e.prototype.pause=function(t){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(nn.PAUSED),this.showPausedState(),(Ii(t)||t!==!0)&&(t=!1),t&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var t=this,n=function(){t.stateManagerProxy.directTransition(nn.SCANNING),t.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var t=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(nn.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var s=function(){if(t.element){var f=document.getElementById(Tr.SHADED_REGION_ELEMENT_ID);f&&t.element.removeChild(f)}},l=this;return this.renderedCamera.close().then(function(){return l.renderedCamera=null,l.element&&(l.element.removeChild(l.canvasElement),l.canvasElement=null),s(),l.qrRegion&&(l.qrRegion=null),l.context&&(l.context=null),n.execute(),l.hidePausedState(),l.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(t,n){return this.scanFileV2(t,n).then(function(s){return s.decodedText})},e.prototype.scanFileV2=function(t,n){var s=this;if(!t||!(t instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Ii(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(l,f){s.possiblyCloseLastScanImageFile(),s.clearElement(),s.lastScanImageFile=URL.createObjectURL(t);var m=new Image;m.onload=function(){var v=m.width,_=m.height,x=document.getElementById(s.elementId),E=x.clientWidth?x.clientWidth:Tr.DEFAULT_WIDTH,b=Math.max(x.clientHeight?x.clientHeight:_,Tr.FILE_SCAN_MIN_HEIGHT),M=s.computeCanvasDrawConfig(v,_,E,b);if(n){var F=s.createCanvasElement(E,b,"qr-canvas-visible");F.style.display="inline-block",x.appendChild(F);var z=F.getContext("2d");if(!z)throw"Unable to get 2d context from canvas";z.canvas.width=E,z.canvas.height=b,z.drawImage(m,0,0,v,_,M.x,M.y,M.width,M.height)}var U=Tr.FILE_SCAN_HIDDEN_CANVAS_PADDING,re=Math.max(m.width,M.width),H=Math.max(m.height,M.height),D=re+2*U,B=H+2*U,$=s.createCanvasElement(D,B);x.appendChild($);var fe=$.getContext("2d");if(!fe)throw"Unable to get 2d context from canvas";fe.canvas.width=D,fe.canvas.height=B,fe.drawImage(m,0,0,v,_,U,U,re,H);try{s.qrcode.decodeRobustlyAsync($).then(function(pe){l(J0.createFromQrcodeResult(pe))}).catch(f)}catch(pe){f("QR code parse error, error = ".concat(pe))}},m.onerror=f,m.onabort=f,m.onstalled=f,m.onsuspend=f,m.src=URL.createObjectURL(t)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return tw.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(t){if(t){if(!gm.isMediaStreamConstraintsValid(t,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(t)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(t){var n=[Fe.QR_CODE,Fe.AZTEC,Fe.CODABAR,Fe.CODE_39,Fe.CODE_93,Fe.CODE_128,Fe.DATA_MATRIX,Fe.MAXICODE,Fe.ITF,Fe.EAN_13,Fe.EAN_8,Fe.PDF_417,Fe.RSS_14,Fe.RSS_EXPANDED,Fe.UPC_A,Fe.UPC_E,Fe.UPC_EAN_EXTENSION];if(!t||typeof t=="boolean"||!t.formatsToSupport)return n;if(!Array.isArray(t.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(t.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var s=[],l=0,f=t.formatsToSupport;l<f.length;l++){var m=f[l];jv(m)?s.push(m):this.logger.warn("Invalid format: ".concat(m," passed in config, ignoring."))}if(s.length===0)throw"None of formatsToSupport match supported values.";return s},e.prototype.getUseBarCodeDetectorIfSupported=function(t){if(Ii(t))return!0;if(!Ii(t.useBarCodeDetectorIfSupported))return t.useBarCodeDetectorIfSupported!==!1;if(Ii(t.experimentalFeatures))return!0;var n=t.experimentalFeatures;return Ii(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(t,n,s){var l=this,f=s.qrbox;this.validateQrboxConfig(f);var m=this.toQrdimensions(t,n,f),v=function(x){if(x<Tr.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Tr.MIN_QR_BOX_SIZE,"px.")},_=function(x){return x>t&&(l.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),x=t),x};v(m.width),v(m.height),m.width=_(m.width)},e.prototype.validateQrboxConfig=function(t){if(typeof t!="number"&&typeof t!="function"&&(t.width===void 0||t.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(t,n,s){if(typeof s=="number")return{width:s,height:s};if(typeof s=="function")try{return s(t,n)}catch(l){throw new Error("qrbox config was passed as a function but it failed with unknown error"+l)}return s},e.prototype.setupUi=function(t,n,s){s.isShadedBoxEnabled()&&this.validateQrboxSize(t,n,s);var l=Ii(s.qrbox)?{width:t,height:n}:s.qrbox;this.validateQrboxConfig(l);var f=this.toQrdimensions(t,n,l);f.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var m=s.isShadedBoxEnabled()&&f.height<=n,v={x:0,y:0,width:t,height:n},_=m?this.getShadedRegionBounds(t,n,f):v,x=this.createCanvasElement(_.width,_.height),E={willReadFrequently:!0},b=x.getContext("2d",E);b.canvas.width=_.width,b.canvas.height=_.height,this.element.append(x),m&&this.possiblyInsertShadingElement(this.element,t,n,f),this.createScannerPausedUiElement(this.element),this.qrRegion=_,this.context=b,this.canvasElement=x},e.prototype.createScannerPausedUiElement=function(t){var n=document.createElement("div");n.innerText=Io.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",t.appendChild(n),this.scannerPausedUiElement=n},e.prototype.scanContext=function(t,n){var s=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(l){return t(l.text,J0.createFromQrcodeResult(l)),s.possiblyUpdateShaders(!0),!0}).catch(function(l){s.possiblyUpdateShaders(!1);var f=Io.codeParseError(l);return n(f,dm.createFrom(f)),!1})},e.prototype.foreverScan=function(t,n,s){var l=this;if(this.shouldScan&&this.renderedCamera){var f=this.renderedCamera.getSurface(),m=f.videoWidth/f.clientWidth,v=f.videoHeight/f.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var _=this.qrRegion.width*m,x=this.qrRegion.height*v,E=this.qrRegion.x*m,b=this.qrRegion.y*v;this.context.drawImage(f,E,b,_,x,0,0,this.qrRegion.width,this.qrRegion.height);var M=function(){l.foreverScanTimeout=setTimeout(function(){l.foreverScan(t,n,s)},l.getTimeoutFps(t.fps))};this.scanContext(n,s).then(function(F){!F&&t.disableFlip!==!0?(l.context.translate(l.context.canvas.width,0),l.context.scale(-1,1),l.scanContext(n,s).finally(function(){M()})):M()}).catch(function(F){l.logger.logError("Error happend while scanning context",F),M()})}},e.prototype.createVideoConstraints=function(t){if(typeof t=="string")return{deviceId:{exact:t}};if(typeof t=="object"){var n="facingMode",s="deviceId",l={user:!0,environment:!0},f="exact",m=function(z){if(z in l)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(z,"'")},v=Object.keys(t);if(v.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(v.length," keys");var _=Object.keys(t)[0];if(_!==n&&_!==s)throw"Only '".concat(n,"' and '").concat(s,"' ")+" are supported for 'cameraIdOrConfig'";if(_===n){var x=t.facingMode;if(typeof x=="string"){if(m(x))return{facingMode:x}}else if(typeof x=="object")if(f in x){if(m(x["".concat(f)]))return{facingMode:{exact:x["".concat(f)]}}}else throw"'facingMode' should be string or object with"+" ".concat(f," as key.");else{var E=typeof x;throw"Invalid type of 'facingMode' = ".concat(E)}}else{var b=t.deviceId;if(typeof b=="string")return{deviceId:b};if(typeof b=="object"){if(f in b)return{deviceId:{exact:b["".concat(f)]}};throw"'deviceId' should be string or object with"+" ".concat(f," as key.")}else{var M=typeof b;throw"Invalid type of 'deviceId' = ".concat(M)}}}var F=typeof t;throw"Invalid type of 'cameraIdOrConfig' = ".concat(F)},e.prototype.computeCanvasDrawConfig=function(t,n,s,l){if(t<=s&&n<=l){var f=(s-t)/2,m=(l-n)/2;return{x:f,y:m,width:t,height:n}}else{var v=t,_=n;return t>s&&(n=s/t*n,t=s),n>l&&(t=l/n*t,n=l),this.logger.log("Image downsampled from "+"".concat(v,"X").concat(_)+" to ".concat(t,"X").concat(n,".")),this.computeCanvasDrawConfig(t,n,s,l)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var t=document.getElementById(this.elementId);t&&(t.innerHTML="")},e.prototype.possiblyUpdateShaders=function(t){this.qrMatch!==t&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=t?Tr.BORDER_SHADER_MATCH_COLOR:Tr.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=t)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(t,n,s){var l=t,f=n,m=document.createElement("canvas");return m.style.width="".concat(l,"px"),m.style.height="".concat(f,"px"),m.style.display="none",m.id=Ii(s)?"qr-canvas":s,m},e.prototype.getShadedRegionBounds=function(t,n,s){if(s.width>t||s.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(t-s.width)/2,y:(n-s.height)/2,width:s.width,height:s.height}},e.prototype.possiblyInsertShadingElement=function(t,n,s,l){if(!(n-l.width<1||s-l.height<1)){var f=document.createElement("div");f.style.position="absolute";var m=(n-l.width)/2,v=(s-l.height)/2;if(f.style.borderLeft="".concat(m,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderRight="".concat(m,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderTop="".concat(v,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderBottom="".concat(v,"px solid rgba(0, 0, 0, 0.48)"),f.style.boxSizing="border-box",f.style.top="0px",f.style.bottom="0px",f.style.left="0px",f.style.right="0px",f.id="".concat(Tr.SHADED_REGION_ELEMENT_ID),n-l.width<11||s-l.height<11)this.hasBorderShaders=!1;else{var _=5,x=40;this.insertShaderBorders(f,x,_,-_,null,0,!0),this.insertShaderBorders(f,x,_,-_,null,0,!1),this.insertShaderBorders(f,x,_,null,-_,0,!0),this.insertShaderBorders(f,x,_,null,-_,0,!1),this.insertShaderBorders(f,_,x+_,-_,null,-_,!0),this.insertShaderBorders(f,_,x+_,null,-_,-_,!0),this.insertShaderBorders(f,_,x+_,-_,null,-_,!1),this.insertShaderBorders(f,_,x+_,null,-_,-_,!1),this.hasBorderShaders=!0}t.append(f)}},e.prototype.insertShaderBorders=function(t,n,s,l,f,m,v){var _=document.createElement("div");_.style.position="absolute",_.style.backgroundColor=Tr.BORDER_SHADER_DEFAULT_COLOR,_.style.width="".concat(n,"px"),_.style.height="".concat(s,"px"),l!==null&&(_.style.top="".concat(l,"px")),f!==null&&(_.style.bottom="".concat(f,"px")),v?_.style.left="".concat(m,"px"):_.style.right="".concat(m,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(_),t.appendChild(_)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(t){return 1e3/t},e}(),od="data:image/svg+xml;base64,",aw=od+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",lw=od+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",l1=od+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",cw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",c1=function(){function e(){}return e.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},e}(),uw=function(){function e(){this.data=c1.createDefault();var t=localStorage.getItem(e.LOCAL_STORAGE_KEY);t?this.data=JSON.parse(t):this.reset()}return e.prototype.hasCameraPermissions=function(){return this.data.hasPermission},e.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},e.prototype.setHasPermission=function(t){this.data.hasPermission=t,this.flush()},e.prototype.setLastUsedCameraId=function(t){this.data.lastUsedCameraId=t,this.flush()},e.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},e.prototype.reset=function(){this.data=c1.createDefault(),this.flush()},e.prototype.flush=function(){localStorage.setItem(e.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},e.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",e}(),fw=function(){function e(){this.infoDiv=document.createElement("div")}return e.prototype.renderInto=function(t){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=e1.poweredBy();var n=document.createElement("a");n.innerText="ScanApp",n.href="https://scanapp.org",n.target="new",n.style.color="white",this.infoDiv.appendChild(n);var s=document.createElement("br"),l=document.createElement("br");this.infoDiv.appendChild(s),this.infoDiv.appendChild(l);var f=document.createElement("a");f.innerText=e1.reportIssues(),f.href="https://github.com/mebjas/html5-qrcode/issues",f.target="new",f.style.color="white",this.infoDiv.appendChild(f),t.appendChild(this.infoDiv)},e.prototype.show=function(){this.infoDiv.style.display="block"},e.prototype.hide=function(){this.infoDiv.style.display="none"},e}(),hw=function(){function e(t,n){this.isShowingInfoIcon=!0,this.onTapIn=t,this.onTapOut=n,this.infoIcon=document.createElement("img")}return e.prototype.renderInto=function(t){var n=this;this.infoIcon.alt="Info icon",this.infoIcon.src=l1,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(s){return n.onHoverIn()},this.infoIcon.onmouseout=function(s){return n.onHoverOut()},this.infoIcon.onclick=function(s){return n.onClick()},t.appendChild(this.infoIcon)},e.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},e.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},e.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=cw,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=l1,this.infoIcon.style.opacity="0.6")},e}(),dw=function(){function e(){var t=this;this.infoDiv=new fw,this.infoIcon=new hw(function(){t.infoDiv.show()},function(){t.infoDiv.hide()})}return e.prototype.renderInto=function(t){this.infoDiv.renderInto(t),this.infoIcon.renderInto(t)},e}(),pw=function(e,t,n,s){function l(f){return f instanceof n?f:new n(function(m){m(f)})}return new(n||(n=Promise))(function(f,m){function v(E){try{x(s.next(E))}catch(b){m(b)}}function _(E){try{x(s.throw(E))}catch(b){m(b)}}function x(E){E.done?f(E.value):l(E.value).then(v,_)}x((s=s.apply(e,t||[])).next())})},gw=function(e,t){var n={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},s,l,f,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(x){return function(E){return _([x,E])}}function _(x){if(s)throw new TypeError("Generator is already executing.");for(;m&&(m=0,x[0]&&(n=0)),n;)try{if(s=1,l&&(f=x[0]&2?l.return:x[0]?l.throw||((f=l.return)&&f.call(l),0):l.next)&&!(f=f.call(l,x[1])).done)return f;switch(l=0,f&&(x=[x[0]&2,f.value]),x[0]){case 0:case 1:f=x;break;case 4:return n.label++,{value:x[1],done:!1};case 5:n.label++,l=x[1],x=[0];continue;case 7:x=n.ops.pop(),n.trys.pop();continue;default:if(f=n.trys,!(f=f.length>0&&f[f.length-1])&&(x[0]===6||x[0]===2)){n=0;continue}if(x[0]===3&&(!f||x[1]>f[0]&&x[1]<f[3])){n.label=x[1];break}if(x[0]===6&&n.label<f[1]){n.label=f[1],f=x;break}if(f&&n.label<f[2]){n.label=f[2],n.ops.push(x);break}f[2]&&n.ops.pop(),n.trys.pop();continue}x=t.call(e,n)}catch(E){x=[6,E],l=0}finally{s=f=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},u1=function(){function e(){}return e.hasPermissions=function(){return pw(this,void 0,void 0,function(){var t,n,s,l;return gw(this,function(f){switch(f.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(t=f.sent(),n=0,s=t;n<s.length;n++)if(l=s[n],l.kind==="videoinput"&&l.label)return[2,!0];return[2,!1]}})})},e}(),as=function(){function e(t){this.supportedScanTypes=this.validateAndReturnScanTypes(t)}return e.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},e.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},e.prototype.isCameraScanRequired=function(){for(var t=0,n=this.supportedScanTypes;t<n.length;t++){var s=n[t];if(e.isCameraScanType(s))return!0}return!1},e.isCameraScanType=function(t){return t===Ts.SCAN_TYPE_CAMERA},e.isFileScanType=function(t){return t===Ts.SCAN_TYPE_FILE},e.prototype.validateAndReturnScanTypes=function(t){if(!t||t.length===0)return ui.DEFAULT_SUPPORTED_SCAN_TYPE;var n=ui.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(t.length>n)throw"Max ".concat(n," values expected for ")+"supportedScanTypes";for(var s=0,l=t;s<l.length;s++){var f=l[s];if(!ui.DEFAULT_SUPPORTED_SCAN_TYPE.includes(f))throw"Unsupported scan type ".concat(f)}return t},e}(),Mr=function(){function e(){}return e.ALL_ELEMENT_CLASS="html5-qrcode-element",e.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",e.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",e.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",e.TORCH_BUTTON_ID="html5-qrcode-button-torch",e.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",e.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",e.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",e.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",e.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",e.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",e}(),Zi=function(){function e(){}return e.createElement=function(t,n){var s=document.createElement(t);return s.id=n,s.classList.add(Mr.ALL_ELEMENT_CLASS),t==="button"&&s.setAttribute("type","button"),s},e}(),xm=function(e,t,n,s){function l(f){return f instanceof n?f:new n(function(m){m(f)})}return new(n||(n=Promise))(function(f,m){function v(E){try{x(s.next(E))}catch(b){m(b)}}function _(E){try{x(s.throw(E))}catch(b){m(b)}}function x(E){E.done?f(E.value):l(E.value).then(v,_)}x((s=s.apply(e,t||[])).next())})},ym=function(e,t){var n={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},s,l,f,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(x){return function(E){return _([x,E])}}function _(x){if(s)throw new TypeError("Generator is already executing.");for(;m&&(m=0,x[0]&&(n=0)),n;)try{if(s=1,l&&(f=x[0]&2?l.return:x[0]?l.throw||((f=l.return)&&f.call(l),0):l.next)&&!(f=f.call(l,x[1])).done)return f;switch(l=0,f&&(x=[x[0]&2,f.value]),x[0]){case 0:case 1:f=x;break;case 4:return n.label++,{value:x[1],done:!1};case 5:n.label++,l=x[1],x=[0];continue;case 7:x=n.ops.pop(),n.trys.pop();continue;default:if(f=n.trys,!(f=f.length>0&&f[f.length-1])&&(x[0]===6||x[0]===2)){n=0;continue}if(x[0]===3&&(!f||x[1]>f[0]&&x[1]<f[3])){n.label=x[1];break}if(x[0]===6&&n.label<f[1]){n.label=f[1],f=x;break}if(f&&n.label<f[2]){n.label=f[2],n.ops.push(x);break}f[2]&&n.ops.pop(),n.trys.pop();continue}x=t.call(e,n)}catch(E){x=[6,E],l=0}finally{s=f=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},f1=function(){function e(t,n,s){this.isTorchOn=!1,this.torchCapability=t,this.buttonController=n,this.onTorchActionFailureCallback=s}return e.prototype.isTorchEnabled=function(){return this.isTorchOn},e.prototype.flipState=function(){return xm(this,void 0,void 0,function(){var t,n;return ym(this,function(s){switch(s.label){case 0:this.buttonController.disable(),t=!this.isTorchOn,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.torchCapability.apply(t)];case 2:return s.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),t),[3,4];case 3:return n=s.sent(),this.propagateFailure(t,n),this.buttonController.enable(),[3,4];case 4:return[2]}})})},e.prototype.updateUiBasedOnLatestSettings=function(t,n){t===n?(this.buttonController.setText(n?At.torchOffButton():At.torchOnButton()),this.isTorchOn=n):this.propagateFailure(n),this.buttonController.enable()},e.prototype.propagateFailure=function(t,n){var s=t?At.torchOnFailedMessage():At.torchOffFailedMessage();n&&(s+="; Error = "+n),this.onTorchActionFailureCallback(s)},e.prototype.reset=function(){this.isTorchOn=!1},e}(),mw=function(){function e(t,n){this.onTorchActionFailureCallback=n,this.torchButton=Zi.createElement("button",Mr.TORCH_BUTTON_ID),this.torchController=new f1(t,this,n)}return e.prototype.render=function(t,n){var s=this;this.torchButton.innerText=At.torchOnButton(),this.torchButton.style.display=n.display,this.torchButton.style.marginLeft=n.marginLeft;var l=this;this.torchButton.addEventListener("click",function(f){return xm(s,void 0,void 0,function(){return ym(this,function(m){switch(m.label){case 0:return[4,l.torchController.flipState()];case 1:return m.sent(),l.torchController.isTorchEnabled()?(l.torchButton.classList.remove(Mr.TORCH_BUTTON_CLASS_TORCH_OFF),l.torchButton.classList.add(Mr.TORCH_BUTTON_CLASS_TORCH_ON)):(l.torchButton.classList.remove(Mr.TORCH_BUTTON_CLASS_TORCH_ON),l.torchButton.classList.add(Mr.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),t.appendChild(this.torchButton)},e.prototype.updateTorchCapability=function(t){this.torchController=new f1(t,this,this.onTorchActionFailureCallback)},e.prototype.getTorchButton=function(){return this.torchButton},e.prototype.hide=function(){this.torchButton.style.display="none"},e.prototype.show=function(){this.torchButton.style.display="inline-block"},e.prototype.disable=function(){this.torchButton.disabled=!0},e.prototype.enable=function(){this.torchButton.disabled=!1},e.prototype.setText=function(t){this.torchButton.innerText=t},e.prototype.reset=function(){this.torchButton.innerText=At.torchOnButton(),this.torchController.reset()},e.create=function(t,n,s,l){var f=new e(n,l);return f.render(t,s),f},e}(),xw=function(){function e(t,n,s){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=n?"block":"none",t.appendChild(this.fileBasedScanRegion);var l=document.createElement("label");l.setAttribute("for",this.getFileScanInputId()),l.style.display="inline-block",this.fileBasedScanRegion.appendChild(l),this.fileSelectionButton=Zi.createElement("button",Mr.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(v){l.click()}),l.append(this.fileSelectionButton),this.fileScanInput=Zi.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",l.appendChild(this.fileScanInput);var f=this;this.fileScanInput.addEventListener("change",function(v){if(!(v==null||v.target==null)){var _=v.target;if(!(_.files&&_.files.length===0)){var x=_.files,E=x[0],b=E.name;f.setImageNameToButton(b),s(E)}}});var m=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(m),this.fileBasedScanRegion.addEventListener("dragenter",function(v){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionActiveBorder(),v.stopPropagation(),v.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(v){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionDefaultBorder(),v.stopPropagation(),v.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(v){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionActiveBorder(),v.stopPropagation(),v.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(v){v.stopPropagation(),v.preventDefault(),f.fileBasedScanRegion.style.border=f.fileBasedScanRegionDefaultBorder();var _=v.dataTransfer;if(_){var x=_.files;if(!x||x.length===0)return;for(var E=!1,b=0;b<x.length;++b){var M=x.item(b);if(M){var F=/image.*/;if(M.type.match(F)){E=!0;var z=M.name;f.setImageNameToButton(z),s(M),m.innerText=At.dragAndDropMessage();break}}}E||(m.innerText=At.dragAndDropMessageOnlyImages())}})}return e.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},e.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},e.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},e.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},e.prototype.createFileBasedScanRegion=function(){var t=document.createElement("div");return t.style.textAlign="center",t.style.margin="auto",t.style.width="80%",t.style.maxWidth="600px",t.style.border=this.fileBasedScanRegionDefaultBorder(),t.style.padding="10px",t.style.marginBottom="10px",t},e.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},e.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},e.prototype.createDragAndDropMessage=function(){var t=document.createElement("div");return t.innerText=At.dragAndDropMessage(),t.style.fontWeight="400",t},e.prototype.setImageNameToButton=function(t){var n=20;if(t.length>n){var s=t.substring(0,8),l=t.length,f=t.substring(l-8,l);t="".concat(s,"....").concat(f)}var m=At.fileSelectionChooseAnother()+" - "+t;this.fileSelectionButton.innerText=m},e.prototype.setInitialValueToButton=function(){var t=At.fileSelectionChooseImage()+" - "+At.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=t},e.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},e.create=function(t,n,s){var l=new e(t,n,s);return l},e}(),yw=function(){function e(t){this.selectElement=Zi.createElement("select",Mr.CAMERA_SELECTION_SELECT_ID),this.cameras=t,this.options=[]}return e.prototype.render=function(t){var n=document.createElement("span");n.style.marginRight="10px";var s=this.cameras.length;if(s===0)throw new Error("No cameras found");if(s===1)n.style.display="none";else{var l=At.selectCamera();n.innerText="".concat(l," (").concat(this.cameras.length,")  ")}for(var f=1,m=0,v=this.cameras;m<v.length;m++){var _=v[m],x=_.id,E=_.label==null?x:_.label;(!E||E==="")&&(E=[At.anonymousCameraPrefix(),f++].join(" "));var b=document.createElement("option");b.value=x,b.innerText=E,this.options.push(b),this.selectElement.appendChild(b)}n.appendChild(this.selectElement),t.appendChild(n)},e.prototype.disable=function(){this.selectElement.disabled=!0},e.prototype.isDisabled=function(){return this.selectElement.disabled===!0},e.prototype.enable=function(){this.selectElement.disabled=!1},e.prototype.getValue=function(){return this.selectElement.value},e.prototype.hasValue=function(t){for(var n=0,s=this.options;n<s.length;n++){var l=s[n];if(l.value===t)return!0}return!1},e.prototype.setValue=function(t){if(!this.hasValue(t))throw new Error("".concat(t," is not present in the camera list."));this.selectElement.value=t},e.prototype.hasSingleItem=function(){return this.cameras.length===1},e.prototype.numCameras=function(){return this.cameras.length},e.create=function(t,n){var s=new e(n);return s.render(t),s},e}(),_w=function(){function e(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=Zi.createElement("input",Mr.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return e.prototype.render=function(t,n){this.zoomElementContainer.style.display=n?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",t.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var s=At.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(s),this.rangeText.style.marginRight="10px";var l=this;this.rangeInput.addEventListener("input",function(){return l.onValueChange()}),this.rangeInput.addEventListener("change",function(){return l.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},e.prototype.onValueChange=function(){var t=At.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(t),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},e.prototype.setValues=function(t,n,s,l){this.rangeInput.min=t.toString(),this.rangeInput.max=n.toString(),this.rangeInput.step=l.toString(),this.rangeInput.value=s.toString(),this.onValueChange()},e.prototype.show=function(){this.zoomElementContainer.style.display="block"},e.prototype.hide=function(){this.zoomElementContainer.style.display="none"},e.prototype.setOnCameraZoomValueChangeCallback=function(t){this.onChangeCallback=t},e.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},e.create=function(t,n){var s=new e;return s.render(t,n),s},e}(),Ir;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Ir||(Ir={}));function vw(e){return{fps:e.fps,qrbox:e.qrbox,aspectRatio:e.aspectRatio,disableFlip:e.disableFlip,videoConstraints:e.videoConstraints}}function ww(e,t){return{formatsToSupport:e.formatsToSupport,useBarCodeDetectorIfSupported:e.useBarCodeDetectorIfSupported,experimentalFeatures:e.experimentalFeatures,verbose:t}}var Cw=function(){function e(t,n,s){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=t,this.config=this.createConfig(n),this.verbose=s===!0,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.scanTypeSelector=new as(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new pm(this.verbose),this.persistedDataManager=new uw,n.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return e.prototype.render=function(t,n){var s=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(f,m){if(t)t(f,m);else{if(s.lastMatchFound===f)return;s.lastMatchFound=f,s.setHeaderMessage(At.lastMatch(f),Ir.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(f,m){n&&n(f,m)};var l=document.getElementById(this.elementId);if(!l)throw"HTML Element with id=".concat(this.elementId," not found");l.innerHTML="",this.createBasicLayout(l),this.html5Qrcode=new a1(this.getScanRegionId(),ww(this.config,this.verbose))},e.prototype.pause=function(t){(Ii(t)||t!==!0)&&(t=!1),this.getHtml5QrcodeOrFail().pause(t)},e.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},e.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},e.prototype.clear=function(){var t=this,n=function(){var s=document.getElementById(t.elementId);s&&(s.innerHTML="",t.resetBasicLayout(s))};return this.html5Qrcode?new Promise(function(s,l){if(!t.html5Qrcode){s();return}t.html5Qrcode.isScanning?t.html5Qrcode.stop().then(function(f){if(!t.html5Qrcode){s();return}t.html5Qrcode.clear(),n(),s()}).catch(function(f){t.verbose&&t.logger.logError("Unable to stop qrcode scanner",f),l(f)}):(t.html5Qrcode.clear(),n(),s())}):Promise.resolve()},e.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},e.prototype.applyVideoConstraints=function(t){return this.getHtml5QrcodeOrFail().applyVideoConstraints(t)},e.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},e.prototype.createConfig=function(t){return t?(t.fps||(t.fps=ui.SCAN_DEFAULT_FPS),t.rememberLastUsedCamera!==!ui.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(t.rememberLastUsedCamera=ui.DEFAULT_REMEMBER_LAST_CAMERA_USED),t.supportedScanTypes||(t.supportedScanTypes=ui.DEFAULT_SUPPORTED_SCAN_TYPE),t):{fps:ui.SCAN_DEFAULT_FPS,rememberLastUsedCamera:ui.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:ui.DEFAULT_SUPPORTED_SCAN_TYPE}},e.prototype.createBasicLayout=function(t){t.style.position="relative",t.style.padding="0px",t.style.border="1px solid silver",this.createHeader(t);var n=document.createElement("div"),s=this.getScanRegionId();n.id=s,n.style.width="100%",n.style.minHeight="100px",n.style.textAlign="center",t.appendChild(n),as.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var l=document.createElement("div"),f=this.getDashboardId();l.id=f,l.style.width="100%",t.appendChild(l),this.setupInitialDashboard(l)},e.prototype.resetBasicLayout=function(t){t.style.border="none"},e.prototype.setupInitialDashboard=function(t){this.createSection(t),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},e.prototype.createHeader=function(t){var n=document.createElement("div");n.style.textAlign="left",n.style.margin="0px",t.appendChild(n);var s=new dw;s.renderInto(n);var l=document.createElement("div");l.id=this.getHeaderMessageContainerId(),l.style.display="none",l.style.textAlign="center",l.style.fontSize="14px",l.style.padding="2px 10px",l.style.margin="4px",l.style.borderTop="1px solid #f6f6f6",n.appendChild(l)},e.prototype.createSection=function(t){var n=document.createElement("div");n.id=this.getDashboardSectionId(),n.style.width="100%",n.style.padding="10px 0px 10px 0px",n.style.textAlign="left",t.appendChild(n)},e.prototype.createCameraListUi=function(t,n,s){var l=this;l.showHideScanTypeSwapLink(!1),l.setHeaderMessage(At.cameraPermissionRequesting());var f=function(){s||l.createPermissionButton(t,n)};a1.getCameras().then(function(m){l.persistedDataManager.setHasPermission(!0),l.showHideScanTypeSwapLink(!0),l.resetHeaderMessage(),m&&m.length>0?(t.removeChild(n),l.renderCameraSelection(m)):(l.setHeaderMessage(At.noCameraFound(),Ir.STATUS_WARNING),f())}).catch(function(m){l.persistedDataManager.setHasPermission(!1),s?s.disabled=!1:f(),l.setHeaderMessage(m,Ir.STATUS_WARNING),l.showHideScanTypeSwapLink(!0)})},e.prototype.createPermissionButton=function(t,n){var s=this,l=Zi.createElement("button",this.getCameraPermissionButtonId());l.innerText=At.cameraPermissionTitle(),l.addEventListener("click",function(){l.disabled=!0,s.createCameraListUi(t,n,l)}),n.appendChild(l)},e.prototype.createPermissionsUi=function(t,n){var s=this;if(as.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){u1.hasPermissions().then(function(l){l?s.createCameraListUi(t,n):(s.persistedDataManager.setHasPermission(!1),s.createPermissionButton(t,n))}).catch(function(l){s.persistedDataManager.setHasPermission(!1),s.createPermissionButton(t,n)});return}this.createPermissionButton(t,n)},e.prototype.createSectionControlPanel=function(){var t=document.getElementById(this.getDashboardSectionId()),n=document.createElement("div");t.appendChild(n);var s=document.createElement("div");s.id=this.getDashboardSectionCameraScanRegionId(),s.style.display=as.isCameraScanType(this.currentScanType)?"block":"none",n.appendChild(s);var l=document.createElement("div");l.style.textAlign="center",s.appendChild(l),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(s,l),this.renderFileScanUi(n)},e.prototype.renderFileScanUi=function(t){var n=as.isFileScanType(this.currentScanType),s=this,l=function(f){if(!s.html5Qrcode)throw"html5Qrcode not defined";as.isFileScanType(s.currentScanType)&&(s.setHeaderMessage(At.loadingImage()),s.html5Qrcode.scanFileV2(f,!0).then(function(m){s.resetHeaderMessage(),s.qrCodeSuccessCallback(m.decodedText,m)}).catch(function(m){s.setHeaderMessage(m,Ir.STATUS_WARNING),s.qrCodeErrorCallback(m,dm.createFrom(m))}))};this.fileSelectionUi=xw.create(t,n,l)},e.prototype.renderCameraSelection=function(t){var n=this,s=this,l=document.getElementById(this.getDashboardSectionCameraScanRegionId());l.style.textAlign="center";var f=_w.create(l,!1),m=function(U){var re=U.zoomFeature();if(re.isSupported()){f.setOnCameraZoomValueChangeCallback(function(D){re.apply(D)});var H=1;n.config.defaultZoomValueIfSupported&&(H=n.config.defaultZoomValueIfSupported),H=zv(H,re.min(),re.max()),f.setValues(re.min(),re.max(),H,re.step()),f.show()}},v=yw.create(l,t),_=document.createElement("span"),x=Zi.createElement("button",Mr.CAMERA_START_BUTTON_ID);x.innerText=At.scanButtonStartScanningText(),_.appendChild(x);var E=Zi.createElement("button",Mr.CAMERA_STOP_BUTTON_ID);E.innerText=At.scanButtonStopScanningText(),E.style.display="none",E.disabled=!0,_.appendChild(E);var b,M=function(U){if(!U.torchFeature().isSupported()){b&&b.hide();return}b?b.updateTorchCapability(U.torchFeature()):b=mw.create(_,U.torchFeature(),{display:"none",marginLeft:"5px"},function(re){s.setHeaderMessage(re,Ir.STATUS_WARNING)}),b.show()};l.appendChild(_);var F=function(U){U||(x.style.display="none"),x.innerText=At.scanButtonStartScanningText(),x.style.opacity="1",x.disabled=!1,U&&(x.style.display="inline-block")};if(x.addEventListener("click",function(U){x.innerText=At.scanButtonScanningStarting(),v.disable(),x.disabled=!0,x.style.opacity="0.5",n.scanTypeSelector.hasMoreThanOneScanType()&&s.showHideScanTypeSwapLink(!1),s.resetHeaderMessage();var re=v.getValue();s.persistedDataManager.setLastUsedCameraId(re),s.html5Qrcode.start(re,vw(s.config),s.qrCodeSuccessCallback,s.qrCodeErrorCallback).then(function(H){E.disabled=!1,E.style.display="inline-block",F(!1);var D=s.html5Qrcode.getRunningTrackCameraCapabilities();n.config.showTorchButtonIfSupported===!0&&M(D),n.config.showZoomSliderIfSupported===!0&&m(D)}).catch(function(H){s.showHideScanTypeSwapLink(!0),v.enable(),F(!0),s.setHeaderMessage(H,Ir.STATUS_WARNING)})}),v.hasSingleItem()&&x.click(),E.addEventListener("click",function(U){if(!s.html5Qrcode)throw"html5Qrcode not defined";E.disabled=!0,s.html5Qrcode.stop().then(function(re){n.scanTypeSelector.hasMoreThanOneScanType()&&s.showHideScanTypeSwapLink(!0),v.enable(),x.disabled=!1,E.style.display="none",x.style.display="inline-block",b&&(b.reset(),b.hide()),f.removeOnCameraZoomValueChangeCallback(),f.hide(),s.insertCameraScanImageToScanRegion()}).catch(function(re){E.disabled=!1,s.setHeaderMessage(re,Ir.STATUS_WARNING)})}),s.persistedDataManager.getLastUsedCameraId()){var z=s.persistedDataManager.getLastUsedCameraId();v.hasValue(z)?(v.setValue(z),x.click()):s.persistedDataManager.resetLastUsedCameraId()}},e.prototype.createSectionSwap=function(){var t=this,n=At.textIfCameraScanSelected(),s=At.textIfFileScanSelected(),l=document.getElementById(this.getDashboardSectionId()),f=document.createElement("div");f.style.textAlign="center";var m=Zi.createElement("span",this.getDashboardSectionSwapLinkId());m.style.textDecoration="underline",m.style.cursor="pointer",m.innerText=as.isCameraScanType(this.currentScanType)?n:s,m.addEventListener("click",function(){if(!t.sectionSwapAllowed){t.verbose&&t.logger.logError("Section swap called when not allowed");return}t.resetHeaderMessage(),t.fileSelectionUi.resetValue(),t.sectionSwapAllowed=!1,as.isCameraScanType(t.currentScanType)?(t.clearScanRegion(),t.getCameraScanRegion().style.display="none",t.fileSelectionUi.show(),m.innerText=s,t.currentScanType=Ts.SCAN_TYPE_FILE,t.insertFileScanImageToScanRegion()):(t.clearScanRegion(),t.getCameraScanRegion().style.display="block",t.fileSelectionUi.hide(),m.innerText=n,t.currentScanType=Ts.SCAN_TYPE_CAMERA,t.insertCameraScanImageToScanRegion(),t.startCameraScanIfPermissionExistsOnSwap()),t.sectionSwapAllowed=!0}),f.appendChild(m),l.appendChild(f)},e.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var t=this,n=this;if(this.persistedDataManager.hasCameraPermissions()){u1.hasPermissions().then(function(s){if(s){var l=document.getElementById(n.getCameraPermissionButtonId());if(!l)throw t.logger.logError("Permission button not found, fail;"),"Permission button not found";l.click()}else n.persistedDataManager.setHasPermission(!1)}).catch(function(s){n.persistedDataManager.setHasPermission(!1)});return}},e.prototype.resetHeaderMessage=function(){var t=document.getElementById(this.getHeaderMessageContainerId());t.style.display="none"},e.prototype.setHeaderMessage=function(t,n){n||(n=Ir.STATUS_DEFAULT);var s=this.getHeaderMessageDiv();switch(s.innerText=t,s.style.display="block",n){case Ir.STATUS_SUCCESS:s.style.background="rgba(106, 175, 80, 0.26)",s.style.color="#477735";break;case Ir.STATUS_WARNING:s.style.background="rgba(203, 36, 49, 0.14)",s.style.color="#cb2431";break;case Ir.STATUS_DEFAULT:default:s.style.background="rgba(0, 0, 0, 0)",s.style.color="rgb(17, 17, 17)";break}},e.prototype.showHideScanTypeSwapLink=function(t){this.scanTypeSelector.hasMoreThanOneScanType()&&(t!==!0&&(t=!1),this.sectionSwapAllowed=t,this.getDashboardSectionSwapLink().style.display=t?"inline-block":"none")},e.prototype.insertCameraScanImageToScanRegion=function(){var t=this,n=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){n.innerHTML="<br>",n.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(s){n.innerHTML="<br>",n.appendChild(t.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=aw,this.cameraScanImage.alt=At.cameraScanAltText()},e.prototype.insertFileScanImageToScanRegion=function(){var t=this,n=document.getElementById(this.getScanRegionId());if(this.fileScanImage){n.innerHTML="<br>",n.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(s){n.innerHTML="<br>",n.appendChild(t.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=lw,this.fileScanImage.alt=At.fileScanAltText()},e.prototype.clearScanRegion=function(){var t=document.getElementById(this.getScanRegionId());t.innerHTML=""},e.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},e.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},e.prototype.getDashboardSectionSwapLinkId=function(){return Mr.SCAN_TYPE_CHANGE_ANCHOR_ID},e.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},e.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},e.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},e.prototype.getCameraPermissionButtonId=function(){return Mr.CAMERA_PERMISSION_BUTTON_ID},e.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},e.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},e.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},e}();class Ew{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(t){this.flush(),this._parts.push(t)}append(t){this._pieces.push(t)}flush(){if(this._pieces.length>0){const t=new Uint8Array(this._pieces);this._parts.push(t),this._pieces=[]}}toArrayBuffer(){const t=[];for(const n of this._parts)t.push(n);return bw(t).buffer}}function bw(e){let t=0;for(const l of e)t+=l.byteLength;const n=new Uint8Array(t);let s=0;for(const l of e){const f=new Uint8Array(l.buffer,l.byteOffset,l.byteLength);n.set(f,s),s+=l.byteLength}return n}function _m(e){return new Sw(e).unpack()}function vm(e){const t=new Aw,n=t.pack(e);return n instanceof Promise?n.then(()=>t.getBuffer()):t.getBuffer()}class Sw{constructor(t){this.index=0,this.dataBuffer=t,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const t=this.unpack_uint8();if(t<128)return t;if((t^224)<32)return(t^224)-32;let n;if((n=t^160)<=15)return this.unpack_raw(n);if((n=t^176)<=15)return this.unpack_string(n);if((n=t^144)<=15)return this.unpack_array(n);if((n=t^128)<=15)return this.unpack_map(n);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return n=this.unpack_uint16(),this.unpack_string(n);case 217:return n=this.unpack_uint32(),this.unpack_string(n);case 218:return n=this.unpack_uint16(),this.unpack_raw(n);case 219:return n=this.unpack_uint32(),this.unpack_raw(n);case 220:return n=this.unpack_uint16(),this.unpack_array(n);case 221:return n=this.unpack_uint32(),this.unpack_array(n);case 222:return n=this.unpack_uint16(),this.unpack_map(n);case 223:return n=this.unpack_uint32(),this.unpack_map(n)}}unpack_uint8(){const t=this.dataView[this.index]&255;return this.index++,t}unpack_uint16(){const t=this.read(2),n=(t[0]&255)*256+(t[1]&255);return this.index+=2,n}unpack_uint32(){const t=this.read(4),n=((t[0]*256+t[1])*256+t[2])*256+t[3];return this.index+=4,n}unpack_uint64(){const t=this.read(8),n=((((((t[0]*256+t[1])*256+t[2])*256+t[3])*256+t[4])*256+t[5])*256+t[6])*256+t[7];return this.index+=8,n}unpack_int8(){const t=this.unpack_uint8();return t<128?t:t-256}unpack_int16(){const t=this.unpack_uint16();return t<32768?t:t-65536}unpack_int32(){const t=this.unpack_uint32();return t<2**31?t:t-2**32}unpack_int64(){const t=this.unpack_uint64();return t<2**63?t:t-2**64}unpack_raw(t){if(this.length<this.index+t)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${t} ${this.length}`);const n=this.dataBuffer.slice(this.index,this.index+t);return this.index+=t,n}unpack_string(t){const n=this.read(t);let s=0,l="",f,m;for(;s<t;)f=n[s],f<160?(m=f,s++):(f^192)<32?(m=(f&31)<<6|n[s+1]&63,s+=2):(f^224)<16?(m=(f&15)<<12|(n[s+1]&63)<<6|n[s+2]&63,s+=3):(m=(f&7)<<18|(n[s+1]&63)<<12|(n[s+2]&63)<<6|n[s+3]&63,s+=4),l+=String.fromCodePoint(m);return this.index+=t,l}unpack_array(t){const n=new Array(t);for(let s=0;s<t;s++)n[s]=this.unpack();return n}unpack_map(t){const n={};for(let s=0;s<t;s++){const l=this.unpack();n[l]=this.unpack()}return n}unpack_float(){const t=this.unpack_uint32(),n=t>>31,s=(t>>23&255)-127,l=t&8388607|8388608;return(n===0?1:-1)*l*2**(s-23)}unpack_double(){const t=this.unpack_uint32(),n=this.unpack_uint32(),s=t>>31,l=(t>>20&2047)-1023,m=(t&1048575|1048576)*2**(l-20)+n*2**(l-52);return(s===0?1:-1)*m}read(t){const n=this.index;if(n+t<=this.length)return this.dataView.subarray(n,n+t);throw new Error("BinaryPackFailure: read index out of range")}}class Aw{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(t){if(typeof t=="string")this.pack_string(t);else if(typeof t=="number")Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if(typeof t=="boolean")t===!0?this._bufferBuilder.append(195):t===!1&&this._bufferBuilder.append(194);else if(t===void 0)this._bufferBuilder.append(192);else if(typeof t=="object")if(t===null)this._bufferBuilder.append(192);else{const n=t.constructor;if(t instanceof Array){const s=this.pack_array(t);if(s instanceof Promise)return s.then(()=>this._bufferBuilder.flush())}else if(t instanceof ArrayBuffer)this.pack_bin(new Uint8Array(t));else if("BYTES_PER_ELEMENT"in t){const s=t;this.pack_bin(new Uint8Array(s.buffer,s.byteOffset,s.byteLength))}else if(t instanceof Date)this.pack_string(t.toString());else{if(t instanceof Blob)return t.arrayBuffer().then(s=>{this.pack_bin(new Uint8Array(s)),this._bufferBuilder.flush()});if(n==Object||n.toString().startsWith("class")){const s=this.pack_object(t);if(s instanceof Promise)return s.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${n.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof t}" not yet supported`);this._bufferBuilder.flush()}pack_bin(t){const n=t.length;if(n<=15)this.pack_uint8(160+n);else if(n<=65535)this._bufferBuilder.append(218),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(n);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(t)}pack_string(t){const n=this._textEncoder.encode(t),s=n.length;if(s<=15)this.pack_uint8(176+s);else if(s<=65535)this._bufferBuilder.append(216),this.pack_uint16(s);else if(s<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(s);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(n)}pack_array(t){const n=t.length;if(n<=15)this.pack_uint8(144+n);else if(n<=65535)this._bufferBuilder.append(220),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(n);else throw new Error("Invalid length");const s=l=>{if(l<n){const f=this.pack(t[l]);return f instanceof Promise?f.then(()=>s(l+1)):s(l+1)}};return s(0)}pack_integer(t){if(t>=-32&&t<=127)this._bufferBuilder.append(t&255);else if(t>=0&&t<=255)this._bufferBuilder.append(204),this.pack_uint8(t);else if(t>=-128&&t<=127)this._bufferBuilder.append(208),this.pack_int8(t);else if(t>=0&&t<=65535)this._bufferBuilder.append(205),this.pack_uint16(t);else if(t>=-32768&&t<=32767)this._bufferBuilder.append(209),this.pack_int16(t);else if(t>=0&&t<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(t);else if(t>=-2147483648&&t<=2147483647)this._bufferBuilder.append(210),this.pack_int32(t);else if(t>=-9223372036854776e3&&t<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(t);else if(t>=0&&t<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(t);else throw new Error("Invalid integer")}pack_double(t){let n=0;t<0&&(n=1,t=-t);const s=Math.floor(Math.log(t)/Math.LN2),l=t/2**s-1,f=Math.floor(l*2**52),m=2**32,v=n<<31|s+1023<<20|f/m&1048575,_=f%m;this._bufferBuilder.append(203),this.pack_int32(v),this.pack_int32(_)}pack_object(t){const n=Object.keys(t),s=n.length;if(s<=15)this.pack_uint8(128+s);else if(s<=65535)this._bufferBuilder.append(222),this.pack_uint16(s);else if(s<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(s);else throw new Error("Invalid length");const l=f=>{if(f<n.length){const m=n[f];if(t.hasOwnProperty(m)){this.pack(m);const v=this.pack(t[m]);if(v instanceof Promise)return v.then(()=>l(f+1))}return l(f+1)}};return l(0)}pack_uint8(t){this._bufferBuilder.append(t)}pack_uint16(t){this._bufferBuilder.append(t>>8),this._bufferBuilder.append(t&255)}pack_uint32(t){const n=t&4294967295;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}pack_uint64(t){const n=t/4294967296,s=t%2**32;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255),this._bufferBuilder.append((s&4278190080)>>>24),this._bufferBuilder.append((s&16711680)>>>16),this._bufferBuilder.append((s&65280)>>>8),this._bufferBuilder.append(s&255)}pack_int8(t){this._bufferBuilder.append(t&255)}pack_int16(t){this._bufferBuilder.append((t&65280)>>8),this._bufferBuilder.append(t&255)}pack_int32(t){this._bufferBuilder.append(t>>>24&255),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255)}pack_int64(t){const n=Math.floor(t/4294967296),s=t%2**32;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255),this._bufferBuilder.append((s&4278190080)>>>24),this._bufferBuilder.append((s&16711680)>>>16),this._bufferBuilder.append((s&65280)>>>8),this._bufferBuilder.append(s&255)}constructor(){this._bufferBuilder=new Ew,this._textEncoder=new TextEncoder}}let wm=!0,Cm=!0;function Sa(e,t,n){const s=e.match(t);return s&&s.length>=n&&parseFloat(s[n],10)}function to(e,t,n){if(!e.RTCPeerConnection)return;const s=e.RTCPeerConnection.prototype,l=s.addEventListener;s.addEventListener=function(m,v){if(m!==t)return l.apply(this,arguments);const _=x=>{const E=n(x);E&&(v.handleEvent?v.handleEvent(E):v(E))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(v,_),l.apply(this,[m,_])};const f=s.removeEventListener;s.removeEventListener=function(m,v){if(m!==t||!this._eventMap||!this._eventMap[t])return f.apply(this,arguments);if(!this._eventMap[t].has(v))return f.apply(this,arguments);const _=this._eventMap[t].get(v);return this._eventMap[t].delete(v),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,f.apply(this,[m,_])},Object.defineProperty(s,"on"+t,{get(){return this["_on"+t]},set(m){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),m&&this.addEventListener(t,this["_on"+t]=m)},enumerable:!0,configurable:!0})}function Tw(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(wm=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Iw(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(Cm=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Em(){if(typeof window=="object"){if(wm)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function ad(e,t){Cm&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Nw(e){const t={browser:null,version:null};if(typeof e>"u"||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.userAgentData&&n.userAgentData.brands){const s=n.userAgentData.brands.find(l=>l.brand==="Chromium");if(s)return{browser:"chrome",version:parseInt(s.version,10)}}if(n.mozGetUserMedia)t.browser="firefox",t.version=parseInt(Sa(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=parseInt(Sa(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(e.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))t.browser="safari",t.version=parseInt(Sa(n.userAgent,/AppleWebKit\/(\d+)\./,1)),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype,t._safariVersion=Sa(n.userAgent,/Version\/(\d+(\.?\d+))/,1);else return t.browser="Not a supported browser.",t;return t}function h1(e){return Object.prototype.toString.call(e)==="[object Object]"}function bm(e){return h1(e)?Object.keys(e).reduce(function(t,n){const s=h1(e[n]),l=s?bm(e[n]):e[n],f=s&&!Object.keys(l).length;return l===void 0||f?t:Object.assign(t,{[n]:l})},{}):e}function Xf(e,t,n){!t||n.has(t.id)||(n.set(t.id,t),Object.keys(t).forEach(s=>{s.endsWith("Id")?Xf(e,e.get(t[s]),n):s.endsWith("Ids")&&t[s].forEach(l=>{Xf(e,e.get(l),n)})}))}function d1(e,t,n){const s=n?"outbound-rtp":"inbound-rtp",l=new Map;if(t===null)return l;const f=[];return e.forEach(m=>{m.type==="track"&&m.trackIdentifier===t.id&&f.push(m)}),f.forEach(m=>{e.forEach(v=>{v.type===s&&v.trackId===m.id&&Xf(e,v,l)})}),l}const p1=Em;function Sm(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const s=function(v){if(typeof v!="object"||v.mandatory||v.optional)return v;const _={};return Object.keys(v).forEach(x=>{if(x==="require"||x==="advanced"||x==="mediaSource")return;const E=typeof v[x]=="object"?v[x]:{ideal:v[x]};E.exact!==void 0&&typeof E.exact=="number"&&(E.min=E.max=E.exact);const b=function(M,F){return M?M+F.charAt(0).toUpperCase()+F.slice(1):F==="deviceId"?"sourceId":F};if(E.ideal!==void 0){_.optional=_.optional||[];let M={};typeof E.ideal=="number"?(M[b("min",x)]=E.ideal,_.optional.push(M),M={},M[b("max",x)]=E.ideal,_.optional.push(M)):(M[b("",x)]=E.ideal,_.optional.push(M))}E.exact!==void 0&&typeof E.exact!="number"?(_.mandatory=_.mandatory||{},_.mandatory[b("",x)]=E.exact):["min","max"].forEach(M=>{E[M]!==void 0&&(_.mandatory=_.mandatory||{},_.mandatory[b(M,x)]=E[M])})}),v.advanced&&(_.optional=(_.optional||[]).concat(v.advanced)),_},l=function(v,_){if(t.version>=61)return _(v);if(v=JSON.parse(JSON.stringify(v)),v&&typeof v.audio=="object"){const x=function(E,b,M){b in E&&!(M in E)&&(E[M]=E[b],delete E[b])};v=JSON.parse(JSON.stringify(v)),x(v.audio,"autoGainControl","googAutoGainControl"),x(v.audio,"noiseSuppression","googNoiseSuppression"),v.audio=s(v.audio)}if(v&&typeof v.video=="object"){let x=v.video.facingMode;x=x&&(typeof x=="object"?x:{ideal:x});const E=t.version<66;if(x&&(x.exact==="user"||x.exact==="environment"||x.ideal==="user"||x.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!E)){delete v.video.facingMode;let b;if(x.exact==="environment"||x.ideal==="environment"?b=["back","rear"]:(x.exact==="user"||x.ideal==="user")&&(b=["front"]),b)return n.mediaDevices.enumerateDevices().then(M=>{M=M.filter(z=>z.kind==="videoinput");let F=M.find(z=>b.some(U=>z.label.toLowerCase().includes(U)));return!F&&M.length&&b.includes("back")&&(F=M[M.length-1]),F&&(v.video.deviceId=x.exact?{exact:F.deviceId}:{ideal:F.deviceId}),v.video=s(v.video),p1("chrome: "+JSON.stringify(v)),_(v)})}v.video=s(v.video)}return p1("chrome: "+JSON.stringify(v)),_(v)},f=function(v){return t.version>=64?v:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[v.name]||v.name,message:v.message,constraint:v.constraint||v.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},m=function(v,_,x){l(v,E=>{n.webkitGetUserMedia(E,_,b=>{x&&x(f(b))})})};if(n.getUserMedia=m.bind(n),n.mediaDevices.getUserMedia){const v=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(_){return l(_,x=>v(x).then(E=>{if(x.audio&&!E.getAudioTracks().length||x.video&&!E.getVideoTracks().length)throw E.getTracks().forEach(b=>{b.stop()}),new DOMException("","NotFoundError");return E},E=>Promise.reject(f(E))))}}}function Am(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Tm(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=s=>{s.stream.addEventListener("addtrack",l=>{let f;e.RTCPeerConnection.prototype.getReceivers?f=this.getReceivers().find(v=>v.track&&v.track.id===l.track.id):f={track:l.track};const m=new Event("track");m.track=l.track,m.receiver=f,m.transceiver={receiver:f},m.streams=[s.stream],this.dispatchEvent(m)}),s.stream.getTracks().forEach(l=>{let f;e.RTCPeerConnection.prototype.getReceivers?f=this.getReceivers().find(v=>v.track&&v.track.id===l.id):f={track:l};const m=new Event("track");m.track=l,m.receiver=f,m.transceiver={receiver:f},m.streams=[s.stream],this.dispatchEvent(m)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else to(e,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function Im(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(l,f){return{track:f,get dtmf(){return this._dtmf===void 0&&(f.kind==="audio"?this._dtmf=l.createDTMFSender(f):this._dtmf=null),this._dtmf},_pc:l}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const l=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(v,_){let x=l.apply(this,arguments);return x||(x=t(this,v),this._senders.push(x)),x};const f=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(v){f.apply(this,arguments);const _=this._senders.indexOf(v);_!==-1&&this._senders.splice(_,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(f){this._senders=this._senders||[],n.apply(this,[f]),f.getTracks().forEach(m=>{this._senders.push(t(this,m))})};const s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(f){this._senders=this._senders||[],s.apply(this,[f]),f.getTracks().forEach(m=>{const v=this._senders.find(_=>_.track===m);v&&this._senders.splice(this._senders.indexOf(v),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const s=t.apply(this,[]);return s.forEach(l=>l._pc=this),s},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Nm(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const n=e.RTCPeerConnection.prototype.getSenders;n&&(e.RTCPeerConnection.prototype.getSenders=function(){const f=n.apply(this,[]);return f.forEach(m=>m._pc=this),f});const s=e.RTCPeerConnection.prototype.addTrack;s&&(e.RTCPeerConnection.prototype.addTrack=function(){const f=s.apply(this,arguments);return f._pc=this,f}),e.RTCRtpSender.prototype.getStats=function(){const f=this;return this._pc.getStats().then(m=>d1(m,f.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){const l=n.apply(this,[]);return l.forEach(f=>f._pc=this),l}),to(e,"track",s=>(s.receiver._pc=s.srcElement,s)),e.RTCRtpReceiver.prototype.getStats=function(){const l=this;return this._pc.getStats().then(f=>d1(f,l.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const s=arguments[0];let l,f,m;return this.getSenders().forEach(v=>{v.track===s&&(l?m=!0:l=v)}),this.getReceivers().forEach(v=>(v.track===s&&(f?m=!0:f=v),v.track===s)),m||l&&f?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):l?l.getStats():f?f.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Mm(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(m=>this._shimmedLocalStreams[m][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(m,v){if(!v)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const _=t.apply(this,arguments);return this._shimmedLocalStreams[v.id]?this._shimmedLocalStreams[v.id].indexOf(_)===-1&&this._shimmedLocalStreams[v.id].push(_):this._shimmedLocalStreams[v.id]=[v,_],_};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(m){this._shimmedLocalStreams=this._shimmedLocalStreams||{},m.getTracks().forEach(x=>{if(this.getSenders().find(b=>b.track===x))throw new DOMException("Track already exists.","InvalidAccessError")});const v=this.getSenders();n.apply(this,arguments);const _=this.getSenders().filter(x=>v.indexOf(x)===-1);this._shimmedLocalStreams[m.id]=[m].concat(_)};const s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(m){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[m.id],s.apply(this,arguments)};const l=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(m){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},m&&Object.keys(this._shimmedLocalStreams).forEach(v=>{const _=this._shimmedLocalStreams[v].indexOf(m);_!==-1&&this._shimmedLocalStreams[v].splice(_,1),this._shimmedLocalStreams[v].length===1&&delete this._shimmedLocalStreams[v]}),l.apply(this,arguments)}}function Rm(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Mm(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const E=n.apply(this);return this._reverseStreams=this._reverseStreams||{},E.map(b=>this._reverseStreams[b.id])};const s=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(E){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},E.getTracks().forEach(b=>{if(this.getSenders().find(F=>F.track===b))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[E.id]){const b=new e.MediaStream(E.getTracks());this._streams[E.id]=b,this._reverseStreams[b.id]=E,E=b}s.apply(this,[E])};const l=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(E){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},l.apply(this,[this._streams[E.id]||E]),delete this._reverseStreams[this._streams[E.id]?this._streams[E.id].id:E.id],delete this._streams[E.id]},e.RTCPeerConnection.prototype.addTrack=function(E,b){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const M=[].slice.call(arguments,1);if(M.length!==1||!M[0].getTracks().find(U=>U===E))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(U=>U.track===E))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const z=this._streams[b.id];if(z)z.addTrack(E),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const U=new e.MediaStream([E]);this._streams[b.id]=U,this._reverseStreams[U.id]=b,this.addStream(U)}return this.getSenders().find(U=>U.track===E)};function f(x,E){let b=E.sdp;return Object.keys(x._reverseStreams||[]).forEach(M=>{const F=x._reverseStreams[M],z=x._streams[F.id];b=b.replace(new RegExp(z.id,"g"),F.id)}),new RTCSessionDescription({type:E.type,sdp:b})}function m(x,E){let b=E.sdp;return Object.keys(x._reverseStreams||[]).forEach(M=>{const F=x._reverseStreams[M],z=x._streams[F.id];b=b.replace(new RegExp(F.id,"g"),z.id)}),new RTCSessionDescription({type:E.type,sdp:b})}["createOffer","createAnswer"].forEach(function(x){const E=e.RTCPeerConnection.prototype[x],b={[x](){const M=arguments;return arguments.length&&typeof arguments[0]=="function"?E.apply(this,[z=>{const U=f(this,z);M[0].apply(null,[U])},z=>{M[1]&&M[1].apply(null,z)},arguments[2]]):E.apply(this,arguments).then(z=>f(this,z))}};e.RTCPeerConnection.prototype[x]=b[x]});const v=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?v.apply(this,arguments):(arguments[0]=m(this,arguments[0]),v.apply(this,arguments))};const _=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const x=_.get.apply(this);return x.type===""?x:f(this,x)}}),e.RTCPeerConnection.prototype.removeTrack=function(E){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!E._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(E._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let M;Object.keys(this._streams).forEach(F=>{this._streams[F].getTracks().find(U=>E.track===U)&&(M=this._streams[F])}),M&&(M.getTracks().length===1?this.removeStream(this._reverseStreams[M.id]):M.removeTrack(E.track),this.dispatchEvent(new Event("negotiationneeded")))}}function $f(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const s=e.RTCPeerConnection.prototype[n],l={[n](){return arguments[0]=new(n==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};e.RTCPeerConnection.prototype[n]=l[n]})}function km(e,t){to(e,"negotiationneeded",n=>{const s=n.target;if(!((t.version<72||s.getConfiguration&&s.getConfiguration().sdpSemantics==="plan-b")&&s.signalingState!=="stable"))return n})}const g1=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:km,shimAddTrackRemoveTrack:Rm,shimAddTrackRemoveTrackWithNative:Mm,shimGetSendersWithDtmf:Im,shimGetUserMedia:Sm,shimMediaStream:Am,shimOnTrack:Tm,shimPeerConnection:$f,shimSenderReceiverGetStats:Nm},Symbol.toStringTag,{value:"Module"}));function Om(e,t){const n=e&&e.navigator,s=e&&e.MediaStreamTrack;if(n.getUserMedia=function(l,f,m){ad("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(l).then(f,m)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const l=function(m,v,_){v in m&&!(_ in m)&&(m[_]=m[v],delete m[v])},f=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(m){return typeof m=="object"&&typeof m.audio=="object"&&(m=JSON.parse(JSON.stringify(m)),l(m.audio,"autoGainControl","mozAutoGainControl"),l(m.audio,"noiseSuppression","mozNoiseSuppression")),f(m)},s&&s.prototype.getSettings){const m=s.prototype.getSettings;s.prototype.getSettings=function(){const v=m.apply(this,arguments);return l(v,"mozAutoGainControl","autoGainControl"),l(v,"mozNoiseSuppression","noiseSuppression"),v}}if(s&&s.prototype.applyConstraints){const m=s.prototype.applyConstraints;s.prototype.applyConstraints=function(v){return this.kind==="audio"&&typeof v=="object"&&(v=JSON.parse(JSON.stringify(v)),l(v,"autoGainControl","mozAutoGainControl"),l(v,"noiseSuppression","mozNoiseSuppression")),m.apply(this,[v])}}}}function Mw(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(s){if(!(s&&s.video)){const l=new DOMException("getDisplayMedia without video constraints is undefined");return l.name="NotFoundError",l.code=8,Promise.reject(l)}return s.video===!0?s.video={mediaSource:t}:s.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(s)})}function Lm(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Qf(e,t){if(typeof e!="object"||!(e.RTCPeerConnection||e.mozRTCPeerConnection))return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(l){const f=e.RTCPeerConnection.prototype[l],m={[l](){return arguments[0]=new(l==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),f.apply(this,arguments)}};e.RTCPeerConnection.prototype[l]=m[l]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[f,m,v]=arguments;return s.apply(this,[f||null]).then(_=>{if(t.version<53&&!m)try{_.forEach(x=>{x.type=n[x.type]||x.type})}catch(x){if(x.name!=="TypeError")throw x;_.forEach((E,b)=>{_.set(b,Object.assign({},E,{type:n[E.type]||E.type}))})}return _}).then(m,v)}}function Pm(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const l=t.apply(this,[]);return l.forEach(f=>f._pc=this),l});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const l=n.apply(this,arguments);return l._pc=this,l}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Dm(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const s=t.apply(this,[]);return s.forEach(l=>l._pc=this),s}),to(e,"track",n=>(n.receiver._pc=n.srcElement,n)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Bm(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(n){ad("removeStream","removeTrack"),this.getSenders().forEach(s=>{s.track&&n.getTracks().includes(s.track)&&this.removeTrack(s)})})}function Fm(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function jm(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let s=arguments[1]&&arguments[1].sendEncodings;s===void 0&&(s=[]),s=[...s];const l=s.length>0;l&&s.forEach(m=>{if("rid"in m&&!/^[a-z0-9]{0,16}$/i.test(m.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in m&&!(parseFloat(m.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in m&&!(parseFloat(m.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const f=t.apply(this,arguments);if(l){const{sender:m}=f,v=m.getParameters();(!("encodings"in v)||v.encodings.length===1&&Object.keys(v.encodings[0]).length===0)&&(v.encodings=s,m.sendEncodings=s,this.setParametersPromises.push(m.setParameters(v).then(()=>{delete m.sendEncodings}).catch(()=>{delete m.sendEncodings})))}return f})}function zm(e){if(!(typeof e=="object"&&e.RTCRtpSender))return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const s=t.apply(this,arguments);return"encodings"in s||(s.encodings=[].concat(this.sendEncodings||[{}])),s})}function Um(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function Hm(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}const m1=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:jm,shimCreateAnswer:Hm,shimCreateOffer:Um,shimGetDisplayMedia:Mw,shimGetParameters:zm,shimGetUserMedia:Om,shimOnTrack:Lm,shimPeerConnection:Qf,shimRTCDataChannel:Fm,shimReceiverGetStats:Dm,shimRemoveStream:Bm,shimSenderGetStats:Pm},Symbol.toStringTag,{value:"Module"}));function Vm(e){if(!(typeof e!="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(s){this._localStreams||(this._localStreams=[]),this._localStreams.includes(s)||this._localStreams.push(s),s.getAudioTracks().forEach(l=>t.call(this,l,s)),s.getVideoTracks().forEach(l=>t.call(this,l,s))},e.RTCPeerConnection.prototype.addTrack=function(s,...l){return l&&l.forEach(f=>{this._localStreams?this._localStreams.includes(f)||this._localStreams.push(f):this._localStreams=[f]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const s=this._localStreams.indexOf(n);if(s===-1)return;this._localStreams.splice(s,1);const l=n.getTracks();this.getSenders().forEach(f=>{l.includes(f.track)&&this.removeTrack(f)})})}}function Wm(e){if(!(typeof e!="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(l=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(l))return;this._remoteStreams.push(l);const f=new Event("addstream");f.stream=l,this.dispatchEvent(f)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const s=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(l){l.streams.forEach(f=>{if(s._remoteStreams||(s._remoteStreams=[]),s._remoteStreams.indexOf(f)>=0)return;s._remoteStreams.push(f);const m=new Event("addstream");m.stream=f,s.dispatchEvent(m)})}),t.apply(s,arguments)}}}function Zm(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,s=t.createAnswer,l=t.setLocalDescription,f=t.setRemoteDescription,m=t.addIceCandidate;t.createOffer=function(x,E){const b=arguments.length>=2?arguments[2]:arguments[0],M=n.apply(this,[b]);return E?(M.then(x,E),Promise.resolve()):M},t.createAnswer=function(x,E){const b=arguments.length>=2?arguments[2]:arguments[0],M=s.apply(this,[b]);return E?(M.then(x,E),Promise.resolve()):M};let v=function(_,x,E){const b=l.apply(this,[_]);return E?(b.then(x,E),Promise.resolve()):b};t.setLocalDescription=v,v=function(_,x,E){const b=f.apply(this,[_]);return E?(b.then(x,E),Promise.resolve()):b},t.setRemoteDescription=v,v=function(_,x,E){const b=m.apply(this,[_]);return E?(b.then(x,E),Promise.resolve()):b},t.addIceCandidate=v}function Gm(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const n=t.mediaDevices,s=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=l=>s(Ym(l))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=(function(s,l,f){t.mediaDevices.getUserMedia(s).then(l,f)}).bind(t))}function Ym(e){return e&&e.video!==void 0?Object.assign({},e,{video:bm(e.video)}):e}function Xm(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(s,l){if(s&&s.iceServers){const f=[];for(let m=0;m<s.iceServers.length;m++){let v=s.iceServers[m];v.urls===void 0&&v.url?(ad("RTCIceServer.url","RTCIceServer.urls"),v=JSON.parse(JSON.stringify(v)),v.urls=v.url,delete v.url,f.push(v)):f.push(s.iceServers[m])}s.iceServers=f}return new t(s,l)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get(){return t.generateCertificate}})}function $m(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Qm(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(s){if(s){typeof s.offerToReceiveAudio<"u"&&(s.offerToReceiveAudio=!!s.offerToReceiveAudio);const l=this.getTransceivers().find(m=>m.receiver.track.kind==="audio");s.offerToReceiveAudio===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):s.offerToReceiveAudio===!0&&!l&&this.addTransceiver("audio",{direction:"recvonly"}),typeof s.offerToReceiveVideo<"u"&&(s.offerToReceiveVideo=!!s.offerToReceiveVideo);const f=this.getTransceivers().find(m=>m.receiver.track.kind==="video");s.offerToReceiveVideo===!1&&f?f.direction==="sendrecv"?f.setDirection?f.setDirection("sendonly"):f.direction="sendonly":f.direction==="recvonly"&&(f.setDirection?f.setDirection("inactive"):f.direction="inactive"):s.offerToReceiveVideo===!0&&!f&&this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Km(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}const x1=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:Km,shimCallbacksAPI:Zm,shimConstraints:Ym,shimCreateOfferLegacy:Qm,shimGetUserMedia:Gm,shimLocalStreamsAPI:Vm,shimRTCIceServerUrls:Xm,shimRemoteStreamsAPI:Wm,shimTrackEventTransceiver:$m},Symbol.toStringTag,{value:"Module"}));var qm={exports:{}};(function(e){const t={};t.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},t.localCName=t.generateIdentifier(),t.splitLines=function(n){return n.trim().split(`
`).map(s=>s.trim())},t.splitSections=function(n){return n.split(`
m=`).map((l,f)=>(f>0?"m="+l:l).trim()+`\r
`)},t.getDescription=function(n){const s=t.splitSections(n);return s&&s[0]},t.getMediaSections=function(n){const s=t.splitSections(n);return s.shift(),s},t.matchPrefix=function(n,s){return t.splitLines(n).filter(l=>l.indexOf(s)===0)},t.parseCandidate=function(n){let s;n.indexOf("a=candidate:")===0?s=n.substring(12).split(" "):s=n.substring(10).split(" ");const l={foundation:s[0],component:{1:"rtp",2:"rtcp"}[s[1]]||s[1],protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]};for(let f=8;f<s.length;f+=2)switch(s[f]){case"raddr":l.relatedAddress=s[f+1];break;case"rport":l.relatedPort=parseInt(s[f+1],10);break;case"tcptype":l.tcpType=s[f+1];break;case"ufrag":l.ufrag=s[f+1],l.usernameFragment=s[f+1];break;default:l[s[f]]===void 0&&(l[s[f]]=s[f+1]);break}return l},t.writeCandidate=function(n){const s=[];s.push(n.foundation);const l=n.component;l==="rtp"?s.push(1):l==="rtcp"?s.push(2):s.push(l),s.push(n.protocol.toUpperCase()),s.push(n.priority),s.push(n.address||n.ip),s.push(n.port);const f=n.type;return s.push("typ"),s.push(f),f!=="host"&&n.relatedAddress&&n.relatedPort&&(s.push("raddr"),s.push(n.relatedAddress),s.push("rport"),s.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(s.push("ufrag"),s.push(n.usernameFragment||n.ufrag)),"candidate:"+s.join(" ")},t.parseIceOptions=function(n){return n.substring(14).split(" ")},t.parseRtpMap=function(n){let s=n.substring(9).split(" ");const l={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),l.name=s[0],l.clockRate=parseInt(s[1],10),l.channels=s.length===3?parseInt(s[2],10):1,l.numChannels=l.channels,l},t.writeRtpMap=function(n){let s=n.payloadType;n.preferredPayloadType!==void 0&&(s=n.preferredPayloadType);const l=n.channels||n.numChannels||1;return"a=rtpmap:"+s+" "+n.name+"/"+n.clockRate+(l!==1?"/"+l:"")+`\r
`},t.parseExtmap=function(n){const s=n.substring(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1],attributes:s.slice(2).join(" ")}},t.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},t.parseFmtp=function(n){const s={};let l;const f=n.substring(n.indexOf(" ")+1).split(";");for(let m=0;m<f.length;m++)l=f[m].trim().split("="),s[l[0].trim()]=l[1];return s},t.writeFmtp=function(n){let s="",l=n.payloadType;if(n.preferredPayloadType!==void 0&&(l=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const f=[];Object.keys(n.parameters).forEach(m=>{n.parameters[m]!==void 0?f.push(m+"="+n.parameters[m]):f.push(m)}),s+="a=fmtp:"+l+" "+f.join(";")+`\r
`}return s},t.parseRtcpFb=function(n){const s=n.substring(n.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},t.writeRtcpFb=function(n){let s="",l=n.payloadType;return n.preferredPayloadType!==void 0&&(l=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(f=>{s+="a=rtcp-fb:"+l+" "+f.type+(f.parameter&&f.parameter.length?" "+f.parameter:"")+`\r
`}),s},t.parseSsrcMedia=function(n){const s=n.indexOf(" "),l={ssrc:parseInt(n.substring(7,s),10)},f=n.indexOf(":",s);return f>-1?(l.attribute=n.substring(s+1,f),l.value=n.substring(f+1)):l.attribute=n.substring(s+1),l},t.parseSsrcGroup=function(n){const s=n.substring(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(l=>parseInt(l,10))}},t.getMid=function(n){const s=t.matchPrefix(n,"a=mid:")[0];if(s)return s.substring(6)},t.parseFingerprint=function(n){const s=n.substring(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1].toUpperCase()}},t.getDtlsParameters=function(n,s){return{role:"auto",fingerprints:t.matchPrefix(n+s,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(n,s){let l="a=setup:"+s+`\r
`;return n.fingerprints.forEach(f=>{l+="a=fingerprint:"+f.algorithm+" "+f.value+`\r
`}),l},t.parseCryptoLine=function(n){const s=n.substring(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},t.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?t.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const s=n.substring(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},t.getCryptoParameters=function(n,s){return t.matchPrefix(n+s,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(n,s){const l=t.matchPrefix(n+s,"a=ice-ufrag:")[0],f=t.matchPrefix(n+s,"a=ice-pwd:")[0];return l&&f?{usernameFragment:l.substring(12),password:f.substring(10)}:null},t.writeIceParameters=function(n){let s="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(s+=`a=ice-lite\r
`),s},t.parseRtpParameters=function(n){const s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},f=t.splitLines(n)[0].split(" ");s.profile=f[2];for(let v=3;v<f.length;v++){const _=f[v],x=t.matchPrefix(n,"a=rtpmap:"+_+" ")[0];if(x){const E=t.parseRtpMap(x),b=t.matchPrefix(n,"a=fmtp:"+_+" ");switch(E.parameters=b.length?t.parseFmtp(b[0]):{},E.rtcpFeedback=t.matchPrefix(n,"a=rtcp-fb:"+_+" ").map(t.parseRtcpFb),s.codecs.push(E),E.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(E.name.toUpperCase());break}}}t.matchPrefix(n,"a=extmap:").forEach(v=>{s.headerExtensions.push(t.parseExtmap(v))});const m=t.matchPrefix(n,"a=rtcp-fb:* ").map(t.parseRtcpFb);return s.codecs.forEach(v=>{m.forEach(_=>{v.rtcpFeedback.find(E=>E.type===_.type&&E.parameter===_.parameter)||v.rtcpFeedback.push(_)})}),s},t.writeRtpDescription=function(n,s){let l="";l+="m="+n+" ",l+=s.codecs.length>0?"9":"0",l+=" "+(s.profile||"UDP/TLS/RTP/SAVPF")+" ",l+=s.codecs.map(m=>m.preferredPayloadType!==void 0?m.preferredPayloadType:m.payloadType).join(" ")+`\r
`,l+=`c=IN IP4 0.0.0.0\r
`,l+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(m=>{l+=t.writeRtpMap(m),l+=t.writeFmtp(m),l+=t.writeRtcpFb(m)});let f=0;return s.codecs.forEach(m=>{m.maxptime>f&&(f=m.maxptime)}),f>0&&(l+="a=maxptime:"+f+`\r
`),s.headerExtensions&&s.headerExtensions.forEach(m=>{l+=t.writeExtmap(m)}),l},t.parseRtpEncodingParameters=function(n){const s=[],l=t.parseRtpParameters(n),f=l.fecMechanisms.indexOf("RED")!==-1,m=l.fecMechanisms.indexOf("ULPFEC")!==-1,v=t.matchPrefix(n,"a=ssrc:").map(M=>t.parseSsrcMedia(M)).filter(M=>M.attribute==="cname"),_=v.length>0&&v[0].ssrc;let x;const E=t.matchPrefix(n,"a=ssrc-group:FID").map(M=>M.substring(17).split(" ").map(z=>parseInt(z,10)));E.length>0&&E[0].length>1&&E[0][0]===_&&(x=E[0][1]),l.codecs.forEach(M=>{if(M.name.toUpperCase()==="RTX"&&M.parameters.apt){let F={ssrc:_,codecPayloadType:parseInt(M.parameters.apt,10)};_&&x&&(F.rtx={ssrc:x}),s.push(F),f&&(F=JSON.parse(JSON.stringify(F)),F.fec={ssrc:_,mechanism:m?"red+ulpfec":"red"},s.push(F))}}),s.length===0&&_&&s.push({ssrc:_});let b=t.matchPrefix(n,"b=");return b.length&&(b[0].indexOf("b=TIAS:")===0?b=parseInt(b[0].substring(7),10):b[0].indexOf("b=AS:")===0?b=parseInt(b[0].substring(5),10)*1e3*.95-50*40*8:b=void 0,s.forEach(M=>{M.maxBitrate=b})),s},t.parseRtcpParameters=function(n){const s={},l=t.matchPrefix(n,"a=ssrc:").map(v=>t.parseSsrcMedia(v)).filter(v=>v.attribute==="cname")[0];l&&(s.cname=l.value,s.ssrc=l.ssrc);const f=t.matchPrefix(n,"a=rtcp-rsize");s.reducedSize=f.length>0,s.compound=f.length===0;const m=t.matchPrefix(n,"a=rtcp-mux");return s.mux=m.length>0,s},t.writeRtcpParameters=function(n){let s="";return n.reducedSize&&(s+=`a=rtcp-rsize\r
`),n.mux&&(s+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(s+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),s},t.parseMsid=function(n){let s;const l=t.matchPrefix(n,"a=msid:");if(l.length===1)return s=l[0].substring(7).split(" "),{stream:s[0],track:s[1]};const f=t.matchPrefix(n,"a=ssrc:").map(m=>t.parseSsrcMedia(m)).filter(m=>m.attribute==="msid");if(f.length>0)return s=f[0].value.split(" "),{stream:s[0],track:s[1]}},t.parseSctpDescription=function(n){const s=t.parseMLine(n),l=t.matchPrefix(n,"a=max-message-size:");let f;l.length>0&&(f=parseInt(l[0].substring(19),10)),isNaN(f)&&(f=65536);const m=t.matchPrefix(n,"a=sctp-port:");if(m.length>0)return{port:parseInt(m[0].substring(12),10),protocol:s.fmt,maxMessageSize:f};const v=t.matchPrefix(n,"a=sctpmap:");if(v.length>0){const _=v[0].substring(10).split(" ");return{port:parseInt(_[0],10),protocol:_[1],maxMessageSize:f}}},t.writeSctpDescription=function(n,s){let l=[];return n.protocol!=="DTLS/SCTP"?l=["m="+n.kind+" 9 "+n.protocol+" "+s.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+s.port+`\r
`]:l=["m="+n.kind+" 9 "+n.protocol+" "+s.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+s.port+" "+s.protocol+` 65535\r
`],s.maxMessageSize!==void 0&&l.push("a=max-message-size:"+s.maxMessageSize+`\r
`),l.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(n,s,l){let f;const m=s!==void 0?s:2;return n?f=n:f=t.generateSessionId(),`v=0\r
o=`+(l||"thisisadapterortc")+" "+f+" "+m+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.getDirection=function(n,s){const l=t.splitLines(n);for(let f=0;f<l.length;f++)switch(l[f]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return l[f].substring(2)}return s?t.getDirection(s):"sendrecv"},t.getKind=function(n){return t.splitLines(n)[0].split(" ")[0].substring(2)},t.isRejected=function(n){return n.split(" ",2)[1]==="0"},t.parseMLine=function(n){const l=t.splitLines(n)[0].substring(2).split(" ");return{kind:l[0],port:parseInt(l[1],10),protocol:l[2],fmt:l.slice(3).join(" ")}},t.parseOLine=function(n){const l=t.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:l[0],sessionId:l[1],sessionVersion:parseInt(l[2],10),netType:l[3],addressType:l[4],address:l[5]}},t.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const s=t.splitLines(n);for(let l=0;l<s.length;l++)if(s[l].length<2||s[l].charAt(1)!=="=")return!1;return!0},e.exports=t})(qm);var Jm=qm.exports;const Do=sl(Jm),Rw=w1({__proto__:null,default:Do},[Jm]);function tc(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(s){if(typeof s=="object"&&s.candidate&&s.candidate.indexOf("a=")===0&&(s=JSON.parse(JSON.stringify(s)),s.candidate=s.candidate.substring(2)),s.candidate&&s.candidate.length){const l=new t(s),f=Do.parseCandidate(s.candidate);for(const m in f)m in l||Object.defineProperty(l,m,{value:f[m]});return l.toJSON=function(){return{candidate:l.candidate,sdpMid:l.sdpMid,sdpMLineIndex:l.sdpMLineIndex,usernameFragment:l.usernameFragment}},l}return new t(s)},e.RTCIceCandidate.prototype=t.prototype,to(e,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new e.RTCIceCandidate(n.candidate),writable:"false"}),n))}function Kf(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||to(e,"icecandidate",t=>{if(t.candidate){const n=Do.parseCandidate(t.candidate.candidate);n.type==="relay"&&(t.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return t})}function nc(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(v){if(!v||!v.sdp)return!1;const _=Do.splitSections(v.sdp);return _.shift(),_.some(x=>{const E=Do.parseMLine(x);return E&&E.kind==="application"&&E.protocol.indexOf("SCTP")!==-1})},s=function(v){const _=v.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(_===null||_.length<2)return-1;const x=parseInt(_[1],10);return x!==x?-1:x},l=function(v){let _=65536;return t.browser==="firefox"&&(t.version<57?v===-1?_=16384:_=2147483637:t.version<60?_=t.version===57?65535:65536:_=2147483637),_},f=function(v,_){let x=65536;t.browser==="firefox"&&t.version===57&&(x=65535);const E=Do.matchPrefix(v.sdp,"a=max-message-size:");return E.length>0?x=parseInt(E[0].substring(19),10):t.browser==="firefox"&&_!==-1&&(x=2147483637),x},m=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){const{sdpSemantics:_}=this.getConfiguration();_==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const _=s(arguments[0]),x=l(_),E=f(arguments[0],_);let b;x===0&&E===0?b=Number.POSITIVE_INFINITY:x===0||E===0?b=Math.max(x,E):b=Math.min(x,E);const M={};Object.defineProperty(M,"maxMessageSize",{get(){return b}}),this._sctp=M}return m.apply(this,arguments)}}function rc(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(s,l){const f=s.send;s.send=function(){const v=arguments[0],_=v.length||v.size||v.byteLength;if(s.readyState==="open"&&l.sctp&&_>l.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+l.sctp.maxMessageSize+" bytes)");return f.apply(s,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const l=n.apply(this,arguments);return t(l,this),l},to(e,"datachannel",s=>(t(s.channel,s.target),s))}function qf(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const s=t[n];t[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=l=>{const f=l.target;if(f._lastConnectionState!==f.connectionState){f._lastConnectionState=f.connectionState;const m=new Event("connectionstatechange",l);f.dispatchEvent(m)}return l},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function Jf(e,t){if(!e.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t._safariVersion>=13.1)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(l){if(l&&l.sdp&&l.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const f=l.sdp.split(`
`).filter(m=>m.trim()!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&l instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:l.type,sdp:f}):l.sdp=f}return n.apply(this,arguments)}}function ic(e,t){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const n=e.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function sc(e,t){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const n=e.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(e.RTCPeerConnection.prototype.setLocalDescription=function(){let l=arguments[0]||{};if(typeof l!="object"||l.type&&l.sdp)return n.apply(this,arguments);if(l={type:l.type,sdp:l.sdp},!l.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":l.type="offer";break;default:l.type="answer";break}return l.sdp||l.type!=="offer"&&l.type!=="answer"?n.apply(this,[l]):(l.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(m=>n.apply(this,[m]))})}const kw=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:Jf,shimAddIceCandidateNullOrEmpty:ic,shimConnectionState:qf,shimMaxMessageSize:nc,shimParameterlessSetLocalDescription:sc,shimRTCIceCandidate:tc,shimRTCIceCandidateRelayProtocol:Kf,shimSendThrowTypeError:rc},Symbol.toStringTag,{value:"Module"}));function Ow({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=Em,s=Nw(e),l={browserDetails:s,commonShim:kw,extractVersion:Sa,disableLog:Tw,disableWarnings:Iw,sdp:Rw};switch(s.browser){case"chrome":if(!g1||!$f||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),l;if(s.version===null)return n("Chrome shim can not determine version, not shimming."),l;n("adapter.js shimming chrome."),l.browserShim=g1,ic(e,s),sc(e),Sm(e,s),Am(e),$f(e,s),Tm(e),Rm(e,s),Im(e),Nm(e),km(e,s),tc(e),Kf(e),qf(e),nc(e,s),rc(e),Jf(e,s);break;case"firefox":if(!m1||!Qf||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),l;n("adapter.js shimming firefox."),l.browserShim=m1,ic(e,s),sc(e),Om(e,s),Qf(e,s),Lm(e),Bm(e),Pm(e),Dm(e),Fm(e),jm(e),zm(e),Um(e),Hm(e),tc(e),qf(e),nc(e,s),rc(e);break;case"safari":if(!x1||!t.shimSafari)return n("Safari shim is not included in this adapter release."),l;n("adapter.js shimming safari."),l.browserShim=x1,ic(e,s),sc(e),Xm(e),Qm(e),Zm(e),Vm(e),Wm(e),$m(e),Gm(e),Km(e),tc(e),Kf(e),nc(e,s),rc(e),Jf(e,s);break;default:n("Unsupported browser!");break}return l}const y1=Ow({window:typeof window>"u"?void 0:window});function no(e,t,n,s){Object.defineProperty(e,t,{get:n,set:s,enumerable:!0,configurable:!0})}class ex{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=t=>{const n=[],s=t.byteLength,l=Math.ceil(s/this.chunkedMTU);let f=0,m=0;for(;m<s;){const v=Math.min(s,m+this.chunkedMTU),_=t.slice(m,v),x={__peerData:this._dataCount,n:f,data:_,total:l};n.push(x),m=v,f++}return this._dataCount++,n}}}function Lw(e){let t=0;for(const l of e)t+=l.byteLength;const n=new Uint8Array(t);let s=0;for(const l of e)n.set(l,s),s+=l.byteLength;return n}const Uu=y1.default||y1,va=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const e=this.getBrowser(),t=this.getVersion();return this.supportedBrowsers.includes(e)?e==="chrome"?t>=this.minChromeVersion:e==="firefox"?t>=this.minFirefoxVersion:e==="safari"?!this.isIOS&&t>=this.minSafariVersion:!1:!1}getBrowser(){return Uu.browserDetails.browser}getVersion(){return Uu.browserDetails.version||0}isUnifiedPlanSupported(){const e=this.getBrowser(),t=Uu.browserDetails.version||0;if(e==="chrome"&&t<this.minChromeVersion)return!1;if(e==="firefox"&&t>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let n,s=!1;try{n=new RTCPeerConnection,n.addTransceiver("audio"),s=!0}catch{}finally{n&&n.close()}return s}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},Pw=e=>!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e),tx=()=>Math.random().toString(36).slice(2),_1={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class Dw extends ex{noop(){}blobToArrayBuffer(t,n){const s=new FileReader;return s.onload=function(l){l.target&&n(l.target.result)},s.readAsArrayBuffer(t),s}binaryStringToArrayBuffer(t){const n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s)&255;return n.buffer}isSecure(){return location.protocol==="https:"}constructor(...t){super(...t),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=_1,this.browser=va.getBrowser(),this.browserVersion=va.getVersion(),this.pack=vm,this.unpack=_m,this.supports=function(){const n={browser:va.isBrowserSupported(),webRTC:va.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!n.webRTC)return n;let s;try{s=new RTCPeerConnection(_1),n.audioVideo=!0;let l;try{l=s.createDataChannel("_PEERJSTEST",{ordered:!0}),n.data=!0,n.reliable=!!l.ordered;try{l.binaryType="blob",n.binaryBlob=!va.isIOS}catch{}}catch{}finally{l&&l.close()}}catch{}finally{s&&s.close()}return n}(),this.validateId=Pw,this.randomToken=tx}}const pr=new Dw,Bw="PeerJS: ";class Fw{get logLevel(){return this._logLevel}set logLevel(t){this._logLevel=t}log(...t){this._logLevel>=3&&this._print(3,...t)}warn(...t){this._logLevel>=2&&this._print(2,...t)}error(...t){this._logLevel>=1&&this._print(1,...t)}setLogFunction(t){this._print=t}_print(t,...n){const s=[Bw,...n];for(const l in s)s[l]instanceof Error&&(s[l]="("+s[l].name+") "+s[l].message);t>=3?console.log(...s):t>=2?console.warn("WARNING",...s):t>=1&&console.error("ERROR",...s)}constructor(){this._logLevel=0}}var Ue=new Fw,ld={},jw=Object.prototype.hasOwnProperty,lr="~";function il(){}Object.create&&(il.prototype=Object.create(null),new il().__proto__||(lr=!1));function zw(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function nx(e,t,n,s,l){if(typeof n!="function")throw new TypeError("The listener must be a function");var f=new zw(n,s||e,l),m=lr?lr+t:t;return e._events[m]?e._events[m].fn?e._events[m]=[e._events[m],f]:e._events[m].push(f):(e._events[m]=f,e._eventsCount++),e}function oc(e,t){--e._eventsCount===0?e._events=new il:delete e._events[t]}function $n(){this._events=new il,this._eventsCount=0}$n.prototype.eventNames=function(){var t=[],n,s;if(this._eventsCount===0)return t;for(s in n=this._events)jw.call(n,s)&&t.push(lr?s.slice(1):s);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(n)):t};$n.prototype.listeners=function(t){var n=lr?lr+t:t,s=this._events[n];if(!s)return[];if(s.fn)return[s.fn];for(var l=0,f=s.length,m=new Array(f);l<f;l++)m[l]=s[l].fn;return m};$n.prototype.listenerCount=function(t){var n=lr?lr+t:t,s=this._events[n];return s?s.fn?1:s.length:0};$n.prototype.emit=function(t,n,s,l,f,m){var v=lr?lr+t:t;if(!this._events[v])return!1;var _=this._events[v],x=arguments.length,E,b;if(_.fn){switch(_.once&&this.removeListener(t,_.fn,void 0,!0),x){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,n),!0;case 3:return _.fn.call(_.context,n,s),!0;case 4:return _.fn.call(_.context,n,s,l),!0;case 5:return _.fn.call(_.context,n,s,l,f),!0;case 6:return _.fn.call(_.context,n,s,l,f,m),!0}for(b=1,E=new Array(x-1);b<x;b++)E[b-1]=arguments[b];_.fn.apply(_.context,E)}else{var M=_.length,F;for(b=0;b<M;b++)switch(_[b].once&&this.removeListener(t,_[b].fn,void 0,!0),x){case 1:_[b].fn.call(_[b].context);break;case 2:_[b].fn.call(_[b].context,n);break;case 3:_[b].fn.call(_[b].context,n,s);break;case 4:_[b].fn.call(_[b].context,n,s,l);break;default:if(!E)for(F=1,E=new Array(x-1);F<x;F++)E[F-1]=arguments[F];_[b].fn.apply(_[b].context,E)}}return!0};$n.prototype.on=function(t,n,s){return nx(this,t,n,s,!1)};$n.prototype.once=function(t,n,s){return nx(this,t,n,s,!0)};$n.prototype.removeListener=function(t,n,s,l){var f=lr?lr+t:t;if(!this._events[f])return this;if(!n)return oc(this,f),this;var m=this._events[f];if(m.fn)m.fn===n&&(!l||m.once)&&(!s||m.context===s)&&oc(this,f);else{for(var v=0,_=[],x=m.length;v<x;v++)(m[v].fn!==n||l&&!m[v].once||s&&m[v].context!==s)&&_.push(m[v]);_.length?this._events[f]=_.length===1?_[0]:_:oc(this,f)}return this};$n.prototype.removeAllListeners=function(t){var n;return t?(n=lr?lr+t:t,this._events[n]&&oc(this,n)):(this._events=new il,this._eventsCount=0),this};$n.prototype.off=$n.prototype.removeListener;$n.prototype.addListener=$n.prototype.on;$n.prefixed=lr;$n.EventEmitter=$n;ld=$n;var ro={};no(ro,"ConnectionType",()=>bs);no(ro,"PeerErrorType",()=>xn);no(ro,"BaseConnectionErrorType",()=>eh);no(ro,"DataConnectionErrorType",()=>cd);no(ro,"SerializationType",()=>iu);no(ro,"SocketEventType",()=>gs);no(ro,"ServerMessageType",()=>Gn);var bs=function(e){return e.Data="data",e.Media="media",e}({}),xn=function(e){return e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc",e}({}),eh=function(e){return e.NegotiationFailed="negotiation-failed",e.ConnectionClosed="connection-closed",e}({}),cd=function(e){return e.NotOpenYet="not-open-yet",e.MessageToBig="message-too-big",e}({}),iu=function(e){return e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json",e.None="raw",e}({}),gs=function(e){return e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close",e}({}),Gn=function(e){return e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE",e}({});const rx="1.5.5";class Uw extends ld.EventEmitter{constructor(t,n,s,l,f,m=5e3){super(),this.pingInterval=m,this._disconnected=!0,this._messagesQueue=[];const v=t?"wss://":"ws://";this._baseUrl=v+n+":"+s+l+"peerjs?key="+f}start(t,n){this._id=t;const s=`${this._baseUrl}&id=${t}&token=${n}`;this._socket||!this._disconnected||(this._socket=new WebSocket(s+"&version="+rx),this._disconnected=!1,this._socket.onmessage=l=>{let f;try{f=JSON.parse(l.data),Ue.log("Server message received:",f)}catch{Ue.log("Invalid server message",l.data);return}this.emit(gs.Message,f)},this._socket.onclose=l=>{this._disconnected||(Ue.log("Socket closed.",l),this._cleanup(),this._disconnected=!0,this.emit(gs.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),Ue.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){Ue.log("Cannot send heartbeat, because socket closed");return}const t=JSON.stringify({type:Gn.Heartbeat});this._socket.send(t),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const t=[...this._messagesQueue];this._messagesQueue=[];for(const n of t)this.send(n)}send(t){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(t);return}if(!t.type){this.emit(gs.Error,"Invalid message");return}if(!this._wsOpen())return;const n=JSON.stringify(t);this._socket.send(n)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class ix{constructor(t){this.connection=t}startConnection(t){const n=this._startPeerConnection();if(this.connection.peerConnection=n,this.connection.type===bs.Media&&t._stream&&this._addTracksToConnection(t._stream,n),t.originator){const s=this.connection,l={ordered:!!t.reliable},f=n.createDataChannel(s.label,l);s._initializeDataChannel(f),this._makeOffer()}else this.handleSDP("OFFER",t.sdp)}_startPeerConnection(){Ue.log("Creating RTCPeerConnection.");const t=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(t),t}_setupListeners(t){const n=this.connection.peer,s=this.connection.connectionId,l=this.connection.type,f=this.connection.provider;Ue.log("Listening for ICE candidates."),t.onicecandidate=m=>{!m.candidate||!m.candidate.candidate||(Ue.log(`Received ICE candidates for ${n}:`,m.candidate),f.socket.send({type:Gn.Candidate,payload:{candidate:m.candidate,type:l,connectionId:s},dst:n}))},t.oniceconnectionstatechange=()=>{switch(t.iceConnectionState){case"failed":Ue.log("iceConnectionState is failed, closing connections to "+n),this.connection.emitError(eh.NegotiationFailed,"Negotiation of connection to "+n+" failed."),this.connection.close();break;case"closed":Ue.log("iceConnectionState is closed, closing connections to "+n),this.connection.emitError(eh.ConnectionClosed,"Connection to "+n+" closed."),this.connection.close();break;case"disconnected":Ue.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":t.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",t.iceConnectionState)},Ue.log("Listening for data channel"),t.ondatachannel=m=>{Ue.log("Received data channel");const v=m.channel;f.getConnection(n,s)._initializeDataChannel(v)},Ue.log("Listening for remote stream"),t.ontrack=m=>{Ue.log("Received remote stream");const v=m.streams[0],_=f.getConnection(n,s);if(_.type===bs.Media){const x=_;this._addStreamToMediaConnection(v,x)}}}cleanup(){Ue.log("Cleaning up PeerConnection to "+this.connection.peer);const t=this.connection.peerConnection;if(!t)return;this.connection.peerConnection=null,t.onicecandidate=t.oniceconnectionstatechange=t.ondatachannel=t.ontrack=()=>{};const n=t.signalingState!=="closed";let s=!1;const l=this.connection.dataChannel;l&&(s=!!l.readyState&&l.readyState!=="closed"),(n||s)&&t.close()}async _makeOffer(){const t=this.connection.peerConnection,n=this.connection.provider;try{const s=await t.createOffer(this.connection.options.constraints);Ue.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(s.sdp=this.connection.options.sdpTransform(s.sdp)||s.sdp);try{await t.setLocalDescription(s),Ue.log("Set localDescription:",s,`for:${this.connection.peer}`);let l={sdp:s,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===bs.Data){const f=this.connection;l={...l,label:f.label,reliable:f.reliable,serialization:f.serialization}}n.socket.send({type:Gn.Offer,payload:l,dst:this.connection.peer})}catch(l){l!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(n.emitError(xn.WebRTC,l),Ue.log("Failed to setLocalDescription, ",l))}}catch(s){n.emitError(xn.WebRTC,s),Ue.log("Failed to createOffer, ",s)}}async _makeAnswer(){const t=this.connection.peerConnection,n=this.connection.provider;try{const s=await t.createAnswer();Ue.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(s.sdp=this.connection.options.sdpTransform(s.sdp)||s.sdp);try{await t.setLocalDescription(s),Ue.log("Set localDescription:",s,`for:${this.connection.peer}`),n.socket.send({type:Gn.Answer,payload:{sdp:s,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(l){n.emitError(xn.WebRTC,l),Ue.log("Failed to setLocalDescription, ",l)}}catch(s){n.emitError(xn.WebRTC,s),Ue.log("Failed to create answer, ",s)}}async handleSDP(t,n){n=new RTCSessionDescription(n);const s=this.connection.peerConnection,l=this.connection.provider;Ue.log("Setting remote description",n);const f=this;try{await s.setRemoteDescription(n),Ue.log(`Set remoteDescription:${t} for:${this.connection.peer}`),t==="OFFER"&&await f._makeAnswer()}catch(m){l.emitError(xn.WebRTC,m),Ue.log("Failed to setRemoteDescription, ",m)}}async handleCandidate(t){Ue.log("handleCandidate:",t);try{await this.connection.peerConnection.addIceCandidate(t),Ue.log(`Added ICE candidate for:${this.connection.peer}`)}catch(n){this.connection.provider.emitError(xn.WebRTC,n),Ue.log("Failed to handleCandidate, ",n)}}_addTracksToConnection(t,n){if(Ue.log(`add tracks from stream ${t.id} to peer connection`),!n.addTrack)return Ue.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");t.getTracks().forEach(s=>{n.addTrack(s,t)})}_addStreamToMediaConnection(t,n){Ue.log(`add stream ${t.id} to media connection ${n.connectionId}`),n.addStream(t)}}class sx extends ld.EventEmitter{emitError(t,n){Ue.error("Error:",n),this.emit("error",new Hw(`${t}`,n))}}class Hw extends Error{constructor(t,n){typeof n=="string"?super(n):(super(),Object.assign(this,n)),this.type=t}}class ox extends sx{get open(){return this._open}constructor(t,n,s){super(),this.peer=t,this.provider=n,this.options=s,this._open=!1,this.metadata=s.metadata}}var nh;const Ba=class Ba extends ox{get type(){return bs.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(t,n,s){super(t,n,s),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||Ba.ID_PREFIX+pr.randomToken(),this._negotiator=new ix(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(t){this.dataChannel=t,this.dataChannel.onopen=()=>{Ue.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{Ue.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(t){Ue.log("Receiving stream",t),this._remoteStream=t,super.emit("stream",t)}handleMessage(t){const n=t.type,s=t.payload;switch(t.type){case Gn.Answer:this._negotiator.handleSDP(n,s.sdp),this._open=!0;break;case Gn.Candidate:this._negotiator.handleCandidate(s.candidate);break;default:Ue.warn(`Unrecognized message type:${n} from peer:${this.peer}`);break}}answer(t,n={}){if(this._localStream){Ue.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=t,n&&n.sdpTransform&&(this.options.sdpTransform=n.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:t});const s=this.provider._getMessages(this.connectionId);for(const l of s)this.handleMessage(l);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}};nh=new WeakMap,la(Ba,nh,Ba.ID_PREFIX="mc_");let Pc=Ba;class Vw{constructor(t){this._options=t}_buildRequest(t){const n=this._options.secure?"https":"http",{host:s,port:l,path:f,key:m}=this._options,v=new URL(`${n}://${s}:${l}${f}${m}/${t}`);return v.searchParams.set("ts",`${Date.now()}${Math.random()}`),v.searchParams.set("version",rx),fetch(v.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const t=await this._buildRequest("id");if(t.status!==200)throw new Error(`Error. Status:${t.status}`);return t.text()}catch(t){Ue.error("Error retrieving ID",t);let n="";throw this._options.path==="/"&&this._options.host!==pr.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+n)}}async listAllPeers(){try{const t=await this._buildRequest("peers");if(t.status!==200){if(t.status===401){let n="";throw this._options.host===pr.CLOUD_HOST?n="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":n="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n)}throw new Error(`Error. Status:${t.status}`)}return t.json()}catch(t){throw Ue.error("Error retrieving list peers",t),new Error("Could not get list peers from the server."+t)}}}var rh,ih;const zs=class zs extends ox{get type(){return bs.Data}constructor(t,n,s){super(t,n,s),this.connectionId=this.options.connectionId||zs.ID_PREFIX+tx(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new ix(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(t){this.dataChannel=t,this.dataChannel.onopen=()=>{Ue.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=n=>{Ue.log(`DC#${this.connectionId} dc onmessage:`,n.data)},this.dataChannel.onclose=()=>{Ue.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(t){if(t!=null&&t.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(t,n=!1){if(!this.open){this.emitError(cd.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(t,n)}async handleMessage(t){const n=t.payload;switch(t.type){case Gn.Answer:await this._negotiator.handleSDP(t.type,n.sdp);break;case Gn.Candidate:await this._negotiator.handleCandidate(n.candidate);break;default:Ue.warn("Unrecognized message type:",t.type,"from peer:",this.peer);break}}};rh=new WeakMap,ih=new WeakMap,la(zs,rh,zs.ID_PREFIX="dc_"),la(zs,ih,zs.MAX_BUFFERED_AMOUNT=8388608);let Dc=zs;class ud extends Dc{get bufferSize(){return this._bufferSize}_initializeDataChannel(t){super._initializeDataChannel(t),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",n=>this._handleDataMessage(n))}_bufferedSend(t){(this._buffering||!this._trySend(t))&&(this._buffer.push(t),this._bufferSize=this._buffer.length)}_trySend(t){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>Dc.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(t)}catch(n){return Ue.error(`DC#:${this.connectionId} Error when sending:`,n),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const t=this._buffer[0];this._trySend(t)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(t){if(t!=null&&t.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...t){super(...t),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class Hu extends ud{close(t){super.close(t),this._chunkedData={}}constructor(t,n,s){super(t,n,s),this.chunker=new ex,this.serialization=iu.Binary,this._chunkedData={}}_handleDataMessage({data:t}){const n=_m(t),s=n.__peerData;if(s){if(s.type==="close"){this.close();return}this._handleChunk(n);return}this.emit("data",n)}_handleChunk(t){const n=t.__peerData,s=this._chunkedData[n]||{data:[],count:0,total:t.total};if(s.data[t.n]=new Uint8Array(t.data),s.count++,this._chunkedData[n]=s,s.total===s.count){delete this._chunkedData[n];const l=Lw(s.data);this._handleDataMessage({data:l})}}_send(t,n){const s=vm(t);if(s instanceof Promise)return this._send_blob(s);if(!n&&s.byteLength>this.chunker.chunkedMTU){this._sendChunks(s);return}this._bufferedSend(s)}async _send_blob(t){const n=await t;if(n.byteLength>this.chunker.chunkedMTU){this._sendChunks(n);return}this._bufferedSend(n)}_sendChunks(t){const n=this.chunker.chunk(t);Ue.log(`DC#${this.connectionId} Try to send ${n.length} chunks...`);for(const s of n)this.send(s,!0)}}class Ww extends ud{_handleDataMessage({data:t}){super.emit("data",t)}_send(t,n){this._bufferedSend(t)}constructor(...t){super(...t),this.serialization=iu.None}}class Zw extends ud{_handleDataMessage({data:t}){const n=this.parse(this.decoder.decode(t)),s=n.__peerData;if(s&&s.type==="close"){this.close();return}this.emit("data",n)}_send(t,n){const s=this.encoder.encode(this.stringify(t));if(s.byteLength>=pr.chunkedMTU){this.emitError(cd.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(s)}constructor(...t){super(...t),this.serialization=iu.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}var sh;const Fa=class Fa extends sx{get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const t=Object.create(null);for(const[n,s]of this._connections)t[n]=s;return t}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(t,n){super(),this._serializers={raw:Ww,json:Zw,binary:Hu,"binary-utf8":Hu,default:Hu},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let s;if(t&&t.constructor==Object?n=t:t&&(s=t.toString()),n={debug:0,host:pr.CLOUD_HOST,port:pr.CLOUD_PORT,path:"/",key:Fa.DEFAULT_KEY,token:pr.randomToken(),config:pr.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...n},this._options=n,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==pr.CLOUD_HOST?this._options.secure=pr.isSecure():this._options.host==pr.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&Ue.setLogFunction(this._options.logFunction),Ue.logLevel=this._options.debug||0,this._api=new Vw(n),this._socket=this._createServerConnection(),!pr.supports.audioVideo&&!pr.supports.data){this._delayedAbort(xn.BrowserIncompatible,"The current browser does not support WebRTC");return}if(s&&!pr.validateId(s)){this._delayedAbort(xn.InvalidID,`ID "${s}" is invalid`);return}s?this._initialize(s):this._api.retrieveId().then(l=>this._initialize(l)).catch(l=>this._abort(xn.ServerError,l))}_createServerConnection(){const t=new Uw(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t.on(gs.Message,n=>{this._handleMessage(n)}),t.on(gs.Error,n=>{this._abort(xn.SocketError,n)}),t.on(gs.Disconnected,()=>{this.disconnected||(this.emitError(xn.Network,"Lost connection to server."),this.disconnect())}),t.on(gs.Close,()=>{this.disconnected||this._abort(xn.SocketClosed,"Underlying socket is already closed.")}),t}_initialize(t){this._id=t,this.socket.start(t,this._options.token)}_handleMessage(t){const n=t.type,s=t.payload,l=t.src;switch(n){case Gn.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case Gn.Error:this._abort(xn.ServerError,s.msg);break;case Gn.IdTaken:this._abort(xn.UnavailableID,`ID "${this.id}" is taken`);break;case Gn.InvalidKey:this._abort(xn.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case Gn.Leave:Ue.log(`Received leave message from ${l}`),this._cleanupPeer(l),this._connections.delete(l);break;case Gn.Expire:this.emitError(xn.PeerUnavailable,`Could not connect to peer ${l}`);break;case Gn.Offer:{const f=s.connectionId;let m=this.getConnection(l,f);if(m&&(m.close(),Ue.warn(`Offer received for existing Connection ID:${f}`)),s.type===bs.Media){const _=new Pc(l,this,{connectionId:f,_payload:s,metadata:s.metadata});m=_,this._addConnection(l,m),this.emit("call",_)}else if(s.type===bs.Data){const _=new this._serializers[s.serialization](l,this,{connectionId:f,_payload:s,metadata:s.metadata,label:s.label,serialization:s.serialization,reliable:s.reliable});m=_,this._addConnection(l,m),this.emit("connection",_)}else{Ue.warn(`Received malformed connection type:${s.type}`);return}const v=this._getMessages(f);for(const _ of v)m.handleMessage(_);break}default:{if(!s){Ue.warn(`You received a malformed message from ${l} of type ${n}`);return}const f=s.connectionId,m=this.getConnection(l,f);m&&m.peerConnection?m.handleMessage(t):f?this._storeMessage(f,t):Ue.warn("You received an unrecognized message:",t);break}}}_storeMessage(t,n){this._lostMessages.has(t)||this._lostMessages.set(t,[]),this._lostMessages.get(t).push(n)}_getMessages(t){const n=this._lostMessages.get(t);return n?(this._lostMessages.delete(t),n):[]}connect(t,n={}){if(n={serialization:"default",...n},this.disconnected){Ue.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(xn.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const s=new this._serializers[n.serialization](t,this,n);return this._addConnection(t,s),s}call(t,n,s={}){if(this.disconnected){Ue.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(xn.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!n){Ue.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const l=new Pc(t,this,{...s,_stream:n});return this._addConnection(t,l),l}_addConnection(t,n){Ue.log(`add connection ${n.type}:${n.connectionId} to peerId:${t}`),this._connections.has(t)||this._connections.set(t,[]),this._connections.get(t).push(n)}_removeConnection(t){const n=this._connections.get(t.peer);if(n){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}this._lostMessages.delete(t.connectionId)}getConnection(t,n){const s=this._connections.get(t);if(!s)return null;for(const l of s)if(l.connectionId===n)return l;return null}_delayedAbort(t,n){setTimeout(()=>{this._abort(t,n)},0)}_abort(t,n){Ue.error("Aborting!"),this.emitError(t,n),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(Ue.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const t of this._connections.keys())this._cleanupPeer(t),this._connections.delete(t);this.socket.removeAllListeners()}_cleanupPeer(t){const n=this._connections.get(t);if(n)for(const s of n)s.close()}disconnect(){if(this.disconnected)return;const t=this.id;Ue.log(`Disconnect peer with ID:${t}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=t,this._id=null,this.emit("disconnected",t)}reconnect(){if(this.disconnected&&!this.destroyed)Ue.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)Ue.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(t=n=>{}){this._api.listAllPeers().then(n=>t(n)).catch(n=>this._abort(xn.ServerError,n))}};sh=new WeakMap,la(Fa,sh,Fa.DEFAULT_KEY="peerjs");let th=Fa;var v1=th;const Gw=()=>{const e=["#ef4444","#f97316","#f59e0b","#84cc16","#10b981","#06b6d4","#3b82f6","#8b5cf6","#d946ef","#f43f5e"];return e[Math.floor(Math.random()*e.length)]},Yw=()=>Math.random().toString(36).substr(2,6).toUpperCase(),ax=td((e,t)=>({connectionStatus:"disconnected",myPeerId:null,logs:[],peers:{},myColor:Gw(),peerInstance:null,addLog:(n,s="info")=>{console.log(`[P2P] ${n}`),e(l=>({logs:[...l.logs,{time:new Date().toLocaleTimeString(),message:n,type:s}]}))},clearLogs:()=>e({logs:[]}),cleanup:()=>{const{peerInstance:n,peers:s}=t();Object.values(s).forEach(l=>{l.conn&&l.conn.close()}),n&&n.destroy(),e({connectionStatus:"disconnected",myPeerId:null,peers:{},peerInstance:null}),t().addLog("All connections closed and cleaned up")},initializeReceiver:()=>{t().cleanup();const n=Yw(),s=new v1(n);e({connectionStatus:"connecting",peerInstance:s}),t().addLog(`Initializing Receiver with ID: ${n}...`),s.on("open",l=>{e({myPeerId:l,connectionStatus:"connected"}),t().addLog(`Receiver ready. Share ID: ${l}`)}),s.on("connection",l=>{t().handleConnection(l)}),s.on("error",l=>{t().addLog(`PeerJS Error: ${l.type} - ${l.message}`,"error")})},connectToReceiver:n=>{t().cleanup();const s=new v1;e({connectionStatus:"connecting",peerInstance:s}),t().addLog("Initializing Sender..."),s.on("open",l=>{e({myPeerId:l}),t().addLog(`Sender ready. Connecting to ${n}...`);const f=s.connect(n);t().handleConnection(f)}),s.on("error",l=>{t().addLog(`PeerJS Error: ${l.type} - ${l.message}`,"error")})},handleConnection:n=>{n.on("open",()=>{t().addLog(`Connected to ${n.peer}`);const s=t().myColor;n.send({type:"handshake",payload:{color:s}}),e(l=>({peers:{...l.peers,[n.peer]:{id:n.peer,conn:n,status:"connected"}},connectionStatus:"connected"}))}),n.on("data",s=>{const l=n.peer;e(f=>{const m={...f.peers};if(!m[l])return{};let v={...m[l]};return s.type==="location"?v.location=s.payload:s.type==="routes"?(v.routes=s.payload,t().addLog(`[${l}] Received routes update`)):s.type==="message"?t().addLog(`[${l}] Says: ${s.payload}`,"message-received"):s.type==="handshake"&&(v.color=s.payload.color,t().addLog(`[${l}] Color set to ${s.payload.color}`)),m[l]=v,{peers:m}})}),n.on("close",()=>{t().removePeer(n.peer)}),n.on("error",s=>{t().addLog(`Connection Error: ${s}`,"error")})},removePeer:n=>{e(s=>{const l={...s.peers};return l[n]&&delete l[n],{peers:l}}),t().addLog(`Peer ${n} disconnected`)},sendMessage:n=>{const{peers:s}=t();Object.values(s).forEach(l=>{l.conn&&l.conn.open&&l.conn.send({type:"message",payload:n})}),t().addLog(`Sent to all: ${n}`,"message-sent")},sendLocation:n=>{const{peers:s}=t();Object.values(s).forEach(l=>{l.conn&&l.conn.open&&l.conn.send({type:"location",payload:n})})},sendRoutes:n=>{const{peers:s}=t();Object.values(s).forEach(l=>{l.conn&&l.conn.open&&l.conn.send({type:"routes",payload:n})}),t().addLog("Sent routes update to all peers")}})),Xw=({onScan:e,onClose:t})=>(Y.useEffect(()=>{const n=new Cw("reader",{fps:10,qrbox:{width:250,height:250}},!1);return n.render(s=>{e(s),n.clear()},s=>{}),()=>{n.clear().catch(s=>console.error("Failed to clear scanner",s))}},[e]),T.jsxs("div",{className:"fixed inset-0 z-[2000] bg-black/90 flex flex-col items-center justify-center p-4",children:[T.jsx("div",{id:"reader",className:"w-full max-w-sm bg-white rounded-lg overflow-hidden"}),T.jsx("button",{onClick:t,className:"mt-4 px-6 py-2 bg-slate-700 text-white rounded-full",children:"Close Camera"})]})),$w=()=>{const{connectionStatus:e,myPeerId:t,initializeReceiver:n,connectToReceiver:s,logs:l,sendMessage:f,cleanup:m,peers:v,myColor:_,clearLogs:x}=ax(),[E,b]=Y.useState(""),[M,F]=Y.useState(""),[z,U]=Y.useState("receiver"),[re,H]=Y.useState(!1),D=Y.useRef(null);Y.useEffect(()=>{var V;(V=D.current)==null||V.scrollIntoView({behavior:"smooth"})},[l]);const B=()=>{navigator.clipboard.writeText(t),alert("ID copied to clipboard!")},$=()=>{n()},fe=()=>{E&&s(E)},pe=V=>{b(V),H(!1),s(V)},K=V=>{V.preventDefault(),M&&(f(M),F(""))},q=Object.keys(v).length;return T.jsxs("div",{className:"p-4 bg-slate-900 text-slate-100 rounded-lg shadow-md max-w-md mx-auto mt-4 border border-slate-800",children:[T.jsx("h2",{className:"text-xl font-bold mb-4 text-slate-100",children:"P2P Connection Manager"}),T.jsxs("div",{className:"mb-4 flex flex-col gap-2",children:[T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsxs("span",{className:`px-2 py-1 rounded text-sm font-semibold ${e==="connected"?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/50":e==="connecting"?"bg-amber-500/20 text-amber-400 border border-amber-500/50":"bg-slate-800 text-slate-400 border border-slate-700"}`,children:["Status: ",e]}),e==="connected"&&T.jsxs("span",{className:"text-xs text-slate-400",children:["(",q," peer",q!==1?"s":"",")"]})]}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("div",{className:"w-4 h-4 rounded-full border border-white/20",style:{backgroundColor:_},title:"My Color"}),e!=="disconnected"&&T.jsx("button",{onClick:m,className:"text-sm text-rose-400 hover:text-rose-300 underline",children:"Disconnect"})]})]}),q>0&&T.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:Object.values(v).map(V=>T.jsxs("div",{className:"flex items-center gap-1 bg-slate-800 px-2 py-1 rounded border border-slate-700 text-xs",children:[T.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:V.color||"#ccc"}}),T.jsx("span",{className:"text-slate-300",title:V.id,children:V.id.substring(0,6)})]},V.id))})]}),T.jsxs("div",{className:"flex space-x-4 mb-6 border-b border-slate-700 pb-2",children:[T.jsx("button",{className:`pb-2 transition-colors ${z==="receiver"?"border-b-2 border-sky-500 font-bold text-sky-400":"text-slate-400 hover:text-slate-200"}`,onClick:()=>U("receiver"),children:"Receiver (HQ)"}),T.jsx("button",{className:`pb-2 transition-colors ${z==="sender"?"border-b-2 border-sky-500 font-bold text-sky-400":"text-slate-400 hover:text-slate-200"}`,onClick:()=>U("sender"),children:"Sender (Field)"})]}),z==="receiver"&&T.jsxs("div",{children:[T.jsx("button",{onClick:$,className:"w-full bg-sky-600 text-white py-2 rounded hover:bg-sky-500 transition font-semibold mb-4",disabled:e!=="disconnected",children:e==="disconnected"?"Start Session":"Session Active"}),e==="connecting"&&!t&&T.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-4",children:[T.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-sky-500"}),T.jsx("p",{className:"text-slate-400 text-sm",children:"Initializing Session..."})]}),t&&T.jsxs("div",{className:"mt-4 space-y-4 animate-in fade-in slide-in-from-top-4 duration-300",children:[T.jsxs("div",{className:"bg-amber-500/10 p-3 rounded border border-amber-500/30 text-sm text-amber-200",children:["Share this ",T.jsx("strong",{children:"Session Code"})," with field agents"]}),T.jsx("div",{className:"flex justify-center bg-white p-4 rounded-lg",children:T.jsx(fm,{value:t,size:192})}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("input",{readOnly:!0,value:t,className:"flex-1 p-2 text-center text-lg font-bold tracking-widest border border-slate-700 rounded bg-slate-950 text-sky-400 font-mono focus:outline-none"}),T.jsx("button",{onClick:B,className:"px-4 border border-slate-600 rounded hover:bg-slate-800 text-slate-300 transition",children:"Copy"})]})]})]}),z==="sender"&&T.jsxs("div",{children:[e==="disconnected"&&T.jsxs("div",{className:"space-y-4",children:[T.jsxs("div",{className:"bg-amber-500/10 p-3 rounded border border-amber-500/30 text-sm text-amber-200",children:["Enter the ",T.jsx("strong",{children:"Session Code"})," from HQ"]}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("input",{placeholder:"Enter Code",value:E,onChange:V=>b(V.target.value.toUpperCase()),className:"flex-1 p-2 text-lg font-mono border border-slate-700 rounded bg-slate-950 text-slate-100 focus:border-sky-500 focus:outline-none"}),T.jsx("button",{onClick:()=>H(!0),className:"px-3 bg-slate-700 text-white rounded hover:bg-slate-600 transition",title:"Scan QR Code",children:""})]}),T.jsx("button",{onClick:fe,className:"w-full bg-emerald-600 text-white py-2 rounded hover:bg-emerald-500 transition font-semibold disabled:opacity-50 disabled:cursor-not-allowed",disabled:!E,children:"Connect to HQ"})]}),e==="connecting"&&T.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-4",children:[T.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-sky-500"}),T.jsx("p",{className:"text-slate-400 text-sm",children:"Connecting to HQ..."})]})]}),re&&T.jsx(Xw,{onScan:pe,onClose:()=>H(!1)}),e==="connected"&&T.jsx("div",{className:"mt-4",children:T.jsxs("form",{onSubmit:K,className:"flex gap-2",children:[T.jsx("input",{type:"text",value:M,onChange:V=>F(V.target.value),placeholder:"Type a message...",className:"flex-1 border border-slate-700 bg-slate-950 text-slate-100 rounded px-2 py-1 focus:border-sky-500 focus:outline-none"}),T.jsx("button",{type:"submit",className:"bg-sky-600 text-white px-4 py-1 rounded hover:bg-sky-500 transition",children:"Send"})]})}),T.jsxs("div",{className:"mt-6 border-t border-slate-700 pt-2",children:[T.jsxs("div",{className:"flex items-center justify-between mb-1",children:[T.jsx("h3",{className:"text-xs font-bold text-slate-500",children:"Connection Logs"}),T.jsx("button",{onClick:x,className:"text-[10px] text-slate-500 hover:text-slate-300 underline",children:"Clear"})]}),T.jsxs("div",{className:"h-32 overflow-y-auto bg-slate-950 p-2 text-xs font-mono rounded border border-slate-800",children:[l.length===0&&T.jsx("span",{className:"text-slate-600",children:"No logs yet..."}),l.map((V,le)=>{const ce=V.type==="message-received"||V.type==="message-sent",ue=V.type==="message-received"?"text-sky-400":V.type==="message-sent"?"text-emerald-400":V.type==="error"?"text-rose-400":"text-slate-400";return T.jsxs("div",{className:`${ue} ${ce?"font-bold":""}`,children:[T.jsxs("span",{className:"opacity-50 mr-2",children:["[",V.time,"]"]}),V.message]},le)}),T.jsx("div",{ref:D})]})]})]})},Qw=()=>{const{checkpoints:e,checkpointMap:t,routes:n,activeRouteId:s,selectedId:l,selectCheckpoint:f,addCheckpoint:m}=$o(),[v,_]=Y.useState(null);Y.useEffect(()=>{!v&&s&&_(s)},[s,v]);const x=Y.useMemo(()=>{const Ie=v||s,Me=n.find(Ve=>Ve.id===Ie);return Me?Me.items.map((Ve,It)=>{const Dt=t[Ve];return Dt?{id:Dt.id,label:Dt.name||`Point ${It+1}`,position:Dt.position}:null}).filter(Boolean):[]},[v,s,n,t]),E=Y.useMemo(()=>x.find(Ie=>Ie.id===l)??null,[x,l]),b=(E==null?void 0:E.position)??null,{heading:M,bearing:F,distance:z,geolocation:U,error:re,needsPermission:H,isSupported:D,locationEnabled:B,hasLocationFix:$,isRequestingLocation:fe,requestPermission:pe,startGeolocation:K}=pv(b),{sendLocation:q,sendRoutes:V,connectionStatus:le,peers:ce}=ax(),ue=Y.useRef(0);Y.useEffect(()=>{if(le==="connected"&&U){const Ie=Date.now();Ie-ue.current>1e4&&(q(U),ue.current=Ie)}},[U,le,q]),Y.useEffect(()=>{if(le==="connected"){const Ie=n.map(Me=>({...Me,items:Me.items.map(Ve=>t[Ve]).filter(Boolean)}));V(Ie)}},[le,n,t,V]);const Q=Y.useMemo(()=>x.filter(Ie=>Ie.id!==l).map(Ie=>{if(!U)return{...Ie,bearing:null,distance:null,relativeBearing:null};const Me=Kg(U,Ie.position),Ve=Jg(M,Me);return{...Ie,bearing:Me,distance:qg(U,Ie.position),relativeBearing:Ve??Me}}),[U,x,l,M]),[ne,Z]=Y.useState(null),[ye,he]=Y.useState(!1),[J,de]=Y.useState(!1),[ae,Ce]=Y.useState(0),[Ne,Qe]=Y.useState("degrees"),[we,Le]=Y.useState("topo"),[ge,mt]=Y.useState("light"),[He,Bn]=Y.useState(.58),[Fn,Ot]=Y.useState(null),[yt,$e]=Y.useState(!1),Sn=Y.useRef(null),Xt=Y.useRef(!1),Rn=Y.useRef(null),[Oe,We]=Y.useState(!1),Xe=.32,$t=.85,Te=Y.useCallback(Ie=>Math.min(Math.max(Ie,Xe),$t),[$t,Xe]),Lt=Y.useCallback(()=>{const Ie=K();return Ie&&Ce(Me=>Me+1),Ie},[K]),ki=Y.useCallback(()=>{Qe(Ie=>Ie==="degrees"?"mils":"degrees")},[]),hn=Y.useCallback(()=>{he(Ie=>{const Me=!Ie;return Me&&(Z(null),de(!1)),Me})},[]),Oi=Y.useCallback(()=>{de(Ie=>{const Me=!Ie;return Me&&(Z(null),he(!1)),Me})},[]),Ct=Y.useCallback(Ie=>{Z(Me=>Me===Ie?null:Ie),he(!1),de(!1),Bn(Me=>Te(Me))},[Te]),gi=Y.useCallback(()=>{Ct("compass")},[Ct]),Qn=Y.useCallback(()=>{Ct("checkpoints")},[Ct]),Pt=Y.useCallback(Ie=>{const Me=Sn.current;if(!Me)return;const{startY:Ve,startHeight:It}=Me;if(window.innerHeight===0)return;const Dt=(Ve-Ie.clientY)/window.innerHeight,Ge=Math.abs(Ve-Ie.clientY);!Me.moved&&Ge>6&&(Me.moved=!0),Bn(Te(It+Dt))},[Te]),Kn=Y.useCallback(()=>{var Me,Ve;const Ie=Sn.current;Ie!=null&&Ie.target&&Ie.pointerId!=null&&((Ve=(Me=Ie.target).releasePointerCapture)==null||Ve.call(Me,Ie.pointerId)),Sn.current=null,window.removeEventListener("pointermove",Pt),window.removeEventListener("pointerup",Kn),Ie&&!Ie.moved&&Ie.overlayId&&Z(It=>It===Ie.overlayId?null:It)},[Pt,Z]),An=Y.useCallback(Ie=>{var Dt,Ge;if(window.innerHeight===0)return;Ie.preventDefault();const Me=Ie.pointerId,Ve=Ie.clientY,It=Ie.currentTarget.dataset.overlayId??null;Sn.current={startY:Ve,startHeight:He,pointerId:Me,target:Ie.currentTarget,overlayId:It,moved:!1},(Ge=(Dt=Ie.currentTarget).setPointerCapture)==null||Ge.call(Dt,Me),window.addEventListener("pointermove",Pt,{passive:!0}),window.addEventListener("pointerup",Kn,{passive:!0})},[He,Pt,Kn]);Y.useEffect(()=>()=>{window.removeEventListener("pointermove",Pt),window.removeEventListener("pointerup",Kn)},[Pt,Kn]);const jn=Y.useMemo(()=>({"--overlay-height":`${(Te(He)*100).toFixed(2)}vh`,"--overlay-max-height":`${($t*100).toFixed(2)}vh`}),[$t,Te,He]);Y.useEffect(()=>{if(typeof window>"u"||!window.matchMedia)return;window.matchMedia("(prefers-color-scheme: dark)").matches&&(Le(Me=>Me==="street"?"dark":Me),mt("dark"))},[]),Y.useEffect(()=>{Lt()},[Lt]),Y.useEffect(()=>{Rn.current=U},[U]),Y.useEffect(()=>{if(!Xt.current){Xt.current=!0;return}B?Lt():Rn.current&&Ce(Ie=>Ie+1)},[we,B,Lt]);const wt=Y.useCallback(()=>{mt(Ie=>Ie==="light"?"dark":"light")},[]),Ae=Y.useCallback((Ie,Me)=>{m(Me)},[m]);return Y.useEffect(()=>{Ot(null)},[e]),T.jsxs("div",{className:"relative viewport-safe bg-slate-950 text-slate-100",children:[T.jsx(hv,{userLocation:U,peers:ce,userHeading:M,targets:Q,onEnableLocation:Lt,locationEnabled:B,hasLocationFix:$,isRequestingLocation:fe,locationRequestToken:ae,baseLayer:we,onBaseLayerChange:Le,onToggleMenu:hn,onOpenCompass:gi,onOpenRoute:Qn,toolbarTheme:ge,onToolbarThemeToggle:wt,isMenuOpen:ye,isSettingsOpen:J,onToggleSettings:Oi,previewLocation:Fn,onDropItem:Ae,hideToolbar:Oe}),!Oe&&ne==="compass"&&T.jsxs("div",{className:"pointer-events-auto overlay-sheet fixed inset-x-0 bottom-0 z-[1300] mx-auto w-full max-w-md overflow-y-auto overscroll-contain rounded-t-3xl border border-slate-800 bg-slate-900 p-3 shadow-2xl shadow-slate-950/80 md:bottom-6 md:left-auto md:right-6 md:max-w-sm md:rounded-2xl",style:jn,children:[T.jsx("div",{className:"mb-3 flex justify-center",children:T.jsx("button",{type:"button","data-overlay-id":"compass",className:"group flex h-12 w-full max-w-[220px] cursor-row-resize items-center justify-center rounded-full bg-slate-900 shadow-inner shadow-slate-950/40 ring-1 ring-slate-700/60 transition hover:ring-slate-500/80 active:bg-slate-800 touch-none","aria-label":"Drag to resize or tap to close panel",onPointerDown:An,children:T.jsx("span",{className:"block h-2 w-16 rounded-full bg-slate-500 transition group-active:bg-slate-300"})})}),T.jsxs("div",{className:"mb-2 text-left text-[11px]",children:[T.jsx("p",{className:"font-semibold uppercase tracking-wide text-slate-500",children:"Compass"}),T.jsx("p",{className:"text-xs text-slate-400",children:"Heading & bearings"})]}),T.jsx(mv,{heading:M,bearing:F,distance:z,error:re,enableCompass:pe,onEnableLocation:Lt,needsPermission:H,isSupported:D,locationEnabled:B,hasLocationFix:$,isRequestingLocation:fe,targets:Q,selectedTarget:E,onSelectTarget:f,bearingUnit:Ne,onToggleBearingUnit:ki,routes:n,activeRouteId:v,onSelectRoute:_})]}),!Oe&&ne==="checkpoints"&&T.jsxs("div",{className:"pointer-events-auto overlay-sheet fixed inset-x-0 bottom-0 z-[1300] mx-auto w-full max-w-md overflow-y-auto overscroll-contain rounded-t-3xl border border-slate-800 bg-slate-900 p-3 shadow-2xl shadow-slate-950/80 md:left-6 md:right-auto md:top-6 md:max-w-xs md:rounded-2xl md:rounded-bl-none md:rounded-br-xl",style:jn,children:[T.jsx("div",{className:"mb-3 flex justify-center",children:T.jsx("button",{type:"button","data-overlay-id":"checkpoints",className:"group flex h-12 w-full max-w-[220px] cursor-row-resize items-center justify-center rounded-full bg-slate-900 shadow-inner shadow-slate-950/40 ring-1 ring-slate-700/60 transition hover:ring-slate-500/80 active:bg-slate-800 touch-none","aria-label":"Drag to resize or tap to close panel",onPointerDown:An,children:T.jsx("span",{className:"block h-2 w-16 rounded-full bg-slate-500 transition group-active:bg-slate-300"})})}),T.jsxs("div",{className:"mb-2 text-left text-[11px]",children:[T.jsx("p",{className:"font-semibold uppercase tracking-wide text-slate-500",children:"Route tools"}),T.jsx("p",{className:"text-xs text-slate-400",children:"Manage checkpoints"})]}),T.jsx(yv,{onEnterPlacingMode:()=>We(!0)})]}),!Oe&&ne==="grid"&&T.jsxs("div",{className:"pointer-events-auto overlay-sheet fixed inset-x-0 bottom-0 z-[1300] mx-auto w-full max-w-md overflow-y-auto overscroll-contain rounded-t-3xl border border-slate-800 bg-slate-900 p-3 shadow-2xl shadow-slate-950/80 md:left-auto md:right-6 md:top-6 md:max-w-md md:rounded-2xl",style:jn,children:[T.jsx("div",{className:"mb-3 flex justify-center",children:T.jsx("button",{type:"button","data-overlay-id":"grid",className:"group flex h-12 w-full max-w-[220px] cursor-row-resize items-center justify-center rounded-full bg-slate-900 shadow-inner shadow-slate-950/40 ring-1 ring-slate-700/60 transition hover:ring-slate-500/80 active:bg-slate-800 touch-none","aria-label":"Drag to resize or tap to close panel",onPointerDown:An,children:T.jsx("span",{className:"block h-2 w-16 rounded-full bg-slate-500 transition group-active:bg-slate-300"})})}),T.jsxs("div",{className:"mb-2 text-left text-[11px]",children:[T.jsx("p",{className:"font-semibold uppercase tracking-wide text-slate-500",children:"Grid tools"}),T.jsx("p",{className:"text-xs text-slate-400",children:"References & bearings"})]}),T.jsx(Tv,{userLocation:U,selectedPosition:b,onPreviewLocationChange:Ot})]}),!Oe&&ne==="p2p"&&T.jsxs("div",{className:"pointer-events-auto overlay-sheet fixed inset-x-0 bottom-0 z-[1300] mx-auto w-full max-w-md overflow-y-auto overscroll-contain rounded-t-3xl border border-slate-800 bg-slate-900 p-3 shadow-2xl shadow-slate-950/80 md:left-auto md:right-6 md:top-6 md:max-w-md md:rounded-2xl",style:jn,children:[T.jsx("div",{className:"mb-3 flex justify-center",children:T.jsx("button",{type:"button","data-overlay-id":"p2p",className:"group flex h-12 w-full max-w-[220px] cursor-row-resize items-center justify-center rounded-full bg-slate-900 shadow-inner shadow-slate-950/40 ring-1 ring-slate-700/60 transition hover:ring-slate-500/80 active:bg-slate-800 touch-none","aria-label":"Drag to resize or tap to close panel",onPointerDown:An,children:T.jsx("span",{className:"block h-2 w-16 rounded-full bg-slate-500 transition group-active:bg-slate-300"})})}),T.jsxs("div",{className:"mb-2 text-left text-[11px]",children:[T.jsx("p",{className:"font-semibold uppercase tracking-wide text-slate-500",children:"P2P Connection"}),T.jsx("p",{className:"text-xs text-slate-400",children:"Share location & routes"})]}),T.jsx($w,{})]}),!Oe&&ye&&T.jsx("div",{className:"pointer-events-auto absolute inset-x-0 bottom-28 z-[1300] flex justify-center px-4 md:bottom-32",children:T.jsxs("div",{className:"w-full max-w-xs rounded-2xl border border-slate-800 bg-slate-950 p-3 text-[12px] text-slate-100 shadow-xl shadow-slate-950/80",children:[T.jsx("p",{className:"mb-2 text-[11px] font-semibold uppercase tracking-wide text-slate-400",children:"Navigate"}),T.jsxs("div",{className:"flex flex-col gap-2",children:[T.jsxs("button",{type:"button",className:`flex items-center justify-between rounded-lg border px-3 py-2 font-semibold transition ${ne==="compass"?"border-sky-500 bg-sky-500 text-slate-950":"border-slate-700 bg-slate-900 hover:border-sky-500 hover:text-sky-100"}`,onClick:()=>Ct("compass"),children:["Compass",T.jsx("span",{className:`text-[10px] ${ne==="compass"?"text-slate-800":"text-slate-400"}`,children:"Heading"})]}),T.jsxs("button",{type:"button",className:`flex items-center justify-between rounded-lg border px-3 py-2 font-semibold transition ${ne==="checkpoints"?"border-sky-500 bg-sky-500 text-slate-950":"border-slate-700 bg-slate-900 hover:border-sky-500 hover:text-sky-100"}`,onClick:()=>Ct("checkpoints"),children:["Route",T.jsx("span",{className:`text-[10px] ${ne==="checkpoints"?"text-slate-800":"text-slate-400"}`,children:"Checkpoints"})]}),T.jsxs("button",{type:"button",className:`flex items-center justify-between rounded-lg border px-3 py-2 font-semibold transition ${ne==="grid"?"border-sky-500 bg-sky-500 text-slate-950":"border-slate-700 bg-slate-900 hover:border-sky-500 hover:text-sky-100"}`,onClick:()=>Ct("grid"),children:["Grid",T.jsx("span",{className:`text-[10px] ${ne==="grid"?"text-slate-800":"text-slate-400"}`,children:"Conversions"})]}),T.jsxs("button",{type:"button",className:`flex items-center justify-between rounded-lg border px-3 py-2 font-semibold transition ${ne==="p2p"?"border-sky-500 bg-sky-500 text-slate-950":"border-slate-700 bg-slate-900 hover:border-sky-500 hover:text-sky-100"}`,onClick:()=>Ct("p2p"),children:["P2P Share",T.jsx("span",{className:`text-[10px] ${ne==="p2p"?"text-slate-800":"text-slate-400"}`,children:"Connect"})]})]}),T.jsx("p",{className:"mt-3 text-[11px] text-slate-400",children:"Choose a tool to open its overlay. Tap Menu again to close this panel."})]})}),Oe&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"absolute inset-x-0 bottom-8 z-[1400] flex justify-center pointer-events-none",children:T.jsx(Nv,{})}),T.jsxs("div",{className:"absolute top-4 right-4 z-[1400] flex gap-3",children:[T.jsx("button",{type:"button",className:"flex h-10 w-10 items-center justify-center rounded-full border border-slate-600 bg-slate-900 text-slate-200 shadow-lg transition hover:bg-slate-800",title:"Help",onClick:()=>$e(!0),children:"?"}),T.jsx("button",{onClick:()=>We(!1),className:"flex h-10 w-10 items-center justify-center rounded-full border border-red-500/50 bg-red-900/40 text-red-200 shadow-lg backdrop-blur-sm transition hover:bg-red-900/60",title:"Exit Placing Mode",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"h-6 w-6",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})]}),yt&&T.jsx("div",{className:"fixed inset-0 z-[1500] flex items-center justify-center bg-slate-950/60 p-4 backdrop-blur-sm",children:T.jsxs("div",{className:"w-full max-w-sm rounded-2xl border border-slate-700 bg-slate-900 p-6 shadow-2xl",children:[T.jsx("h3",{className:"mb-2 text-lg font-bold text-slate-100",children:"How placement works"}),T.jsxs("ul",{className:"mb-6 list-disc space-y-2 pl-5 text-sm text-slate-300",children:[T.jsxs("li",{children:[T.jsx("strong",{children:"Drag & drop:"})," The single puck in the bottom toolbar matches your active route colour. Drag it onto the map to add a checkpoint to that route at the drop point."]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Control the order:"})," In the Route panel, tap ",T.jsx("em",{children:"Insert Before"})," or ",T.jsx("em",{children:"Insert After"}),". The next checkpoint you drop will slot into that position; otherwise its appended to the end."]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Grid & projections:"})," Use the Grid Tools to resolve or project a coordinate. Drop the puck onto the magenta preview marker to capture that exact location."]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Edit or move:"})," Drag any existing checkpoint marker to fine-tune its location, or use the accordion controls to rename, recolour, or delete it."]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Exit placement:"})," Tap the red X button in the top-right corner when youre done."]})]}),T.jsx("button",{onClick:()=>$e(!1),className:"w-full rounded-lg bg-sky-600 py-2.5 text-sm font-semibold text-white transition hover:bg-sky-500",children:"Got it"})]})})]})},Kw=()=>T.jsx(Qw,{});Xy.polyfill({dragImageTranslateOverride:$y.scrollBehaviourDragImageTranslateOverride});window.addEventListener("touchmove",()=>{},{passive:!1});Vu.createRoot(document.getElementById("root")).render(T.jsx(Gt.StrictMode,{children:T.jsx(Kw,{})}));
